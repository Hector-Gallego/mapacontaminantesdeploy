(self.webpackChunkmapa_contaminantes_frontend=self.webpackChunkmapa_contaminantes_frontend||[]).push([[179],{6075:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{J:()=>x});var m=_e(2096),be=_e(9468),ge=_e(9862);let x=(()=>{class tt{constructor(Ze){this.http=Ze,this.companysUrl="http://mapa-contaminantes-backend-dev.us-east-2.elasticbeanstalk.com/api/companies"}getCompanies(){return this.http.get(this.companysUrl)}getCompany(Ze){return this.http.get(`${this.companysUrl}/${Ze}`)}getEconomyActivities(Ze){let yt="";if(Ze&&Ze.economyActivityCIIUs&&Ze.economyActivityCIIUs.length>0){for(const Ht of Ze.economyActivityCIIUs)yt+=Ht.name+", ";yt=yt.slice(0,-2)}return yt}searchCompany(Ze){return Ze.trim()?this.http.get(`${this.companysUrl}/term/${Ze}`):(0,m.of)([])}}return tt.\u0275fac=function(Ze){return new(Ze||tt)(be.LFG(ge.eN))},tt.\u0275prov=be.Yz7({token:tt,factory:tt.\u0275fac,providedIn:"root"}),tt})()},3691:(ri,Lt,_e)=>{"use strict";_e.r(Lt),_e.d(Lt,{CompanyDetailsModule:()=>vi});var m=_e(594),be=_e(9468),ge=_e(6075),x=_e(6814),tt=_e(6303);function Pe(Vt,Tt){if(1&Vt&&(be.TgZ(0,"li",4)(1,"div",5)(2,"div",6),be._UZ(3,"i",7),be.TgZ(4,"span",8),be._uU(5),be.qZA()(),be.TgZ(6,"div",9),be._UZ(7,"i",10),be.TgZ(8,"span",8),be._uU(9,"Descripci\xf3n"),be.qZA()(),be.TgZ(10,"p"),be._uU(11),be.qZA()()()),2&Vt){const wt=Tt.$implicit;be.xp6(5),be.hij("C\xf3digo de residuo: ",wt.code,""),be.xp6(6),be.Oqu(wt.name)}}function Ze(Vt,Tt){if(1&Vt&&(be.ynx(0),be.TgZ(1,"ul",2),be.YNc(2,Pe,12,2,"li",3),be.qZA(),be.BQk()),2&Vt){const wt=be.oxw();be.xp6(2),be.Q6J("ngForOf",null==wt.ecoAct?null:wt.ecoAct.residualCurrents)}}function yt(Vt,Tt){if(1&Vt&&(be.TgZ(0,"li",4)(1,"div",5)(2,"div",6),be._UZ(3,"i",7),be.TgZ(4,"span",8),be._uU(5),be.qZA()(),be.TgZ(6,"div",9),be._UZ(7,"i",10),be.TgZ(8,"span",8),be._uU(9,"Descripci\xf3n"),be.qZA()(),be.TgZ(10,"p"),be._uU(11),be.qZA()()()),2&Vt){const wt=Tt.$implicit;be.xp6(5),be.hij("C\xf3digo de de producto o/y servicio: ",wt.code,""),be.xp6(6),be.Oqu(wt.name)}}function Ht(Vt,Tt){if(1&Vt&&(be.TgZ(0,"ul",2),be.YNc(1,yt,12,2,"li",3),be.qZA()),2&Vt){const wt=be.oxw();be.xp6(1),be.Q6J("ngForOf",null==wt.ecoAct?null:wt.ecoAct.centralProductClasificationCPCs)}}let $t=(()=>{class Vt{constructor(){this.residuo=!0}}return Vt.\u0275fac=function(wt){return new(wt||Vt)},Vt.\u0275cmp=be.Xpm({type:Vt,selectors:[["app-list-acordeon-company"]],inputs:{ecoAct:"ecoAct",residuo:"residuo"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["productsList",""],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"d-flex","flex-column"],[1,"d-flex","align-items-center"],[1,"bi","bi-code","me-3",2,"font-size","1.2rem","color","rgb(44, 101, 206)"],[1,"fw-medium"],[1,"mb-3","d-flex","align-items-center"],[1,"me-3","bi","bi-info-circle",2,"font-size","1.2rem","color","rgb(44, 101, 206)"]],template:function(wt,Et){if(1&wt&&(be.YNc(0,Ze,3,1,"ng-container",0),be.YNc(1,Ht,2,1,"ng-template",null,1,be.W1O)),2&wt){const Bt=be.MAs(2);be.Q6J("ngIf",Et.residuo)("ngIfElse",Bt)}},dependencies:[x.sg,x.O5]}),Vt})();function It(Vt,Tt){if(1&Vt&&be._UZ(0,"app-list-acordeon-company",19),2&Vt){const wt=be.oxw().$implicit;be.Q6J("residuo",!0)("ecoAct",wt)}}function bt(Vt,Tt){if(1&Vt&&be._UZ(0,"app-list-acordeon-company",20),2&Vt){const wt=be.oxw().$implicit;be.Q6J("ecoAct",wt)("residuo",!1)}}function Zt(Vt,Tt){if(1&Vt&&(be.TgZ(0,"div",1)(1,"div",2)(2,"h2",3)(3,"button",4)(4,"div",5)(5,"div",6),be._UZ(6,"i",7),be.TgZ(7,"span",8),be._uU(8),be.qZA()(),be.TgZ(9,"div",9),be._UZ(10,"i",10),be.TgZ(11,"span",8),be._uU(12,"Descripci\xf3n"),be.qZA()(),be.TgZ(13,"p"),be._uU(14),be.qZA()()()(),be.TgZ(15,"div",11)(16,"div",1)(17,"div",12)(18,"h2",3)(19,"button",4)(20,"div",13),be._UZ(21,"i",14),be.TgZ(22,"span",8),be._uU(23,"Residuos asociados a esta actividad econ\xf3mica"),be.qZA()()()(),be.TgZ(24,"div",11)(25,"div",15),be.YNc(26,It,1,2,"ng-template"),be.qZA()()(),be.TgZ(27,"div",12)(28,"h2",3)(29,"button",4)(30,"div",13),be._UZ(31,"i",16),be.TgZ(32,"span",8),be._uU(33,"Productos y/o servicios asociados a esta actividad econ\xf3mica"),be.qZA()()()(),be.TgZ(34,"div",17)(35,"div",18),be.YNc(36,bt,1,2,"ng-template"),be.qZA()()()()()()()),2&Vt){const wt=Tt.$implicit;be.xp6(8),be.hij("C\xf3digo CIIU: ",wt.code,""),be.xp6(6),be.hij(" ",wt.name,"")}}let dt=(()=>{class Vt{}return Vt.\u0275fac=function(wt){return new(wt||Vt)},Vt.\u0275cmp=be.Xpm({type:Vt,selectors:[["app-acordeon-company"]],inputs:{company:"company"},decls:1,vars:1,consts:[["ngbAccordion","",4,"ngFor","ngForOf"],["ngbAccordion",""],["ngbAccordionItem","",1,"mb-2"],["ngbAccordionHeader",""],["ngbAccordionButton",""],[1,"d-flex","flex-column"],[1,"mb-2","d-flex","align-items-center"],[1,"bi","bi-code","me-3",2,"font-size","1.2rem","color","rgb(44, 101, 206)"],[1,"fw-medium"],[1,"mb-4","d-flex","align-items-center"],[1,"me-3","bi","bi-info-circle",2,"font-size","1.2rem","color","rgb(44, 101, 206)"],["ngbAccordionCollapse",""],["ngbAccordionItem",""],[1,"d-flex","align-items-center"],[1,"me-3","bi","bi-radioactive",2,"font-size","1.3rem","color","rgb(187, 197, 40)"],["ngbAccordionBody","",1,"scroll-acordeon"],[1,"me-3","bi","bi-box",2,"font-size","1.3rem","color","rgb(44, 101, 206)"],["ngbAccordionCollapse","",1,"scroll-acordeon"],["ngbAccordionBody",""],[3,"residuo","ecoAct"],[3,"ecoAct","residuo"]],template:function(wt,Et){1&wt&&be.YNc(0,Zt,37,2,"div",0),2&wt&&be.Q6J("ngForOf",null==Et.company?null:Et.company.economyActivityCIIUs)},dependencies:[x.sg,tt.fD,tt.QQ,tt.VE,tt.I,tt.fA,tt.ud,$t],styles:[".scroll-acordeon[_ngcontent-%COMP%]{overflow-y:auto!important;max-height:50vh;position:relative}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#cfe2ff;border-radius:4px}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background-color:#8ebbff}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#f1f1f1}"]}),Vt})();const Tn=[{path:"company/detail/:id",component:(()=>{class Vt{constructor(wt,Et){this.route=wt,this.companyService=Et,this.panelOpenState=!1}ngOnInit(){this.getCompany()}getCompany(){const wt=Number(this.route.snapshot.paramMap.get("id"));this.companyService.getCompany(wt).subscribe(Et=>{this.company=Et,Et.economyActivityCIIUs.forEach(Bt=>{console.log(Bt.centralProductClasificationCPCs)})})}}return Vt.\u0275fac=function(wt){return new(wt||Vt)(be.Y36(m.gz),be.Y36(ge.J))},Vt.\u0275cmp=be.Xpm({type:Vt,selectors:[["app-detail-company"]],decls:20,vars:3,consts:[[1,"container"],[1,"mt-5"],[1,"font-ralewey"],[1,"d-flex","align-items-center"],[1,"me-3","bi","bi-geo-alt",2,"font-size","1.3rem","color","rgb(44, 101, 206)"],[1,"mb-0"],[1,"mt-5","mb-5"],[1,"mb-5"],[1,"mb-3"],[3,"company"]],template:function(wt,Et){1&wt&&(be.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),be._uU(3),be.qZA(),be.TgZ(4,"div",3),be._UZ(5,"i",4),be.TgZ(6,"p",5),be._uU(7),be.qZA()()(),be.TgZ(8,"div",6)(9,"div",7)(10,"h3",8),be._uU(11,"Actividades Econ\xf3micas"),be.qZA(),be.TgZ(12,"p"),be._uU(13," A continuaci\xf3n se presentan las actividades econ\xf3micas asociadas a esta empresa. Al desplegar una actividad econ\xf3mica, podr\xe1s visualizar las corrientes de residuos y los productos o servicios asociados a esa actividad econ\xf3mica. "),be._UZ(14,"br")(15,"br"),be._uU(16," Cabe destacar que los residuos, productos y/o servicios no est\xe1n directamente relacionados con la empresa en cuesti\xf3n, simplemente se trata de datos potencialmente relacionados con esta empresa en base a sus actividades econ\xf3micas. "),be._UZ(17,"br")(18,"br"),be.qZA()(),be._UZ(19,"app-acordeon-company",9),be.qZA()()),2&wt&&(be.xp6(3),be.Oqu(null==Et.company?null:Et.company.name),be.xp6(4),be.hij(" ",null==Et.company?null:Et.company.adress,""),be.xp6(12),be.Q6J("company",Et.company))},dependencies:[dt],styles:[".bd-callout-info[_ngcontent-%COMP%]{background-color:#cff4fc;border-left:solid 5px #9eeaf9;color:#106ebb}"]}),Vt})()}];let Gn=(()=>{class Vt{}return Vt.\u0275fac=function(wt){return new(wt||Vt)},Vt.\u0275mod=be.oAB({type:Vt}),Vt.\u0275inj=be.cJS({imports:[m.Bz.forChild(Tn),m.Bz]}),Vt})();var yi=_e(6208);let vi=(()=>{class Vt{}return Vt.\u0275fac=function(wt){return new(wt||Vt)},Vt.\u0275mod=be.oAB({type:Vt}),Vt.\u0275inj=be.cJS({imports:[Gn,yi.m]}),Vt})()},1014:(ri,Lt,_e)=>{"use strict";_e.r(Lt),_e.d(Lt,{CompanyListModule:()=>bn});var m=_e(6208),be=_e(594),ge=_e(9468),x=_e(9862);let tt=(()=>{class en{constructor(Jt){this.http=Jt}getResults(Jt,Pn){return this.http.get(`http://mapa-contaminantes-backend-dev.us-east-2.elasticbeanstalk.com/api/companies/pages?page=${Jt}&size=${Pn}`)}}return en.\u0275fac=function(Jt){return new(Jt||en)(ge.LFG(x.eN))},en.\u0275prov=ge.Yz7({token:en,factory:en.\u0275fac,providedIn:"root"}),en})();var Pe=_e(6075),Ze=_e(7417),yt=_e(6814),Ht=_e(6303),$t=_e(9729),It=_e(8645),bt=_e(4352),Zt=_e(9360),dt=_e(8251),Tn=_e(3997),Gn=_e(4664);const yi=["searchBox"];function vi(en,ui){if(1&en&&(ge.TgZ(0,"div")(1,"li",13)(2,"a",14),ge._uU(3),ge.qZA()()()),2&en){const Jt=ui.$implicit;ge.xp6(2),ge.MGl("routerLink","/company/detail/",Jt.id,""),ge.xp6(1),ge.hij(" ",Jt.name," ")}}let Vt=(()=>{class en{constructor(Jt){this.companyService=Jt,this.isSearching=!1,this.searchTerms=new It.x}search(Jt){this.searchTerms.next(Jt),this.isSearching=Jt.length>0}clearSearchBox(){this.isSearching=!1,this.searchBox&&(this.searchBox.nativeElement.value=""),this.searchTerms.next("")}ngOnInit(){this.companies$=this.searchTerms.pipe(function nn(en,ui=bt.z){return(0,Zt.e)((Jt,Pn)=>{let Mi=null,bi=null,ft=null;const ht=()=>{if(Mi){Mi.unsubscribe(),Mi=null;const Nt=bi;bi=null,Pn.next(Nt)}};function Pt(){const Nt=ft+en,hn=ui.now();if(hn<Nt)return Mi=this.schedule(void 0,Nt-hn),void Pn.add(Mi);ht()}Jt.subscribe((0,dt.x)(Pn,Nt=>{bi=Nt,ft=ui.now(),Mi||(Mi=ui.schedule(Pt,en),Pn.add(Mi))},()=>{ht(),Pn.complete()},void 0,()=>{bi=Mi=null}))})}(300),(0,Tn.x)(),(0,Gn.w)(Jt=>this.companyService.searchCompany(Jt)))}}return en.\u0275fac=function(Jt){return new(Jt||en)(ge.Y36(Pe.J))},en.\u0275cmp=ge.Xpm({type:en,selectors:[["app-search"]],viewQuery:function(Jt,Pn){if(1&Jt&&ge.Gf(yi,5),2&Jt){let Mi;ge.iGM(Mi=ge.CRH())&&(Pn.searchBox=Mi.first)}},decls:14,vars:4,consts:[["id","search-component",1,"mt-5","container"],[1,"row","justify-content-center","mt-5"],[1,"col-md-8","col-lg-8","col-sm-12"],[1,"input-group"],["id","search-box","type","text","placeholder","Buscar Empresa",1,"form-control",3,"input"],["searchBox",""],[1,"input-group-text",3,"click"],[1,"bi",3,"ngClass"],[1,"row","justify-content-center"],[1,"col-md-8","col-lg-8","col-sm-12","bg-primary"],[1,"cont-body","overflow-auto","z-3","position-absolute",2,"max-height","200px"],[1,"list-group"],[4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"link-offset-2","link-underline","link-underline-opacity-0",3,"routerLink"]],template:function(Jt,Pn){if(1&Jt){const Mi=ge.EpF();ge.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"input",4,5),ge.NdJ("input",function(){ge.CHM(Mi);const ft=ge.MAs(5);return ge.KtG(Pn.search(ft.value))}),ge.qZA(),ge.TgZ(6,"span",6),ge.NdJ("click",function(){return Pn.clearSearchBox()}),ge._UZ(7,"i",7),ge.qZA()()()(),ge.TgZ(8,"div",8)(9,"div",9)(10,"div",10)(11,"ul",11),ge.YNc(12,vi,4,2,"div",12),ge.ALo(13,"async"),ge.qZA()()()()()}2&Jt&&(ge.xp6(7),ge.Q6J("ngClass",Pn.isSearching?"bi-trash3":"bi-search"),ge.xp6(5),ge.Q6J("ngForOf",ge.lcZ(13,2,Pn.companies$)))},dependencies:[yt.mk,yt.sg,be.rH,yt.Ov],styles:[".cont-body[_ngcontent-%COMP%]{overflow-y:auto!important;position:relative}.cont-body[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}.cont-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#bcd7ff;border-radius:4px}.cont-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background-color:#8ebbff}.cont-body[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#f1f1f1}"]}),en})(),Tt=(()=>{class en{transform(Jt,Pn){return Jt.length>Pn?Jt.substr(0,Pn)+"...":Jt}}return en.\u0275fac=function(Jt){return new(Jt||en)},en.\u0275pipe=ge.Yjl({name:"ellipsis",type:en,pure:!0}),en})();const wt=["container"],Et=["class","list"];function Bt(en,ui){1&en&&ge._UZ(0,"app-sppiner")}function lt(en,ui){if(1&en){const Jt=ge.EpF();ge.TgZ(0,"div")(1,"div",8)(2,"div",9)(3,"h5",10),ge._uU(4),ge.qZA()(),ge.TgZ(5,"ul",11)(6,"li",12)(7,"h6"),ge._UZ(8,"i",13),ge._uU(9,"Direcci\xf3n:"),ge.qZA(),ge.TgZ(10,"p"),ge._uU(11),ge.ALo(12,"ellipsis"),ge.qZA()(),ge.TgZ(13,"li",12)(14,"h6"),ge._UZ(15,"i",14),ge._uU(16,"Actividades econ\xf3micas"),ge.qZA(),ge.TgZ(17,"p"),ge._uU(18),ge.ALo(19,"ellipsis"),ge.qZA()()(),ge.TgZ(20,"div",9)(21,"button",15),ge.NdJ("click",function(){const bi=ge.CHM(Jt).$implicit,ft=ge.oxw();return ge.KtG(ft.goToRouteCompanyDetail(bi.id))}),ge._uU(22,"Detalles"),ge.qZA(),ge.TgZ(23,"button",15),ge.NdJ("click",function(){const bi=ge.CHM(Jt).$implicit,ft=ge.oxw();return ge.KtG(ft.goToRouteMap(bi.latitude,bi.longitude))}),ge._uU(24,"Ver en mapa"),ge.qZA()()()()}if(2&en){const Jt=ui.$implicit,Pn=ge.oxw();ge.xp6(4),ge.Oqu(Jt.name),ge.xp6(7),ge.Oqu(ge.xi3(12,3,Jt.adress,30)),ge.xp6(7),ge.Oqu(ge.xi3(19,6,Pn.getActivities(Jt),50))}}const nt=[{path:"company/list",component:(()=>{class en{constructor(Jt,Pn,Mi,bi){this.pageableService=Jt,this.companyService=Pn,this.router=Mi,this.toastService=bi,this.content=[],this.page=1,this.size=6,this.totalElements=0,this.currentPage=1,this.loading=!0}ngOnInit(){this.getResults()}getActivities(Jt){return this.companyService.getEconomyActivities(Jt)}getResults(){this.pageableService.getResults(this.currentPage-1,this.size).subscribe(Jt=>{this.result=Jt,this.content=Jt.content,this.totalElements=Jt.totalElements,this.loading=!1})}onPaginationChanged(Jt){this.currentPage=Jt,this.getResults(),this.containerElementRef.nativeElement.scrollIntoView({behavior:"smooth",block:"start"})}goToRouteCompanyDetail(Jt){this.router.navigate([`/company/detail/${Jt}`])}goToRouteMap(Jt,Pn){this.router.navigate([`/map/${Jt}/${Pn}`])}}return en.\u0275fac=function(Jt){return new(Jt||en)(ge.Y36(tt),ge.Y36(Pe.J),ge.Y36(be.F0),ge.Y36(Ze.k))},en.\u0275cmp=ge.Xpm({type:en,selectors:[["app-company",8,"list"]],viewQuery:function(Jt,Pn){if(1&Jt&&ge.Gf(wt,5),2&Jt){let Mi;ge.iGM(Mi=ge.CRH())&&(Pn.containerElementRef=Mi.first)}},attrs:Et,decls:9,vars:5,consts:[[1,"container"],["container",""],[1,"mt-5"],[1,"d-flex","flex-wrap","justify-content-around","mt-5","position-relative",2,"min-height","50vh"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center","mt-5","mb-5"],[3,"page","pageSize","collectionSize","pageChange"],[1,"card","mt-3",2,"width","20rem","height","25rem"],[1,"card-body"],[1,"card-title","text-primary","mt-3"],[1,"list-group","list-group-flush"],[1,"list-group-item"],[1,"bi","bi-pin-map-fill","me-3"],[1,"bi","bi-gear","me-3"],[1,"btn","btn-link",3,"click"]],template:function(Jt,Pn){1&Jt&&(ge.TgZ(0,"div",0,1)(2,"div",2),ge._UZ(3,"app-search"),ge.qZA(),ge.TgZ(4,"div",3),ge.YNc(5,Bt,1,0,"app-sppiner",4),ge.YNc(6,lt,25,9,"div",5),ge.qZA(),ge.TgZ(7,"div",6)(8,"ngb-pagination",7),ge.NdJ("pageChange",function(bi){return Pn.onPaginationChanged(bi)}),ge.qZA()()()),2&Jt&&(ge.xp6(5),ge.Q6J("ngIf",Pn.loading),ge.xp6(1),ge.Q6J("ngForOf",Pn.content),ge.xp6(2),ge.Q6J("page",Pn.page)("pageSize",Pn.size)("collectionSize",Pn.totalElements))},dependencies:[yt.sg,yt.O5,Ht.N9,$t.O,Vt,Tt],styles:[".cont-body[_ngcontent-%COMP%]{overflow-y:auto!important;position:relative}.cont-body[_ngcontent-%COMP%]::-webkit-scrollbar{width:10px}.cont-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#bcd7ff;border-radius:4px}.cont-body[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background-color:#8ebbff}.cont-body[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#f1f1f1}.bd-callout-info[_ngcontent-%COMP%]{background-color:#cff4fc;border-left:solid 5px #9eeaf9;color:#106ebb}"]}),en})()}];let xt=(()=>{class en{}return en.\u0275fac=function(Jt){return new(Jt||en)},en.\u0275mod=ge.oAB({type:en}),en.\u0275inj=ge.cJS({imports:[be.Bz.forChild(nt),be.Bz]}),en})(),bn=(()=>{class en{}return en.\u0275fac=function(Jt){return new(Jt||en)},en.\u0275mod=ge.oAB({type:en}),en.\u0275inj=ge.cJS({imports:[m.m,xt]}),en})()},7787:(ri,Lt,_e)=>{"use strict";_e.r(Lt),_e.d(Lt,{DashboardFeatureModule:()=>xy});var m=_e(6208),be=_e(594),ge=_e(9468);function x(s){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(l){return typeof l}:function(l){return l&&"function"==typeof Symbol&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l})(s)}function Ze(s,l,r){return(l=function Pe(s){var l=function tt(s,l){if("object"!==x(s)||null===s)return s;var r=s[Symbol.toPrimitive];if(void 0!==r){var u=r.call(s,l||"default");if("object"!==x(u))return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===l?String:Number)(s)}(s,"string");return"symbol"===x(l)?l:String(l)}(l))in s?Object.defineProperty(s,l,{value:r,enumerable:!0,configurable:!0,writable:!0}):s[l]=r,s}function yt(s){return s+.5|0}const Ht=(s,l,r)=>Math.max(Math.min(s,r),l);function $t(s){return Ht(yt(2.55*s),0,255)}function bt(s){return Ht(yt(255*s),0,255)}function Zt(s){return Ht(yt(s/2.55)/100,0,1)}function dt(s){return Ht(yt(100*s),0,100)}const nn={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Tn=[..."0123456789ABCDEF"],Gn=s=>Tn[15&s],yi=s=>Tn[(240&s)>>4]+Tn[15&s],vi=s=>(240&s)>>4==(15&s);const Bt=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function lt(s,l,r){const u=l*Math.min(r,1-r),p=(v,E=(v+s/30)%12)=>r-u*Math.max(Math.min(E-3,9-E,1),-1);return[p(0),p(8),p(4)]}function zt(s,l,r){const u=(p,v=(p+s/60)%6)=>r-r*l*Math.max(Math.min(v,4-v,1),0);return[u(5),u(3),u(1)]}function nt(s,l,r){const u=lt(s,1,.5);let p;for(l+r>1&&(p=1/(l+r),l*=p,r*=p),p=0;p<3;p++)u[p]*=1-l-r,u[p]+=l;return u}function bn(s){const r=s.r/255,u=s.g/255,p=s.b/255,v=Math.max(r,u,p),E=Math.min(r,u,p),I=(v+E)/2;let L,H,Q;return v!==E&&(Q=v-E,H=I>.5?Q/(2-v-E):Q/(v+E),L=function xt(s,l,r,u,p){return s===p?(l-r)/u+(l<r?6:0):l===p?(r-s)/u+2:(s-l)/u+4}(r,u,p,Q,v),L=60*L+.5),[0|L,H||0,I]}function en(s,l,r,u){return(Array.isArray(l)?s(l[0],l[1],l[2]):s(l,r,u)).map(bt)}function ui(s,l,r){return en(lt,s,l,r)}function Mi(s){return(s%360+360)%360}const Pt={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Nt={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let ln;const mi=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,Si=s=>s<=.0031308?12.92*s:1.055*Math.pow(s,1/2.4)-.055,st=s=>s<=.04045?s/12.92:Math.pow((s+.055)/1.055,2.4);function er(s,l,r){if(s){let u=bn(s);u[l]=Math.max(0,Math.min(u[l]+u[l]*r,0===l?360:1)),u=ui(u),s.r=u[0],s.g=u[1],s.b=u[2]}}function Mn(s,l){return s&&Object.assign(l||{},s)}function An(s){var l={r:0,g:0,b:0,a:255};return Array.isArray(s)?s.length>=3&&(l={r:s[0],g:s[1],b:s[2],a:255},s.length>3&&(l.a=bt(s[3]))):(l=Mn(s,{r:0,g:0,b:0,a:1})).a=bt(l.a),l}function mt(s){return"r"===s.charAt(0)?function zi(s){const l=mi.exec(s);let u,p,v,r=255;if(l){if(l[7]!==u){const E=+l[7];r=l[8]?$t(E):Ht(255*E,0,255)}return u=+l[1],p=+l[3],v=+l[5],u=255&(l[2]?$t(u):Ht(u,0,255)),p=255&(l[4]?$t(p):Ht(p,0,255)),v=255&(l[6]?$t(v):Ht(v,0,255)),{r:u,g:p,b:v,a:r}}}(s):function bi(s){const l=Bt.exec(s);let u,r=255;if(!l)return;l[5]!==u&&(r=l[6]?$t(+l[5]):bt(+l[5]));const p=Mi(+l[2]),v=+l[3]/100,E=+l[4]/100;return u="hwb"===l[1]?function Jt(s,l,r){return en(nt,s,l,r)}(p,v,E):"hsv"===l[1]?function Pn(s,l,r){return en(zt,s,l,r)}(p,v,E):ui(p,v,E),{r:u[0],g:u[1],b:u[2],a:r}}(s)}class We{constructor(l){if(l instanceof We)return l;const r=typeof l;let u;"object"===r?u=An(l):"string"===r&&(u=function Tt(s){var r,l=s.length;return"#"===s[0]&&(4===l||5===l?r={r:255&17*nn[s[1]],g:255&17*nn[s[2]],b:255&17*nn[s[3]],a:5===l?17*nn[s[4]]:255}:(7===l||9===l)&&(r={r:nn[s[1]]<<4|nn[s[2]],g:nn[s[3]]<<4|nn[s[4]],b:nn[s[5]]<<4|nn[s[6]],a:9===l?nn[s[7]]<<4|nn[s[8]]:255})),r}(l)||function oi(s){ln||(ln=function hn(){const s={},l=Object.keys(Nt),r=Object.keys(Pt);let u,p,v,E,I;for(u=0;u<l.length;u++){for(E=I=l[u],p=0;p<r.length;p++)v=r[p],I=I.replace(v,Pt[v]);v=parseInt(Nt[E],16),s[I]=[v>>16&255,v>>8&255,255&v]}return s}(),ln.transparent=[0,0,0,0]);const l=ln[s.toLowerCase()];return l&&{r:l[0],g:l[1],b:l[2],a:4===l.length?l[3]:255}}(l)||mt(l)),this._rgb=u,this._valid=!!u}get valid(){return this._valid}get rgb(){var l=Mn(this._rgb);return l&&(l.a=Zt(l.a)),l}set rgb(l){this._rgb=An(l)}rgbString(){return this._valid?function di(s){return s&&(s.a<255?`rgba(${s.r}, ${s.g}, ${s.b}, ${Zt(s.a)})`:`rgb(${s.r}, ${s.g}, ${s.b})`)}(this._rgb):void 0}hexString(){return this._valid?function Et(s){var l=(s=>vi(s.r)&&vi(s.g)&&vi(s.b)&&vi(s.a))(s)?Gn:yi;return s?"#"+l(s.r)+l(s.g)+l(s.b)+((s,l)=>s<255?l(s):"")(s.a,l):void 0}(this._rgb):void 0}hslString(){return this._valid?function ht(s){if(!s)return;const l=bn(s),r=l[0],u=dt(l[1]),p=dt(l[2]);return s.a<255?`hsla(${r}, ${u}%, ${p}%, ${Zt(s.a)})`:`hsl(${r}, ${u}%, ${p}%)`}(this._rgb):void 0}mix(l,r){if(l){const u=this.rgb,p=l.rgb;let v;const E=r===v?.5:r,I=2*E-1,L=u.a-p.a,H=((I*L==-1?I:(I+L)/(1+I*L))+1)/2;v=1-H,u.r=255&H*u.r+v*p.r+.5,u.g=255&H*u.g+v*p.g+.5,u.b=255&H*u.b+v*p.b+.5,u.a=E*u.a+(1-E)*p.a,this.rgb=u}return this}interpolate(l,r){return l&&(this._rgb=function Ci(s,l,r){const u=st(Zt(s.r)),p=st(Zt(s.g)),v=st(Zt(s.b));return{r:bt(Si(u+r*(st(Zt(l.r))-u))),g:bt(Si(p+r*(st(Zt(l.g))-p))),b:bt(Si(v+r*(st(Zt(l.b))-v))),a:s.a+r*(l.a-s.a)}}(this._rgb,l._rgb,r)),this}clone(){return new We(this.rgb)}alpha(l){return this._rgb.a=bt(l),this}clearer(l){return this._rgb.a*=1-l,this}greyscale(){const l=this._rgb,r=yt(.3*l.r+.59*l.g+.11*l.b);return l.r=l.g=l.b=r,this}opaquer(l){return this._rgb.a*=1+l,this}negate(){const l=this._rgb;return l.r=255-l.r,l.g=255-l.g,l.b=255-l.b,this}lighten(l){return er(this._rgb,2,l),this}darken(l){return er(this._rgb,2,-l),this}saturate(l){return er(this._rgb,1,l),this}desaturate(l){return er(this._rgb,1,-l),this}rotate(l){return function ft(s,l){var r=bn(s);r[0]=Mi(r[0]+l),r=ui(r),s.r=r[0],s.g=r[1],s.b=r[2]}(this._rgb,l),this}}function kt(){}const gn=(()=>{let s=0;return()=>s++})();function Yt(s){return null===s||typeof s>"u"}function jn(s){if(Array.isArray&&Array.isArray(s))return!0;const l=Object.prototype.toString.call(s);return"[object"===l.slice(0,7)&&"Array]"===l.slice(-6)}function at(s){return null!==s&&"[object Object]"===Object.prototype.toString.call(s)}function qt(s){return("number"==typeof s||s instanceof Number)&&isFinite(+s)}function yn(s,l){return qt(s)?s:l}function Kn(s,l){return typeof s>"u"?l:s}const rn=(s,l)=>"string"==typeof s&&s.endsWith("%")?parseFloat(s)/100*l:+s;function On(s,l,r){if(s&&"function"==typeof s.call)return s.apply(r,l)}function Qt(s,l,r,u){let p,v,E;if(jn(s))if(v=s.length,u)for(p=v-1;p>=0;p--)l.call(r,s[p],p);else for(p=0;p<v;p++)l.call(r,s[p],p);else if(at(s))for(E=Object.keys(s),v=E.length,p=0;p<v;p++)l.call(r,s[E[p]],E[p])}function mr(s,l){let r,u,p,v;if(!s||!l||s.length!==l.length)return!1;for(r=0,u=s.length;r<u;++r)if(p=s[r],v=l[r],p.datasetIndex!==v.datasetIndex||p.index!==v.index)return!1;return!0}function ii(s){if(jn(s))return s.map(ii);if(at(s)){const l=Object.create(null),r=Object.keys(s),u=r.length;let p=0;for(;p<u;++p)l[r[p]]=ii(s[r[p]]);return l}return s}function Rn(s){return-1===["__proto__","prototype","constructor"].indexOf(s)}function Li(s,l,r,u){if(!Rn(s))return;const p=l[s],v=r[s];at(p)&&at(v)?Lr(p,v,u):l[s]=ii(v)}function Lr(s,l,r){const u=jn(l)?l:[l],p=u.length;if(!at(s))return s;const v=(r=r||{}).merger||Li;let E;for(let I=0;I<p;++I){if(E=u[I],!at(E))continue;const L=Object.keys(E);for(let H=0,Q=L.length;H<Q;++H)v(L[H],s,E,r)}return s}function _r(s,l){return Lr(s,l,{merger:Ai})}function Ai(s,l,r){if(!Rn(s))return;const u=l[s],p=r[s];at(u)&&at(p)?_r(u,p):Object.prototype.hasOwnProperty.call(l,s)||(l[s]=ii(p))}const si={"":s=>s,x:s=>s.x,y:s=>s.y};function Le(s,l){return(si[l]||(si[l]=function Vo(s){const l=function Br(s){const l=s.split("."),r=[];let u="";for(const p of l)u+=p,u.endsWith("\\")?u=u.slice(0,-1)+".":(r.push(u),u="");return r}(s);return r=>{for(const u of l){if(""===u)break;r=r&&r[u]}return r}}(l)))(s)}function he(s){return s.charAt(0).toUpperCase()+s.slice(1)}const ye=s=>typeof s<"u",Ie=s=>"function"==typeof s,Ve=(s,l)=>{if(s.size!==l.size)return!1;for(const r of s)if(!l.has(r))return!1;return!0},we=Math.PI,me=2*we,oe=me+we,Se=Number.POSITIVE_INFINITY,Ye=we/180,Xe=we/2,gt=we/4,mn=2*we/3,wn=Math.log10,sn=Math.sign;function Cn(s,l,r){return Math.abs(s-l)<r}function Fn(s){const l=Math.round(s);s=Cn(s,l,s/1e3)?l:s;const r=Math.pow(10,Math.floor(wn(s))),u=s/r;return(u<=1?1:u<=2?2:u<=5?5:10)*r}function Oe(s){return!isNaN(parseFloat(s))&&isFinite(s)}function Gt(s,l,r){let u,p,v;for(u=0,p=s.length;u<p;u++)v=s[u][r],isNaN(v)||(l.min=Math.min(l.min,v),l.max=Math.max(l.max,v))}function tn(s){return s*(we/180)}function Wt(s){return s*(180/we)}function cn(s){if(!qt(s))return;let l=1,r=0;for(;Math.round(s*l)/l!==s;)l*=10,r++;return r}function Zi(s,l){const r=l.x-s.x,u=l.y-s.y,p=Math.sqrt(r*r+u*u);let v=Math.atan2(u,r);return v<-.5*we&&(v+=me),{angle:v,distance:p}}function Qn(s,l){return Math.sqrt(Math.pow(l.x-s.x,2)+Math.pow(l.y-s.y,2))}function nr(s,l){return(s-l+oe)%me-we}function ji(s){return(s%me+me)%me}function Pr(s,l,r,u){const p=ji(s),v=ji(l),E=ji(r),I=ji(v-p),L=ji(E-p),H=ji(p-v),Q=ji(p-E);return p===v||p===E||u&&v===E||I>L&&H<Q}function Ki(s,l,r){return Math.max(l,Math.min(r,s))}function Hr(s,l,r,u=1e-6){return s>=Math.min(l,r)-u&&s<=Math.max(l,r)+u}function Hi(s,l,r){r=r||(E=>s[E]<l);let v,u=s.length-1,p=0;for(;u-p>1;)v=p+u>>1,r(v)?p=v:u=v;return{lo:p,hi:u}}const hi=(s,l,r,u)=>Hi(s,r,u?p=>{const v=s[p][l];return v<r||v===r&&s[p+1][l]===r}:p=>s[p][l]<r),Uo=(s,l,r)=>Hi(s,r,u=>s[u][l]>=r),lo=["push","pop","shift","splice","unshift"];function us(s,l){const r=s._chartjs;if(!r)return;const u=r.listeners,p=u.indexOf(l);-1!==p&&u.splice(p,1),!(u.length>0)&&(lo.forEach(v=>{delete s[v]}),delete s._chartjs)}function ds(s){const l=new Set(s);return l.size===s.length?s:Array.from(l)}const ir=typeof window>"u"?function(s){return s()}:window.requestAnimationFrame;function Ts(s,l){let r=[],u=!1;return function(...p){r=p,u||(u=!0,ir.call(window,()=>{u=!1,s.apply(l,r)}))}}const Ss=s=>"start"===s?"left":"end"===s?"right":"center",io=(s,l,r)=>"start"===s?l:"end"===s?r:(l+r)/2;function ts(s,l,r){const u=l.length;let p=0,v=u;if(s._sorted){const{iScale:E,_parsed:I}=s,L=E.axis,{min:H,max:Q,minDefined:pe,maxDefined:Me}=E.getUserBounds();pe&&(p=Ki(Math.min(hi(I,E.axis,H).lo,r?u:hi(l,L,E.getPixelForValue(H)).lo),0,u-1)),v=Me?Ki(Math.max(hi(I,E.axis,Q,!0).hi+1,r?0:hi(l,L,E.getPixelForValue(Q),!0).hi+1),p,u)-p:u-p}return{start:p,count:v}}function Ta(s){const{xScale:l,yScale:r,_scaleRanges:u}=s,p={xmin:l.min,xmax:l.max,ymin:r.min,ymax:r.max};if(!u)return s._scaleRanges=p,!0;const v=u.xmin!==l.min||u.xmax!==l.max||u.ymin!==r.min||u.ymax!==r.max;return Object.assign(u,p),v}const hs=s=>0===s||1===s,Sa=(s,l,r)=>-Math.pow(2,10*(s-=1))*Math.sin((s-l)*me/r),Qs=(s,l,r)=>Math.pow(2,-10*s)*Math.sin((s-l)*me/r)+1,$s={linear:s=>s,easeInQuad:s=>s*s,easeOutQuad:s=>-s*(s-2),easeInOutQuad:s=>(s/=.5)<1?.5*s*s:-.5*(--s*(s-2)-1),easeInCubic:s=>s*s*s,easeOutCubic:s=>(s-=1)*s*s+1,easeInOutCubic:s=>(s/=.5)<1?.5*s*s*s:.5*((s-=2)*s*s+2),easeInQuart:s=>s*s*s*s,easeOutQuart:s=>-((s-=1)*s*s*s-1),easeInOutQuart:s=>(s/=.5)<1?.5*s*s*s*s:-.5*((s-=2)*s*s*s-2),easeInQuint:s=>s*s*s*s*s,easeOutQuint:s=>(s-=1)*s*s*s*s+1,easeInOutQuint:s=>(s/=.5)<1?.5*s*s*s*s*s:.5*((s-=2)*s*s*s*s+2),easeInSine:s=>1-Math.cos(s*Xe),easeOutSine:s=>Math.sin(s*Xe),easeInOutSine:s=>-.5*(Math.cos(we*s)-1),easeInExpo:s=>0===s?0:Math.pow(2,10*(s-1)),easeOutExpo:s=>1===s?1:1-Math.pow(2,-10*s),easeInOutExpo:s=>hs(s)?s:s<.5?.5*Math.pow(2,10*(2*s-1)):.5*(2-Math.pow(2,-10*(2*s-1))),easeInCirc:s=>s>=1?s:-(Math.sqrt(1-s*s)-1),easeOutCirc:s=>Math.sqrt(1-(s-=1)*s),easeInOutCirc:s=>(s/=.5)<1?-.5*(Math.sqrt(1-s*s)-1):.5*(Math.sqrt(1-(s-=2)*s)+1),easeInElastic:s=>hs(s)?s:Sa(s,.075,.3),easeOutElastic:s=>hs(s)?s:Qs(s,.075,.3),easeInOutElastic:s=>hs(s)?s:s<.5?.5*Sa(2*s,.1125,.45):.5+.5*Qs(2*s-1,.1125,.45),easeInBack:s=>s*s*(2.70158*s-1.70158),easeOutBack:s=>(s-=1)*s*(2.70158*s+1.70158)+1,easeInOutBack(s){let l=1.70158;return(s/=.5)<1?s*s*((1+(l*=1.525))*s-l)*.5:.5*((s-=2)*s*((1+(l*=1.525))*s+l)+2)},easeInBounce:s=>1-$s.easeOutBounce(1-s),easeOutBounce:s=>s<1/2.75?7.5625*s*s:s<2/2.75?7.5625*(s-=1.5/2.75)*s+.75:s<2.5/2.75?7.5625*(s-=2.25/2.75)*s+.9375:7.5625*(s-=2.625/2.75)*s+.984375,easeInOutBounce:s=>s<.5?.5*$s.easeInBounce(2*s):.5*$s.easeOutBounce(2*s-1)+.5};function Oo(s){if(s&&"object"==typeof s){const l=s.toString();return"[object CanvasPattern]"===l||"[object CanvasGradient]"===l}return!1}function Ya(s){return Oo(s)?s:new We(s)}function Ma(s){return Oo(s)?s:new We(s).saturate(.5).darken(.1).hexString()}const dl=["x","y","borderWidth","radius","tension"],dr=["color","borderColor","backgroundColor"],xo=new Map;function Ms(s,l,r){return function Po(s,l){l=l||{};const r=s+JSON.stringify(l);let u=xo.get(r);return u||(u=new Intl.NumberFormat(s,l),xo.set(r,u)),u}(l,r).format(s)}const ks={values:s=>jn(s)?s:""+s,numeric(s,l,r){if(0===s)return"0";const u=this.chart.options.locale;let p,v=s;if(r.length>1){const H=Math.max(Math.abs(r[0].value),Math.abs(r[r.length-1].value));(H<1e-4||H>1e15)&&(p="scientific"),v=function Gs(s,l){let r=l.length>3?l[2].value-l[1].value:l[1].value-l[0].value;return Math.abs(r)>=1&&s!==Math.floor(s)&&(r=s-Math.floor(s)),r}(s,r)}const E=wn(Math.abs(v)),I=isNaN(E)?1:Math.max(Math.min(-1*Math.floor(E),20),0),L={notation:p,minimumFractionDigits:I,maximumFractionDigits:I};return Object.assign(L,this.options.ticks.format),Ms(s,u,L)},logarithmic(s,l,r){if(0===s)return"0";const u=r[l].significand||s/Math.pow(10,Math.floor(wn(s)));return[1,2,3,5,10,15].includes(u)||l>.8*r.length?ks.numeric.call(this,s,l,r):""}};var qa={formatters:ks};const rr=Object.create(null),Ln=Object.create(null);function ai(s,l){if(!l)return s;const r=l.split(".");for(let u=0,p=r.length;u<p;++u){const v=r[u];s=s[v]||(s[v]=Object.create(null))}return s}function Fi(s,l,r){return"string"==typeof l?Lr(ai(s,l),r):Lr(ai(s,""),l)}class ro{constructor(l,r){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=u=>u.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(u,p)=>Ma(p.backgroundColor),this.hoverBorderColor=(u,p)=>Ma(p.borderColor),this.hoverColor=(u,p)=>Ma(p.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(l),this.apply(r)}set(l,r){return Fi(this,l,r)}get(l){return ai(this,l)}describe(l,r){return Fi(Ln,l,r)}override(l,r){return Fi(rr,l,r)}route(l,r,u,p){const v=ai(this,l),E=ai(this,u),I="_"+r;Object.defineProperties(v,{[I]:{value:v[r],writable:!0},[r]:{enumerable:!0,get(){const L=this[I],H=E[p];return at(L)?Object.assign({},H,L):Kn(L,H)},set(L){this[I]=L}}})}apply(l){l.forEach(r=>r(this))}}var $i=new ro({_scriptable:s=>!s.startsWith("on"),_indexable:s=>"events"!==s,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function $r(s){s.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),s.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:l=>"onProgress"!==l&&"onComplete"!==l&&"fn"!==l}),s.set("animations",{colors:{type:"color",properties:dr},numbers:{type:"number",properties:dl}}),s.describe("animations",{_fallback:"animation"}),s.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:l=>0|l}}}})},function bo(s){s.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function Fs(s){s.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(l,r)=>r.lineWidth,tickColor:(l,r)=>r.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:qa.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),s.route("scale.ticks","color","","color"),s.route("scale.grid","color","","borderColor"),s.route("scale.border","color","","borderColor"),s.route("scale.title","color","","color"),s.describe("scale",{_fallback:!1,_scriptable:l=>!l.startsWith("before")&&!l.startsWith("after")&&"callback"!==l&&"parser"!==l,_indexable:l=>"borderDash"!==l&&"tickBorderDash"!==l&&"dash"!==l}),s.describe("scales",{_fallback:"scale"}),s.describe("scale.ticks",{_scriptable:l=>"backdropPadding"!==l&&"callback"!==l,_indexable:l=>"backdropPadding"!==l})}]);function fs(s,l,r,u,p){let v=l[p];return v||(v=l[p]=s.measureText(p).width,r.push(p)),v>u&&(u=v),u}function zr(s,l,r,u){let p=(u=u||{}).data=u.data||{},v=u.garbageCollect=u.garbageCollect||[];u.font!==l&&(p=u.data={},v=u.garbageCollect=[],u.font=l),s.save(),s.font=l;let E=0;const I=r.length;let L,H,Q,pe,Me;for(L=0;L<I;L++)if(pe=r[L],null==pe||jn(pe)){if(jn(pe))for(H=0,Q=pe.length;H<Q;H++)Me=pe[H],null!=Me&&!jn(Me)&&(E=fs(s,p,v,E,Me))}else E=fs(s,p,v,E,pe);s.restore();const Re=v.length/2;if(Re>r.length){for(L=0;L<Re;L++)delete p[v[L]];v.splice(0,Re)}return E}function Gr(s,l,r){const u=s.currentDevicePixelRatio,p=0!==r?Math.max(r/2,.5):0;return Math.round((l-p)*u)/u+p}function Ni(s,l){(l=l||s.getContext("2d")).save(),l.resetTransform(),l.clearRect(0,0,s.width,s.height),l.restore()}function Ei(s,l,r,u){ns(s,l,r,u,null)}function ns(s,l,r,u,p){let v,E,I,L,H,Q,pe,Me;const Re=l.pointStyle,qe=l.rotation,Qe=l.radius;let rt=(qe||0)*Ye;if(Re&&"object"==typeof Re&&(v=Re.toString(),"[object HTMLImageElement]"===v||"[object HTMLCanvasElement]"===v))return s.save(),s.translate(r,u),s.rotate(rt),s.drawImage(Re,-Re.width/2,-Re.height/2,Re.width,Re.height),void s.restore();if(!(isNaN(Qe)||Qe<=0)){switch(s.beginPath(),Re){default:p?s.ellipse(r,u,p/2,Qe,0,0,me):s.arc(r,u,Qe,0,me),s.closePath();break;case"triangle":Q=p?p/2:Qe,s.moveTo(r+Math.sin(rt)*Q,u-Math.cos(rt)*Qe),rt+=mn,s.lineTo(r+Math.sin(rt)*Q,u-Math.cos(rt)*Qe),rt+=mn,s.lineTo(r+Math.sin(rt)*Q,u-Math.cos(rt)*Qe),s.closePath();break;case"rectRounded":H=.516*Qe,L=Qe-H,E=Math.cos(rt+gt)*L,pe=Math.cos(rt+gt)*(p?p/2-H:L),I=Math.sin(rt+gt)*L,Me=Math.sin(rt+gt)*(p?p/2-H:L),s.arc(r-pe,u-I,H,rt-we,rt-Xe),s.arc(r+Me,u-E,H,rt-Xe,rt),s.arc(r+pe,u+I,H,rt,rt+Xe),s.arc(r-Me,u+E,H,rt+Xe,rt+we),s.closePath();break;case"rect":if(!qe){L=Math.SQRT1_2*Qe,Q=p?p/2:L,s.rect(r-Q,u-L,2*Q,2*L);break}rt+=gt;case"rectRot":pe=Math.cos(rt)*(p?p/2:Qe),E=Math.cos(rt)*Qe,I=Math.sin(rt)*Qe,Me=Math.sin(rt)*(p?p/2:Qe),s.moveTo(r-pe,u-I),s.lineTo(r+Me,u-E),s.lineTo(r+pe,u+I),s.lineTo(r-Me,u+E),s.closePath();break;case"crossRot":rt+=gt;case"cross":pe=Math.cos(rt)*(p?p/2:Qe),E=Math.cos(rt)*Qe,I=Math.sin(rt)*Qe,Me=Math.sin(rt)*(p?p/2:Qe),s.moveTo(r-pe,u-I),s.lineTo(r+pe,u+I),s.moveTo(r+Me,u-E),s.lineTo(r-Me,u+E);break;case"star":pe=Math.cos(rt)*(p?p/2:Qe),E=Math.cos(rt)*Qe,I=Math.sin(rt)*Qe,Me=Math.sin(rt)*(p?p/2:Qe),s.moveTo(r-pe,u-I),s.lineTo(r+pe,u+I),s.moveTo(r+Me,u-E),s.lineTo(r-Me,u+E),rt+=gt,pe=Math.cos(rt)*(p?p/2:Qe),E=Math.cos(rt)*Qe,I=Math.sin(rt)*Qe,Me=Math.sin(rt)*(p?p/2:Qe),s.moveTo(r-pe,u-I),s.lineTo(r+pe,u+I),s.moveTo(r+Me,u-E),s.lineTo(r-Me,u+E);break;case"line":E=p?p/2:Math.cos(rt)*Qe,I=Math.sin(rt)*Qe,s.moveTo(r-E,u-I),s.lineTo(r+E,u+I);break;case"dash":s.moveTo(r,u),s.lineTo(r+Math.cos(rt)*(p?p/2:Qe),u+Math.sin(rt)*Qe);break;case!1:s.closePath()}s.fill(),l.borderWidth>0&&s.stroke()}}function As(s,l,r){return r=r||.5,!l||s&&s.x>l.left-r&&s.x<l.right+r&&s.y>l.top-r&&s.y<l.bottom+r}function ps(s,l){s.save(),s.beginPath(),s.rect(l.left,l.top,l.right-l.left,l.bottom-l.top),s.clip()}function yr(s){s.restore()}function ha(s,l,r,u,p){if(!l)return s.lineTo(r.x,r.y);if("middle"===p){const v=(l.x+r.x)/2;s.lineTo(v,l.y),s.lineTo(v,r.y)}else"after"===p!=!!u?s.lineTo(l.x,r.y):s.lineTo(r.x,l.y);s.lineTo(r.x,r.y)}function fa(s,l,r,u){if(!l)return s.lineTo(r.x,r.y);s.bezierCurveTo(u?l.cp1x:l.cp2x,u?l.cp1y:l.cp2y,u?r.cp2x:r.cp1x,u?r.cp2y:r.cp1y,r.x,r.y)}function hl(s,l,r,u,p){if(p.strikethrough||p.underline){const v=s.measureText(u),E=l-v.actualBoundingBoxLeft,I=l+v.actualBoundingBoxRight,H=r+v.actualBoundingBoxDescent,Q=p.strikethrough?(r-v.actualBoundingBoxAscent+H)/2:H;s.strokeStyle=s.fillStyle,s.beginPath(),s.lineWidth=p.decorationWidth||2,s.moveTo(E,Q),s.lineTo(I,Q),s.stroke()}}function Aa(s,l){const r=s.fillStyle;s.fillStyle=l.color,s.fillRect(l.left,l.top,l.width,l.height),s.fillStyle=r}function jo(s,l,r,u,p,v={}){const E=jn(l)?l:[l],I=v.strokeWidth>0&&""!==v.strokeColor;let L,H;for(s.save(),s.font=p.string,function Zo(s,l){l.translation&&s.translate(l.translation[0],l.translation[1]),Yt(l.rotation)||s.rotate(l.rotation),l.color&&(s.fillStyle=l.color),l.textAlign&&(s.textAlign=l.textAlign),l.textBaseline&&(s.textBaseline=l.textBaseline)}(s,v),L=0;L<E.length;++L)H=E[L],v.backdrop&&Aa(s,v.backdrop),I&&(v.strokeColor&&(s.strokeStyle=v.strokeColor),Yt(v.strokeWidth)||(s.lineWidth=v.strokeWidth),s.strokeText(H,r,u,v.maxWidth)),s.fillText(H,r,u,v.maxWidth),hl(s,r,u,H,v),u+=Number(p.lineHeight);s.restore()}function co(s,l){const{x:r,y:u,w:p,h:v,radius:E}=l;s.arc(r+E.topLeft,u+E.topLeft,E.topLeft,-Xe,we,!0),s.lineTo(r,u+v-E.bottomLeft),s.arc(r+E.bottomLeft,u+v-E.bottomLeft,E.bottomLeft,we,Xe,!0),s.lineTo(r+p-E.bottomRight,u+v),s.arc(r+p-E.bottomRight,u+v-E.bottomRight,E.bottomRight,Xe,0,!0),s.lineTo(r+p,u+E.topRight),s.arc(r+p-E.topRight,u+E.topRight,E.topRight,0,-Xe,!0),s.lineTo(r+E.topLeft,u)}const Ls=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Ia=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Ui(s,l){const r=(""+s).match(Ls);if(!r||"normal"===r[1])return 1.2*l;switch(s=+r[2],r[3]){case"px":return s;case"%":s/=100}return l*s}const ea=s=>+s||0;function pa(s,l){const r={},u=at(l),p=u?Object.keys(l):l,v=at(s)?u?E=>Kn(s[E],s[l[E]]):E=>s[E]:()=>s;for(const E of p)r[E]=ea(v(E));return r}function Dl(s){return pa(s,{top:"y",right:"x",bottom:"y",left:"x"})}function uo(s){return pa(s,["topLeft","topRight","bottomLeft","bottomRight"])}function Nr(s){const l=Dl(s);return l.width=l.left+l.right,l.height=l.top+l.bottom,l}function Er(s,l){let r=Kn((s=s||{}).size,(l=l||$i.font).size);"string"==typeof r&&(r=parseInt(r,10));let u=Kn(s.style,l.style);u&&!(""+u).match(Ia)&&(console.warn('Invalid font style specified: "'+u+'"'),u=void 0);const p={family:Kn(s.family,l.family),lineHeight:Ui(Kn(s.lineHeight,l.lineHeight),r),size:r,style:u,weight:Kn(s.weight,l.weight),string:""};return p.string=function Zr(s){return!s||Yt(s.size)||Yt(s.family)?null:(s.style?s.style+" ":"")+(s.weight?s.weight+" ":"")+s.size+"px "+s.family}(p),p}function or(s,l,r,u){let v,E,I,p=!0;for(v=0,E=s.length;v<E;++v)if(I=s[v],void 0!==I&&(void 0!==l&&"function"==typeof I&&(I=I(l),p=!1),void 0!==r&&jn(I)&&(I=I[r%I.length],p=!1),void 0!==I))return u&&!p&&(u.cacheable=!1),I}function ta(s,l){return Object.assign(Object.create(s),l)}function Bo(s,l=[""],r,u,p=(()=>s[0])){const v=r||s;typeof u>"u"&&(u=Rr("_fallback",s));const E={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:s,_rootScopes:v,_fallback:u,_getTarget:p,override:I=>Bo([I,...s],l,v,u)};return new Proxy(E,{deleteProperty:(I,L)=>(delete I[L],delete I._keys,delete s[0][L],!0),get:(I,L)=>Ho(I,L,()=>function $l(s,l,r,u){let p;for(const v of l)if(p=Rr(Oa(v,s),r),typeof p<"u")return Pa(s,p)?Yr(r,u,s,p):p}(L,l,s,I)),getOwnPropertyDescriptor:(I,L)=>Reflect.getOwnPropertyDescriptor(I._scopes[0],L),getPrototypeOf:()=>Reflect.getPrototypeOf(s[0]),has:(I,L)=>vr(I).includes(L),ownKeys:I=>vr(I),set(I,L,H){const Q=I._storage||(I._storage=p());return I[L]=Q[L]=H,delete I._keys,!0}})}function wi(s,l,r,u){const p={_cacheable:!1,_proxy:s,_context:l,_subProxy:r,_stack:new Set,_descriptors:ga(s,u),setContext:v=>wi(s,v,r,u),override:v=>wi(s.override(v),l,r,u)};return new Proxy(p,{deleteProperty:(v,E)=>(delete v[E],delete s[E],!0),get:(v,E,I)=>Ho(v,E,()=>function Cl(s,l,r){const{_proxy:u,_context:p,_subProxy:v,_descriptors:E}=s;let I=u[l];return Ie(I)&&E.isScriptable(l)&&(I=function gs(s,l,r,u){const{_proxy:p,_context:v,_subProxy:E,_stack:I}=r;if(I.has(s))throw new Error("Recursion detected: "+Array.from(I).join("->")+"->"+s);I.add(s);let L=l(v,E||u);return I.delete(s),Pa(s,L)&&(L=Yr(p._scopes,p,s,L)),L}(l,I,s,r)),jn(I)&&I.length&&(I=function jl(s,l,r,u){const{_proxy:p,_context:v,_subProxy:E,_descriptors:I}=r;if(typeof v.index<"u"&&u(s))return l[v.index%l.length];if(at(l[0])){const L=l,H=p._scopes.filter(Q=>Q!==L);l=[];for(const Q of L){const pe=Yr(H,p,s,Q);l.push(wi(pe,v,E&&E[s],I))}}return l}(l,I,s,E.isIndexable)),Pa(l,I)&&(I=wi(I,p,v&&v[l],E)),I}(v,E,I)),getOwnPropertyDescriptor:(v,E)=>v._descriptors.allKeys?Reflect.has(s,E)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(s,E),getPrototypeOf:()=>Reflect.getPrototypeOf(s),has:(v,E)=>Reflect.has(s,E),ownKeys:()=>Reflect.ownKeys(s),set:(v,E,I)=>(s[E]=I,delete v[E],!0)})}function ga(s,l={scriptable:!0,indexable:!0}){const{_scriptable:r=l.scriptable,_indexable:u=l.indexable,_allKeys:p=l.allKeys}=s;return{allKeys:p,scriptable:r,indexable:u,isScriptable:Ie(r)?r:()=>r,isIndexable:Ie(u)?u:()=>u}}const Oa=(s,l)=>s?s+he(l):l,Pa=(s,l)=>at(l)&&"adapters"!==s&&(null===Object.getPrototypeOf(l)||l.constructor===Object);function Ho(s,l,r){if(Object.prototype.hasOwnProperty.call(s,l))return s[l];const u=r();return s[l]=u,u}function fl(s,l,r){return Ie(s)?s(l,r):s}const hc=(s,l)=>!0===s?l:"string"==typeof s?Le(l,s):void 0;function Hl(s,l,r,u,p){for(const v of l){const E=hc(r,v);if(E){s.add(E);const I=fl(E._fallback,r,p);if(typeof I<"u"&&I!==r&&I!==u)return I}else if(!1===E&&typeof u<"u"&&r!==u)return null}return!1}function Yr(s,l,r,u){const p=l._rootScopes,v=fl(l._fallback,r,u),E=[...s,...p],I=new Set;I.add(u);let L=El(I,E,r,v||r,u);return!(null===L||typeof v<"u"&&v!==r&&(L=El(I,E,v,L,u),null===L))&&Bo(Array.from(I),[""],p,v,()=>function Bi(s,l,r){const u=s._getTarget();l in u||(u[l]={});const p=u[l];return jn(p)&&at(r)?r:p||{}}(l,r,u))}function El(s,l,r,u,p){for(;r;)r=Hl(s,l,r,u,p);return r}function Rr(s,l){for(const r of l){if(!r)continue;const u=r[s];if(typeof u<"u")return u}}function vr(s){let l=s._keys;return l||(l=s._keys=function re(s){const l=new Set;for(const r of s)for(const u of Object.keys(r).filter(p=>!p.startsWith("_")))l.add(u);return Array.from(l)}(s._scopes)),l}function ne(s,l,r,u){const{iScale:p}=s,{key:v="r"}=this._parsing,E=new Array(u);let I,L,H,Q;for(I=0,L=u;I<L;++I)H=I+r,Q=l[H],E[I]={r:p.parse(Le(Q,v),H)};return E}const J=Number.EPSILON||1e-14,Ae=(s,l)=>l<s.length&&!s[l].skip&&s[l],Ft=s=>"x"===s?"y":"x";function Vn(s,l,r,u){const p=s.skip?l:s,v=l,E=r.skip?l:r,I=Qn(v,p),L=Qn(E,v);let H=I/(I+L),Q=L/(I+L);H=isNaN(H)?0:H,Q=isNaN(Q)?0:Q;const pe=u*H,Me=u*Q;return{previous:{x:v.x-pe*(E.x-p.x),y:v.y-pe*(E.y-p.y)},next:{x:v.x+Me*(E.x-p.x),y:v.y+Me*(E.y-p.y)}}}function na(s,l,r){return Math.max(Math.min(s,r),l)}function Tl(s,l,r,u,p){let v,E,I,L;if(l.spanGaps&&(s=s.filter(H=>!H.skip)),"monotone"===l.cubicInterpolationMode)!function pl(s,l="x"){const r=Ft(l),u=s.length,p=Array(u).fill(0),v=Array(u);let E,I,L,H=Ae(s,0);for(E=0;E<u;++E)if(I=L,L=H,H=Ae(s,E+1),L){if(H){const Q=H[l]-L[l];p[E]=0!==Q?(H[r]-L[r])/Q:0}v[E]=I?H?sn(p[E-1])!==sn(p[E])?0:(p[E-1]+p[E])/2:p[E-1]:p[E]}(function Jr(s,l,r){const u=s.length;let p,v,E,I,L,H=Ae(s,0);for(let Q=0;Q<u-1;++Q)if(L=H,H=Ae(s,Q+1),L&&H){if(Cn(l[Q],0,J)){r[Q]=r[Q+1]=0;continue}p=r[Q]/l[Q],v=r[Q+1]/l[Q],I=Math.pow(p,2)+Math.pow(v,2),!(I<=9)&&(E=3/Math.sqrt(I),r[Q]=p*E*l[Q],r[Q+1]=v*E*l[Q])}})(s,p,v),function Is(s,l,r="x"){const u=Ft(r),p=s.length;let v,E,I,L=Ae(s,0);for(let H=0;H<p;++H){if(E=I,I=L,L=Ae(s,H+1),!I)continue;const Q=I[r],pe=I[u];E&&(v=(Q-E[r])/3,I[`cp1${r}`]=Q-v,I[`cp1${u}`]=pe-v*l[H]),L&&(v=(L[r]-Q)/3,I[`cp2${r}`]=Q+v,I[`cp2${u}`]=pe+v*l[H])}}(s,v,l)}(s,p);else{let H=u?s[s.length-1]:s[0];for(v=0,E=s.length;v<E;++v)I=s[v],L=Vn(H,I,s[Math.min(v+1,E-(u?0:1))%E],l.tension),I.cp1x=L.previous.x,I.cp1y=L.previous.y,I.cp2x=L.next.x,I.cp2y=L.next.y,H=I}l.capBezierPoints&&function fc(s,l){let r,u,p,v,E,I=As(s[0],l);for(r=0,u=s.length;r<u;++r)E=v,v=I,I=r<u-1&&As(s[r+1],l),v&&(p=s[r],E&&(p.cp1x=na(p.cp1x,l.left,l.right),p.cp1y=na(p.cp1y,l.top,l.bottom)),I&&(p.cp2x=na(p.cp2x,l.left,l.right),p.cp2y=na(p.cp2y,l.top,l.bottom)))}(s,r)}function Gl(){return typeof window<"u"&&typeof document<"u"}function fo(s){let l=s.parentNode;return l&&"[object ShadowRoot]"===l.toString()&&(l=l.host),l}function ms(s,l,r){let u;return"string"==typeof s?(u=parseInt(s,10),-1!==s.indexOf("%")&&(u=u/100*l.parentNode[r])):u=s,u}const wo=s=>s.ownerDocument.defaultView.getComputedStyle(s,null),gc=["top","right","bottom","left"];function Na(s,l,r){const u={};r=r?"-"+r:"";for(let p=0;p<4;p++){const v=gc[p];u[v]=parseFloat(s[l+"-"+v+r])||0}return u.width=u.left+u.right,u.height=u.top+u.bottom,u}const Ra=(s,l,r)=>(s>0||l>0)&&(!r||!r.shadowRoot);function Do(s,l){if("native"in s)return s;const{canvas:r,currentDevicePixelRatio:u}=l,p=wo(r),v="border-box"===p.boxSizing,E=Na(p,"padding"),I=Na(p,"border","width"),{x:L,y:H,box:Q}=function ma(s,l){const r=s.touches,u=r&&r.length?r[0]:s,{offsetX:p,offsetY:v}=u;let I,L,E=!1;if(Ra(p,v,s.target))I=p,L=v;else{const H=l.getBoundingClientRect();I=u.clientX-H.left,L=u.clientY-H.top,E=!0}return{x:I,y:L,box:E}}(s,r),pe=E.left+(Q&&I.left),Me=E.top+(Q&&I.top);let{width:Re,height:qe}=l;return v&&(Re-=E.width+I.width,qe-=E.height+I.height),{x:Math.round((L-pe)/Re*r.width/u),y:Math.round((H-Me)/qe*r.height/u)}}const Qr=s=>Math.round(10*s)/10;function Bc(s,l,r){const u=l||1,p=Math.floor(s.height*u),v=Math.floor(s.width*u);s.height=Math.floor(s.height),s.width=Math.floor(s.width);const E=s.canvas;return E.style&&(r||!E.style.height&&!E.style.width)&&(E.style.height=`${s.height}px`,E.style.width=`${s.width}px`),(s.currentDevicePixelRatio!==u||E.height!==p||E.width!==v)&&(s.currentDevicePixelRatio=u,E.height=p,E.width=v,s.ctx.setTransform(u,0,0,u,0,0),!0)}const Ml=function(){let s=!1;try{const l={get passive(){return s=!0,!1}};window.addEventListener("test",null,l),window.removeEventListener("test",null,l)}catch{}return s}();function zo(s,l){const r=function pc(s,l){return wo(s).getPropertyValue(l)}(s,l),u=r&&r.match(/^(\d+)(\.\d+)?px$/);return u?+u[1]:void 0}function is(s,l,r,u){return{x:s.x+r*(l.x-s.x),y:s.y+r*(l.y-s.y)}}function ka(s,l,r,u){return{x:s.x+r*(l.x-s.x),y:"middle"===u?r<.5?s.y:l.y:"after"===u?r<1?s.y:l.y:r>0?l.y:s.y}}function cu(s,l,r,u){const p={x:s.cp2x,y:s.cp2y},v={x:l.cp1x,y:l.cp1y},E=is(s,p,r),I=is(p,v,r),L=is(v,l,r),H=is(E,I,r),Q=is(I,L,r);return is(H,Q,r)}function gl(s,l,r){return s?function(s,l){return{x:r=>s+s+l-r,setWidth(r){l=r},textAlign:r=>"center"===r?r:"right"===r?"left":"right",xPlus:(r,u)=>r-u,leftForLtr:(r,u)=>r-u}}(l,r):{x:s=>s,setWidth(s){},textAlign:s=>s,xPlus:(s,l)=>s+l,leftForLtr:(s,l)=>s}}function ia(s,l){let r,u;("ltr"===l||"rtl"===l)&&(r=s.canvas.style,u=[r.getPropertyValue("direction"),r.getPropertyPriority("direction")],r.setProperty("direction",l,"important"),s.prevTextDirection=u)}function zc(s,l){void 0!==l&&(delete s.prevTextDirection,s.canvas.style.setProperty("direction",l[0],l[1]))}function Ws(s){return"angle"===s?{between:Pr,compare:nr,normalize:ji}:{between:Hr,compare:(l,r)=>l-r,normalize:l=>l}}function Os({start:s,end:l,count:r,loop:u,style:p}){return{start:s%r,end:l%r,loop:u&&(l-s+1)%r==0,style:p}}function po(s,l,r){if(!r)return[s];const{property:u,start:p,end:v}=r,E=l.length,{compare:I,between:L,normalize:H}=Ws(u),{start:Q,end:pe,loop:Me,style:Re}=function Zl(s,l,r){const{property:u,start:p,end:v}=r,{between:E,normalize:I}=Ws(u),L=l.length;let Me,Re,{start:H,end:Q,loop:pe}=s;if(pe){for(H+=L,Q+=L,Me=0,Re=L;Me<Re&&E(I(l[H%L][u]),p,v);++Me)H--,Q--;H%=L,Q%=L}return Q<H&&(Q+=L),{start:H,end:Q,loop:pe,style:s.style}}(s,l,r),qe=[];let jt,Ut,vn,Qe=!1,rt=null;for(let Yn=Q,Ti=Q;Yn<=pe;++Yn)Ut=l[Yn%E],!Ut.skip&&(jt=H(Ut[u]),jt!==vn&&(Qe=L(jt,p,v),null===rt&&(Qe||L(p,vn,jt)&&0!==I(p,vn))&&(rt=0===I(jt,p)?Yn:Ti),null!==rt&&(!Qe||0===I(v,jt)||L(v,vn,jt))&&(qe.push(Os({start:rt,end:Yn,loop:Me,count:E,style:Re})),rt=null),Ti=Yn,vn=jt));return null!==rt&&qe.push(Os({start:rt,end:pe,loop:Me,count:E,style:Re})),qe}function Fa(s,l){const r=[],u=s.segments;for(let p=0;p<u.length;p++){const v=po(u[p],s.points,l);v.length&&r.push(...v)}return r}function ra(s){return{backgroundColor:s.backgroundColor,borderCapStyle:s.borderCapStyle,borderDash:s.borderDash,borderDashOffset:s.borderDashOffset,borderJoinStyle:s.borderJoinStyle,borderWidth:s.borderWidth,borderColor:s.borderColor}}function Xn(s,l){if(!l)return!1;const r=[],u=function(p,v){return Oo(v)?(r.includes(v)||r.push(v),r.indexOf(v)):v};return JSON.stringify(s,u)!==JSON.stringify(l,u)}class Vc{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(l,r,u,p){const E=r.duration;r.listeners[p].forEach(I=>I({chart:l,initial:r.initial,numSteps:E,currentStep:Math.min(u-r.start,E)}))}_refresh(){this._request||(this._running=!0,this._request=ir.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(l=Date.now()){let r=0;this._charts.forEach((u,p)=>{if(!u.running||!u.items.length)return;const v=u.items;let L,E=v.length-1,I=!1;for(;E>=0;--E)L=v[E],L._active?(L._total>u.duration&&(u.duration=L._total),L.tick(l),I=!0):(v[E]=v[v.length-1],v.pop());I&&(p.draw(),this._notify(p,u,l,"progress")),v.length||(u.running=!1,this._notify(p,u,l,"complete"),u.initial=!1),r+=v.length}),this._lastDate=l,0===r&&(this._running=!1)}_getAnims(l){const r=this._charts;let u=r.get(l);return u||(u={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},r.set(l,u)),u}listen(l,r,u){this._getAnims(l).listeners[r].push(u)}add(l,r){!r||!r.length||this._getAnims(l).items.push(...r)}has(l){return this._getAnims(l).items.length>0}start(l){const r=this._charts.get(l);r&&(r.running=!0,r.start=Date.now(),r.duration=r.items.reduce((u,p)=>Math.max(u,p._duration),0),this._refresh())}running(l){if(!this._running)return!1;const r=this._charts.get(l);return!(!r||!r.running||!r.items.length)}stop(l){const r=this._charts.get(l);if(!r||!r.items.length)return;const u=r.items;let p=u.length-1;for(;p>=0;--p)u[p].cancel();r.items=[],this._notify(l,r,Date.now(),"complete")}remove(l){return this._charts.delete(l)}}var _s=new Vc;const La="transparent",rs={boolean:(s,l,r)=>r>.5?l:s,color(s,l,r){const u=Ya(s||La),p=u.valid&&Ya(l||La);return p&&p.valid?p.mix(u,r).hexString():l},number:(s,l,r)=>s+(l-s)*r};class G{constructor(l,r,u,p){const v=r[u];p=or([l.to,p,v,l.from]);const E=or([l.from,v,p]);this._active=!0,this._fn=l.fn||rs[l.type||typeof E],this._easing=$s[l.easing]||$s.linear,this._start=Math.floor(Date.now()+(l.delay||0)),this._duration=this._total=Math.floor(l.duration),this._loop=!!l.loop,this._target=r,this._prop=u,this._from=E,this._to=p,this._promises=void 0}active(){return this._active}update(l,r,u){if(this._active){this._notify(!1);const p=this._target[this._prop],v=u-this._start,E=this._duration-v;this._start=u,this._duration=Math.floor(Math.max(E,l.duration)),this._total+=v,this._loop=!!l.loop,this._to=or([l.to,r,p,l.from]),this._from=or([l.from,p,r])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(l){const r=l-this._start,u=this._duration,p=this._prop,v=this._from,E=this._loop,I=this._to;let L;if(this._active=v!==I&&(E||r<u),!this._active)return this._target[p]=I,void this._notify(!0);r<0?this._target[p]=v:(L=r/u%2,L=E&&L>1?2-L:L,L=this._easing(Math.min(1,Math.max(0,L))),this._target[p]=this._fn(v,I,L))}wait(){const l=this._promises||(this._promises=[]);return new Promise((r,u)=>{l.push({res:r,rej:u})})}_notify(l){const r=l?"res":"rej",u=this._promises||[];for(let p=0;p<u.length;p++)u[p][r]()}}class de{constructor(l,r){this._chart=l,this._properties=new Map,this.configure(r)}configure(l){if(!at(l))return;const r=Object.keys($i.animation),u=this._properties;Object.getOwnPropertyNames(l).forEach(p=>{const v=l[p];if(!at(v))return;const E={};for(const I of r)E[I]=v[I];(jn(v.properties)&&v.properties||[p]).forEach(I=>{(I===p||!u.has(I))&&u.set(I,E)})})}_animateOptions(l,r){const u=r.options,p=function Ee(s,l){if(!l)return;let r=s.options;if(r)return r.$shared&&(s.options=r=Object.assign({},r,{$shared:!1,$animations:{}})),r;s.options=l}(l,u);if(!p)return[];const v=this._createAnimations(p,u);return u.$shared&&function K(s,l){const r=[],u=Object.keys(l);for(let p=0;p<u.length;p++){const v=s[u[p]];v&&v.active()&&r.push(v.wait())}return Promise.all(r)}(l.options.$animations,u).then(()=>{l.options=u},()=>{}),v}_createAnimations(l,r){const u=this._properties,p=[],v=l.$animations||(l.$animations={}),E=Object.keys(r),I=Date.now();let L;for(L=E.length-1;L>=0;--L){const H=E[L];if("$"===H.charAt(0))continue;if("options"===H){p.push(...this._animateOptions(l,r));continue}const Q=r[H];let pe=v[H];const Me=u.get(H);if(pe){if(Me&&pe.active()){pe.update(Me,Q,I);continue}pe.cancel()}Me&&Me.duration?(v[H]=pe=new G(Me,l,H,Q),p.push(pe)):l[H]=Q}return p}update(l,r){if(0===this._properties.size)return void Object.assign(l,r);const u=this._createAnimations(l,r);return u.length?(_s.add(this._chart,u),!0):void 0}}function He(s,l){const r=s&&s.options||{},u=r.reverse,p=void 0===r.min?l:0,v=void 0===r.max?l:0;return{start:u?v:p,end:u?p:v}}function ni(s,l){const r=[],u=s._getSortedDatasetMetas(l);let p,v;for(p=0,v=u.length;p<v;++p)r.push(u[p].index);return r}function sr(s,l,r,u={}){const p=s.keys,v="single"===u.mode;let E,I,L,H;if(null!==l){for(E=0,I=p.length;E<I;++E){if(L=+p[E],L===r){if(u.all)continue;break}H=s.values[L],qt(H)&&(v||0===l||sn(l)===sn(H))&&(l+=H)}return l}}function lr(s,l){const r=s&&s.options.stacked;return r||void 0===r&&void 0!==l.stack}function Ii(s,l,r){const u=s[l]||(s[l]={});return u[r]||(u[r]={})}function Vr(s,l,r,u){for(const p of l.getMatchingVisibleMetas(u).reverse()){const v=s[p.index];if(r&&v>0||!r&&v<0)return p.index}return null}function eo(s,l){const{chart:r,_cachedMeta:u}=s,p=r._stacks||(r._stacks={}),{iScale:v,vScale:E,index:I}=u,L=v.axis,H=E.axis,Q=function Yi(s,l,r){return`${s.id}.${l.id}.${r.stack||r.type}`}(v,E,u),pe=l.length;let Me;for(let Re=0;Re<pe;++Re){const qe=l[Re],{[L]:Qe,[H]:rt}=qe;Me=(qe._stacks||(qe._stacks={}))[H]=Ii(p,Q,Qe),Me[I]=rt,Me._top=Vr(Me,E,!0,u.type),Me._bottom=Vr(Me,E,!1,u.type),(Me._visualValues||(Me._visualValues={}))[I]=rt}}function Ps(s,l){const r=s.scales;return Object.keys(r).filter(u=>r[u].axis===l).shift()}function kr(s,l){const r=s.controller.index,u=s.vScale&&s.vScale.axis;if(u){l=l||s._parsed;for(const p of l){const v=p._stacks;if(!v||void 0===v[u]||void 0===v[u][r])return;delete v[u][r],void 0!==v[u]._visualValues&&void 0!==v[u]._visualValues[r]&&delete v[u]._visualValues[r]}}}const Nn=s=>"reset"===s||"none"===s,Xi=(s,l)=>l?s:Object.assign({},s);let _o=(()=>{class s{constructor(r,u){this.chart=r,this._ctx=r.ctx,this.index=u,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const r=this._cachedMeta;this.configure(),this.linkScales(),r._stacked=lr(r.vScale,r),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(r){this.index!==r&&kr(this._cachedMeta),this.index=r}linkScales(){const r=this.chart,u=this._cachedMeta,p=this.getDataset(),v=(Me,Re,qe,Qe)=>"x"===Me?Re:"r"===Me?Qe:qe,E=u.xAxisID=Kn(p.xAxisID,Ps(r,"x")),I=u.yAxisID=Kn(p.yAxisID,Ps(r,"y")),L=u.rAxisID=Kn(p.rAxisID,Ps(r,"r")),H=u.indexAxis,Q=u.iAxisID=v(H,E,I,L),pe=u.vAxisID=v(H,I,E,L);u.xScale=this.getScaleForId(E),u.yScale=this.getScaleForId(I),u.rScale=this.getScaleForId(L),u.iScale=this.getScaleForId(Q),u.vScale=this.getScaleForId(pe)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(r){return this.chart.scales[r]}_getOtherScale(r){const u=this._cachedMeta;return r===u.iScale?u.vScale:u.iScale}reset(){this._update("reset")}_destroy(){const r=this._cachedMeta;this._data&&us(this._data,this),r._stacked&&kr(r)}_dataCheck(){const r=this.getDataset(),u=r.data||(r.data=[]),p=this._data;if(at(u))this._data=function Ri(s){const l=Object.keys(s),r=new Array(l.length);let u,p,v;for(u=0,p=l.length;u<p;++u)v=l[u],r[u]={x:v,y:s[v]};return r}(u);else if(p!==u){if(p){us(p,this);const v=this._cachedMeta;kr(v),v._parsed=[]}u&&Object.isExtensible(u)&&function Vi(s,l){s._chartjs?s._chartjs.listeners.push(l):(Object.defineProperty(s,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[l]}}),lo.forEach(r=>{const u="_onData"+he(r),p=s[r];Object.defineProperty(s,r,{configurable:!0,enumerable:!1,value(...v){const E=p.apply(this,v);return s._chartjs.listeners.forEach(I=>{"function"==typeof I[u]&&I[u](...v)}),E}})}))}(u,this),this._syncList=[],this._data=u}}addElements(){const r=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(r.dataset=new this.datasetElementType)}buildOrUpdateElements(r){const u=this._cachedMeta,p=this.getDataset();let v=!1;this._dataCheck();const E=u._stacked;u._stacked=lr(u.vScale,u),u.stack!==p.stack&&(v=!0,kr(u),u.stack=p.stack),this._resyncElements(r),(v||E!==u._stacked)&&eo(this,u._parsed)}configure(){const r=this.chart.config,u=r.datasetScopeKeys(this._type),p=r.getOptionScopes(this.getDataset(),u,!0);this.options=r.createResolver(p,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(r,u){const{_cachedMeta:p,_data:v}=this,{iScale:E,_stacked:I}=p,L=E.axis;let pe,Me,Re,H=0===r&&u===v.length||p._sorted,Q=r>0&&p._parsed[r-1];if(!1===this._parsing)p._parsed=v,p._sorted=!0,Re=v;else{Re=jn(v[r])?this.parseArrayData(p,v,r,u):at(v[r])?this.parseObjectData(p,v,r,u):this.parsePrimitiveData(p,v,r,u);const qe=()=>null===Me[L]||Q&&Me[L]<Q[L];for(pe=0;pe<u;++pe)p._parsed[pe+r]=Me=Re[pe],H&&(qe()&&(H=!1),Q=Me);p._sorted=H}I&&eo(this,Re)}parsePrimitiveData(r,u,p,v){const{iScale:E,vScale:I}=r,L=E.axis,H=I.axis,Q=E.getLabels(),pe=E===I,Me=new Array(v);let Re,qe,Qe;for(Re=0,qe=v;Re<qe;++Re)Qe=Re+p,Me[Re]={[L]:pe||E.parse(Q[Qe],Qe),[H]:I.parse(u[Qe],Qe)};return Me}parseArrayData(r,u,p,v){const{xScale:E,yScale:I}=r,L=new Array(v);let H,Q,pe,Me;for(H=0,Q=v;H<Q;++H)pe=H+p,Me=u[pe],L[H]={x:E.parse(Me[0],pe),y:I.parse(Me[1],pe)};return L}parseObjectData(r,u,p,v){const{xScale:E,yScale:I}=r,{xAxisKey:L="x",yAxisKey:H="y"}=this._parsing,Q=new Array(v);let pe,Me,Re,qe;for(pe=0,Me=v;pe<Me;++pe)Re=pe+p,qe=u[Re],Q[pe]={x:E.parse(Le(qe,L),Re),y:I.parse(Le(qe,H),Re)};return Q}getParsed(r){return this._cachedMeta._parsed[r]}getDataElement(r){return this._cachedMeta.data[r]}applyStack(r,u,p){const E=this._cachedMeta,I=u[r.axis];return sr({keys:ni(this.chart,!0),values:u._stacks[r.axis]._visualValues},I,E.index,{mode:p})}updateRangeFromParsed(r,u,p,v){const E=p[u.axis];let I=null===E?NaN:E;const L=v&&p._stacks[u.axis];v&&L&&(v.values=L,I=sr(v,E,this._cachedMeta.index)),r.min=Math.min(r.min,I),r.max=Math.max(r.max,I)}getMinMax(r,u){const p=this._cachedMeta,v=p._parsed,E=p._sorted&&r===p.iScale,I=v.length,L=this._getOtherScale(r),H=((s,l,r)=>s&&!l.hidden&&l._stacked&&{keys:ni(this.chart,!0),values:null})(u,p),Q={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:pe,max:Me}=function Wr(s){const{min:l,max:r,minDefined:u,maxDefined:p}=s.getUserBounds();return{min:u?l:Number.NEGATIVE_INFINITY,max:p?r:Number.POSITIVE_INFINITY}}(L);let Re,qe;function Qe(){qe=v[Re];const rt=qe[L.axis];return!qt(qe[r.axis])||pe>rt||Me<rt}for(Re=0;Re<I&&(Qe()||(this.updateRangeFromParsed(Q,r,qe,H),!E));++Re);if(E)for(Re=I-1;Re>=0;--Re)if(!Qe()){this.updateRangeFromParsed(Q,r,qe,H);break}return Q}getAllParsedValues(r){const u=this._cachedMeta._parsed,p=[];let v,E,I;for(v=0,E=u.length;v<E;++v)I=u[v][r.axis],qt(I)&&p.push(I);return p}getMaxOverflow(){return!1}getLabelAndValue(r){const u=this._cachedMeta,p=u.iScale,v=u.vScale,E=this.getParsed(r);return{label:p?""+p.getLabelForValue(E[p.axis]):"",value:v?""+v.getLabelForValue(E[v.axis]):""}}_update(r){const u=this._cachedMeta;this.update(r||"default"),u._clip=function Kt(s){let l,r,u,p;return at(s)?(l=s.top,r=s.right,u=s.bottom,p=s.left):l=r=u=p=s,{top:l,right:r,bottom:u,left:p,disabled:!1===s}}(Kn(this.options.clip,function St(s,l,r){if(!1===r)return!1;const u=He(s,r),p=He(l,r);return{top:p.end,right:u.end,bottom:p.start,left:u.start}}(u.xScale,u.yScale,this.getMaxOverflow())))}update(r){}draw(){const r=this._ctx,p=this._cachedMeta,v=p.data||[],E=this.chart.chartArea,I=[],L=this._drawStart||0,H=this._drawCount||v.length-L,Q=this.options.drawActiveElementsOnTop;let pe;for(p.dataset&&p.dataset.draw(r,E,L,H),pe=L;pe<L+H;++pe){const Me=v[pe];Me.hidden||(Me.active&&Q?I.push(Me):Me.draw(r,E))}for(pe=0;pe<I.length;++pe)I[pe].draw(r,E)}getStyle(r,u){const p=u?"active":"default";return void 0===r&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(p):this.resolveDataElementOptions(r||0,p)}getContext(r,u,p){const v=this.getDataset();let E;if(r>=0&&r<this._cachedMeta.data.length){const I=this._cachedMeta.data[r];E=I.$context||(I.$context=function Co(s,l,r){return ta(s,{active:!1,dataIndex:l,parsed:void 0,raw:void 0,element:r,index:l,mode:"default",type:"data"})}(this.getContext(),r,I)),E.parsed=this.getParsed(r),E.raw=v.data[r],E.index=E.dataIndex=r}else E=this.$context||(this.$context=function oa(s,l){return ta(s,{active:!1,dataset:void 0,datasetIndex:l,index:l,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),E.dataset=v,E.index=E.datasetIndex=this.index;return E.active=!!u,E.mode=p,E}resolveDatasetElementOptions(r){return this._resolveElementOptions(this.datasetElementType.id,r)}resolveDataElementOptions(r,u){return this._resolveElementOptions(this.dataElementType.id,u,r)}_resolveElementOptions(r,u="default",p){const v="active"===u,E=this._cachedDataOpts,I=r+"-"+u,L=E[I],H=this.enableOptionSharing&&ye(p);if(L)return Xi(L,H);const Q=this.chart.config,pe=Q.datasetElementScopeKeys(this._type,r),Me=v?[`${r}Hover`,"hover",r,""]:[r,""],Re=Q.getOptionScopes(this.getDataset(),pe),qe=Object.keys($i.elements[r]),rt=Q.resolveNamedOptions(Re,qe,()=>this.getContext(p,v,u),Me);return rt.$shared&&(rt.$shared=H,E[I]=Object.freeze(Xi(rt,H))),rt}_resolveAnimations(r,u,p){const v=this.chart,E=this._cachedDataOpts,I=`animation-${u}`,L=E[I];if(L)return L;let H;if(!1!==v.options.animation){const pe=this.chart.config,Me=pe.datasetAnimationScopeKeys(this._type,u),Re=pe.getOptionScopes(this.getDataset(),Me);H=pe.createResolver(Re,this.getContext(r,p,u))}const Q=new de(v,H&&H.animations);return H&&H._cacheable&&(E[I]=Object.freeze(Q)),Q}getSharedOptions(r){if(r.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},r))}includeOptions(r,u){return!u||Nn(r)||this.chart._animationsDisabled}_getSharedOptions(r,u){const p=this.resolveDataElementOptions(r,u),v=this._sharedOptions,E=this.getSharedOptions(p),I=this.includeOptions(u,E)||E!==v;return this.updateSharedOptions(E,u,p),{sharedOptions:E,includeOptions:I}}updateElement(r,u,p,v){Nn(v)?Object.assign(r,p):this._resolveAnimations(u,v).update(r,p)}updateSharedOptions(r,u,p){r&&!Nn(u)&&this._resolveAnimations(void 0,u).update(r,p)}_setStyle(r,u,p,v){r.active=v;const E=this.getStyle(u,v);this._resolveAnimations(u,p,v).update(r,{options:!v&&this.getSharedOptions(E)||E})}removeHoverStyle(r,u,p){this._setStyle(r,p,"active",!1)}setHoverStyle(r,u,p){this._setStyle(r,p,"active",!0)}_removeDatasetHoverStyle(){const r=this._cachedMeta.dataset;r&&this._setStyle(r,void 0,"active",!1)}_setDatasetHoverStyle(){const r=this._cachedMeta.dataset;r&&this._setStyle(r,void 0,"active",!0)}_resyncElements(r){const u=this._data,p=this._cachedMeta.data;for(const[L,H,Q]of this._syncList)this[L](H,Q);this._syncList=[];const v=p.length,E=u.length,I=Math.min(E,v);I&&this.parse(0,I),E>v?this._insertElements(v,E-v,r):E<v&&this._removeElements(E,v-E)}_insertElements(r,u,p=!0){const v=this._cachedMeta,E=v.data,I=r+u;let L;const H=Q=>{for(Q.length+=u,L=Q.length-1;L>=I;L--)Q[L]=Q[L-u]};for(H(E),L=r;L<I;++L)E[L]=new this.dataElementType;this._parsing&&H(v._parsed),this.parse(r,u),p&&this.updateElements(E,r,u,"reset")}updateElements(r,u,p,v){}_removeElements(r,u){const p=this._cachedMeta;if(this._parsing){const v=p._parsed.splice(r,u);p._stacked&&kr(p,v)}p.data.splice(r,u)}_sync(r){if(this._parsing)this._syncList.push(r);else{const[u,p,v]=r;this[u](p,v)}this.chart._dataChanges.push([this.index,...r])}_onDataPush(){const r=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-r,r])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(r,u){u&&this._sync(["_removeElements",r,u]);const p=arguments.length-2;p&&this._sync(["_insertElements",r,p])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return Ze(s,"defaults",{}),Ze(s,"datasetElementType",null),Ze(s,"dataElementType",null),s})();function ql(s){const l=s.iScale,r=function Ru(s,l){if(!s._cache.$bar){const r=s.getMatchingVisibleMetas(l);let u=[];for(let p=0,v=r.length;p<v;p++)u=u.concat(r[p].controller.getAllParsedValues(s));s._cache.$bar=ds(u.sort((p,v)=>p-v))}return s._cache.$bar}(l,s.type);let p,v,E,I,u=l._length;const L=()=>{32767===E||-32768===E||(ye(I)&&(u=Math.min(u,Math.abs(E-I)||u)),I=E)};for(p=0,v=r.length;p<v;++p)E=l.getPixelForValue(r[p]),L();for(I=void 0,p=0,v=l.ticks.length;p<v;++p)E=l.getPixelForTick(p),L();return u}function ys(s,l,r,u){return jn(s)?function Ba(s,l,r,u){const p=r.parse(s[0],u),v=r.parse(s[1],u),E=Math.min(p,v),I=Math.max(p,v);let L=E,H=I;Math.abs(E)>Math.abs(I)&&(L=I,H=E),l[r.axis]=H,l._custom={barStart:L,barEnd:H,start:p,end:v,min:E,max:I}}(s,l,r,u):l[r.axis]=r.parse(s,u),l}function li(s,l,r,u){const p=s.iScale,v=s.vScale,E=p.getLabels(),I=p===v,L=[];let H,Q,pe,Me;for(H=r,Q=r+u;H<Q;++H)Me=l[H],pe={},pe[p.axis]=I||p.parse(E[H],H),L.push(ys(Me,pe,v,H));return L}function pi(s){return s&&void 0!==s.barStart&&void 0!==s.barEnd}function qi(s,l,r,u){let p=l.borderSkipped;const v={};if(!p)return void(s.borderSkipped=v);if(!0===p)return void(s.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:E,end:I,reverse:L,top:H,bottom:Q}=function dn(s){let l,r,u,p,v;return s.horizontal?(l=s.base>s.x,r="left",u="right"):(l=s.base<s.y,r="bottom",u="top"),l?(p="end",v="start"):(p="start",v="end"),{start:r,end:u,reverse:l,top:p,bottom:v}}(s);"middle"===p&&r&&(s.enableBorderRadius=!0,(r._top||0)===u?p=H:(r._bottom||0)===u?p=Q:(v[Fr(Q,E,I,L)]=!0,p=H)),v[Fr(p,E,I,L)]=!0,s.borderSkipped=v}function Fr(s,l,r,u){return u?(s=function od(s,l,r){return s===l?r:s===r?l:s}(s,l,r),s=qr(s,r,l)):s=qr(s,l,r),s}function qr(s,l,r){return"start"===s?l:"end"===s?r:s}function Kl(s,{inflateAmount:l},r){s.inflateAmount="auto"===l?1===r?.33:0:l}let Yo=(()=>{class s extends _o{parsePrimitiveData(r,u,p,v){return li(r,u,p,v)}parseArrayData(r,u,p,v){return li(r,u,p,v)}parseObjectData(r,u,p,v){const{iScale:E,vScale:I}=r,{xAxisKey:L="x",yAxisKey:H="y"}=this._parsing,Q="x"===E.axis?L:H,pe="x"===I.axis?L:H,Me=[];let Re,qe,Qe,rt;for(Re=p,qe=p+v;Re<qe;++Re)rt=u[Re],Qe={},Qe[E.axis]=E.parse(Le(rt,Q),Re),Me.push(ys(Le(rt,pe),Qe,I,Re));return Me}updateRangeFromParsed(r,u,p,v){super.updateRangeFromParsed(r,u,p,v);const E=p._custom;E&&u===this._cachedMeta.vScale&&(r.min=Math.min(r.min,E.min),r.max=Math.max(r.max,E.max))}getMaxOverflow(){return 0}getLabelAndValue(r){const u=this._cachedMeta,{iScale:p,vScale:v}=u,E=this.getParsed(r),I=E._custom,L=pi(I)?"["+I.start+", "+I.end+"]":""+v.getLabelForValue(E[v.axis]);return{label:""+p.getLabelForValue(E[p.axis]),value:L}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(r){const u=this._cachedMeta;this.updateElements(u.data,0,u.data.length,r)}updateElements(r,u,p,v){const E="reset"===v,{index:I,_cachedMeta:{vScale:L}}=this,H=L.getBasePixel(),Q=L.isHorizontal(),pe=this._getRuler(),{sharedOptions:Me,includeOptions:Re}=this._getSharedOptions(u,v);for(let qe=u;qe<u+p;qe++){const Qe=this.getParsed(qe),rt=E||Yt(Qe[L.axis])?{base:H,head:H}:this._calculateBarValuePixels(qe),jt=this._calculateBarIndexPixels(qe,pe),Ut=(Qe._stacks||{})[L.axis],vn={horizontal:Q,base:rt.base,enableBorderRadius:!Ut||pi(Qe._custom)||I===Ut._top||I===Ut._bottom,x:Q?rt.head:jt.center,y:Q?jt.center:rt.head,height:Q?jt.size:Math.abs(rt.size),width:Q?Math.abs(rt.size):jt.size};Re&&(vn.options=Me||this.resolveDataElementOptions(qe,r[qe].active?"active":v));const Sn=vn.options||r[qe].options;qi(vn,Sn,Ut,I),Kl(vn,Sn,pe.ratio),this.updateElement(r[qe],qe,vn,v)}}_getStacks(r,u){const{iScale:p}=this._cachedMeta,v=p.getMatchingVisibleMetas(this._type).filter(H=>H.controller.options.grouped),E=p.options.stacked,I=[],L=H=>{const Q=H.controller.getParsed(u),pe=Q&&Q[H.vScale.axis];if(Yt(pe)||isNaN(pe))return!0};for(const H of v)if((void 0===u||!L(H))&&((!1===E||-1===I.indexOf(H.stack)||void 0===E&&void 0===H.stack)&&I.push(H.stack),H.index===r))break;return I.length||I.push(void 0),I}_getStackCount(r){return this._getStacks(void 0,r).length}_getStackIndex(r,u,p){const v=this._getStacks(r,p),E=void 0!==u?v.indexOf(u):-1;return-1===E?v.length-1:E}_getRuler(){const r=this.options,u=this._cachedMeta,p=u.iScale,v=[];let E,I;for(E=0,I=u.data.length;E<I;++E)v.push(p.getPixelForValue(this.getParsed(E)[p.axis],E));const L=r.barThickness;return{min:L||ql(u),pixels:v,start:p._startPixel,end:p._endPixel,stackCount:this._getStackCount(),scale:p,grouped:r.grouped,ratio:L?1:r.categoryPercentage*r.barPercentage}}_calculateBarValuePixels(r){const{_cachedMeta:{vScale:u,_stacked:p,index:v},options:{base:E,minBarLength:I}}=this,L=E||0,H=this.getParsed(r),Q=H._custom,pe=pi(Q);let Qe,rt,Me=H[u.axis],Re=0,qe=p?this.applyStack(u,H,p):Me;qe!==Me&&(Re=qe-Me,qe=Me),pe&&(Me=Q.barStart,qe=Q.barEnd-Q.barStart,0!==Me&&sn(Me)!==sn(Q.barEnd)&&(Re=0),Re+=Me);const jt=Yt(E)||pe?Re:E;let Ut=u.getPixelForValue(jt);if(Qe=this.chart.getDataVisibility(r)?u.getPixelForValue(Re+qe):Ut,rt=Qe-Ut,Math.abs(rt)<I){rt=function yc(s,l,r){return 0!==s?sn(s):(l.isHorizontal()?1:-1)*(l.min>=r?1:-1)}(rt,u,L)*I,Me===L&&(Ut-=rt/2);const vn=u.getPixelForDecimal(0),Sn=u.getPixelForDecimal(1),fn=Math.min(vn,Sn),En=Math.max(vn,Sn);Ut=Math.max(Math.min(Ut,En),fn),Qe=Ut+rt,p&&!pe&&(H._stacks[u.axis]._visualValues[v]=u.getValueForPixel(Qe)-u.getValueForPixel(Ut))}if(Ut===u.getPixelForValue(L)){const vn=sn(rt)*u.getLineWidthForValue(L)/2;Ut+=vn,rt-=vn}return{size:rt,base:Ut,head:Qe,center:Qe+rt/2}}_calculateBarIndexPixels(r,u){const p=u.scale,v=this.options,E=v.skipNull,I=Kn(v.maxBarThickness,1/0);let L,H;if(u.grouped){const Q=E?this._getStackCount(r):u.stackCount,pe="flex"===v.barThickness?function Zs(s,l,r,u){const p=l.pixels,v=p[s];let E=s>0?p[s-1]:null,I=s<p.length-1?p[s+1]:null;const L=r.categoryPercentage;null===E&&(E=v-(null===I?l.end-l.start:I-v)),null===I&&(I=v+v-E);const H=v-(v-Math.min(E,I))/2*L;return{chunk:Math.abs(I-E)/2*L/u,ratio:r.barPercentage,start:H}}(r,u,v,Q):function du(s,l,r,u){const p=r.barThickness;let v,E;return Yt(p)?(v=l.min*r.categoryPercentage,E=r.barPercentage):(v=p*u,E=1),{chunk:v/u,ratio:E,start:l.pixels[s]-v/2}}(r,u,v,Q),Me=this._getStackIndex(this.index,this._cachedMeta.stack,E?r:void 0);L=pe.start+pe.chunk*Me+pe.chunk/2,H=Math.min(I,pe.chunk*pe.ratio)}else L=p.getPixelForValue(this.getParsed(r)[p.axis],r),H=Math.min(I,u.min*u.ratio);return{base:L-H/2,head:L+H/2,center:L,size:H}}draw(){const r=this._cachedMeta,u=r.vScale,p=r.data,v=p.length;let E=0;for(;E<v;++E)null!==this.getParsed(E)[u.axis]&&p[E].draw(this._ctx)}}return Ze(s,"id","bar"),Ze(s,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Ze(s,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}}),s})(),Ar=(()=>{class s extends _o{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(r,u,p,v){const E=super.parsePrimitiveData(r,u,p,v);for(let I=0;I<E.length;I++)E[I]._custom=this.resolveDataElementOptions(I+p).radius;return E}parseArrayData(r,u,p,v){const E=super.parseArrayData(r,u,p,v);for(let I=0;I<E.length;I++)E[I]._custom=Kn(u[p+I][2],this.resolveDataElementOptions(I+p).radius);return E}parseObjectData(r,u,p,v){const E=super.parseObjectData(r,u,p,v);for(let I=0;I<E.length;I++){const L=u[p+I];E[I]._custom=Kn(L&&L.r&&+L.r,this.resolveDataElementOptions(I+p).radius)}return E}getMaxOverflow(){const r=this._cachedMeta.data;let u=0;for(let p=r.length-1;p>=0;--p)u=Math.max(u,r[p].size(this.resolveDataElementOptions(p))/2);return u>0&&u}getLabelAndValue(r){const u=this._cachedMeta,p=this.chart.data.labels||[],{xScale:v,yScale:E}=u,I=this.getParsed(r),L=v.getLabelForValue(I.x),H=E.getLabelForValue(I.y),Q=I._custom;return{label:p[r]||"",value:"("+L+", "+H+(Q?", "+Q:"")+")"}}update(r){const u=this._cachedMeta.data;this.updateElements(u,0,u.length,r)}updateElements(r,u,p,v){const E="reset"===v,{iScale:I,vScale:L}=this._cachedMeta,{sharedOptions:H,includeOptions:Q}=this._getSharedOptions(u,v),pe=I.axis,Me=L.axis;for(let Re=u;Re<u+p;Re++){const qe=r[Re],Qe=!E&&this.getParsed(Re),rt={},jt=rt[pe]=E?I.getPixelForDecimal(.5):I.getPixelForValue(Qe[pe]),Ut=rt[Me]=E?L.getBasePixel():L.getPixelForValue(Qe[Me]);rt.skip=isNaN(jt)||isNaN(Ut),Q&&(rt.options=H||this.resolveDataElementOptions(Re,qe.active?"active":v),E&&(rt.options.radius=0)),this.updateElement(qe,Re,rt,v)}}resolveDataElementOptions(r,u){const p=this.getParsed(r);let v=super.resolveDataElementOptions(r,u);v.$shared&&(v=Object.assign({},v,{$shared:!1}));const E=v.radius;return"active"!==u&&(v.radius=0),v.radius+=Kn(p&&p._custom,E),v}}return Ze(s,"id","bubble"),Ze(s,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),Ze(s,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}}),s})(),vs=(()=>{class s extends _o{constructor(r,u){super(r,u),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(r,u){const p=this.getDataset().data,v=this._cachedMeta;if(!1===this._parsing)v._parsed=p;else{let I,L,E=H=>+p[H];if(at(p[r])){const{key:H="value"}=this._parsing;E=Q=>+Le(p[Q],H)}for(I=r,L=r+u;I<L;++I)v._parsed[I]=E(I)}}_getRotation(){return tn(this.options.rotation-90)}_getCircumference(){return tn(this.options.circumference)}_getRotationExtents(){let r=me,u=-me;for(let p=0;p<this.chart.data.datasets.length;++p)if(this.chart.isDatasetVisible(p)&&this.chart.getDatasetMeta(p).type===this._type){const v=this.chart.getDatasetMeta(p).controller,E=v._getRotation(),I=v._getCircumference();r=Math.min(r,E),u=Math.max(u,E+I)}return{rotation:r,circumference:u-r}}update(r){const u=this.chart,{chartArea:p}=u,v=this._cachedMeta,E=v.data,I=this.getMaxBorderWidth()+this.getMaxOffset(E)+this.options.spacing,L=Math.max((Math.min(p.width,p.height)-I)/2,0),H=Math.min(((s,l)=>"string"==typeof s&&s.endsWith("%")?parseFloat(s)/100:+s/l)(this.options.cutout,L),1),Q=this._getRingWeight(this.index),{circumference:pe,rotation:Me}=this._getRotationExtents(),{ratioX:Re,ratioY:qe,offsetX:Qe,offsetY:rt}=function yo(s,l,r){let u=1,p=1,v=0,E=0;if(l<me){const I=s,L=I+l,H=Math.cos(I),Q=Math.sin(I),pe=Math.cos(L),Me=Math.sin(L),Re=(vn,Sn,fn)=>Pr(vn,I,L,!0)?1:Math.max(Sn,Sn*r,fn,fn*r),qe=(vn,Sn,fn)=>Pr(vn,I,L,!0)?-1:Math.min(Sn,Sn*r,fn,fn*r),Qe=Re(0,H,pe),rt=Re(Xe,Q,Me),jt=qe(we,H,pe),Ut=qe(we+Xe,Q,Me);u=(Qe-jt)/2,p=(rt-Ut)/2,v=-(Qe+jt)/2,E=-(rt+Ut)/2}return{ratioX:u,ratioY:p,offsetX:v,offsetY:E}}(Me,pe,H),vn=Math.max(Math.min((p.width-I)/Re,(p.height-I)/qe)/2,0),Sn=rn(this.options.radius,vn),En=(Sn-Math.max(Sn*H,0))/this._getVisibleDatasetWeightTotal();this.offsetX=Qe*Sn,this.offsetY=rt*Sn,v.total=this.calculateTotal(),this.outerRadius=Sn-En*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-En*Q,0),this.updateElements(E,0,E.length,r)}_circumference(r,u){const p=this.options,v=this._cachedMeta,E=this._getCircumference();return u&&p.animation.animateRotate||!this.chart.getDataVisibility(r)||null===v._parsed[r]||v.data[r].hidden?0:this.calculateCircumference(v._parsed[r]*E/me)}updateElements(r,u,p,v){const E="reset"===v,I=this.chart,L=I.chartArea,pe=(L.left+L.right)/2,Me=(L.top+L.bottom)/2,Re=E&&I.options.animation.animateScale,qe=Re?0:this.innerRadius,Qe=Re?0:this.outerRadius,{sharedOptions:rt,includeOptions:jt}=this._getSharedOptions(u,v);let vn,Ut=this._getRotation();for(vn=0;vn<u;++vn)Ut+=this._circumference(vn,E);for(vn=u;vn<u+p;++vn){const Sn=this._circumference(vn,E),fn=r[vn],En={x:pe+this.offsetX,y:Me+this.offsetY,startAngle:Ut,endAngle:Ut+Sn,circumference:Sn,outerRadius:Qe,innerRadius:qe};jt&&(En.options=rt||this.resolveDataElementOptions(vn,fn.active?"active":v)),Ut+=Sn,this.updateElement(fn,vn,En,v)}}calculateTotal(){const r=this._cachedMeta,u=r.data;let v,p=0;for(v=0;v<u.length;v++){const E=r._parsed[v];null!==E&&!isNaN(E)&&this.chart.getDataVisibility(v)&&!u[v].hidden&&(p+=Math.abs(E))}return p}calculateCircumference(r){const u=this._cachedMeta.total;return u>0&&!isNaN(r)?me*(Math.abs(r)/u):0}getLabelAndValue(r){const p=this.chart,v=p.data.labels||[],E=Ms(this._cachedMeta._parsed[r],p.options.locale);return{label:v[r]||"",value:E}}getMaxBorderWidth(r){let u=0;const p=this.chart;let v,E,I,L,H;if(!r)for(v=0,E=p.data.datasets.length;v<E;++v)if(p.isDatasetVisible(v)){I=p.getDatasetMeta(v),r=I.data,L=I.controller;break}if(!r)return 0;for(v=0,E=r.length;v<E;++v)H=L.resolveDataElementOptions(v),"inner"!==H.borderAlign&&(u=Math.max(u,H.borderWidth||0,H.hoverBorderWidth||0));return u}getMaxOffset(r){let u=0;for(let p=0,v=r.length;p<v;++p){const E=this.resolveDataElementOptions(p);u=Math.max(u,E.offset||0,E.hoverOffset||0)}return u}_getRingWeightOffset(r){let u=0;for(let p=0;p<r;++p)this.chart.isDatasetVisible(p)&&(u+=this._getRingWeight(p));return u}_getRingWeight(r){return Math.max(Kn(this.chart.data.datasets[r].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}return Ze(s,"id","doughnut"),Ze(s,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Ze(s,"descriptors",{_scriptable:l=>"spacing"!==l,_indexable:l=>"spacing"!==l&&!l.startsWith("borderDash")&&!l.startsWith("hoverBorderDash")}),Ze(s,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(l){const r=l.data;if(r.labels.length&&r.datasets.length){const{labels:{pointStyle:u,color:p}}=l.legend.options;return r.labels.map((v,E)=>{const L=l.getDatasetMeta(0).controller.getStyle(E);return{text:v,fillStyle:L.backgroundColor,strokeStyle:L.borderColor,fontColor:p,lineWidth:L.borderWidth,pointStyle:u,hidden:!l.getDataVisibility(E),index:E}})}return[]}},onClick(l,r,u){u.chart.toggleDataVisibility(r.index),u.chart.update()}}}}),s})(),Ol=(()=>{class s extends _o{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(r){const u=this._cachedMeta,{dataset:p,data:v=[],_dataset:E}=u,I=this.chart._animationsDisabled;let{start:L,count:H}=ts(u,v,I);this._drawStart=L,this._drawCount=H,Ta(u)&&(L=0,H=v.length),p._chart=this.chart,p._datasetIndex=this.index,p._decimated=!!E._decimated,p.points=v;const Q=this.resolveDatasetElementOptions(r);this.options.showLine||(Q.borderWidth=0),Q.segment=this.options.segment,this.updateElement(p,void 0,{animated:!I,options:Q},r),this.updateElements(v,L,H,r)}updateElements(r,u,p,v){const E="reset"===v,{iScale:I,vScale:L,_stacked:H,_dataset:Q}=this._cachedMeta,{sharedOptions:pe,includeOptions:Me}=this._getSharedOptions(u,v),Re=I.axis,qe=L.axis,{spanGaps:Qe,segment:rt}=this.options,jt=Oe(Qe)?Qe:Number.POSITIVE_INFINITY,Ut=this.chart._animationsDisabled||E||"none"===v,vn=u+p,Sn=r.length;let fn=u>0&&this.getParsed(u-1);for(let En=0;En<Sn;++En){const fi=r[En],Yn=Ut?fi:{};if(En<u||En>=vn){Yn.skip=!0;continue}const Ti=this.getParsed(En),Mr=Yt(Ti[qe]),Sr=Yn[Re]=I.getPixelForValue(Ti[Re],En),jr=Yn[qe]=E||Mr?L.getBasePixel():L.getPixelForValue(H?this.applyStack(L,Ti,H):Ti[qe],En);Yn.skip=isNaN(Sr)||isNaN(jr)||Mr,Yn.stop=En>0&&Math.abs(Ti[Re]-fn[Re])>jt,rt&&(Yn.parsed=Ti,Yn.raw=Q.data[En]),Me&&(Yn.options=pe||this.resolveDataElementOptions(En,fi.active?"active":v)),Ut||this.updateElement(fi,En,Yn,v),fn=Ti}}getMaxOverflow(){const r=this._cachedMeta,u=r.dataset,p=u.options&&u.options.borderWidth||0,v=r.data||[];if(!v.length)return p;const E=v[0].size(this.resolveDataElementOptions(0)),I=v[v.length-1].size(this.resolveDataElementOptions(v.length-1));return Math.max(p,E,I)/2}draw(){const r=this._cachedMeta;r.dataset.updateControlPoints(this.chart.chartArea,r.iScale.axis),super.draw()}}return Ze(s,"id","line"),Ze(s,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Ze(s,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}}),s})(),jc=(()=>{class s extends _o{constructor(r,u){super(r,u),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(r){const p=this.chart,v=p.data.labels||[],E=Ms(this._cachedMeta._parsed[r].r,p.options.locale);return{label:v[r]||"",value:E}}parseObjectData(r,u,p,v){return ne.bind(this)(r,u,p,v)}update(r){const u=this._cachedMeta.data;this._updateRadius(),this.updateElements(u,0,u.length,r)}getMinMax(){const u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return this._cachedMeta.data.forEach((p,v)=>{const E=this.getParsed(v).r;!isNaN(E)&&this.chart.getDataVisibility(v)&&(E<u.min&&(u.min=E),E>u.max&&(u.max=E))}),u}_updateRadius(){const r=this.chart,u=r.chartArea,p=r.options,v=Math.min(u.right-u.left,u.bottom-u.top),E=Math.max(v/2,0),L=(E-Math.max(p.cutoutPercentage?E/100*p.cutoutPercentage:1,0))/r.getVisibleDatasetCount();this.outerRadius=E-L*this.index,this.innerRadius=this.outerRadius-L}updateElements(r,u,p,v){const E="reset"===v,I=this.chart,H=I.options.animation,Q=this._cachedMeta.rScale,pe=Q.xCenter,Me=Q.yCenter,Re=Q.getIndexAngle(0)-.5*we;let Qe,qe=Re;const rt=360/this.countVisibleElements();for(Qe=0;Qe<u;++Qe)qe+=this._computeAngle(Qe,v,rt);for(Qe=u;Qe<u+p;Qe++){const jt=r[Qe];let Ut=qe,vn=qe+this._computeAngle(Qe,v,rt),Sn=I.getDataVisibility(Qe)?Q.getDistanceFromCenterForValue(this.getParsed(Qe).r):0;qe=vn,E&&(H.animateScale&&(Sn=0),H.animateRotate&&(Ut=vn=Re));const fn={x:pe,y:Me,innerRadius:0,outerRadius:Sn,startAngle:Ut,endAngle:vn,options:this.resolveDataElementOptions(Qe,jt.active?"active":v)};this.updateElement(jt,Qe,fn,v)}}countVisibleElements(){let u=0;return this._cachedMeta.data.forEach((p,v)=>{!isNaN(this.getParsed(v).r)&&this.chart.getDataVisibility(v)&&u++}),u}_computeAngle(r,u,p){return this.chart.getDataVisibility(r)?tn(this.resolveDataElementOptions(r,u).angle||p):0}}return Ze(s,"id","polarArea"),Ze(s,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),Ze(s,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(l){const r=l.data;if(r.labels.length&&r.datasets.length){const{labels:{pointStyle:u,color:p}}=l.legend.options;return r.labels.map((v,E)=>{const L=l.getDatasetMeta(0).controller.getStyle(E);return{text:v,fillStyle:L.backgroundColor,strokeStyle:L.borderColor,fontColor:p,lineWidth:L.borderWidth,pointStyle:u,hidden:!l.getDataVisibility(E),index:E}})}return[]}},onClick(l,r,u){u.chart.toggleDataVisibility(r.index),u.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}}),s})();var za=Object.freeze({__proto__:null,BarController:Yo,BubbleController:Ar,DoughnutController:vs,LineController:Ol,PieController:(()=>{class s extends vs{}return Ze(s,"id","pie"),Ze(s,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"}),s})(),PolarAreaController:jc,RadarController:(()=>{class s extends _o{getLabelAndValue(r){const u=this._cachedMeta.vScale,p=this.getParsed(r);return{label:u.getLabels()[r],value:""+u.getLabelForValue(p[u.axis])}}parseObjectData(r,u,p,v){return ne.bind(this)(r,u,p,v)}update(r){const u=this._cachedMeta,p=u.dataset,v=u.data||[],E=u.iScale.getLabels();if(p.points=v,"resize"!==r){const I=this.resolveDatasetElementOptions(r);this.options.showLine||(I.borderWidth=0),this.updateElement(p,void 0,{_loop:!0,_fullLoop:E.length===v.length,options:I},r)}this.updateElements(v,0,v.length,r)}updateElements(r,u,p,v){const E=this._cachedMeta.rScale,I="reset"===v;for(let L=u;L<u+p;L++){const H=r[L],Q=this.resolveDataElementOptions(L,H.active?"active":v),pe=E.getPointPositionForValue(L,this.getParsed(L).r),Me=I?E.xCenter:pe.x,Re=I?E.yCenter:pe.y,qe={x:Me,y:Re,angle:pe.angle,skip:isNaN(Me)||isNaN(Re),options:Q};this.updateElement(H,L,qe,v)}}}return Ze(s,"id","radar"),Ze(s,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),Ze(s,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}}),s})(),ScatterController:(()=>{class s extends _o{getLabelAndValue(r){const u=this._cachedMeta,p=this.chart.data.labels||[],{xScale:v,yScale:E}=u,I=this.getParsed(r),L=v.getLabelForValue(I.x),H=E.getLabelForValue(I.y);return{label:p[r]||"",value:"("+L+", "+H+")"}}update(r){const u=this._cachedMeta,{data:p=[]}=u,v=this.chart._animationsDisabled;let{start:E,count:I}=ts(u,p,v);if(this._drawStart=E,this._drawCount=I,Ta(u)&&(E=0,I=p.length),this.options.showLine){const{dataset:L,_dataset:H}=u;L._chart=this.chart,L._datasetIndex=this.index,L._decimated=!!H._decimated,L.points=p;const Q=this.resolveDatasetElementOptions(r);Q.segment=this.options.segment,this.updateElement(L,void 0,{animated:!v,options:Q},r)}this.updateElements(p,E,I,r)}addElements(){const{showLine:r}=this.options;!this.datasetElementType&&r&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(r,u,p,v){const E="reset"===v,{iScale:I,vScale:L,_stacked:H,_dataset:Q}=this._cachedMeta,pe=this.resolveDataElementOptions(u,v),Me=this.getSharedOptions(pe),Re=this.includeOptions(v,Me),qe=I.axis,Qe=L.axis,{spanGaps:rt,segment:jt}=this.options,Ut=Oe(rt)?rt:Number.POSITIVE_INFINITY,vn=this.chart._animationsDisabled||E||"none"===v;let Sn=u>0&&this.getParsed(u-1);for(let fn=u;fn<u+p;++fn){const En=r[fn],fi=this.getParsed(fn),Yn=vn?En:{},Ti=Yt(fi[Qe]),Mr=Yn[qe]=I.getPixelForValue(fi[qe],fn),Sr=Yn[Qe]=E||Ti?L.getBasePixel():L.getPixelForValue(H?this.applyStack(L,fi,H):fi[Qe],fn);Yn.skip=isNaN(Mr)||isNaN(Sr)||Ti,Yn.stop=fn>0&&Math.abs(fi[qe]-Sn[qe])>Ut,jt&&(Yn.parsed=fi,Yn.raw=Q.data[fn]),Re&&(Yn.options=Me||this.resolveDataElementOptions(fn,En.active?"active":v)),vn||this.updateElement(En,fn,Yn,v),Sn=fi}this.updateSharedOptions(Me,v,pe)}getMaxOverflow(){const r=this._cachedMeta,u=r.data||[];if(!this.options.showLine){let L=0;for(let H=u.length-1;H>=0;--H)L=Math.max(L,u[H].size(this.resolveDataElementOptions(H))/2);return L>0&&L}const p=r.dataset,v=p.options&&p.options.borderWidth||0;if(!u.length)return v;const E=u[0].size(this.resolveDataElementOptions(0)),I=u[u.length-1].size(this.resolveDataElementOptions(u.length-1));return Math.max(v,E,I)/2}}return Ze(s,"id","scatter"),Ze(s,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),Ze(s,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}}),s})()});function os(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class bs{static override(l){Object.assign(bs.prototype,l)}constructor(l){Ze(this,"options",void 0),this.options=l||{}}init(){}formats(){return os()}parse(){return os()}format(){return os()}add(){return os()}diff(){return os()}startOf(){return os()}endOf(){return os()}}var hu__date=bs;function Pl(s,l,r,u){const{controller:p,data:v,_sorted:E}=s,I=p._cachedMeta.iScale;if(I&&l===I.axis&&"r"!==l&&E&&v.length){const L=I._reversePixels?Uo:hi;if(!u)return L(v,l,r);if(p._sharedOptions){const H=v[0],Q="function"==typeof H.getRange&&H.getRange(l);if(Q){const pe=L(v,l,r-Q),Me=L(v,l,r+Q);return{lo:pe.lo,hi:Me.hi}}}}return{lo:0,hi:v.length-1}}function Bs(s,l,r,u,p){const v=s.getSortedVisibleDatasetMetas(),E=r[l];for(let I=0,L=v.length;I<L;++I){const{index:H,data:Q}=v[I],{lo:pe,hi:Me}=Pl(v[I],l,E,p);for(let Re=pe;Re<=Me;++Re){const qe=Q[Re];qe.skip||u(qe,H,Re)}}}function ml(s,l,r,u,p){const v=[];return!p&&!s.isPointInArea(l)||Bs(s,r,l,function(I,L,H){!p&&!As(I,s.chartArea,0)||I.inRange(l.x,l.y,u)&&v.push({element:I,datasetIndex:L,index:H})},!0),v}function Va(s,l,r,u,p,v){return v||s.isPointInArea(l)?"r"!==r||u?function _a(s,l,r,u,p,v){let E=[];const I=function $c(s){const l=-1!==s.indexOf("x"),r=-1!==s.indexOf("y");return function(u,p){const v=l?Math.abs(u.x-p.x):0,E=r?Math.abs(u.y-p.y):0;return Math.sqrt(Math.pow(v,2)+Math.pow(E,2))}}(r);let L=Number.POSITIVE_INFINITY;return Bs(s,r,l,function H(Q,pe,Me){const Re=Q.inRange(l.x,l.y,p);if(u&&!Re)return;const qe=Q.getCenterPoint(p);if(!v&&!s.isPointInArea(qe)&&!Re)return;const rt=I(l,qe);rt<L?(E=[{element:Q,datasetIndex:pe,index:Me}],L=rt):rt===L&&E.push({element:Q,datasetIndex:pe,index:Me})}),E}(s,l,r,u,p,v):function Ka(s,l,r,u){let p=[];return Bs(s,r,l,function v(E,I,L){const{startAngle:H,endAngle:Q}=E.getProps(["startAngle","endAngle"],u),{angle:pe}=Zi(E,{x:l.x,y:l.y});Pr(pe,H,Q)&&p.push({element:E,datasetIndex:I,index:L})}),p}(s,l,r,p):[]}function fu(s,l,r,u,p){const v=[],E="x"===r?"inXRange":"inYRange";let I=!1;return Bs(s,r,l,(L,H,Q)=>{L[E](l[r],p)&&(v.push({element:L,datasetIndex:H,index:Q}),I=I||L.inRange(l.x,l.y,p))}),u&&!I?[]:v}var Nl={evaluateInteractionItems:Bs,modes:{index(s,l,r,u){const p=Do(l,s),v=r.axis||"x",E=r.includeInvisible||!1,I=r.intersect?ml(s,p,v,u,E):Va(s,p,v,!1,u,E),L=[];return I.length?(s.getSortedVisibleDatasetMetas().forEach(H=>{const Q=I[0].index,pe=H.data[Q];pe&&!pe.skip&&L.push({element:pe,datasetIndex:H.index,index:Q})}),L):[]},dataset(s,l,r,u){const p=Do(l,s),v=r.axis||"xy",E=r.includeInvisible||!1;let I=r.intersect?ml(s,p,v,u,E):Va(s,p,v,!1,u,E);if(I.length>0){const L=I[0].datasetIndex,H=s.getDatasetMeta(L).data;I=[];for(let Q=0;Q<H.length;++Q)I.push({element:H[Q],datasetIndex:L,index:Q})}return I},point:(s,l,r,u)=>ml(s,Do(l,s),r.axis||"xy",u,r.includeInvisible||!1),nearest:(s,l,r,u)=>Va(s,Do(l,s),r.axis||"xy",r.intersect,u,r.includeInvisible||!1),x:(s,l,r,u)=>fu(s,Do(l,s),"x",r.intersect,u),y:(s,l,r,u)=>fu(s,Do(l,s),"y",r.intersect,u)}};const Xl=["left","top","right","bottom"];function w(s,l){return s.filter(r=>r.pos===l)}function n(s,l){return s.filter(r=>-1===Xl.indexOf(r.pos)&&r.box.axis===l)}function d(s,l){return s.sort((r,u)=>{const p=l?u:r,v=l?r:u;return p.weight===v.weight?p.index-v.index:p.weight-v.weight})}function Z(s,l,r,u){return Math.max(s[r],l[r])+Math.max(s[u],l[u])}function Y(s,l){s.top=Math.max(s.top,l.top),s.left=Math.max(s.left,l.left),s.bottom=Math.max(s.bottom,l.bottom),s.right=Math.max(s.right,l.right)}function X(s,l,r,u){const{pos:p,box:v}=r,E=s.maxPadding;if(!at(p)){r.size&&(s[p]-=r.size);const pe=u[r.stack]||{size:0,count:1};pe.size=Math.max(pe.size,r.horizontal?v.height:v.width),r.size=pe.size/pe.count,s[p]+=r.size}v.getPadding&&Y(E,v.getPadding());const I=Math.max(0,l.outerWidth-Z(E,s,"left","right")),L=Math.max(0,l.outerHeight-Z(E,s,"top","bottom")),H=I!==s.w,Q=L!==s.h;return s.w=I,s.h=L,r.horizontal?{same:H,other:Q}:{same:Q,other:H}}function ae(s,l){const r=l.maxPadding;return function u(p){const v={left:0,top:0,right:0,bottom:0};return p.forEach(E=>{v[E]=Math.max(l[E],r[E])}),v}(s?["left","right"]:["top","bottom"])}function De(s,l,r,u){const p=[];let v,E,I,L,H,Q;for(v=0,E=s.length,H=0;v<E;++v){I=s[v],L=I.box,L.update(I.width||l.w,I.height||l.h,ae(I.horizontal,l));const{same:pe,other:Me}=X(l,r,I,u);H|=pe&&p.length,Q=Q||Me,L.fullSize||p.push(I)}return H&&De(p,l,r,u)||Q}function ze(s,l,r,u,p){s.top=r,s.left=l,s.right=l+u,s.bottom=r+p,s.width=u,s.height=p}function ke(s,l,r,u){const p=r.padding;let{x:v,y:E}=l;for(const I of s){const L=I.box,H=u[I.stack]||{count:1,placed:0,weight:1},Q=I.stackWeight/H.weight||1;if(I.horizontal){const pe=l.w*Q,Me=H.size||L.height;ye(H.start)&&(E=H.start),L.fullSize?ze(L,p.left,E,r.outerWidth-p.right-p.left,Me):ze(L,l.left+H.placed,E,pe,Me),H.start=E,H.placed+=pe,E=L.bottom}else{const pe=l.h*Q,Me=H.size||L.width;ye(H.start)&&(v=H.start),L.fullSize?ze(L,v,p.top,Me,r.outerHeight-p.bottom-p.top):ze(L,v,l.top+H.placed,Me,pe),H.start=v,H.placed+=pe,v=L.right}}l.x=v,l.y=E}var R={addBox(s,l){s.boxes||(s.boxes=[]),l.fullSize=l.fullSize||!1,l.position=l.position||"top",l.weight=l.weight||0,l._layers=l._layers||function(){return[{z:0,draw(r){l.draw(r)}}]},s.boxes.push(l)},removeBox(s,l){const r=s.boxes?s.boxes.indexOf(l):-1;-1!==r&&s.boxes.splice(r,1)},configure(s,l,r){l.fullSize=r.fullSize,l.position=r.position,l.weight=r.weight},update(s,l,r,u){if(!s)return;const p=Nr(s.options.layout.padding),v=Math.max(l-p.width,0),E=Math.max(r-p.height,0),I=function V(s){const l=function y(s){const l=[];let r,u,p,v,E,I;for(r=0,u=(s||[]).length;r<u;++r)p=s[r],({position:v,options:{stack:E,stackWeight:I=1}}=p),l.push({index:r,box:p,pos:v,horizontal:p.isHorizontal(),weight:p.weight,stack:E&&v+E,stackWeight:I});return l}(s),r=d(l.filter(H=>H.box.fullSize),!0),u=d(w(l,"left"),!0),p=d(w(l,"right")),v=d(w(l,"top"),!0),E=d(w(l,"bottom")),I=n(l,"x"),L=n(l,"y");return{fullSize:r,leftAndTop:u.concat(v),rightAndBottom:p.concat(L).concat(E).concat(I),chartArea:w(l,"chartArea"),vertical:u.concat(p).concat(L),horizontal:v.concat(E).concat(I)}}(s.boxes),L=I.vertical,H=I.horizontal;Qt(s.boxes,Qe=>{"function"==typeof Qe.beforeLayout&&Qe.beforeLayout()});const Q=L.reduce((Qe,rt)=>rt.box.options&&!1===rt.box.options.display?Qe:Qe+1,0)||1,pe=Object.freeze({outerWidth:l,outerHeight:r,padding:p,availableWidth:v,availableHeight:E,vBoxMaxWidth:v/2/Q,hBoxMaxHeight:E/2}),Me=Object.assign({},p);Y(Me,Nr(u));const Re=Object.assign({maxPadding:Me,w:v,h:E,x:p.left,y:p.top},p),qe=function N(s,l){const r=function C(s){const l={};for(const r of s){const{stack:u,pos:p,stackWeight:v}=r;if(!u||!Xl.includes(p))continue;const E=l[u]||(l[u]={count:0,placed:0,weight:0,size:0});E.count++,E.weight+=v}return l}(s),{vBoxMaxWidth:u,hBoxMaxHeight:p}=l;let v,E,I;for(v=0,E=s.length;v<E;++v){I=s[v];const{fullSize:L}=I.box,H=r[I.stack],Q=H&&I.stackWeight/H.weight;I.horizontal?(I.width=Q?Q*u:L&&l.availableWidth,I.height=p):(I.width=u,I.height=Q?Q*p:L&&l.availableHeight)}return r}(L.concat(H),pe);De(I.fullSize,Re,pe,qe),De(L,Re,pe,qe),De(H,Re,pe,qe)&&De(L,Re,pe,qe),function le(s){const l=s.maxPadding;function r(u){const p=Math.max(l[u]-s[u],0);return s[u]+=p,p}s.y+=r("top"),s.x+=r("left"),r("right"),r("bottom")}(Re),ke(I.leftAndTop,Re,pe,qe),Re.x+=Re.w,Re.y+=Re.h,ke(I.rightAndBottom,Re,pe,qe),s.chartArea={left:Re.left,top:Re.top,right:Re.left+Re.w,bottom:Re.top+Re.h,height:Re.h,width:Re.w},Qt(I.chartArea,Qe=>{const rt=Qe.box;Object.assign(rt,s.chartArea),rt.update(Re.w,Re.h,{left:0,top:0,right:0,bottom:0})})}};class k{acquireContext(l,r){}releaseContext(l){return!1}addEventListener(l,r,u){}removeEventListener(l,r,u){}getDevicePixelRatio(){return 1}getMaximumSize(l,r,u,p){return r=Math.max(0,r||l.width),u=u||l.height,{width:r,height:Math.max(0,p?Math.floor(r/p):u)}}isAttached(l){return!0}updateConfig(l){}}class O extends k{acquireContext(l){return l&&l.getContext&&l.getContext("2d")||null}updateConfig(l){l.options.animation=!1}}const z="$chartjs",W={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},ie=s=>null===s||""===s,Ne=!!Ml&&{passive:!0};function Mt(s,l,r){s.canvas.removeEventListener(l,r,Ne)}function on(s,l){for(const r of s)if(r===l||r.contains(l))return!0}function Hn(s,l,r){const u=s.canvas,p=new MutationObserver(v=>{let E=!1;for(const I of v)E=E||on(I.addedNodes,u),E=E&&!on(I.removedNodes,u);E&&r()});return p.observe(document,{childList:!0,subtree:!0}),p}function Pi(s,l,r){const u=s.canvas,p=new MutationObserver(v=>{let E=!1;for(const I of v)E=E||on(I.removedNodes,u),E=E&&!on(I.addedNodes,u);E&&r()});return p.observe(document,{childList:!0,subtree:!0}),p}const Dn=new Map;let gi=0;function Bn(){const s=window.devicePixelRatio;s!==gi&&(gi=s,Dn.forEach((l,r)=>{r.currentDevicePixelRatio!==s&&l()}))}function Ir(s,l,r){const u=s.canvas,p=u&&fo(u);if(!p)return;const v=Ts((I,L)=>{const H=p.clientWidth;r(I,L),H<p.clientWidth&&r()},window),E=new ResizeObserver(I=>{const L=I[0],H=L.contentRect.width,Q=L.contentRect.height;0===H&&0===Q||v(H,Q)});return E.observe(p),function cr(s,l){Dn.size||window.addEventListener("resize",Bn),Dn.set(s,l)}(s,v),E}function ki(s,l,r){r&&r.disconnect(),"resize"===l&&function To(s){Dn.delete(s),Dn.size||window.removeEventListener("resize",Bn)}(s)}function Kr(s,l,r){const u=s.canvas,p=Ts(v=>{null!==s.ctx&&r(function vt(s,l){const r=W[s.type]||s.type,{x:u,y:p}=Do(s,l);return{type:r,chart:l,native:s,x:void 0!==u?u:null,y:void 0!==p?p:null}}(v,s))},s);return function et(s,l,r){s.addEventListener(l,r,Ne)}(u,l,p),p}class xs extends k{acquireContext(l,r){const u=l&&l.getContext&&l.getContext("2d");return u&&u.canvas===l?(function ue(s,l){const r=s.style,u=s.getAttribute("height"),p=s.getAttribute("width");if(s[z]={initial:{height:u,width:p,style:{display:r.display,height:r.height,width:r.width}}},r.display=r.display||"block",r.boxSizing=r.boxSizing||"border-box",ie(p)){const v=zo(s,"width");void 0!==v&&(s.width=v)}if(ie(u))if(""===s.style.height)s.height=s.width/(l||2);else{const v=zo(s,"height");void 0!==v&&(s.height=v)}}(l,r),u):null}releaseContext(l){const r=l.canvas;if(!r[z])return!1;const u=r[z].initial;["height","width"].forEach(v=>{const E=u[v];Yt(E)?r.removeAttribute(v):r.setAttribute(v,E)});const p=u.style||{};return Object.keys(p).forEach(v=>{r.style[v]=p[v]}),r.width=r.width,delete r[z],!0}addEventListener(l,r,u){this.removeEventListener(l,r),(l.$proxies||(l.$proxies={}))[r]=({attach:Hn,detach:Pi,resize:Ir}[r]||Kr)(l,r,u)}removeEventListener(l,r){const u=l.$proxies||(l.$proxies={}),p=u[r];p&&(({attach:ki,detach:ki,resize:ki}[r]||Mt)(l,r,p),u[r]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(l,r,u,p){return function Sl(s,l,r,u){const p=wo(s),v=Na(p,"margin"),E=ms(p.maxWidth,s,"clientWidth")||Se,I=ms(p.maxHeight,s,"clientHeight")||Se,L=function Wl(s,l,r){let u,p;if(void 0===l||void 0===r){const v=fo(s);if(v){const E=v.getBoundingClientRect(),I=wo(v),L=Na(I,"border","width"),H=Na(I,"padding");l=E.width-H.width-L.width,r=E.height-H.height-L.height,u=ms(I.maxWidth,v,"clientWidth"),p=ms(I.maxHeight,v,"clientHeight")}else l=s.clientWidth,r=s.clientHeight}return{width:l,height:r,maxWidth:u||Se,maxHeight:p||Se}}(s,l,r);let{width:H,height:Q}=L;if("content-box"===p.boxSizing){const Me=Na(p,"border","width"),Re=Na(p,"padding");H-=Re.width+Me.width,Q-=Re.height+Me.height}return H=Math.max(0,H-v.width),Q=Math.max(0,u?H/u:Q-v.height),H=Qr(Math.min(H,E,L.maxWidth)),Q=Qr(Math.min(Q,I,L.maxHeight)),H&&!Q&&(Q=Qr(H/2)),(void 0!==l||void 0!==r)&&u&&L.height&&Q>L.height&&(Q=L.height,H=Qr(Math.floor(Q*u))),{width:H,height:Q}}(l,r,u,p)}isAttached(l){const r=fo(l);return!(!r||!r.isConnected)}}class ar{constructor(){Ze(this,"x",void 0),Ze(this,"y",void 0),Ze(this,"active",!1),Ze(this,"options",void 0),Ze(this,"$animations",void 0)}tooltipPosition(l){const{x:r,y:u}=this.getProps(["x","y"],l);return{x:r,y:u}}hasValue(){return Oe(this.x)&&Oe(this.y)}getProps(l,r){const u=this.$animations;if(!r||!u)return this;const p={};return l.forEach(v=>{p[v]=u[v]&&u[v].active()?u[v]._to:this[v]}),p}}function yl(s,l,r,u,p){const v=Kn(u,0),E=Math.min(Kn(p,s.length),s.length);let L,H,Q,I=0;for(r=Math.ceil(r),p&&(L=p-u,r=L/Math.floor(L/r)),Q=v;Q<0;)I++,Q=Math.round(v+I*r);for(H=Math.max(v,0);H<E;H++)H===Q&&(l.push(s[H]),I++,Q=Math.round(v+I*r))}Ze(ar,"defaults",{}),Ze(ar,"defaultRoutes",void 0);const br=(s,l,r)=>"top"===l||"left"===l?s[l]+r:s[l]-r,Ro=(s,l)=>Math.min(l||s,s);function $o(s,l){const r=[],u=s.length/l,p=s.length;let v=0;for(;v<p;v+=u)r.push(s[Math.floor(v)]);return r}function Cr(s,l,r){const u=s.ticks.length,p=Math.min(l,u-1),v=s._startPixel,E=s._endPixel,I=1e-6;let H,L=s.getPixelForTick(p);if(!(r&&(H=1===u?Math.max(L-v,E-L):0===l?(s.getPixelForTick(1)-L)/2:(L-s.getPixelForTick(p-1))/2,L+=p<l?H:-H,L<v-I||L>E+I)))return L}function ws(s){return s.drawTicks?s.tickLength:0}function Gc(s,l){if(!s.display)return 0;const r=Er(s.font,l),u=Nr(s.padding);return(jn(s.text)?s.text.length:1)*r.lineHeight+u.height}function ku(s,l,r){let u=Ss(s);return(r&&"right"!==l||!r&&"right"===l)&&(u=(s=>"left"===s?"right":"right"===s?"left":s)(u)),u}class ya extends ar{constructor(l){super(),this.id=l.id,this.type=l.type,this.options=void 0,this.ctx=l.ctx,this.chart=l.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(l){this.options=l.setContext(this.getContext()),this.axis=l.axis,this._userMin=this.parse(l.min),this._userMax=this.parse(l.max),this._suggestedMin=this.parse(l.suggestedMin),this._suggestedMax=this.parse(l.suggestedMax)}parse(l,r){return l}getUserBounds(){let{_userMin:l,_userMax:r,_suggestedMin:u,_suggestedMax:p}=this;return l=yn(l,Number.POSITIVE_INFINITY),r=yn(r,Number.NEGATIVE_INFINITY),u=yn(u,Number.POSITIVE_INFINITY),p=yn(p,Number.NEGATIVE_INFINITY),{min:yn(l,u),max:yn(r,p),minDefined:qt(l),maxDefined:qt(r)}}getMinMax(l){let E,{min:r,max:u,minDefined:p,maxDefined:v}=this.getUserBounds();if(p&&v)return{min:r,max:u};const I=this.getMatchingVisibleMetas();for(let L=0,H=I.length;L<H;++L)E=I[L].controller.getMinMax(this,l),p||(r=Math.min(r,E.min)),v||(u=Math.max(u,E.max));return r=v&&r>u?u:r,u=p&&r>u?r:u,{min:yn(r,yn(u,r)),max:yn(u,yn(r,u))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const l=this.chart.data;return this.options.labels||(this.isHorizontal()?l.xLabels:l.yLabels)||l.labels||[]}getLabelItems(l=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(l))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){On(this.options.beforeUpdate,[this])}update(l,r,u){const{beginAtZero:p,grace:v,ticks:E}=this.options,I=E.sampleSize;this.beforeUpdate(),this.maxWidth=l,this.maxHeight=r,this._margins=u=Object.assign({left:0,right:0,top:0,bottom:0},u),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+u.left+u.right:this.height+u.top+u.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function ho(s,l,r){const{min:u,max:p}=s,v=rn(l,(p-u)/2),E=(I,L)=>r&&0===I?0:I+L;return{min:E(u,-Math.abs(v)),max:E(p,v)}}(this,v,p),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const L=I<this.ticks.length;this._convertTicksToLabels(L?$o(this.ticks,I):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),E.display&&(E.autoSkip||"auto"===E.source)&&(this.ticks=function qs(s,l){const r=s.options.ticks,u=function sa(s){const l=s.options.offset,r=s._tickSize();return Math.floor(Math.min(s._length/r+(l?0:1),s._maxLength/r))}(s),p=Math.min(r.maxTicksLimit||u,u),v=r.major.enabled?function ci(s){const l=[];let r,u;for(r=0,u=s.length;r<u;r++)s[r].major&&l.push(r);return l}(l):[],E=v.length,I=v[0],L=v[E-1],H=[];if(E>p)return function Xa(s,l,r,u){let E,p=0,v=r[0];for(u=Math.ceil(u),E=0;E<s.length;E++)E===v&&(l.push(s[E]),p++,v=r[p*u])}(l,H,v,E/p),H;const Q=function _l(s,l,r){const u=function vo(s){const l=s.length;let r,u;if(l<2)return!1;for(u=s[0],r=1;r<l;++r)if(s[r]-s[r-1]!==u)return!1;return u}(s),p=l.length/r;if(!u)return Math.max(p,1);const v=function ut(s){const l=[],r=Math.sqrt(s);let u;for(u=1;u<r;u++)s%u==0&&(l.push(u),l.push(s/u));return r===(0|r)&&l.push(r),l.sort((p,v)=>p-v).pop(),l}(u);for(let E=0,I=v.length-1;E<I;E++){const L=v[E];if(L>p)return L}return Math.max(p,1)}(v,l,p);if(E>0){let pe,Me;const Re=E>1?Math.round((L-I)/(E-1)):null;for(yl(l,H,Q,Yt(Re)?0:I-Re,I),pe=0,Me=E-1;pe<Me;pe++)yl(l,H,Q,v[pe],v[pe+1]);return yl(l,H,Q,L,Yt(Re)?l.length:L+Re),H}return yl(l,H,Q),H}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),L&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let r,u,l=this.options.reverse;this.isHorizontal()?(r=this.left,u=this.right):(r=this.top,u=this.bottom,l=!l),this._startPixel=r,this._endPixel=u,this._reversePixels=l,this._length=u-r,this._alignToPixels=this.options.alignToPixels}afterUpdate(){On(this.options.afterUpdate,[this])}beforeSetDimensions(){On(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){On(this.options.afterSetDimensions,[this])}_callHooks(l){this.chart.notifyPlugins(l,this.getContext()),On(this.options[l],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){On(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(l){const r=this.options.ticks;let u,p,v;for(u=0,p=l.length;u<p;u++)v=l[u],v.label=On(r.callback,[v.value,u,l],this)}afterTickToLabelConversion(){On(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){On(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const l=this.options,r=l.ticks,u=Ro(this.ticks.length,l.ticks.maxTicksLimit),p=r.minRotation||0,v=r.maxRotation;let I,L,H,E=p;if(!this._isVisible()||!r.display||p>=v||u<=1||!this.isHorizontal())return void(this.labelRotation=p);const Q=this._getLabelSizes(),pe=Q.widest.width,Me=Q.highest.height,Re=Ki(this.chart.width-pe,0,this.maxWidth);I=l.offset?this.maxWidth/u:Re/(u-1),pe+6>I&&(I=Re/(u-(l.offset?.5:1)),L=this.maxHeight-ws(l.grid)-r.padding-Gc(l.title,this.chart.options.font),H=Math.sqrt(pe*pe+Me*Me),E=Wt(Math.min(Math.asin(Ki((Q.highest.height+6)/I,-1,1)),Math.asin(Ki(L/H,-1,1))-Math.asin(Ki(Me/H,-1,1)))),E=Math.max(p,Math.min(v,E))),this.labelRotation=E}afterCalculateLabelRotation(){On(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){On(this.options.beforeFit,[this])}fit(){const l={width:0,height:0},{chart:r,options:{ticks:u,title:p,grid:v}}=this,E=this._isVisible(),I=this.isHorizontal();if(E){const L=Gc(p,r.options.font);if(I?(l.width=this.maxWidth,l.height=ws(v)+L):(l.height=this.maxHeight,l.width=ws(v)+L),u.display&&this.ticks.length){const{first:H,last:Q,widest:pe,highest:Me}=this._getLabelSizes(),Re=2*u.padding,qe=tn(this.labelRotation),Qe=Math.cos(qe),rt=Math.sin(qe);I?l.height=Math.min(this.maxHeight,l.height+(u.mirror?0:rt*pe.width+Qe*Me.height)+Re):l.width=Math.min(this.maxWidth,l.width+(u.mirror?0:Qe*pe.width+rt*Me.height)+Re),this._calculatePadding(H,Q,rt,Qe)}}this._handleMargins(),I?(this.width=this._length=r.width-this._margins.left-this._margins.right,this.height=l.height):(this.width=l.width,this.height=this._length=r.height-this._margins.top-this._margins.bottom)}_calculatePadding(l,r,u,p){const{ticks:{align:v,padding:E},position:I}=this.options,L=0!==this.labelRotation,H="top"!==I&&"x"===this.axis;if(this.isHorizontal()){const Q=this.getPixelForTick(0)-this.left,pe=this.right-this.getPixelForTick(this.ticks.length-1);let Me=0,Re=0;L?H?(Me=p*l.width,Re=u*r.height):(Me=u*l.height,Re=p*r.width):"start"===v?Re=r.width:"end"===v?Me=l.width:"inner"!==v&&(Me=l.width/2,Re=r.width/2),this.paddingLeft=Math.max((Me-Q+E)*this.width/(this.width-Q),0),this.paddingRight=Math.max((Re-pe+E)*this.width/(this.width-pe),0)}else{let Q=r.height/2,pe=l.height/2;"start"===v?(Q=0,pe=l.height):"end"===v&&(Q=r.height,pe=0),this.paddingTop=Q+E,this.paddingBottom=pe+E}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){On(this.options.afterFit,[this])}isHorizontal(){const{axis:l,position:r}=this.options;return"top"===r||"bottom"===r||"x"===l}isFullSize(){return this.options.fullSize}_convertTicksToLabels(l){let r,u;for(this.beforeTickToLabelConversion(),this.generateTickLabels(l),r=0,u=l.length;r<u;r++)Yt(l[r].label)&&(l.splice(r,1),u--,r--);this.afterTickToLabelConversion()}_getLabelSizes(){let l=this._labelSizes;if(!l){const r=this.options.ticks.sampleSize;let u=this.ticks;r<u.length&&(u=$o(u,r)),this._labelSizes=l=this._computeLabelSizes(u,u.length,this.options.ticks.maxTicksLimit)}return l}_computeLabelSizes(l,r,u){const{ctx:p,_longestTextCache:v}=this,E=[],I=[],L=Math.floor(r/Ro(r,u));let pe,Me,Re,qe,Qe,rt,jt,Ut,vn,Sn,fn,H=0,Q=0;for(pe=0;pe<r;pe+=L){if(qe=l[pe].label,Qe=this._resolveTickFontOptions(pe),p.font=rt=Qe.string,jt=v[rt]=v[rt]||{data:{},gc:[]},Ut=Qe.lineHeight,vn=Sn=0,Yt(qe)||jn(qe)){if(jn(qe))for(Me=0,Re=qe.length;Me<Re;++Me)fn=qe[Me],!Yt(fn)&&!jn(fn)&&(vn=fs(p,jt.data,jt.gc,vn,fn),Sn+=Ut)}else vn=fs(p,jt.data,jt.gc,vn,qe),Sn=Ut;E.push(vn),I.push(Sn),H=Math.max(vn,H),Q=Math.max(Sn,Q)}!function So(s,l){Qt(s,r=>{const u=r.gc,p=u.length/2;let v;if(p>l){for(v=0;v<p;++v)delete r.data[u[v]];u.splice(0,p)}})}(v,r);const En=E.indexOf(H),fi=I.indexOf(Q),Yn=Ti=>({width:E[Ti]||0,height:I[Ti]||0});return{first:Yn(0),last:Yn(r-1),widest:Yn(En),highest:Yn(fi),widths:E,heights:I}}getLabelForValue(l){return l}getPixelForValue(l,r){return NaN}getValueForPixel(l){}getPixelForTick(l){const r=this.ticks;return l<0||l>r.length-1?null:this.getPixelForValue(r[l].value)}getPixelForDecimal(l){this._reversePixels&&(l=1-l);const r=this._startPixel+l*this._length;return function tr(s){return Ki(s,-32768,32767)}(this._alignToPixels?Gr(this.chart,r,0):r)}getDecimalForPixel(l){const r=(l-this._startPixel)/this._length;return this._reversePixels?1-r:r}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:l,max:r}=this;return l<0&&r<0?r:l>0&&r>0?l:0}getContext(l){const r=this.ticks||[];if(l>=0&&l<r.length){const u=r[l];return u.$context||(u.$context=function sd(s,l,r){return ta(s,{tick:r,index:l,type:"tick"})}(this.getContext(),l,u))}return this.$context||(this.$context=function vl(s,l){return ta(s,{scale:l,type:"scale"})}(this.chart.getContext(),this))}_tickSize(){const l=this.options.ticks,r=tn(this.labelRotation),u=Math.abs(Math.cos(r)),p=Math.abs(Math.sin(r)),v=this._getLabelSizes(),E=l.autoSkipPadding||0,I=v?v.widest.width+E:0,L=v?v.highest.height+E:0;return this.isHorizontal()?L*u>I*p?I/u:L/p:L*p<I*u?L/u:I/p}_isVisible(){const l=this.options.display;return"auto"!==l?!!l:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(l){const r=this.axis,u=this.chart,p=this.options,{grid:v,position:E,border:I}=p,L=v.offset,H=this.isHorizontal(),pe=this.ticks.length+(L?1:0),Me=ws(v),Re=[],qe=I.setContext(this.getContext()),Qe=qe.display?qe.width:0,rt=Qe/2,jt=function(cs){return Gr(u,cs,Qe)};let Ut,vn,Sn,fn,En,fi,Yn,Ti,Mr,Sr,jr,Ea;if("top"===E)Ut=jt(this.bottom),fi=this.bottom-Me,Ti=Ut-rt,Sr=jt(l.top)+rt,Ea=l.bottom;else if("bottom"===E)Ut=jt(this.top),Sr=l.top,Ea=jt(l.bottom)-rt,fi=Ut+rt,Ti=this.top+Me;else if("left"===E)Ut=jt(this.right),En=this.right-Me,Yn=Ut-rt,Mr=jt(l.left)+rt,jr=l.right;else if("right"===E)Ut=jt(this.left),Mr=l.left,jr=jt(l.right)-rt,En=Ut+rt,Yn=this.left+Me;else if("x"===r){if("center"===E)Ut=jt((l.top+l.bottom)/2+.5);else if(at(E)){const cs=Object.keys(E)[0];Ut=jt(this.chart.scales[cs].getPixelForValue(E[cs]))}Sr=l.top,Ea=l.bottom,fi=Ut+rt,Ti=fi+Me}else if("y"===r){if("center"===E)Ut=jt((l.left+l.right)/2);else if(at(E)){const cs=Object.keys(E)[0];Ut=jt(this.chart.scales[cs].getPixelForValue(E[cs]))}En=Ut-rt,Yn=En-Me,Mr=l.left,jr=l.right}const uc=Kn(p.ticks.maxTicksLimit,pe),Io=Math.max(1,Math.ceil(pe/uc));for(vn=0;vn<pe;vn+=Io){const cs=this.getContext(vn),Js=v.setContext(cs),lu=I.setContext(cs),cl=Js.lineWidth,mf=Js.color,Op=lu.dash||[],Kf=lu.dashOffset,Xf=Js.tickWidth,Jf=Js.tickColor,_f=Js.tickBorderDash||[],Dh=Js.tickBorderDashOffset;Sn=Cr(this,vn,L),void 0!==Sn&&(fn=Gr(u,Sn,cl),H?En=Yn=Mr=jr=fn:fi=Ti=Sr=Ea=fn,Re.push({tx1:En,ty1:fi,tx2:Yn,ty2:Ti,x1:Mr,y1:Sr,x2:jr,y2:Ea,width:cl,color:mf,borderDash:Op,borderDashOffset:Kf,tickWidth:Xf,tickColor:Jf,tickBorderDash:_f,tickBorderDashOffset:Dh}))}return this._ticksLength=pe,this._borderValue=Ut,Re}_computeLabelItems(l){const r=this.axis,u=this.options,{position:p,ticks:v}=u,E=this.isHorizontal(),I=this.ticks,{align:L,crossAlign:H,padding:Q,mirror:pe}=v,Me=ws(u.grid),Re=Me+Q,qe=pe?-Q:Re,Qe=-tn(this.labelRotation),rt=[];let jt,Ut,vn,Sn,fn,En,fi,Yn,Ti,Mr,Sr,jr,Ea="middle";if("top"===p)En=this.bottom-qe,fi=this._getXAxisLabelAlignment();else if("bottom"===p)En=this.top+qe,fi=this._getXAxisLabelAlignment();else if("left"===p){const Io=this._getYAxisLabelAlignment(Me);fi=Io.textAlign,fn=Io.x}else if("right"===p){const Io=this._getYAxisLabelAlignment(Me);fi=Io.textAlign,fn=Io.x}else if("x"===r){if("center"===p)En=(l.top+l.bottom)/2+Re;else if(at(p)){const Io=Object.keys(p)[0];En=this.chart.scales[Io].getPixelForValue(p[Io])+Re}fi=this._getXAxisLabelAlignment()}else if("y"===r){if("center"===p)fn=(l.left+l.right)/2-Re;else if(at(p)){const Io=Object.keys(p)[0];fn=this.chart.scales[Io].getPixelForValue(p[Io])}fi=this._getYAxisLabelAlignment(Me).textAlign}"y"===r&&("start"===L?Ea="top":"end"===L&&(Ea="bottom"));const uc=this._getLabelSizes();for(jt=0,Ut=I.length;jt<Ut;++jt){vn=I[jt],Sn=vn.label;const Io=v.setContext(this.getContext(jt));Yn=this.getPixelForTick(jt)+v.labelOffset,Ti=this._resolveTickFontOptions(jt),Mr=Ti.lineHeight,Sr=jn(Sn)?Sn.length:1;const cs=Sr/2,Js=Io.color,lu=Io.textStrokeColor,cl=Io.textStrokeWidth;let Op,mf=fi;if(E?(fn=Yn,"inner"===fi&&(mf=jt===Ut-1?this.options.reverse?"left":"right":0===jt?this.options.reverse?"right":"left":"center"),jr="top"===p?"near"===H||0!==Qe?-Sr*Mr+Mr/2:"center"===H?-uc.highest.height/2-cs*Mr+Mr:Mr/2-uc.highest.height:"near"===H||0!==Qe?Mr/2:"center"===H?uc.highest.height/2-cs*Mr:uc.highest.height-Sr*Mr,pe&&(jr*=-1),0!==Qe&&!Io.showLabelBackdrop&&(fn+=Mr/2*Math.sin(Qe))):(En=Yn,jr=(1-Sr)*Mr/2),Io.showLabelBackdrop){const Kf=Nr(Io.backdropPadding),Xf=uc.heights[jt],Jf=uc.widths[jt];let _f=jr-Kf.top,Dh=0-Kf.left;switch(Ea){case"middle":_f-=Xf/2;break;case"bottom":_f-=Xf}switch(fi){case"center":Dh-=Jf/2;break;case"right":Dh-=Jf}Op={left:Dh,top:_f,width:Jf+Kf.width,height:Xf+Kf.height,color:Io.backdropColor}}rt.push({label:Sn,font:Ti,textOffset:jr,options:{rotation:Qe,color:Js,strokeColor:lu,strokeWidth:cl,textAlign:mf,textBaseline:Ea,translation:[fn,En],backdrop:Op}})}return rt}_getXAxisLabelAlignment(){const{position:l,ticks:r}=this.options;if(-tn(this.labelRotation))return"top"===l?"left":"right";let p="center";return"start"===r.align?p="left":"end"===r.align?p="right":"inner"===r.align&&(p="inner"),p}_getYAxisLabelAlignment(l){const{position:r,ticks:{crossAlign:u,mirror:p,padding:v}}=this.options,I=l+v,L=this._getLabelSizes().widest.width;let H,Q;return"left"===r?p?(Q=this.right+v,"near"===u?H="left":"center"===u?(H="center",Q+=L/2):(H="right",Q+=L)):(Q=this.right-I,"near"===u?H="right":"center"===u?(H="center",Q-=L/2):(H="left",Q=this.left)):"right"===r?p?(Q=this.left+v,"near"===u?H="right":"center"===u?(H="center",Q-=L/2):(H="left",Q-=L)):(Q=this.left+I,"near"===u?H="left":"center"===u?(H="center",Q+=L/2):(H="right",Q=this.right)):H="right",{textAlign:H,x:Q}}_computeLabelArea(){if(this.options.ticks.mirror)return;const l=this.chart,r=this.options.position;return"left"===r||"right"===r?{top:0,left:this.left,bottom:l.height,right:this.right}:"top"===r||"bottom"===r?{top:this.top,left:0,bottom:this.bottom,right:l.width}:void 0}drawBackground(){const{ctx:l,options:{backgroundColor:r},left:u,top:p,width:v,height:E}=this;r&&(l.save(),l.fillStyle=r,l.fillRect(u,p,v,E),l.restore())}getLineWidthForValue(l){const r=this.options.grid;if(!this._isVisible()||!r.display)return 0;const p=this.ticks.findIndex(v=>v.value===l);return p>=0?r.setContext(this.getContext(p)).lineWidth:0}drawGrid(l){const r=this.options.grid,u=this.ctx,p=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(l));let v,E;const I=(L,H,Q)=>{!Q.width||!Q.color||(u.save(),u.lineWidth=Q.width,u.strokeStyle=Q.color,u.setLineDash(Q.borderDash||[]),u.lineDashOffset=Q.borderDashOffset,u.beginPath(),u.moveTo(L.x,L.y),u.lineTo(H.x,H.y),u.stroke(),u.restore())};if(r.display)for(v=0,E=p.length;v<E;++v){const L=p[v];r.drawOnChartArea&&I({x:L.x1,y:L.y1},{x:L.x2,y:L.y2},L),r.drawTicks&&I({x:L.tx1,y:L.ty1},{x:L.tx2,y:L.ty2},{color:L.tickColor,width:L.tickWidth,borderDash:L.tickBorderDash,borderDashOffset:L.tickBorderDashOffset})}}drawBorder(){const{chart:l,ctx:r,options:{border:u,grid:p}}=this,v=u.setContext(this.getContext()),E=u.display?v.width:0;if(!E)return;const I=p.setContext(this.getContext(0)).lineWidth,L=this._borderValue;let H,Q,pe,Me;this.isHorizontal()?(H=Gr(l,this.left,E)-E/2,Q=Gr(l,this.right,I)+I/2,pe=Me=L):(pe=Gr(l,this.top,E)-E/2,Me=Gr(l,this.bottom,I)+I/2,H=Q=L),r.save(),r.lineWidth=v.width,r.strokeStyle=v.color,r.beginPath(),r.moveTo(H,pe),r.lineTo(Q,Me),r.stroke(),r.restore()}drawLabels(l){if(!this.options.ticks.display)return;const u=this.ctx,p=this._computeLabelArea();p&&ps(u,p);const v=this.getLabelItems(l);for(const E of v)jo(u,E.label,0,E.textOffset,E.font,E.options);p&&yr(u)}drawTitle(){const{ctx:l,options:{position:r,title:u,reverse:p}}=this;if(!u.display)return;const v=Er(u.font),E=Nr(u.padding),I=u.align;let L=v.lineHeight/2;"bottom"===r||"center"===r||at(r)?(L+=E.bottom,jn(u.text)&&(L+=v.lineHeight*(u.text.length-1))):L+=E.top;const{titleX:H,titleY:Q,maxWidth:pe,rotation:Me}=function oo(s,l,r,u){const{top:p,left:v,bottom:E,right:I,chart:L}=s,{chartArea:H,scales:Q}=L;let Me,Re,qe,pe=0;const Qe=E-p,rt=I-v;if(s.isHorizontal()){if(Re=io(u,v,I),at(r)){const jt=Object.keys(r)[0];qe=Q[jt].getPixelForValue(r[jt])+Qe-l}else qe="center"===r?(H.bottom+H.top)/2+Qe-l:br(s,r,l);Me=I-v}else{if(at(r)){const jt=Object.keys(r)[0];Re=Q[jt].getPixelForValue(r[jt])-rt+l}else Re="center"===r?(H.left+H.right)/2-rt+l:br(s,r,l);qe=io(u,E,p),pe="left"===r?-Xe:Xe}return{titleX:Re,titleY:qe,maxWidth:Me,rotation:pe}}(this,L,r,I);jo(l,u.text,0,0,v,{color:u.color,maxWidth:pe,rotation:Me,textAlign:ku(I,r,p),textBaseline:"middle",translation:[H,Q]})}draw(l){this._isVisible()&&(this.drawBackground(),this.drawGrid(l),this.drawBorder(),this.drawTitle(),this.drawLabels(l))}_layers(){const l=this.options,r=l.ticks&&l.ticks.z||0,u=Kn(l.grid&&l.grid.z,-1),p=Kn(l.border&&l.border.z,0);return this._isVisible()&&this.draw===ya.prototype.draw?[{z:u,draw:v=>{this.drawBackground(),this.drawGrid(v),this.drawTitle()}},{z:p,draw:()=>{this.drawBorder()}},{z:r,draw:v=>{this.drawLabels(v)}}]:[{z:r,draw:v=>{this.draw(v)}}]}getMatchingVisibleMetas(l){const r=this.chart.getSortedVisibleDatasetMetas(),u=this.axis+"AxisID",p=[];let v,E;for(v=0,E=r.length;v<E;++v){const I=r[v];I[u]===this.id&&(!l||I.type===l)&&p.push(I)}return p}_resolveTickFontOptions(l){return Er(this.options.ticks.setContext(this.getContext(l)).font)}_maxDigits(){const l=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/l}}class aa{constructor(l,r,u){this.type=l,this.scope=r,this.override=u,this.items=Object.create(null)}isForType(l){return Object.prototype.isPrototypeOf.call(this.type.prototype,l.prototype)}register(l){const r=Object.getPrototypeOf(l);let u;(function ad(s){return"id"in s&&"defaults"in s})(r)&&(u=this.register(r));const p=this.items,v=l.id,E=this.scope+"."+v;if(!v)throw new Error("class does not have id: "+l);return v in p||(p[v]=l,function Rl(s,l,r){const u=Lr(Object.create(null),[r?$i.get(r):{},$i.get(l),s.defaults]);$i.set(l,u),s.defaultRoutes&&function Wc(s,l){Object.keys(l).forEach(r=>{const u=r.split("."),p=u.pop(),v=[s].concat(u).join("."),E=l[r].split("."),I=E.pop(),L=E.join(".");$i.route(v,p,L,I)})}(l,s.defaultRoutes),s.descriptors&&$i.describe(l,s.descriptors)}(l,E,u),this.override&&$i.override(l.id,l.overrides)),E}get(l){return this.items[l]}unregister(l){const r=this.items,u=l.id,p=this.scope;u in r&&delete r[u],p&&u in $i[p]&&(delete $i[p][u],this.override&&delete rr[u])}}class Zc{constructor(){this.controllers=new aa(_o,"datasets",!0),this.elements=new aa(ar,"elements"),this.plugins=new aa(Object,"plugins"),this.scales=new aa(ya,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...l){this._each("register",l)}remove(...l){this._each("unregister",l)}addControllers(...l){this._each("register",l,this.controllers)}addElements(...l){this._each("register",l,this.elements)}addPlugins(...l){this._each("register",l,this.plugins)}addScales(...l){this._each("register",l,this.scales)}getController(l){return this._get(l,this.controllers,"controller")}getElement(l){return this._get(l,this.elements,"element")}getPlugin(l){return this._get(l,this.plugins,"plugin")}getScale(l){return this._get(l,this.scales,"scale")}removeControllers(...l){this._each("unregister",l,this.controllers)}removeElements(...l){this._each("unregister",l,this.elements)}removePlugins(...l){this._each("unregister",l,this.plugins)}removeScales(...l){this._each("unregister",l,this.scales)}_each(l,r,u){[...r].forEach(p=>{const v=u||this._getRegistryForType(p);u||v.isForType(p)||v===this.plugins&&p.id?this._exec(l,v,p):Qt(p,E=>{const I=u||this._getRegistryForType(E);this._exec(l,I,E)})})}_exec(l,r,u){const p=he(l);On(u["before"+p],[],u),r[l](u),On(u["after"+p],[],u)}_getRegistryForType(l){for(let r=0;r<this._typedRegistries.length;r++){const u=this._typedRegistries[r];if(u.isForType(l))return u}return this.plugins}_get(l,r,u){const p=r.get(l);if(void 0===p)throw new Error('"'+l+'" is not a registered '+u+".");return p}}var kl=new Zc;class yf{constructor(){this._init=[]}notify(l,r,u,p){"beforeInit"===r&&(this._init=this._createDescriptors(l,!0),this._notify(this._init,l,"install"));const v=p?this._descriptors(l).filter(p):this._descriptors(l),E=this._notify(v,l,r,u);return"afterDestroy"===r&&(this._notify(v,l,"stop"),this._notify(this._init,l,"uninstall")),E}_notify(l,r,u,p){p=p||{};for(const v of l){const E=v.plugin;if(!1===On(E[u],[r,p,v.options],E)&&p.cancelable)return!1}return!0}invalidate(){Yt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(l){if(this._cache)return this._cache;const r=this._cache=this._createDescriptors(l);return this._notifyStateChanges(l),r}_createDescriptors(l,r){const u=l&&l.config,p=Kn(u.options&&u.options.plugins,{}),v=function jd(s){const l={},r=[],u=Object.keys(kl.plugins.items);for(let v=0;v<u.length;v++)r.push(kl.getPlugin(u[v]));const p=s.plugins||[];for(let v=0;v<p.length;v++){const E=p[v];-1===r.indexOf(E)&&(r.push(E),l[E.id]=!0)}return{plugins:r,localIds:l}}(u);return!1!==p||r?function Hd(s,{plugins:l,localIds:r},u,p){const v=[],E=s.getContext();for(const I of l){const L=I.id,H=tp(u[L],p);null!==H&&v.push({plugin:I,options:$d(s.config,{plugin:I,local:r[L]},H,E)})}return v}(l,v,p,r):[]}_notifyStateChanges(l){const r=this._oldCache||[],u=this._cache,p=(v,E)=>v.filter(I=>!E.some(L=>I.plugin.id===L.plugin.id));this._notify(p(r,u),l,"stop"),this._notify(p(u,r),l,"start")}}function tp(s,l){return l||!1!==s?!0===s?{}:s:null}function $d(s,{plugin:l,local:r},u,p){const v=s.pluginScopeKeys(l),E=s.getOptionScopes(u,v);return r&&l.defaults&&E.push(l.defaults),s.createResolver(E,p,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Fl(s,l){return((l.datasets||{})[s]||{}).indexAxis||l.indexAxis||($i.datasets[s]||{}).indexAxis||"x"}function vc(s){if("x"===s||"y"===s||"r"===s)return s}function Sh(s){return"top"===s||"bottom"===s?"x":"left"===s||"right"===s?"y":void 0}function Ja(s,...l){if(vc(s))return s;for(const r of l){const u=r.axis||Sh(r.position)||s.length>1&&vc(s[0].toLowerCase());if(u)return u}throw new Error(`Cannot determine type of '${s}' axis. Please provide 'axis' or 'position' option.`)}function Gd(s,l,r){if(r[l+"AxisID"]===s)return{axis:l}}function np(s){const l=s.options||(s.options={});l.plugins=Kn(l.plugins,{}),l.scales=function kp(s,l){const r=rr[s.type]||{scales:{}},u=l.scales||{},p=Fl(s.type,l),v=Object.create(null);return Object.keys(u).forEach(E=>{const I=u[E];if(!at(I))return console.error(`Invalid scale configuration for scale: ${E}`);if(I._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${E}`);const L=Ja(E,I,function Wd(s,l){if(l.data&&l.data.datasets){const r=l.data.datasets.filter(u=>u.xAxisID===s||u.yAxisID===s);if(r.length)return Gd(s,"x",r[0])||Gd(s,"y",r[0])}return{}}(E,s),$i.scales[I.type]),H=function qc(s,l){return s===l?"_index_":"_value_"}(L,p),Q=r.scales||{};v[E]=_r(Object.create(null),[{axis:L},I,Q[L],Q[H]])}),s.data.datasets.forEach(E=>{const I=E.type||s.type,L=E.indexAxis||Fl(I,l),Q=(rr[I]||{}).scales||{};Object.keys(Q).forEach(pe=>{const Me=function Yc(s,l){let r=s;return"_index_"===s?r=l:"_value_"===s&&(r="x"===l?"y":"x"),r}(pe,L),Re=E[Me+"AxisID"]||Me;v[Re]=v[Re]||Object.create(null),_r(v[Re],[{axis:Me},u[Re],Q[pe]])})}),Object.keys(v).forEach(E=>{const I=v[E];_r(I,[$i.scales[I.type],$i.scale])}),v}(s,l)}function Fp(s){return(s=s||{}).datasets=s.datasets||[],s.labels=s.labels||[],s}const ld=new Map,vf=new Set;function Kc(s,l){let r=ld.get(s);return r||(r=l(),ld.set(s,r),vf.add(r)),r}const pu=(s,l,r)=>{const u=Le(l,r);void 0!==u&&s.add(u)};class gg{constructor(l){this._config=function Ua(s){return(s=s||{}).data=Fp(s.data),np(s),s}(l),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(l){this._config.type=l}get data(){return this._config.data}set data(l){this._config.data=Fp(l)}get options(){return this._config.options}set options(l){this._config.options=l}get plugins(){return this._config.plugins}update(){const l=this._config;this.clearCache(),np(l)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(l){return Kc(l,()=>[[`datasets.${l}`,""]])}datasetAnimationScopeKeys(l,r){return Kc(`${l}.transition.${r}`,()=>[[`datasets.${l}.transitions.${r}`,`transitions.${r}`],[`datasets.${l}`,""]])}datasetElementScopeKeys(l,r){return Kc(`${l}-${r}`,()=>[[`datasets.${l}.elements.${r}`,`datasets.${l}`,`elements.${r}`,""]])}pluginScopeKeys(l){const r=l.id;return Kc(`${this.type}-plugin-${r}`,()=>[[`plugins.${r}`,...l.additionalOptionScopes||[]]])}_cachedScopes(l,r){const u=this._scopeCache;let p=u.get(l);return(!p||r)&&(p=new Map,u.set(l,p)),p}getOptionScopes(l,r,u){const{options:p,type:v}=this,E=this._cachedScopes(l,u),I=E.get(r);if(I)return I;const L=new Set;r.forEach(Q=>{l&&(L.add(l),Q.forEach(pe=>pu(L,l,pe))),Q.forEach(pe=>pu(L,p,pe)),Q.forEach(pe=>pu(L,rr[v]||{},pe)),Q.forEach(pe=>pu(L,$i,pe)),Q.forEach(pe=>pu(L,Ln,pe))});const H=Array.from(L);return 0===H.length&&H.push(Object.create(null)),vf.has(r)&&E.set(r,H),H}chartOptionScopes(){const{options:l,type:r}=this;return[l,rr[r]||{},$i.datasets[r]||{},{type:r},$i,Ln]}resolveNamedOptions(l,r,u,p=[""]){const v={$shared:!0},{resolver:E,subPrefixes:I}=Ko(this._resolverCache,l,p);let L=E;(function cd(s,l){const{isScriptable:r,isIndexable:u}=ga(s);for(const p of l){const v=r(p),E=u(p),I=(E||v)&&s[p];if(v&&(Ie(I)||ip(I))||E&&jn(I))return!0}return!1})(E,r)&&(v.$shared=!1,L=wi(E,u=Ie(u)?u():u,this.createResolver(l,u,I)));for(const H of r)v[H]=L[H];return v}createResolver(l,r,u=[""],p){const{resolver:v}=Ko(this._resolverCache,l,u);return at(r)?wi(v,r,void 0,p):v}}function Ko(s,l,r){let u=s.get(l);u||(u=new Map,s.set(l,u));const p=r.join();let v=u.get(p);return v||(v={resolver:Bo(l,r),subPrefixes:r.filter(I=>!I.toLowerCase().includes("hover"))},u.set(p,v)),v}const ip=s=>at(s)&&Object.getOwnPropertyNames(s).reduce((l,r)=>l||Ie(s[r]),!1),bl=["top","bottom","left","right","chartArea"];function gu(s,l){return"top"===s||"bottom"===s||-1===bl.indexOf(s)&&"x"===l}function Mh(s,l){return function(r,u){return r[s]===u[s]?r[l]-u[l]:r[s]-u[s]}}function Fu(s){const l=s.chart,r=l.options.animation;l.notifyPlugins("afterRender"),On(r&&r.onComplete,[s],l)}function Xc(s){const l=s.chart,r=l.options.animation;On(r&&r.onProgress,[s],l)}function Qa(s){return Gl()&&"string"==typeof s?s=document.getElementById(s):s&&s.length&&(s=s[0]),s&&s.canvas&&(s=s.canvas),s}const Ah={},Zd=s=>{const l=Qa(s);return Object.values(Ah).filter(r=>r.canvas===l).pop()};function mg(s,l,r){const u=Object.keys(s);for(const p of u){const v=+p;if(v>=l){const E=s[p];delete s[p],(r>0||v>l)&&(s[v+r]=E)}}}let el=(()=>{class s{static register(...r){kl.add(...r),ud()}static unregister(...r){kl.remove(...r),ud()}constructor(r,u){const p=this.config=new gg(u),v=Qa(r),E=Zd(v);if(E)throw new Error("Canvas is already in use. Chart with ID '"+E.id+"' must be destroyed before the canvas with ID '"+E.canvas.id+"' can be reused.");const I=p.createResolver(p.chartOptionScopes(),this.getContext());this.platform=new(p.platform||function No(s){return!Gl()||typeof OffscreenCanvas<"u"&&s instanceof OffscreenCanvas?O:xs}(v)),this.platform.updateConfig(p);const L=this.platform.acquireContext(v,I.aspectRatio),H=L&&L.canvas,Q=H&&H.height,pe=H&&H.width;this.id=gn(),this.ctx=L,this.canvas=H,this.width=pe,this.height=Q,this._options=I,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new yf,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function da(s,l){let r;return function(...u){return l?(clearTimeout(r),r=setTimeout(s,l,u)):s.apply(this,u),l}}(Me=>this.update(Me),I.resizeDelay||0),this._dataChanges=[],Ah[this.id]=this,L&&H?(_s.listen(this,"complete",Fu),_s.listen(this,"progress",Xc),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:r,maintainAspectRatio:u},width:p,height:v,_aspectRatio:E}=this;return Yt(r)?u&&E?E:v?p/v:null:r}get data(){return this.config.data}set data(r){this.config.data=r}get options(){return this._options}set options(r){this.config.options=r}get registry(){return kl}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Bc(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Ni(this.canvas,this.ctx),this}stop(){return _s.stop(this),this}resize(r,u){_s.running(this)?this._resizeBeforeDraw={width:r,height:u}:this._resize(r,u)}_resize(r,u){const p=this.options,I=this.platform.getMaximumSize(this.canvas,r,u,p.maintainAspectRatio&&this.aspectRatio),L=p.devicePixelRatio||this.platform.getDevicePixelRatio(),H=this.width?"resize":"attach";this.width=I.width,this.height=I.height,this._aspectRatio=this.aspectRatio,Bc(this,L,!0)&&(this.notifyPlugins("resize",{size:I}),On(p.onResize,[this,I],this),this.attached&&this._doResize(H)&&this.render())}ensureScalesHaveIDs(){Qt(this.options.scales||{},(p,v)=>{p.id=v})}buildOrUpdateScales(){const r=this.options,u=r.scales,p=this.scales,v=Object.keys(p).reduce((I,L)=>(I[L]=!1,I),{});let E=[];u&&(E=E.concat(Object.keys(u).map(I=>{const L=u[I],H=Ja(I,L),Q="r"===H,pe="x"===H;return{options:L,dposition:Q?"chartArea":pe?"bottom":"left",dtype:Q?"radialLinear":pe?"category":"linear"}}))),Qt(E,I=>{const L=I.options,H=L.id,Q=Ja(H,L),pe=Kn(L.type,I.dtype);(void 0===L.position||gu(L.position,Q)!==gu(I.dposition))&&(L.position=I.dposition),v[H]=!0;let Me=null;H in p&&p[H].type===pe?Me=p[H]:(Me=new(kl.getScale(pe))({id:H,type:pe,ctx:this.ctx,chart:this}),p[Me.id]=Me),Me.init(L,r)}),Qt(v,(I,L)=>{I||delete p[L]}),Qt(p,I=>{R.configure(this,I,I.options),R.addBox(this,I)})}_updateMetasets(){const r=this._metasets,u=this.data.datasets.length,p=r.length;if(r.sort((v,E)=>v.index-E.index),p>u){for(let v=u;v<p;++v)this._destroyDatasetMeta(v);r.splice(u,p-u)}this._sortedMetasets=r.slice(0).sort(Mh("order","index"))}_removeUnreferencedMetasets(){const{_metasets:r,data:{datasets:u}}=this;r.length>u.length&&delete this._stacks,r.forEach((p,v)=>{0===u.filter(E=>E===p._dataset).length&&this._destroyDatasetMeta(v)})}buildOrUpdateControllers(){const r=[],u=this.data.datasets;let p,v;for(this._removeUnreferencedMetasets(),p=0,v=u.length;p<v;p++){const E=u[p];let I=this.getDatasetMeta(p);const L=E.type||this.config.type;if(I.type&&I.type!==L&&(this._destroyDatasetMeta(p),I=this.getDatasetMeta(p)),I.type=L,I.indexAxis=E.indexAxis||Fl(L,this.options),I.order=E.order||0,I.index=p,I.label=""+E.label,I.visible=this.isDatasetVisible(p),I.controller)I.controller.updateIndex(p),I.controller.linkScales();else{const H=kl.getController(L),{datasetElementType:Q,dataElementType:pe}=$i.datasets[L];Object.assign(H,{dataElementType:kl.getElement(pe),datasetElementType:Q&&kl.getElement(Q)}),I.controller=new H(this,p),r.push(I.controller)}}return this._updateMetasets(),r}_resetElements(){Qt(this.data.datasets,(r,u)=>{this.getDatasetMeta(u).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(r){const u=this.config;u.update();const p=this._options=u.createResolver(u.chartOptionScopes(),this.getContext()),v=this._animationsDisabled=!p.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:r,cancelable:!0}))return;const E=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let I=0;for(let Q=0,pe=this.data.datasets.length;Q<pe;Q++){const{controller:Me}=this.getDatasetMeta(Q),Re=!v&&-1===E.indexOf(Me);Me.buildOrUpdateElements(Re),I=Math.max(+Me.getMaxOverflow(),I)}I=this._minPadding=p.layout.autoPadding?I:0,this._updateLayout(I),v||Qt(E,Q=>{Q.reset()}),this._updateDatasets(r),this.notifyPlugins("afterUpdate",{mode:r}),this._layers.sort(Mh("z","_idx"));const{_active:L,_lastEvent:H}=this;H?this._eventHandler(H,!0):L.length&&this._updateHoverStyles(L,L,!0),this.render()}_updateScales(){Qt(this.scales,r=>{R.removeBox(this,r)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const r=this.options,u=new Set(Object.keys(this._listeners)),p=new Set(r.events);(!Ve(u,p)||!!this._responsiveListeners!==r.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:r}=this,u=this._getUniformDataChanges()||[];for(const{method:p,start:v,count:E}of u)mg(r,v,"_removeElements"===p?-E:E)}_getUniformDataChanges(){const r=this._dataChanges;if(!r||!r.length)return;this._dataChanges=[];const u=this.data.datasets.length,p=E=>new Set(r.filter(I=>I[0]===E).map((I,L)=>L+","+I.splice(1).join(","))),v=p(0);for(let E=1;E<u;E++)if(!Ve(v,p(E)))return;return Array.from(v).map(E=>E.split(",")).map(E=>({method:E[1],start:+E[2],count:+E[3]}))}_updateLayout(r){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;R.update(this,this.width,this.height,r);const u=this.chartArea,p=u.width<=0||u.height<=0;this._layers=[],Qt(this.boxes,v=>{p&&"chartArea"===v.position||(v.configure&&v.configure(),this._layers.push(...v._layers()))},this),this._layers.forEach((v,E)=>{v._idx=E}),this.notifyPlugins("afterLayout")}_updateDatasets(r){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:r,cancelable:!0})){for(let u=0,p=this.data.datasets.length;u<p;++u)this.getDatasetMeta(u).controller.configure();for(let u=0,p=this.data.datasets.length;u<p;++u)this._updateDataset(u,Ie(r)?r({datasetIndex:u}):r);this.notifyPlugins("afterDatasetsUpdate",{mode:r})}}_updateDataset(r,u){const p=this.getDatasetMeta(r),v={meta:p,index:r,mode:u,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",v)&&(p.controller._update(u),v.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",v))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(_s.has(this)?this.attached&&!_s.running(this)&&_s.start(this):(this.draw(),Fu({chart:this})))}draw(){let r;if(this._resizeBeforeDraw){const{width:p,height:v}=this._resizeBeforeDraw;this._resize(p,v),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const u=this._layers;for(r=0;r<u.length&&u[r].z<=0;++r)u[r].draw(this.chartArea);for(this._drawDatasets();r<u.length;++r)u[r].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(r){const u=this._sortedMetasets,p=[];let v,E;for(v=0,E=u.length;v<E;++v){const I=u[v];(!r||I.visible)&&p.push(I)}return p}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const r=this.getSortedVisibleDatasetMetas();for(let u=r.length-1;u>=0;--u)this._drawDataset(r[u]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(r){const u=this.ctx,p=r._clip,v=!p.disabled,E=function Mo(s){const{xScale:l,yScale:r}=s;if(l&&r)return{left:l.left,right:l.right,top:r.top,bottom:r.bottom}}(r)||this.chartArea,I={meta:r,index:r.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",I)&&(v&&ps(u,{left:!1===p.left?0:E.left-p.left,right:!1===p.right?this.width:E.right+p.right,top:!1===p.top?0:E.top-p.top,bottom:!1===p.bottom?this.height:E.bottom+p.bottom}),r.controller.draw(),v&&yr(u),I.cancelable=!1,this.notifyPlugins("afterDatasetDraw",I))}isPointInArea(r){return As(r,this.chartArea,this._minPadding)}getElementsAtEventForMode(r,u,p,v){const E=Nl.modes[u];return"function"==typeof E?E(this,r,p,v):[]}getDatasetMeta(r){const u=this.data.datasets[r],p=this._metasets;let v=p.filter(E=>E&&E._dataset===u).pop();return v||(v={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:u&&u.order||0,index:r,_dataset:u,_parsed:[],_sorted:!1},p.push(v)),v}getContext(){return this.$context||(this.$context=ta(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(r){const u=this.data.datasets[r];if(!u)return!1;const p=this.getDatasetMeta(r);return"boolean"==typeof p.hidden?!p.hidden:!u.hidden}setDatasetVisibility(r,u){this.getDatasetMeta(r).hidden=!u}toggleDataVisibility(r){this._hiddenIndices[r]=!this._hiddenIndices[r]}getDataVisibility(r){return!this._hiddenIndices[r]}_updateVisibility(r,u,p){const v=p?"show":"hide",E=this.getDatasetMeta(r),I=E.controller._resolveAnimations(void 0,v);ye(u)?(E.data[u].hidden=!p,this.update()):(this.setDatasetVisibility(r,p),I.update(E,{visible:p}),this.update(L=>L.datasetIndex===r?v:void 0))}hide(r,u){this._updateVisibility(r,u,!1)}show(r,u){this._updateVisibility(r,u,!0)}_destroyDatasetMeta(r){const u=this._metasets[r];u&&u.controller&&u.controller._destroy(),delete this._metasets[r]}_stop(){let r,u;for(this.stop(),_s.remove(this),r=0,u=this.data.datasets.length;r<u;++r)this._destroyDatasetMeta(r)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:r,ctx:u}=this;this._stop(),this.config.clearCache(),r&&(this.unbindEvents(),Ni(r,u),this.platform.releaseContext(u),this.canvas=null,this.ctx=null),delete Ah[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...r){return this.canvas.toDataURL(...r)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const r=this._listeners,u=this.platform,p=(E,I)=>{u.addEventListener(this,E,I),r[E]=I},v=(E,I,L)=>{E.offsetX=I,E.offsetY=L,this._eventHandler(E)};Qt(this.options.events,E=>p(E,v))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const r=this._responsiveListeners,u=this.platform,p=(H,Q)=>{u.addEventListener(this,H,Q),r[H]=Q},v=(H,Q)=>{r[H]&&(u.removeEventListener(this,H,Q),delete r[H])},E=(H,Q)=>{this.canvas&&this.resize(H,Q)};let I;const L=()=>{v("attach",L),this.attached=!0,this.resize(),p("resize",E),p("detach",I)};I=()=>{this.attached=!1,v("resize",E),this._stop(),this._resize(0,0),p("attach",L)},u.isAttached(this.canvas)?L():I()}unbindEvents(){Qt(this._listeners,(r,u)=>{this.platform.removeEventListener(this,u,r)}),this._listeners={},Qt(this._responsiveListeners,(r,u)=>{this.platform.removeEventListener(this,u,r)}),this._responsiveListeners=void 0}updateHoverStyle(r,u,p){const v=p?"set":"remove";let E,I,L,H;for("dataset"===u&&(E=this.getDatasetMeta(r[0].datasetIndex),E.controller["_"+v+"DatasetHoverStyle"]()),L=0,H=r.length;L<H;++L){I=r[L];const Q=I&&this.getDatasetMeta(I.datasetIndex).controller;Q&&Q[v+"HoverStyle"](I.element,I.datasetIndex,I.index)}}getActiveElements(){return this._active||[]}setActiveElements(r){const u=this._active||[],p=r.map(({datasetIndex:E,index:I})=>{const L=this.getDatasetMeta(E);if(!L)throw new Error("No dataset found at index "+E);return{datasetIndex:E,element:L.data[I],index:I}});!mr(p,u)&&(this._active=p,this._lastEvent=null,this._updateHoverStyles(p,u))}notifyPlugins(r,u,p){return this._plugins.notify(this,r,u,p)}isPluginEnabled(r){return 1===this._plugins._cache.filter(u=>u.plugin.id===r).length}_updateHoverStyles(r,u,p){const v=this.options.hover,E=(H,Q)=>H.filter(pe=>!Q.some(Me=>pe.datasetIndex===Me.datasetIndex&&pe.index===Me.index)),I=E(u,r),L=p?r:E(r,u);I.length&&this.updateHoverStyle(I,v.mode,!1),L.length&&v.mode&&this.updateHoverStyle(L,v.mode,!0)}_eventHandler(r,u){const p={event:r,replay:u,cancelable:!0,inChartArea:this.isPointInArea(r)},v=I=>(I.options.events||this.options.events).includes(r.native.type);if(!1===this.notifyPlugins("beforeEvent",p,v))return;const E=this._handleEvent(r,u,p.inChartArea);return p.cancelable=!1,this.notifyPlugins("afterEvent",p,v),(E||p.changed)&&this.render(),this}_handleEvent(r,u,p){const{_active:v=[],options:E}=this,L=this._getActiveElements(r,v,p,u),H=function $e(s){return"mouseup"===s.type||"click"===s.type||"contextmenu"===s.type}(r),Q=function Go(s,l,r,u){return r&&"mouseout"!==s.type?u?l:s:null}(r,this._lastEvent,p,H);p&&(this._lastEvent=null,On(E.onHover,[r,L,this],this),H&&On(E.onClick,[r,L,this],this));const pe=!mr(L,v);return(pe||u)&&(this._active=L,this._updateHoverStyles(L,v,u)),this._lastEvent=Q,pe}_getActiveElements(r,u,p,v){if("mouseout"===r.type)return[];if(!p)return u;const E=this.options.hover;return this.getElementsAtEventForMode(r,E.mode,E,v)}}return Ze(s,"defaults",$i),Ze(s,"instances",Ah),Ze(s,"overrides",rr),Ze(s,"registry",kl),Ze(s,"version","4.3.0"),Ze(s,"getChart",Zd),s})();function ud(){return Qt(el.instances,s=>s._plugins.invalidate())}function Jc(s,l,r,u){return{x:r+s*Math.cos(l),y:u+s*Math.sin(l)}}function Ih(s,l,r,u,p,v){const{x:E,y:I,startAngle:L,pixelMargin:H,innerRadius:Q}=l,pe=Math.max(l.outerRadius+u+r-H,0),Me=Q>0?Q+u+r+H:0;let Re=0;const qe=p-L;if(u){const Js=((Q>0?Q-u:0)+(pe>0?pe-u:0))/2;Re=(qe-(0!==Js?qe*Js/(Js+u):qe))/2}const rt=(qe-Math.max(.001,qe*pe-r/we)/pe)/2,jt=L+rt+Re,Ut=p-rt-Re,{outerStart:vn,outerEnd:Sn,innerStart:fn,innerEnd:En}=function hd(s,l,r,u){const p=function mu(s){return pa(s,["outerStart","outerEnd","innerStart","innerEnd"])}(s.options.borderRadius),v=(r-l)/2,E=Math.min(v,u*l/2),I=L=>{const H=(r-Math.min(v,L))*u/2;return Ki(L,0,Math.min(v,H))};return{outerStart:I(p.outerStart),outerEnd:I(p.outerEnd),innerStart:Ki(p.innerStart,0,E),innerEnd:Ki(p.innerEnd,0,E)}}(l,Me,pe,Ut-jt),fi=pe-vn,Yn=pe-Sn,Ti=jt+vn/fi,Mr=Ut-Sn/Yn,Sr=Me+fn,jr=Me+En,Ea=jt+fn/Sr,uc=Ut-En/jr;if(s.beginPath(),v){const Io=(Ti+Mr)/2;if(s.arc(E,I,pe,Ti,Io),s.arc(E,I,pe,Io,Mr),Sn>0){const cl=Jc(Yn,Mr,E,I);s.arc(cl.x,cl.y,Sn,Mr,Ut+Xe)}const cs=Jc(jr,Ut,E,I);if(s.lineTo(cs.x,cs.y),En>0){const cl=Jc(jr,uc,E,I);s.arc(cl.x,cl.y,En,Ut+Xe,uc+Math.PI)}const Js=(Ut-En/Me+(jt+fn/Me))/2;if(s.arc(E,I,Me,Ut-En/Me,Js,!0),s.arc(E,I,Me,Js,jt+fn/Me,!0),fn>0){const cl=Jc(Sr,Ea,E,I);s.arc(cl.x,cl.y,fn,Ea+Math.PI,jt-Xe)}const lu=Jc(fi,jt,E,I);if(s.lineTo(lu.x,lu.y),vn>0){const cl=Jc(fi,Ti,E,I);s.arc(cl.x,cl.y,vn,jt-Xe,Ti)}}else{s.moveTo(E,I);const Io=Math.cos(Ti)*pe+E,cs=Math.sin(Ti)*pe+I;s.lineTo(Io,cs);const Js=Math.cos(Mr)*pe+E,lu=Math.sin(Mr)*pe+I;s.lineTo(Js,lu)}s.closePath()}class bc extends ar{constructor(l){super(),Ze(this,"circumference",void 0),Ze(this,"endAngle",void 0),Ze(this,"fullCircles",void 0),Ze(this,"innerRadius",void 0),Ze(this,"outerRadius",void 0),Ze(this,"pixelMargin",void 0),Ze(this,"startAngle",void 0),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,l&&Object.assign(this,l)}inRange(l,r,u){const p=this.getProps(["x","y"],u),{angle:v,distance:E}=Zi(p,{x:l,y:r}),{startAngle:I,endAngle:L,innerRadius:H,outerRadius:Q,circumference:pe}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],u),Me=(this.options.spacing+this.options.borderWidth)/2,qe=Kn(pe,L-I)>=me||Pr(v,I,L),Qe=Hr(E,H+Me,Q+Me);return qe&&Qe}getCenterPoint(l){const{x:r,y:u,startAngle:p,endAngle:v,innerRadius:E,outerRadius:I}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],l),{offset:L,spacing:H}=this.options,Q=(p+v)/2,pe=(E+I+H+L)/2;return{x:r+Math.cos(Q)*pe,y:u+Math.sin(Q)*pe}}tooltipPosition(l){return this.getCenterPoint(l)}draw(l){const{options:r,circumference:u}=this,p=(r.offset||0)/4,v=(r.spacing||0)/2,E=r.circular;if(this.pixelMargin="inner"===r.borderAlign?.33:0,this.fullCircles=u>me?Math.floor(u/me):0,0===u||this.innerRadius<0||this.outerRadius<0)return;l.save();const I=(this.startAngle+this.endAngle)/2;l.translate(Math.cos(I)*p,Math.sin(I)*p);const H=p*(1-Math.sin(Math.min(we,u||0)));l.fillStyle=r.backgroundColor,l.strokeStyle=r.borderColor,function fd(s,l,r,u,p){const{fullCircles:v,startAngle:E,circumference:I}=l;let L=l.endAngle;if(v){Ih(s,l,r,u,L,p);for(let H=0;H<v;++H)s.fill();isNaN(I)||(L=E+(I%me||me))}Ih(s,l,r,u,L,p),s.fill()}(l,this,H,v,E),function Yd(s,l,r,u,p){const{fullCircles:v,startAngle:E,circumference:I,options:L}=l,{borderWidth:H,borderJoinStyle:Q,borderDash:pe,borderDashOffset:Me}=L,Re="inner"===L.borderAlign;if(!H)return;s.setLineDash(pe||[]),s.lineDashOffset=Me,Re?(s.lineWidth=2*H,s.lineJoin=Q||"round"):(s.lineWidth=H,s.lineJoin=Q||"bevel");let qe=l.endAngle;if(v){Ih(s,l,r,u,qe,p);for(let Qe=0;Qe<v;++Qe)s.stroke();isNaN(I)||(qe=E+(I%me||me))}Re&&function dd(s,l,r){const{startAngle:u,pixelMargin:p,x:v,y:E,outerRadius:I,innerRadius:L}=l;let H=p/I;s.beginPath(),s.arc(v,E,I,u-H,r+H),L>p?(H=p/L,s.arc(v,E,L,r+H,u-H,!0)):s.arc(v,E,p,r+Xe,u-Xe),s.closePath(),s.clip()}(s,l,qe),v||(Ih(s,l,r,u,qe,p),s.stroke())}(l,this,H,v,E),l.restore()}}function pd(s,l,r=l){s.lineCap=Kn(r.borderCapStyle,l.borderCapStyle),s.setLineDash(Kn(r.borderDash,l.borderDash)),s.lineDashOffset=Kn(r.borderDashOffset,l.borderDashOffset),s.lineJoin=Kn(r.borderJoinStyle,l.borderJoinStyle),s.lineWidth=Kn(r.borderWidth,l.borderWidth),s.strokeStyle=Kn(r.borderColor,l.borderColor)}function op(s,l,r){s.lineTo(r.x,r.y)}function bf(s,l,r={}){const u=s.length,{start:p=0,end:v=u-1}=r,{start:E,end:I}=l,L=Math.max(p,E),H=Math.min(v,I);return{count:u,start:L,loop:l.loop,ilen:H<L&&!(p<E&&v<E||p>I&&v>I)?u+H-L:H-L}}function ja(s,l,r,u){const{points:p,options:v}=l,{count:E,start:I,loop:L,ilen:H}=bf(p,r,u),Q=function Lu(s){return s.stepped?ha:s.tension||"monotone"===s.cubicInterpolationMode?fa:op}(v);let Re,qe,Qe,{move:pe=!0,reverse:Me}=u||{};for(Re=0;Re<=H;++Re)qe=p[(I+(Me?H-Re:Re))%E],!qe.skip&&(pe?(s.moveTo(qe.x,qe.y),pe=!1):Q(s,Qe,qe,Me,v.stepped),Qe=qe);return L&&(qe=p[(I+(Me?H:0))%E],Q(s,Qe,qe,Me,v.stepped)),!!L}function _u(s,l,r,u){const p=l.points,{count:v,start:E,ilen:I}=bf(p,r,u),{move:L=!0,reverse:H}=u||{};let Me,Re,qe,Qe,rt,jt,Q=0,pe=0;const Ut=Sn=>(E+(H?I-Sn:Sn))%v,vn=()=>{Qe!==rt&&(s.lineTo(Q,rt),s.lineTo(Q,Qe),s.lineTo(Q,jt))};for(L&&(Re=p[Ut(0)],s.moveTo(Re.x,Re.y)),Me=0;Me<=I;++Me){if(Re=p[Ut(Me)],Re.skip)continue;const Sn=Re.x,fn=Re.y,En=0|Sn;En===qe?(fn<Qe?Qe=fn:fn>rt&&(rt=fn),Q=(pe*Q+Sn)/++pe):(vn(),s.lineTo(Sn,fn),qe=En,pe=0,Qe=rt=fn),jt=fn}vn()}function to(s){const l=s.options;return s._decimated||s._loop||l.tension||"monotone"===l.cubicInterpolationMode||l.stepped||l.borderDash&&l.borderDash.length?ja:_u}Ze(bc,"id","arc"),Ze(bc,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),Ze(bc,"defaultRoutes",{backgroundColor:"backgroundColor"}),Ze(bc,"descriptors",{_scriptable:!0,_indexable:s=>"borderDash"!==s});const Jl="function"==typeof Path2D;let wc=(()=>{class s extends ar{constructor(r){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,r&&Object.assign(this,r)}updateControlPoints(r,u){const p=this.options;!p.tension&&"monotone"!==p.cubicInterpolationMode||p.stepped||this._pointsUpdated||(Tl(this._points,p,r,p.spanGaps?this._loop:this._fullLoop,u),this._pointsUpdated=!0)}set points(r){this._points=r,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function uu(s,l){const r=s.points,u=s.options.spanGaps,p=r.length;if(!p)return[];const v=!!s._loop,{start:E,end:I}=function rd(s,l,r,u){let p=0,v=l-1;if(r&&!u)for(;p<l&&!s[p].skip;)p++;for(;p<l&&s[p].skip;)p++;for(p%=l,r&&(v+=p);v>p&&s[v%l].skip;)v--;return v%=l,{start:p,end:v}}(r,p,v,u);return function Il(s,l,r,u){return u&&u.setContext&&r?function _c(s,l,r,u){const p=s._chart.getContext(),v=ra(s.options),{_datasetIndex:E,options:{spanGaps:I}}=s,L=r.length,H=[];let Q=v,pe=l[0].start,Me=pe;function Re(qe,Qe,rt,jt){const Ut=I?-1:1;if(qe!==Qe){for(qe+=L;r[qe%L].skip;)qe-=Ut;for(;r[Qe%L].skip;)Qe+=Ut;qe%L!=Qe%L&&(H.push({start:qe%L,end:Qe%L,loop:rt,style:jt}),Q=jt,pe=Qe%L)}}for(const qe of l){pe=I?pe:qe.start;let rt,Qe=r[pe%L];for(Me=pe+1;Me<=qe.end;Me++){const jt=r[Me%L];rt=ra(u.setContext(ta(p,{type:"segment",p0:Qe,p1:jt,p0DataIndex:(Me-1)%L,p1DataIndex:Me%L,datasetIndex:E}))),Xn(rt,Q)&&Re(pe,Me-1,qe.loop,Q),Qe=jt,Q=rt}pe<Me-1&&Re(pe,Me-1,qe.loop,Q)}return H}(s,l,r,u):l}(s,!0===u?[{start:E,end:I,loop:v}]:function Yl(s,l,r,u){const p=s.length,v=[];let L,E=l,I=s[l];for(L=l+1;L<=r;++L){const H=s[L%p];H.skip||H.stop?I.skip||(v.push({start:l%p,end:(L-1)%p,loop:u=!1}),l=E=H.stop?L:null):(E=L,I.skip&&(l=L)),I=H}return null!==E&&v.push({start:l%p,end:E%p,loop:u}),v}(r,E,I<E?I+p:I,!!s._fullLoop&&0===E&&I===p-1),r,l)}(this,this.options.segment))}first(){const r=this.segments;return r.length&&this.points[r[0].start]}last(){const r=this.segments,p=r.length;return p&&this.points[r[p-1].end]}interpolate(r,u){const p=this.options,v=r[u],E=this.points,I=Fa(this,{property:u,start:v,end:v});if(!I.length)return;const L=[],H=function xc(s){return s.stepped?ka:s.tension||"monotone"===s.cubicInterpolationMode?cu:is}(p);let Q,pe;for(Q=0,pe=I.length;Q<pe;++Q){const{start:Me,end:Re}=I[Q],qe=E[Me],Qe=E[Re];if(qe===Qe){L.push(qe);continue}const jt=H(qe,Qe,Math.abs((v-qe[u])/(Qe[u]-qe[u])),p.stepped);jt[u]=r[u],L.push(jt)}return 1===L.length?L[0]:L}pathSegment(r,u,p){return to(this)(r,this,u,p)}path(r,u,p){const v=this.segments,E=to(this);let I=this._loop;u=u||0,p=p||this.points.length-u;for(const L of v)I&=E(r,this,L,{start:u,end:u+p-1});return!!I}draw(r,u,p,v){(this.points||[]).length&&(this.options||{}).borderWidth&&(r.save(),function zu(s,l,r,u){Jl&&!l.options.segment?function Bu(s,l,r,u){let p=l._path;p||(p=l._path=new Path2D,l.path(p,r,u)&&p.closePath()),pd(s,l.options),s.stroke(p)}(s,l,r,u):function Qc(s,l,r,u){const{segments:p,options:v}=l,E=to(l);for(const I of p)pd(s,v,I.style),s.beginPath(),E(s,l,I,{start:r,end:r+u-1})&&s.closePath(),s.stroke()}(s,l,r,u)}(r,this,p,v),r.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}return Ze(s,"id","line"),Ze(s,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Ze(s,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Ze(s,"descriptors",{_scriptable:!0,_indexable:l=>"borderDash"!==l&&"fill"!==l}),s})();function Vu(s,l,r,u){const p=s.options,{[r]:v}=s.getProps([r],u);return Math.abs(l-v)<p.radius+p.hitRadius}let gd=(()=>{class s extends ar{constructor(r){super(),Ze(this,"parsed",void 0),Ze(this,"skip",void 0),Ze(this,"stop",void 0),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,r&&Object.assign(this,r)}inRange(r,u,p){const v=this.options,{x:E,y:I}=this.getProps(["x","y"],p);return Math.pow(r-E,2)+Math.pow(u-I,2)<Math.pow(v.hitRadius+v.radius,2)}inXRange(r,u){return Vu(this,r,"x",u)}inYRange(r,u){return Vu(this,r,"y",u)}getCenterPoint(r){const{x:u,y:p}=this.getProps(["x","y"],r);return{x:u,y:p}}size(r){let u=(r=r||this.options||{}).radius||0;return u=Math.max(u,u&&r.hoverRadius||0),2*(u+(u&&r.borderWidth||0))}draw(r,u){const p=this.options;this.skip||p.radius<.1||!As(this,u,this.size(p)/2)||(r.strokeStyle=p.borderColor,r.lineWidth=p.borderWidth,r.fillStyle=p.backgroundColor,Ei(r,p,this.x,this.y))}getRange(){const r=this.options||{};return r.radius+r.hitRadius}}return Ze(s,"id","point"),Ze(s,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Ze(s,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),s})();function xf(s,l){const{x:r,y:u,base:p,width:v,height:E}=s.getProps(["x","y","base","width","height"],l);let I,L,H,Q,pe;return s.horizontal?(pe=E/2,I=Math.min(r,p),L=Math.max(r,p),H=u-pe,Q=u+pe):(pe=v/2,I=r-pe,L=r+pe,H=Math.min(u,p),Q=Math.max(u,p)),{left:I,top:H,right:L,bottom:Q}}function Ql(s,l,r,u){return s?0:Ki(l,r,u)}function Uu(s,l,r,u){const p=null===l,v=null===r,I=s&&!(p&&v)&&xf(s,u);return I&&(p||Hr(l,I.left,I.right))&&(v||Hr(r,I.top,I.bottom))}function md(s,l){s.rect(l.x,l.y,l.w,l.h)}function Oh(s,l,r={}){const u=s.x!==r.x?-l:0,p=s.y!==r.y?-l:0;return{x:s.x+u,y:s.y+p,w:s.w+((s.x+s.w!==r.x+r.w?l:0)-u),h:s.h+((s.y+s.h!==r.y+r.h?l:0)-p),radius:s.radius}}class ju extends ar{constructor(l){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,l&&Object.assign(this,l)}draw(l){const{inflateAmount:r,options:{borderColor:u,backgroundColor:p}}=this,{inner:v,outer:E}=function ap(s){const l=xf(s),r=l.right-l.left,u=l.bottom-l.top,p=function sp(s,l,r){const p=s.borderSkipped,v=Dl(s.options.borderWidth);return{t:Ql(p.top,v.top,0,r),r:Ql(p.right,v.right,0,l),b:Ql(p.bottom,v.bottom,0,r),l:Ql(p.left,v.left,0,l)}}(s,r/2,u/2),v=function _g(s,l,r){const{enableBorderRadius:u}=s.getProps(["enableBorderRadius"]),p=s.options.borderRadius,v=uo(p),E=Math.min(l,r),I=s.borderSkipped,L=u||at(p);return{topLeft:Ql(!L||I.top||I.left,v.topLeft,0,E),topRight:Ql(!L||I.top||I.right,v.topRight,0,E),bottomLeft:Ql(!L||I.bottom||I.left,v.bottomLeft,0,E),bottomRight:Ql(!L||I.bottom||I.right,v.bottomRight,0,E)}}(s,r/2,u/2);return{outer:{x:l.left,y:l.top,w:r,h:u,radius:v},inner:{x:l.left+p.l,y:l.top+p.t,w:r-p.l-p.r,h:u-p.t-p.b,radius:{topLeft:Math.max(0,v.topLeft-Math.max(p.t,p.l)),topRight:Math.max(0,v.topRight-Math.max(p.t,p.r)),bottomLeft:Math.max(0,v.bottomLeft-Math.max(p.b,p.l)),bottomRight:Math.max(0,v.bottomRight-Math.max(p.b,p.r))}}}}(this),I=function Lp(s){return s.topLeft||s.topRight||s.bottomLeft||s.bottomRight}(E.radius)?co:md;l.save(),(E.w!==v.w||E.h!==v.h)&&(l.beginPath(),I(l,Oh(E,r,v)),l.clip(),I(l,Oh(v,-r,E)),l.fillStyle=u,l.fill("evenodd")),l.beginPath(),I(l,Oh(v,r)),l.fillStyle=p,l.fill(),l.restore()}inRange(l,r,u){return Uu(this,l,r,u)}inXRange(l,r){return Uu(this,l,null,r)}inYRange(l,r){return Uu(this,null,l,r)}getCenterPoint(l){const{x:r,y:u,base:p,horizontal:v}=this.getProps(["x","y","base","horizontal"],l);return{x:v?(r+p)/2:r,y:v?u:(u+p)/2}}getRange(l){return"x"===l?this.width/2:this.height/2}}Ze(ju,"id","bar"),Ze(ju,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Ze(ju,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});var Ph=Object.freeze({__proto__:null,ArcElement:bc,BarElement:ju,LineElement:wc,PointElement:gd});const Nh=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],Rh=Nh.map(s=>s.replace("rgb(","rgba(").replace(")",", 0.5)"));function kh(s){return Nh[s%Nh.length]}function wf(s){return Rh[s%Rh.length]}function Kd(s){let l;for(l in s)if(s[l].borderColor||s[l].backgroundColor)return!0;return!1}var Jd={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(s,l,r){if(!r.enabled)return;const{data:{datasets:u},options:p}=s.config,{elements:v}=p;if(!r.forceOverride&&(Kd(u)||function Xd(s){return s&&(s.borderColor||s.backgroundColor)}(p)||v&&Kd(v)))return;const E=function ec(s){let l=0;return(r,u)=>{const p=s.getDatasetMeta(u).controller;p instanceof vs?l=function qd(s,l){return s.backgroundColor=s.data.map(()=>kh(l++)),l}(r,l):p instanceof jc?l=function lp(s,l){return s.backgroundColor=s.data.map(()=>wf(l++)),l}(r,l):p&&(l=function Bp(s,l){return s.borderColor=kh(l),s.backgroundColor=wf(l),++l}(r,l))}}(s);u.forEach(E)}};function zp(s){if(s._decimated){const l=s._data;delete s._decimated,delete s._data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,writable:!0,value:l})}}function Fh(s){s.data.datasets.forEach(l=>{zp(l)})}var Lh={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(s,l,r)=>{if(!r.enabled)return void Fh(s);const u=s.width;s.data.datasets.forEach((p,v)=>{const{_data:E,indexAxis:I}=p,L=s.getDatasetMeta(v),H=E||p.data;if("y"===or([I,s.options.indexAxis])||!L.controller.supportsDecimation)return;const Q=s.scales[L.xAxisID];if("linear"!==Q.type&&"time"!==Q.type||s.options.parsing)return;let qe,{start:pe,count:Me}=function yu(s,l){const r=l.length;let p,u=0;const{iScale:v}=s,{min:E,max:I,minDefined:L,maxDefined:H}=v.getUserBounds();return L&&(u=Ki(hi(l,v.axis,E).lo,0,r-1)),p=H?Ki(hi(l,v.axis,I).hi+1,u,r)-u:r-u,{start:u,count:p}}(L,H);if(Me<=(r.threshold||4*u))zp(p);else{switch(Yt(E)&&(p._data=H,delete p.data,Object.defineProperty(p,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(Qe){this._data=Qe}})),r.algorithm){case"lttb":qe=function cp(s,l,r,u,p){const v=p.samples||u;if(v>=r)return s.slice(l,l+r);const E=[],I=(r-2)/(v-2);let L=0;const H=l+r-1;let pe,Me,Re,qe,Qe,Q=l;for(E[L++]=s[Q],pe=0;pe<v-2;pe++){let Ut,rt=0,jt=0;const vn=Math.floor((pe+1)*I)+1+l,Sn=Math.min(Math.floor((pe+2)*I)+1,r)+l,fn=Sn-vn;for(Ut=vn;Ut<Sn;Ut++)rt+=s[Ut].x,jt+=s[Ut].y;rt/=fn,jt/=fn;const En=Math.floor(pe*I)+1+l,fi=Math.min(Math.floor((pe+1)*I)+1,r)+l,{x:Yn,y:Ti}=s[Q];for(Re=qe=-1,Ut=En;Ut<fi;Ut++)qe=.5*Math.abs((Yn-rt)*(s[Ut].y-Ti)-(Yn-s[Ut].x)*(jt-Ti)),qe>Re&&(Re=qe,Me=s[Ut],Qe=Ut);E[L++]=Me,Q=Qe}return E[L++]=s[H],E}(H,pe,Me,u,r);break;case"min-max":qe=function Hu(s,l,r,u){let E,I,L,H,Q,pe,Me,Re,qe,Qe,p=0,v=0;const rt=[],Ut=s[l].x,Sn=s[l+r-1].x-Ut;for(E=l;E<l+r;++E){I=s[E],L=(I.x-Ut)/Sn*u,H=I.y;const fn=0|L;if(fn===Q)H<qe?(qe=H,pe=E):H>Qe&&(Qe=H,Me=E),p=(v*p+I.x)/++v;else{const En=E-1;if(!Yt(pe)&&!Yt(Me)){const fi=Math.min(pe,Me),Yn=Math.max(pe,Me);fi!==Re&&fi!==En&&rt.push({...s[fi],x:p}),Yn!==Re&&Yn!==En&&rt.push({...s[Yn],x:p})}E>0&&En!==Re&&rt.push(s[En]),rt.push(I),Q=fn,v=0,qe=Qe=H,pe=Me=Re=E}}return rt}(H,pe,Me,u);break;default:throw new Error(`Unsupported decimation algorithm '${r.algorithm}'`)}p._decimated=qe}})},destroy(s){Fh(s)}};function Qd(s,l,r,u){if(u)return;let p=l[s],v=r[s];return"angle"===s&&(p=ji(p),v=ji(v)),{property:s,start:p,end:v}}function nc(s,l,r){for(;l>s;l--){const u=r[l];if(!isNaN(u.x)&&!isNaN(u.y))break}return l}function vu(s,l,r,u){return s&&l?u(s[r],l[r]):s?s[r]:l?l[r]:0}function _d(s,l){let r=[],u=!1;return jn(s)?(u=!0,r=s):r=function tc(s,l){const{x:r=null,y:u=null}=s||{},p=l.points,v=[];return l.segments.forEach(({start:E,end:I})=>{I=nc(E,I,p);const L=p[E],H=p[I];null!==u?(v.push({x:L.x,y:u}),v.push({x:H.x,y:u})):null!==r&&(v.push({x:r,y:L.y}),v.push({x:r,y:H.y}))}),v}(s,l),r.length?new wc({points:r,options:{tension:0},_loop:u,_fullLoop:u}):null}function yd(s){return s&&!1!==s.fill}function vd(s,l,r){let p=s[l].fill;const v=[l];let E;if(!r)return p;for(;!1!==p&&-1===v.indexOf(p);){if(!qt(p))return p;if(E=s[p],!E)return!1;if(E.visible)return p;v.push(p),p=E.fill}return!1}function xl(s,l,r){const u=function Bh(s){const l=s.options,r=l.fill;let u=Kn(r&&r.target,r);return void 0===u&&(u=!!l.backgroundColor),!1!==u&&null!==u&&(!0===u?"origin":u)}(s);if(at(u))return!isNaN(u.value)&&u;let p=parseFloat(u);return qt(p)&&Math.floor(p)===p?function up(s,l,r,u){return("-"===s||"+"===s)&&(r=l+r),!(r===l||r<0||r>=u)&&r}(u[0],l,p,r):["origin","start","end","stack","shape"].indexOf(u)>=0&&u}function Gu(s,l,r){const u=[];for(let p=0;p<r.length;p++){const v=r[p],{first:E,last:I,point:L}=eh(v,l,"x");if(!(!L||E&&I))if(E)u.unshift(L);else if(s.push(L),!I)break}s.push(...u)}function eh(s,l,r){const u=s.interpolate(l,r);if(!u)return{};const p=u[r],v=s.segments,E=s.points;let I=!1,L=!1;for(let H=0;H<v.length;H++){const Q=v[H],pe=E[Q.start][r],Me=E[Q.end][r];if(Hr(p,pe,Me)){I=p===pe,L=p===Me;break}}return{first:I,last:L,point:u}}class Vh{constructor(l){this.x=l.x,this.y=l.y,this.radius=l.radius}pathSegment(l,r,u){const{x:p,y:v,radius:E}=this;return l.arc(p,v,E,(r=r||{start:0,end:me}).end,r.start,!0),!u.bounds}interpolate(l){const{x:r,y:u,radius:p}=this,v=l.angle;return{x:r+Math.cos(v)*p,y:u+Math.sin(v)*p,angle:v}}}function th(s,l,r){const u=function Ef(s){const{chart:l,fill:r,line:u}=s;if(qt(r))return function Uh(s,l){const r=s.getDatasetMeta(l);return r&&s.isDatasetVisible(l)?r.dataset:null}(l,r);if("stack"===r)return function zh(s){const{scale:l,index:r,line:u}=s,p=[],v=u.segments,E=u.points,I=function bd(s,l){const r=[],u=s.getMatchingVisibleMetas("line");for(let p=0;p<u.length;p++){const v=u[p];if(v.index===l)break;v.hidden||r.unshift(v.dataset)}return r}(l,r);I.push(_d({x:null,y:l.bottom},u));for(let L=0;L<v.length;L++){const H=v[L];for(let Q=H.start;Q<=H.end;Q++)Gu(p,E[Q],I)}return new wc({points:p,options:{}})}(s);if("shape"===r)return!0;const p=function va(s){return(s.scale||{}).getPointPositionForValue?function Tf(s){const{scale:l,fill:r}=s,u=l.options,p=l.getLabels().length,v=u.reverse?l.max:l.min,E=function Cf(s,l,r){let u;return u="start"===s?r:"end"===s?l.options.reverse?l.min:l.max:at(s)?s.value:l.getBaseValue(),u}(r,l,v),I=[];if(u.grid.circular){const L=l.getPointPositionForValue(0,v);return new Vh({x:L.x,y:L.y,radius:l.getDistanceFromCenterForValue(E)})}for(let L=0;L<p;++L)I.push(l.getPointPositionForValue(L,E));return I}(s):function Wu(s){const{scale:l={},fill:r}=s,u=function $u(s,l){let r=null;return"start"===s?r=l.bottom:"end"===s?r=l.top:at(s)?r=l.getPixelForValue(s.value):l.getBasePixel&&(r=l.getBasePixel()),r}(r,l);if(qt(u)){const p=l.isHorizontal();return{x:p?u:null,y:p?null:u}}return null}(s)}(s);return p instanceof Vh?p:_d(p,u)}(l),{line:p,scale:v,axis:E}=l,I=p.options,L=I.fill,H=I.backgroundColor,{above:Q=H,below:pe=H}=L||{};u&&p.points.length&&(ps(s,r),function Ds(s,l){const{line:r,target:u,above:p,below:v,area:E,scale:I}=l,L=r._loop?"angle":l.axis;s.save(),"x"===L&&v!==p&&(bu(s,u,E.top),nh(s,{line:r,target:u,color:p,scale:I,property:L}),s.restore(),s.save(),bu(s,u,E.bottom)),nh(s,{line:r,target:u,color:v,scale:I,property:L}),s.restore()}(s,{line:p,target:u,above:Q,below:pe,area:r,scale:v,axis:E}),yr(s))}function bu(s,l,r){const{segments:u,points:p}=l;let v=!0,E=!1;s.beginPath();for(const I of u){const{start:L,end:H}=I,Q=p[L],pe=p[nc(L,H,p)];v?(s.moveTo(Q.x,Q.y),v=!1):(s.lineTo(Q.x,r),s.lineTo(Q.x,Q.y)),E=!!l.pathSegment(s,I,{move:E}),E?s.closePath():s.lineTo(pe.x,r)}s.lineTo(l.first().x,r),s.closePath(),s.clip()}function nh(s,l){const{line:r,target:u,property:p,color:v,scale:E}=l,I=function Df(s,l,r){const u=s.segments,p=s.points,v=l.points,E=[];for(const I of u){let{start:L,end:H}=I;H=nc(L,H,p);const Q=Qd(r,p[L],p[H],I.loop);if(!l.segments){E.push({source:I,target:Q,start:p[L],end:p[H]});continue}const pe=Fa(l,Q);for(const Me of pe){const Re=Qd(r,v[Me.start],v[Me.end],Me.loop),qe=po(I,p,Re);for(const Qe of qe)E.push({source:Qe,target:Me,start:{[r]:vu(Q,Re,"start",Math.max)},end:{[r]:vu(Q,Re,"end",Math.min)}})}}return E}(r,u,p);for(const{source:L,target:H,start:Q,end:pe}of I){const{style:{backgroundColor:Me=v}={}}=L,Re=!0!==u;s.save(),s.fillStyle=Me,jh(s,E,Re&&Qd(p,Q,pe)),s.beginPath();const qe=!!r.pathSegment(s,L);let Qe;if(Re){qe?s.closePath():Hh(s,u,pe,p);const rt=!!u.pathSegment(s,H,{move:qe,reverse:!0});Qe=qe&&rt,Qe||Hh(s,u,Q,p)}s.closePath(),s.fill(Qe?"evenodd":"nonzero"),s.restore()}}function jh(s,l,r){const{top:u,bottom:p}=l.chart.chartArea,{property:v,start:E,end:I}=r||{};"x"===v&&(s.beginPath(),s.rect(E,u,I-E,p-u),s.clip())}function Hh(s,l,r,u){const p=l.interpolate(r,u);p&&s.lineTo(p.x,p.y)}var ih={id:"filler",afterDatasetsUpdate(s,l,r){const u=(s.data.datasets||[]).length,p=[];let v,E,I,L;for(E=0;E<u;++E)v=s.getDatasetMeta(E),I=v.dataset,L=null,I&&I.options&&I instanceof wc&&(L={visible:s.isDatasetVisible(E),index:E,fill:xl(I,E,u),chart:s,axis:v.controller.options.indexAxis,scale:v.vScale,line:I}),v.$filler=L,p.push(L);for(E=0;E<u;++E)L=p[E],L&&!1!==L.fill&&(L.fill=vd(p,E,r.propagate))},beforeDraw(s,l,r){const u="beforeDraw"===r.drawTime,p=s.getSortedVisibleDatasetMetas(),v=s.chartArea;for(let E=p.length-1;E>=0;--E){const I=p[E].$filler;I&&(I.line.updateControlPoints(v,I.axis),u&&I.fill&&th(s.ctx,I,v))}},beforeDatasetsDraw(s,l,r){if("beforeDatasetsDraw"!==r.drawTime)return;const u=s.getSortedVisibleDatasetMetas();for(let p=u.length-1;p>=0;--p){const v=u[p].$filler;yd(v)&&th(s.ctx,v,s.chartArea)}},beforeDatasetDraw(s,l,r){const u=l.meta.$filler;!yd(u)||"beforeDatasetDraw"!==r.drawTime||th(s.ctx,u,s.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const $h=(s,l)=>{let{boxHeight:r=l,boxWidth:u=l}=s;return s.usePointStyle&&(r=Math.min(r,l),u=s.pointStyleWidth||Math.min(u,l)),{boxWidth:u,boxHeight:r,itemHeight:Math.max(l,r)}};class xu extends ar{constructor(l){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=l.chart,this.options=l.options,this.ctx=l.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(l,r,u){this.maxWidth=l,this.maxHeight=r,this._margins=u,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const l=this.options.labels||{};let r=On(l.generateLabels,[this.chart],this)||[];l.filter&&(r=r.filter(u=>l.filter(u,this.chart.data))),l.sort&&(r=r.sort((u,p)=>l.sort(u,p,this.chart.data))),this.options.reverse&&r.reverse(),this.legendItems=r}fit(){const{options:l,ctx:r}=this;if(!l.display)return void(this.width=this.height=0);const u=l.labels,p=Er(u.font),v=p.size,E=this._computeTitleHeight(),{boxWidth:I,itemHeight:L}=$h(u,v);let H,Q;r.font=p.string,this.isHorizontal()?(H=this.maxWidth,Q=this._fitRows(E,v,I,L)+10):(Q=this.maxHeight,H=this._fitCols(E,p,I,L)+10),this.width=Math.min(H,l.maxWidth||this.maxWidth),this.height=Math.min(Q,l.maxHeight||this.maxHeight)}_fitRows(l,r,u,p){const{ctx:v,maxWidth:E,options:{labels:{padding:I}}}=this,L=this.legendHitBoxes=[],H=this.lineWidths=[0],Q=p+I;let pe=l;v.textAlign="left",v.textBaseline="middle";let Me=-1,Re=-Q;return this.legendItems.forEach((qe,Qe)=>{const rt=u+r/2+v.measureText(qe.text).width;(0===Qe||H[H.length-1]+rt+2*I>E)&&(pe+=Q,H[H.length-(Qe>0?0:1)]=0,Re+=Q,Me++),L[Qe]={left:0,top:Re,row:Me,width:rt,height:p},H[H.length-1]+=rt+I}),pe}_fitCols(l,r,u,p){const{ctx:v,maxHeight:E,options:{labels:{padding:I}}}=this,L=this.legendHitBoxes=[],H=this.columnSizes=[],Q=E-l;let pe=I,Me=0,Re=0,qe=0,Qe=0;return this.legendItems.forEach((rt,jt)=>{const{itemWidth:Ut,itemHeight:vn}=function Xo(s,l,r,u,p){const v=function dp(s,l,r,u){let p=s.text;return p&&"string"!=typeof p&&(p=p.reduce((v,E)=>v.length>E.length?v:E)),l+r.size/2+u.measureText(p).width}(u,s,l,r),E=function Wh(s,l,r){let u=s;return"string"!=typeof l.text&&(u=xd(l,r)),u}(p,u,l.lineHeight);return{itemWidth:v,itemHeight:E}}(u,r,v,rt,p);jt>0&&Re+vn+2*I>Q&&(pe+=Me+I,H.push({width:Me,height:Re}),qe+=Me+I,Qe++,Me=Re=0),L[jt]={left:qe,top:Re,col:Qe,width:Ut,height:vn},Me=Math.max(Me,Ut),Re+=vn+I}),pe+=Me,H.push({width:Me,height:Re}),pe}adjustHitBoxes(){if(!this.options.display)return;const l=this._computeTitleHeight(),{legendHitBoxes:r,options:{align:u,labels:{padding:p},rtl:v}}=this,E=gl(v,this.left,this.width);if(this.isHorizontal()){let I=0,L=io(u,this.left+p,this.right-this.lineWidths[I]);for(const H of r)I!==H.row&&(I=H.row,L=io(u,this.left+p,this.right-this.lineWidths[I])),H.top+=this.top+l+p,H.left=E.leftForLtr(E.x(L),H.width),L+=H.width+p}else{let I=0,L=io(u,this.top+l+p,this.bottom-this.columnSizes[I].height);for(const H of r)H.col!==I&&(I=H.col,L=io(u,this.top+l+p,this.bottom-this.columnSizes[I].height)),H.top=L,H.left+=this.left+p,H.left=E.leftForLtr(E.x(H.left),H.width),L+=H.height+p}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const l=this.ctx;ps(l,this),this._draw(),yr(l)}}_draw(){const{options:l,columnSizes:r,lineWidths:u,ctx:p}=this,{align:v,labels:E}=l,I=$i.color,L=gl(l.rtl,this.left,this.width),H=Er(E.font),{padding:Q}=E,pe=H.size,Me=pe/2;let Re;this.drawTitle(),p.textAlign=L.textAlign("left"),p.textBaseline="middle",p.lineWidth=.5,p.font=H.string;const{boxWidth:qe,boxHeight:Qe,itemHeight:rt}=$h(E,pe),vn=this.isHorizontal(),Sn=this._computeTitleHeight();Re=vn?{x:io(v,this.left+Q,this.right-u[0]),y:this.top+Q+Sn,line:0}:{x:this.left+Q,y:io(v,this.top+Sn+Q,this.bottom-r[0].height),line:0},ia(this.ctx,l.textDirection);const fn=rt+Q;this.legendItems.forEach((En,fi)=>{p.strokeStyle=En.fontColor,p.fillStyle=En.fontColor;const Yn=p.measureText(En.text).width,Ti=L.textAlign(En.textAlign||(En.textAlign=E.textAlign)),Mr=qe+Me+Yn;let Sr=Re.x,jr=Re.y;L.setWidth(this.width),vn?fi>0&&Sr+Mr+Q>this.right&&(jr=Re.y+=fn,Re.line++,Sr=Re.x=io(v,this.left+Q,this.right-u[Re.line])):fi>0&&jr+fn>this.bottom&&(Sr=Re.x=Sr+r[Re.line].width+Q,Re.line++,jr=Re.y=io(v,this.top+Sn+Q,this.bottom-r[Re.line].height)),function(En,fi,Yn){if(isNaN(qe)||qe<=0||isNaN(Qe)||Qe<0)return;p.save();const Ti=Kn(Yn.lineWidth,1);if(p.fillStyle=Kn(Yn.fillStyle,I),p.lineCap=Kn(Yn.lineCap,"butt"),p.lineDashOffset=Kn(Yn.lineDashOffset,0),p.lineJoin=Kn(Yn.lineJoin,"miter"),p.lineWidth=Ti,p.strokeStyle=Kn(Yn.strokeStyle,I),p.setLineDash(Kn(Yn.lineDash,[])),E.usePointStyle){const Mr={radius:Qe*Math.SQRT2/2,pointStyle:Yn.pointStyle,rotation:Yn.rotation,borderWidth:Ti},Sr=L.xPlus(En,qe/2);ns(p,Mr,Sr,fi+Me,E.pointStyleWidth&&qe)}else{const Mr=fi+Math.max((pe-Qe)/2,0),Sr=L.leftForLtr(En,qe),jr=uo(Yn.borderRadius);p.beginPath(),Object.values(jr).some(Ea=>0!==Ea)?co(p,{x:Sr,y:Mr,w:qe,h:Qe,radius:jr}):p.rect(Sr,Mr,qe,Qe),p.fill(),0!==Ti&&p.stroke()}p.restore()}(L.x(Sr),jr,En),Sr=((s,l,r,u)=>s===(u?"left":"right")?r:"center"===s?(l+r)/2:l)(Ti,Sr+qe+Me,vn?Sr+Mr:this.right,l.rtl),function(En,fi,Yn){jo(p,Yn.text,En,fi+rt/2,H,{strikethrough:Yn.hidden,textAlign:L.textAlign(Yn.textAlign)})}(L.x(Sr),jr,En),vn?Re.x+=Mr+Q:Re.y+="string"!=typeof En.text?xd(En,H.lineHeight):fn}),zc(this.ctx,l.textDirection)}drawTitle(){const l=this.options,r=l.title,u=Er(r.font),p=Nr(r.padding);if(!r.display)return;const v=gl(l.rtl,this.left,this.width),E=this.ctx,I=r.position,H=p.top+u.size/2;let Q,pe=this.left,Me=this.width;if(this.isHorizontal())Me=Math.max(...this.lineWidths),Q=this.top+H,pe=io(l.align,pe,this.right-Me);else{const qe=this.columnSizes.reduce((Qe,rt)=>Math.max(Qe,rt.height),0);Q=H+io(l.align,this.top,this.bottom-qe-l.labels.padding-this._computeTitleHeight())}const Re=io(I,pe,pe+Me);E.textAlign=v.textAlign(Ss(I)),E.textBaseline="middle",E.strokeStyle=r.color,E.fillStyle=r.color,E.font=u.string,jo(E,r.text,Re,Q,u)}_computeTitleHeight(){const l=this.options.title,r=Er(l.font),u=Nr(l.padding);return l.display?r.lineHeight+u.height:0}_getLegendItemAt(l,r){let u,p,v;if(Hr(l,this.left,this.right)&&Hr(r,this.top,this.bottom))for(v=this.legendHitBoxes,u=0;u<v.length;++u)if(p=v[u],Hr(l,p.left,p.left+p.width)&&Hr(r,p.top,p.top+p.height))return this.legendItems[u];return null}handleEvent(l){const r=this.options;if(!function Ur(s,l){return!(("mousemove"!==s&&"mouseout"!==s||!l.onHover&&!l.onLeave)&&(!l.onClick||"click"!==s&&"mouseup"!==s))}(l.type,r))return;const u=this._getLegendItemAt(l.x,l.y);if("mousemove"===l.type||"mouseout"===l.type){const p=this._hoveredItem,v=((s,l)=>null!==s&&null!==l&&s.datasetIndex===l.datasetIndex&&s.index===l.index)(p,u);p&&!v&&On(r.onLeave,[l,p,this],this),this._hoveredItem=u,u&&!v&&On(r.onHover,[l,u,this],this)}else u&&On(r.onClick,[l,u,this],this)}}function xd(s,l){return l*(s.text?s.text.length+.5:0)}var Zh={id:"legend",_element:xu,start(s,l,r){const u=s.legend=new xu({ctx:s.ctx,options:r,chart:s});R.configure(s,u,r),R.addBox(s,u)},stop(s){R.removeBox(s,s.legend),delete s.legend},beforeUpdate(s,l,r){const u=s.legend;R.configure(s,u,r),u.options=r},afterUpdate(s){const l=s.legend;l.buildLabels(),l.adjustHitBoxes()},afterEvent(s,l){l.replay||s.legend.handleEvent(l.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(s,l,r){const u=l.datasetIndex,p=r.chart;p.isDatasetVisible(u)?(p.hide(u),l.hidden=!0):(p.show(u),l.hidden=!1)},onHover:null,onLeave:null,labels:{color:s=>s.chart.options.color,boxWidth:40,padding:10,generateLabels(s){const l=s.data.datasets,{labels:{usePointStyle:r,pointStyle:u,textAlign:p,color:v,useBorderRadius:E,borderRadius:I}}=s.legend.options;return s._getSortedDatasetMetas().map(L=>{const H=L.controller.getStyle(r?0:void 0),Q=Nr(H.borderWidth);return{text:l[L.index].label,fillStyle:H.backgroundColor,fontColor:v,hidden:!L.visible,lineCap:H.borderCapStyle,lineDash:H.borderDash,lineDashOffset:H.borderDashOffset,lineJoin:H.borderJoinStyle,lineWidth:(Q.width+Q.height)/4,strokeStyle:H.borderColor,pointStyle:u||H.pointStyle,rotation:H.rotation,textAlign:p||H.textAlign,borderRadius:E&&(I||H.borderRadius),datasetIndex:L.index}},this)}},title:{color:s=>s.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:s=>!s.startsWith("on"),labels:{_scriptable:s=>!["generateLabels","filter","sort"].includes(s)}}};class eu extends ar{constructor(l){super(),this.chart=l.chart,this.options=l.options,this.ctx=l.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(l,r){const u=this.options;if(this.left=0,this.top=0,!u.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=l,this.height=this.bottom=r;const p=jn(u.text)?u.text.length:1;this._padding=Nr(u.padding);const v=p*Er(u.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=v:this.width=v}isHorizontal(){const l=this.options.position;return"top"===l||"bottom"===l}_drawArgs(l){const{top:r,left:u,bottom:p,right:v,options:E}=this,I=E.align;let H,Q,pe,L=0;return this.isHorizontal()?(Q=io(I,u,v),pe=r+l,H=v-u):("left"===E.position?(Q=u+l,pe=io(I,p,r),L=-.5*we):(Q=v-l,pe=io(I,r,p),L=.5*we),H=p-r),{titleX:Q,titleY:pe,maxWidth:H,rotation:L}}draw(){const l=this.ctx,r=this.options;if(!r.display)return;const u=Er(r.font),v=u.lineHeight/2+this._padding.top,{titleX:E,titleY:I,maxWidth:L,rotation:H}=this._drawArgs(v);jo(l,r.text,0,0,u,{color:r.color,maxWidth:L,rotation:H,textAlign:Ss(r.align),textBaseline:"middle",translation:[E,I]})}}var Dc={id:"title",_element:eu,start(s,l,r){!function Yh(s,l){const r=new eu({ctx:s.ctx,options:l,chart:s});R.configure(s,r,l),R.addBox(s,r),s.titleBlock=r}(s,r)},stop(s){R.removeBox(s,s.titleBlock),delete s.titleBlock},beforeUpdate(s,l,r){const u=s.titleBlock;R.configure(s,u,r),u.options=r},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Cc=new WeakMap;var Sf={id:"subtitle",start(s,l,r){const u=new eu({ctx:s.ctx,options:r,chart:s});R.configure(s,u,r),R.addBox(s,u),Cc.set(s,u)},stop(s){R.removeBox(s,Cc.get(s)),Cc.delete(s)},beforeUpdate(s,l,r){const u=Cc.get(s);R.configure(s,u,r),u.options=r},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const wd={average(s){if(!s.length)return!1;let l,r,u=0,p=0,v=0;for(l=0,r=s.length;l<r;++l){const E=s[l].element;if(E&&E.hasValue()){const I=E.tooltipPosition();u+=I.x,p+=I.y,++v}}return{x:u/v,y:p/v}},nearest(s,l){if(!s.length)return!1;let v,E,I,r=l.x,u=l.y,p=Number.POSITIVE_INFINITY;for(v=0,E=s.length;v<E;++v){const L=s[v].element;if(L&&L.hasValue()){const Q=Qn(l,L.getCenterPoint());Q<p&&(p=Q,I=L)}}if(I){const L=I.tooltipPosition();r=L.x,u=L.y}return{x:r,y:u}}};function Ha(s,l){return l&&(jn(l)?Array.prototype.push.apply(s,l):s.push(l)),s}function Ll(s){return("string"==typeof s||s instanceof String)&&s.indexOf("\n")>-1?s.split("\n"):s}function qh(s,l){const{element:r,datasetIndex:u,index:p}=l,v=s.getDatasetMeta(u).controller,{label:E,value:I}=v.getLabelAndValue(p);return{chart:s,label:E,parsed:v.getParsed(p),raw:s.data.datasets[u].data[p],formattedValue:I,dataset:v.getDataset(),dataIndex:p,datasetIndex:u,element:r}}function Kh(s,l){const r=s.chart.ctx,{body:u,footer:p,title:v}=s,{boxWidth:E,boxHeight:I}=l,L=Er(l.bodyFont),H=Er(l.titleFont),Q=Er(l.footerFont),pe=v.length,Me=p.length,Re=u.length,qe=Nr(l.padding);let Qe=qe.height,rt=0,jt=u.reduce((Sn,fn)=>Sn+fn.before.length+fn.lines.length+fn.after.length,0);jt+=s.beforeBody.length+s.afterBody.length,pe&&(Qe+=pe*H.lineHeight+(pe-1)*l.titleSpacing+l.titleMarginBottom),jt&&(Qe+=Re*(l.displayColors?Math.max(I,L.lineHeight):L.lineHeight)+(jt-Re)*L.lineHeight+(jt-1)*l.bodySpacing),Me&&(Qe+=l.footerMarginTop+Me*Q.lineHeight+(Me-1)*l.footerSpacing);let Ut=0;const vn=function(Sn){rt=Math.max(rt,r.measureText(Sn).width+Ut)};return r.save(),r.font=H.string,Qt(s.title,vn),r.font=L.string,Qt(s.beforeBody.concat(s.afterBody),vn),Ut=l.displayColors?E+2+l.boxPadding:0,Qt(u,Sn=>{Qt(Sn.before,vn),Qt(Sn.lines,vn),Qt(Sn.after,vn)}),Ut=0,r.font=Q.string,Qt(s.footer,vn),r.restore(),rt+=qe.width,{width:rt,height:Qe}}function Vp(s,l,r,u){const{x:p,width:v}=r,{width:E,chartArea:{left:I,right:L}}=s;let H="center";return"center"===u?H=p<=(I+L)/2?"left":"right":p<=v/2?H="left":p>=E-v/2&&(H="right"),function Mf(s,l,r,u){const{x:p,width:v}=u,E=r.caretSize+r.caretPadding;if("left"===s&&p+v+E>l.width||"right"===s&&p-v-E<0)return!0}(H,s,l,r)&&(H="center"),H}function hp(s,l,r){const u=r.yAlign||l.yAlign||function Xh(s,l){const{y:r,height:u}=l;return r<u/2?"top":r>s.height-u/2?"bottom":"center"}(s,r);return{xAlign:r.xAlign||l.xAlign||Vp(s,l,r,u),yAlign:u}}function Jh(s,l,r,u){const{caretSize:p,caretPadding:v,cornerRadius:E}=s,{xAlign:I,yAlign:L}=r,H=p+v,{topLeft:Q,topRight:pe,bottomLeft:Me,bottomRight:Re}=uo(E);let qe=function Dd(s,l){let{x:r,width:u}=s;return"right"===l?r-=u:"center"===l&&(r-=u/2),r}(l,I);const Qe=function Zu(s,l,r){let{y:u,height:p}=s;return"top"===l?u+=r:u-="bottom"===l?p+r:p/2,u}(l,L,H);return"center"===L?"left"===I?qe+=H:"right"===I&&(qe-=H):"left"===I?qe-=Math.max(Q,Me)+p:"right"===I&&(qe+=Math.max(pe,Re)+p),{x:Ki(qe,0,u.width-l.width),y:Ki(Qe,0,u.height-l.height)}}function Yu(s,l,r){const u=Nr(r.padding);return"center"===l?s.x+s.width/2:"right"===l?s.x+s.width-u.right:s.x+u.left}function Cd(s){return Ha([],Ll(s))}function Qh(s,l){const r=l&&l.dataset&&l.dataset.tooltip&&l.dataset.tooltip.callbacks;return r?s.override(r):s}const pp={beforeTitle:kt,title(s){if(s.length>0){const l=s[0],r=l.chart.data.labels,u=r?r.length:0;if(this&&this.options&&"dataset"===this.options.mode)return l.dataset.label||"";if(l.label)return l.label;if(u>0&&l.dataIndex<u)return r[l.dataIndex]}return""},afterTitle:kt,beforeBody:kt,beforeLabel:kt,label(s){if(this&&this.options&&"dataset"===this.options.mode)return s.label+": "+s.formattedValue||s.formattedValue;let l=s.dataset.label||"";l&&(l+=": ");const r=s.formattedValue;return Yt(r)||(l+=r),l},labelColor(s){const r=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{borderColor:r.borderColor,backgroundColor:r.backgroundColor,borderWidth:r.borderWidth,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(s){const r=s.chart.getDatasetMeta(s.datasetIndex).controller.getStyle(s.dataIndex);return{pointStyle:r.pointStyle,rotation:r.rotation}},afterLabel:kt,afterBody:kt,beforeFooter:kt,footer:kt,afterFooter:kt};function $a(s,l,r,u){const p=s[l].call(r,u);return typeof p>"u"?pp[l].call(r,u):p}let rh=(()=>{class s extends ar{constructor(r){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=r.chart,this.options=r.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(r){this.options=r,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const r=this._cachedAnimations;if(r)return r;const u=this.chart,p=this.options.setContext(this.getContext()),v=p.enabled&&u.options.animation&&p.animations,E=new de(this.chart,v);return v._cacheable&&(this._cachedAnimations=Object.freeze(E)),E}getContext(){return this.$context||(this.$context=function fp(s,l,r){return ta(s,{tooltip:l,tooltipItems:r,type:"tooltip"})}(this.chart.getContext(),this,this._tooltipItems))}getTitle(r,u){const{callbacks:p}=u,v=$a(p,"beforeTitle",this,r),E=$a(p,"title",this,r),I=$a(p,"afterTitle",this,r);let L=[];return L=Ha(L,Ll(v)),L=Ha(L,Ll(E)),L=Ha(L,Ll(I)),L}getBeforeBody(r,u){return Cd($a(u.callbacks,"beforeBody",this,r))}getBody(r,u){const{callbacks:p}=u,v=[];return Qt(r,E=>{const I={before:[],lines:[],after:[]},L=Qh(p,E);Ha(I.before,Ll($a(L,"beforeLabel",this,E))),Ha(I.lines,$a(L,"label",this,E)),Ha(I.after,Ll($a(L,"afterLabel",this,E))),v.push(I)}),v}getAfterBody(r,u){return Cd($a(u.callbacks,"afterBody",this,r))}getFooter(r,u){const{callbacks:p}=u,v=$a(p,"beforeFooter",this,r),E=$a(p,"footer",this,r),I=$a(p,"afterFooter",this,r);let L=[];return L=Ha(L,Ll(v)),L=Ha(L,Ll(E)),L=Ha(L,Ll(I)),L}_createItems(r){const u=this._active,p=this.chart.data,v=[],E=[],I=[];let H,Q,L=[];for(H=0,Q=u.length;H<Q;++H)L.push(qh(this.chart,u[H]));return r.filter&&(L=L.filter((pe,Me,Re)=>r.filter(pe,Me,Re,p))),r.itemSort&&(L=L.sort((pe,Me)=>r.itemSort(pe,Me,p))),Qt(L,pe=>{const Me=Qh(r.callbacks,pe);v.push($a(Me,"labelColor",this,pe)),E.push($a(Me,"labelPointStyle",this,pe)),I.push($a(Me,"labelTextColor",this,pe))}),this.labelColors=v,this.labelPointStyles=E,this.labelTextColors=I,this.dataPoints=L,L}update(r,u){const p=this.options.setContext(this.getContext()),v=this._active;let E,I=[];if(v.length){const L=wd[p.position].call(this,v,this._eventPosition);I=this._createItems(p),this.title=this.getTitle(I,p),this.beforeBody=this.getBeforeBody(I,p),this.body=this.getBody(I,p),this.afterBody=this.getAfterBody(I,p),this.footer=this.getFooter(I,p);const H=this._size=Kh(this,p),Q=Object.assign({},L,H),pe=hp(this.chart,p,Q),Me=Jh(p,Q,pe,this.chart);this.xAlign=pe.xAlign,this.yAlign=pe.yAlign,E={opacity:1,x:Me.x,y:Me.y,width:H.width,height:H.height,caretX:L.x,caretY:L.y}}else 0!==this.opacity&&(E={opacity:0});this._tooltipItems=I,this.$context=void 0,E&&this._resolveAnimations().update(this,E),r&&p.external&&p.external.call(this,{chart:this.chart,tooltip:this,replay:u})}drawCaret(r,u,p,v){const E=this.getCaretPosition(r,p,v);u.lineTo(E.x1,E.y1),u.lineTo(E.x2,E.y2),u.lineTo(E.x3,E.y3)}getCaretPosition(r,u,p){const{xAlign:v,yAlign:E}=this,{caretSize:I,cornerRadius:L}=p,{topLeft:H,topRight:Q,bottomLeft:pe,bottomRight:Me}=uo(L),{x:Re,y:qe}=r,{width:Qe,height:rt}=u;let jt,Ut,vn,Sn,fn,En;return"center"===E?(fn=qe+rt/2,"left"===v?(jt=Re,Ut=jt-I,Sn=fn+I,En=fn-I):(jt=Re+Qe,Ut=jt+I,Sn=fn-I,En=fn+I),vn=jt):(Ut="left"===v?Re+Math.max(H,pe)+I:"right"===v?Re+Qe-Math.max(Q,Me)-I:this.caretX,"top"===E?(Sn=qe,fn=Sn-I,jt=Ut-I,vn=Ut+I):(Sn=qe+rt,fn=Sn+I,jt=Ut+I,vn=Ut-I),En=Sn),{x1:jt,x2:Ut,x3:vn,y1:Sn,y2:fn,y3:En}}drawTitle(r,u,p){const v=this.title,E=v.length;let I,L,H;if(E){const Q=gl(p.rtl,this.x,this.width);for(r.x=Yu(this,p.titleAlign,p),u.textAlign=Q.textAlign(p.titleAlign),u.textBaseline="middle",I=Er(p.titleFont),L=p.titleSpacing,u.fillStyle=p.titleColor,u.font=I.string,H=0;H<E;++H)u.fillText(v[H],Q.x(r.x),r.y+I.lineHeight/2),r.y+=I.lineHeight+L,H+1===E&&(r.y+=p.titleMarginBottom-L)}}_drawColorBox(r,u,p,v,E){const I=this.labelColors[p],L=this.labelPointStyles[p],{boxHeight:H,boxWidth:Q}=E,pe=Er(E.bodyFont),Me=Yu(this,"left",E),Re=v.x(Me),Qe=u.y+(H<pe.lineHeight?(pe.lineHeight-H)/2:0);if(E.usePointStyle){const rt={radius:Math.min(Q,H)/2,pointStyle:L.pointStyle,rotation:L.rotation,borderWidth:1},jt=v.leftForLtr(Re,Q)+Q/2,Ut=Qe+H/2;r.strokeStyle=E.multiKeyBackground,r.fillStyle=E.multiKeyBackground,Ei(r,rt,jt,Ut),r.strokeStyle=I.borderColor,r.fillStyle=I.backgroundColor,Ei(r,rt,jt,Ut)}else{r.lineWidth=at(I.borderWidth)?Math.max(...Object.values(I.borderWidth)):I.borderWidth||1,r.strokeStyle=I.borderColor,r.setLineDash(I.borderDash||[]),r.lineDashOffset=I.borderDashOffset||0;const rt=v.leftForLtr(Re,Q),jt=v.leftForLtr(v.xPlus(Re,1),Q-2),Ut=uo(I.borderRadius);Object.values(Ut).some(vn=>0!==vn)?(r.beginPath(),r.fillStyle=E.multiKeyBackground,co(r,{x:rt,y:Qe,w:Q,h:H,radius:Ut}),r.fill(),r.stroke(),r.fillStyle=I.backgroundColor,r.beginPath(),co(r,{x:jt,y:Qe+1,w:Q-2,h:H-2,radius:Ut}),r.fill()):(r.fillStyle=E.multiKeyBackground,r.fillRect(rt,Qe,Q,H),r.strokeRect(rt,Qe,Q,H),r.fillStyle=I.backgroundColor,r.fillRect(jt,Qe+1,Q-2,H-2))}r.fillStyle=this.labelTextColors[p]}drawBody(r,u,p){const{body:v}=this,{bodySpacing:E,bodyAlign:I,displayColors:L,boxHeight:H,boxWidth:Q,boxPadding:pe}=p,Me=Er(p.bodyFont);let Re=Me.lineHeight,qe=0;const Qe=gl(p.rtl,this.x,this.width),rt=function(Ti){u.fillText(Ti,Qe.x(r.x+qe),r.y+Re/2),r.y+=Re+E},jt=Qe.textAlign(I);let Ut,vn,Sn,fn,En,fi,Yn;for(u.textAlign=I,u.textBaseline="middle",u.font=Me.string,r.x=Yu(this,jt,p),u.fillStyle=p.bodyColor,Qt(this.beforeBody,rt),qe=L&&"right"!==jt?"center"===I?Q/2+pe:Q+2+pe:0,fn=0,fi=v.length;fn<fi;++fn){for(Ut=v[fn],vn=this.labelTextColors[fn],u.fillStyle=vn,Qt(Ut.before,rt),Sn=Ut.lines,L&&Sn.length&&(this._drawColorBox(u,r,fn,Qe,p),Re=Math.max(Me.lineHeight,H)),En=0,Yn=Sn.length;En<Yn;++En)rt(Sn[En]),Re=Me.lineHeight;Qt(Ut.after,rt)}qe=0,Re=Me.lineHeight,Qt(this.afterBody,rt),r.y-=E}drawFooter(r,u,p){const v=this.footer,E=v.length;let I,L;if(E){const H=gl(p.rtl,this.x,this.width);for(r.x=Yu(this,p.footerAlign,p),r.y+=p.footerMarginTop,u.textAlign=H.textAlign(p.footerAlign),u.textBaseline="middle",I=Er(p.footerFont),u.fillStyle=p.footerColor,u.font=I.string,L=0;L<E;++L)u.fillText(v[L],H.x(r.x),r.y+I.lineHeight/2),r.y+=I.lineHeight+p.footerSpacing}}drawBackground(r,u,p,v){const{xAlign:E,yAlign:I}=this,{x:L,y:H}=r,{width:Q,height:pe}=p,{topLeft:Me,topRight:Re,bottomLeft:qe,bottomRight:Qe}=uo(v.cornerRadius);u.fillStyle=v.backgroundColor,u.strokeStyle=v.borderColor,u.lineWidth=v.borderWidth,u.beginPath(),u.moveTo(L+Me,H),"top"===I&&this.drawCaret(r,u,p,v),u.lineTo(L+Q-Re,H),u.quadraticCurveTo(L+Q,H,L+Q,H+Re),"center"===I&&"right"===E&&this.drawCaret(r,u,p,v),u.lineTo(L+Q,H+pe-Qe),u.quadraticCurveTo(L+Q,H+pe,L+Q-Qe,H+pe),"bottom"===I&&this.drawCaret(r,u,p,v),u.lineTo(L+qe,H+pe),u.quadraticCurveTo(L,H+pe,L,H+pe-qe),"center"===I&&"left"===E&&this.drawCaret(r,u,p,v),u.lineTo(L,H+Me),u.quadraticCurveTo(L,H,L+Me,H),u.closePath(),u.fill(),v.borderWidth>0&&u.stroke()}_updateAnimationTarget(r){const u=this.chart,p=this.$animations,v=p&&p.x,E=p&&p.y;if(v||E){const I=wd[r.position].call(this,this._active,this._eventPosition);if(!I)return;const L=this._size=Kh(this,r),H=Object.assign({},I,this._size),Q=hp(u,r,H),pe=Jh(r,H,Q,u);(v._to!==pe.x||E._to!==pe.y)&&(this.xAlign=Q.xAlign,this.yAlign=Q.yAlign,this.width=L.width,this.height=L.height,this.caretX=I.x,this.caretY=I.y,this._resolveAnimations().update(this,pe))}}_willRender(){return!!this.opacity}draw(r){const u=this.options.setContext(this.getContext());let p=this.opacity;if(!p)return;this._updateAnimationTarget(u);const v={width:this.width,height:this.height},E={x:this.x,y:this.y};p=Math.abs(p)<.001?0:p;const I=Nr(u.padding);u.enabled&&(this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length)&&(r.save(),r.globalAlpha=p,this.drawBackground(E,r,v,u),ia(r,u.textDirection),E.y+=I.top,this.drawTitle(E,r,u),this.drawBody(E,r,u),this.drawFooter(E,r,u),zc(r,u.textDirection),r.restore())}getActiveElements(){return this._active||[]}setActiveElements(r,u){const p=this._active,v=r.map(({datasetIndex:L,index:H})=>{const Q=this.chart.getDatasetMeta(L);if(!Q)throw new Error("Cannot find a dataset at index "+L);return{datasetIndex:L,element:Q.data[H],index:H}}),E=!mr(p,v),I=this._positionChanged(v,u);(E||I)&&(this._active=v,this._eventPosition=u,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(r,u,p=!0){if(u&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const v=this.options,E=this._active||[],I=this._getActiveElements(r,E,u,p),L=this._positionChanged(I,r),H=u||!mr(I,E)||L;return H&&(this._active=I,(v.enabled||v.external)&&(this._eventPosition={x:r.x,y:r.y},this.update(!0,u))),H}_getActiveElements(r,u,p,v){const E=this.options;if("mouseout"===r.type)return[];if(!v)return u;const I=this.chart.getElementsAtEventForMode(r,E.mode,E,p);return E.reverse&&I.reverse(),I}_positionChanged(r,u){const{caretX:p,caretY:v,options:E}=this,I=wd[E.position].call(this,r,u);return!1!==I&&(p!==I.x||v!==I.y)}}return Ze(s,"positioners",wd),s})();var ba={id:"tooltip",_element:rh,positioners:wd,afterInit(s,l,r){r&&(s.tooltip=new rh({chart:s,options:r}))},beforeUpdate(s,l,r){s.tooltip&&s.tooltip.initialize(r)},reset(s,l,r){s.tooltip&&s.tooltip.initialize(r)},afterDraw(s){const l=s.tooltip;if(l&&l._willRender()){const r={tooltip:l};if(!1===s.notifyPlugins("beforeTooltipDraw",{...r,cancelable:!0}))return;l.draw(s.ctx),s.notifyPlugins("afterTooltipDraw",r)}},afterEvent(s,l){s.tooltip&&s.tooltip.handleEvent(l.event,l.replay,l.inChartArea)&&(l.changed=!0)},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(s,l)=>l.bodyFont.size,boxWidth:(s,l)=>l.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:pp},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:s=>"filter"!==s&&"itemSort"!==s&&"external"!==s,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},ic=Object.freeze({__proto__:null,Colors:Jd,Decimation:Lh,Filler:ih,Legend:Zh,SubTitle:Sf,Title:Dc,Tooltip:ba});function sh(s){const l=this.getLabels();return s>=0&&s<l.length?l[s]:s}let Ec=(()=>{class s extends ya{constructor(r){super(r),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(r){const u=this._addedLabels;if(u.length){const p=this.getLabels();for(const{index:v,label:E}of u)p[v]===E&&p.splice(v,1);this._addedLabels=[]}super.init(r)}parse(r,u){if(Yt(r))return null;const p=this.getLabels();return((s,l)=>null===s?null:Ki(Math.round(s),0,l))(u=isFinite(u)&&p[u]===r?u:function tu(s,l,r,u){const p=s.indexOf(l);return-1===p?((s,l,r,u)=>("string"==typeof l?(r=s.push(l)-1,u.unshift({index:r,label:l})):isNaN(l)&&(r=null),r))(s,l,r,u):p!==s.lastIndexOf(l)?r:p}(p,r,Kn(u,r),this._addedLabels),p.length-1)}determineDataLimits(){const{minDefined:r,maxDefined:u}=this.getUserBounds();let{min:p,max:v}=this.getMinMax(!0);"ticks"===this.options.bounds&&(r||(p=0),u||(v=this.getLabels().length-1)),this.min=p,this.max=v}buildTicks(){const r=this.min,u=this.max,p=this.options.offset,v=[];let E=this.getLabels();E=0===r&&u===E.length-1?E:E.slice(r,u+1),this._valueRange=Math.max(E.length-(p?0:1),1),this._startValue=this.min-(p?.5:0);for(let I=r;I<=u;I++)v.push({value:I});return v}getLabelForValue(r){return sh.call(this,r)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(r){return"number"!=typeof r&&(r=this.parse(r)),null===r?NaN:this.getPixelForDecimal((r-this._startValue)/this._valueRange)}getPixelForTick(r){const u=this.ticks;return r<0||r>u.length-1?null:this.getPixelForValue(u[r].value)}getValueForPixel(r){return Math.round(this._startValue+this.getDecimalForPixel(r)*this._valueRange)}getBasePixel(){return this.bottom}}return Ze(s,"id","category"),Ze(s,"defaults",{ticks:{callback:sh}}),s})();function Ed(s,l,{horizontal:r,minRotation:u}){const p=tn(u),v=(r?Math.sin(p):Math.cos(p))||.001;return Math.min(l/v,.75*l*(""+s).length)}class Td extends ya{constructor(l){super(l),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(l,r){return Yt(l)||("number"==typeof l||l instanceof Number)&&!isFinite(+l)?null:+l}handleTickRangeOptions(){const{beginAtZero:l}=this.options,{minDefined:r,maxDefined:u}=this.getUserBounds();let{min:p,max:v}=this;const E=L=>p=r?p:L,I=L=>v=u?v:L;if(l){const L=sn(p),H=sn(v);L<0&&H<0?I(0):L>0&&H>0&&E(0)}if(p===v){let L=0===v?1:Math.abs(.05*v);I(v+L),l||E(p-L)}this.min=p,this.max=v}getTickLimit(){const l=this.options.ticks;let p,{maxTicksLimit:r,stepSize:u}=l;return u?(p=Math.ceil(this.max/u)-Math.floor(this.min/u)+1,p>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${u} would result generating up to ${p} ticks. Limiting to 1000.`),p=1e3)):(p=this.computeTickLimit(),r=r||11),r&&(p=Math.min(r,p)),p}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const l=this.options,r=l.ticks;let u=this.getTickLimit();u=Math.max(2,u);const E=function ef(s,l){const r=[],{bounds:p,step:v,min:E,max:I,precision:L,count:H,maxTicks:Q,maxDigits:pe,includeBounds:Me}=s,Re=v||1,qe=Q-1,{min:Qe,max:rt}=l,jt=!Yt(E),Ut=!Yt(I),vn=!Yt(H),Sn=(rt-Qe)/(pe+1);let En,fi,Yn,Ti,fn=Fn((rt-Qe)/qe/Re)*Re;if(fn<1e-14&&!jt&&!Ut)return[{value:Qe},{value:rt}];Ti=Math.ceil(rt/fn)-Math.floor(Qe/fn),Ti>qe&&(fn=Fn(Ti*fn/qe/Re)*Re),Yt(L)||(En=Math.pow(10,L),fn=Math.ceil(fn*En)/En),"ticks"===p?(fi=Math.floor(Qe/fn)*fn,Yn=Math.ceil(rt/fn)*fn):(fi=Qe,Yn=rt),jt&&Ut&&v&&function Ge(s,l){const r=Math.round(s);return r-l<=s&&r+l>=s}((I-E)/v,fn/1e3)?(Ti=Math.round(Math.min((I-E)/fn,Q)),fn=(I-E)/Ti,fi=E,Yn=I):vn?(fi=jt?E:fi,Yn=Ut?I:Yn,Ti=H-1,fn=(Yn-fi)/Ti):(Ti=(Yn-fi)/fn,Ti=Cn(Ti,Math.round(Ti),fn/1e3)?Math.round(Ti):Math.ceil(Ti));const Mr=Math.max(cn(fn),cn(fi));En=Math.pow(10,Yt(L)?Mr:L),fi=Math.round(fi*En)/En,Yn=Math.round(Yn*En)/En;let Sr=0;for(jt&&(Me&&fi!==E?(r.push({value:E}),fi<E&&Sr++,Cn(Math.round((fi+Sr*fn)*En)/En,E,Ed(E,Sn,s))&&Sr++):fi<E&&Sr++);Sr<Ti;++Sr){const jr=Math.round((fi+Sr*fn)*En)/En;if(Ut&&jr>I)break;r.push({value:jr})}return Ut&&Me&&Yn!==I?r.length&&Cn(r[r.length-1].value,I,Ed(I,Sn,s))?r[r.length-1].value=I:r.push({value:I}):(!Ut||Yn===I)&&r.push({value:Yn}),r}({maxTicks:u,bounds:l.bounds,min:l.min,max:l.max,precision:r.precision,step:r.stepSize,count:r.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:r.minRotation||0,includeBounds:!1!==r.includeBounds},this._range||this);return"ticks"===l.bounds&&Gt(E,this,"value"),l.reverse?(E.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),E}configure(){const l=this.ticks;let r=this.min,u=this.max;if(super.configure(),this.options.offset&&l.length){const p=(u-r)/Math.max(l.length-1,1)/2;r-=p,u+=p}this._startValue=r,this._endValue=u,this._valueRange=u-r}getLabelForValue(l){return Ms(l,this.chart.options.locale,this.options.ticks.format)}}class ah extends Td{determineDataLimits(){const{min:l,max:r}=this.getMinMax(!0);this.min=qt(l)?l:0,this.max=qt(r)?r:1,this.handleTickRangeOptions()}computeTickLimit(){const l=this.isHorizontal(),r=l?this.width:this.height,u=tn(this.options.ticks.minRotation),p=(l?Math.sin(u):Math.cos(u))||.001,v=this._resolveTickFontOptions(0);return Math.ceil(r/Math.min(40,v.lineHeight/p))}getPixelForValue(l){return null===l?NaN:this.getPixelForDecimal((l-this._startValue)/this._valueRange)}getValueForPixel(l){return this._startValue+this.getDecimalForPixel(l)*this._valueRange}}Ze(ah,"id","linear"),Ze(ah,"defaults",{ticks:{callback:qa.formatters.numeric}});const wu=s=>Math.floor(wn(s)),Tc=(s,l)=>Math.pow(10,wu(s)+l);function qu(s){return s/Math.pow(10,wu(s))==1}function Du(s,l,r){const u=Math.pow(10,r),p=Math.floor(s/u);return Math.ceil(l/u)-p}class Ku extends ya{constructor(l){super(l),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(l,r){const u=Td.prototype.parse.apply(this,[l,r]);if(0!==u)return qt(u)&&u>0?u:null;this._zero=!0}determineDataLimits(){const{min:l,max:r}=this.getMinMax(!0);this.min=qt(l)?Math.max(0,l):null,this.max=qt(r)?Math.max(0,r):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!qt(this._userMin)&&(this.min=l===Tc(this.min,0)?Tc(this.min,-1):Tc(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:l,maxDefined:r}=this.getUserBounds();let u=this.min,p=this.max;const v=I=>u=l?u:I,E=I=>p=r?p:I;u===p&&(u<=0?(v(1),E(10)):(v(Tc(u,-1)),E(Tc(p,1)))),u<=0&&v(Tc(p,-1)),p<=0&&E(Tc(u,1)),this.min=u,this.max=p}buildTicks(){const l=this.options,u=function Sd(s,{min:l,max:r}){l=yn(s.min,l);const u=[],p=wu(l);let v=function lh(s,l){let u=wu(l-s);for(;Du(s,l,u)>10;)u++;for(;Du(s,l,u)<10;)u--;return Math.min(u,wu(s))}(l,r),E=v<0?Math.pow(10,Math.abs(v)):1;const I=Math.pow(10,v),L=p>v?Math.pow(10,p):0,H=Math.round((l-L)*E)/E,Q=Math.floor((l-L)/I/10)*I*10;let pe=Math.floor((H-Q)/Math.pow(10,v)),Me=yn(s.min,Math.round((L+Q+pe*Math.pow(10,v))*E)/E);for(;Me<r;)u.push({value:Me,major:qu(Me),significand:pe}),pe>=10?pe=pe<15?15:20:pe++,pe>=20&&(v++,pe=2,E=v>=0?1:E),Me=Math.round((L+Q+pe*Math.pow(10,v))*E)/E;const Re=yn(s.max,Me);return u.push({value:Re,major:qu(Re),significand:pe}),u}({min:this._userMin,max:this._userMax},this);return"ticks"===l.bounds&&Gt(u,this,"value"),l.reverse?(u.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),u}getLabelForValue(l){return void 0===l?"0":Ms(l,this.chart.options.locale,this.options.ticks.format)}configure(){const l=this.min;super.configure(),this._startValue=wn(l),this._valueRange=wn(this.max)-wn(l)}getPixelForValue(l){return(void 0===l||0===l)&&(l=this.min),null===l||isNaN(l)?NaN:this.getPixelForDecimal(l===this.min?0:(wn(l)-this._startValue)/this._valueRange)}getValueForPixel(l){const r=this.getDecimalForPixel(l);return Math.pow(10,this._startValue+r*this._valueRange)}}function Md(s){const l=s.ticks;if(l.display&&s.display){const r=Nr(l.backdropPadding);return Kn(l.font&&l.font.size,$i.font.size)+r.height}return 0}function tf(s,l,r){return r=jn(r)?r:[r],{w:zr(s,l.string,r),h:r.length*l.lineHeight}}function Sc(s,l,r,u,p){return s===u||s===p?{start:l-r/2,end:l+r/2}:s<u||s>p?{start:l-r,end:l}:{start:l,end:l+r}}function nu(s,l,r,u,p){const v=Math.abs(Math.sin(r)),E=Math.abs(Math.cos(r));let I=0,L=0;u.start<l.l?(I=(l.l-u.start)/v,s.l=Math.min(s.l,l.l-I)):u.end>l.r&&(I=(u.end-l.r)/v,s.r=Math.max(s.r,l.r+I)),p.start<l.t?(L=(l.t-p.start)/E,s.t=Math.min(s.t,l.t-L)):p.end>l.b&&(L=(p.end-l.b)/E,s.b=Math.max(s.b,l.b+L))}function nf(s,l,r){const u=s.drawingArea,{extra:p,additionalAngle:v,padding:E,size:I}=r,L=s.getPointPosition(l,u+p+E,v),H=Math.round(Wt(ji(L.angle+Xe))),Q=function Xu(s,l,r){return 90===r||270===r?s-=l/2:(r>270||r<90)&&(s-=l),s}(L.y,I.h,H),pe=function gp(s){return 0===s||180===s?"center":s<180?"left":"right"}(H),Me=function ch(s,l,r){return"right"===r?s-=l:"center"===r&&(s-=l/2),s}(L.x,I.w,pe);return{visible:!0,x:L.x,y:Q,textAlign:pe,left:Me,top:Q,right:Me+I.w,bottom:Q+I.h}}function If(s,l){if(!l)return!0;const{left:r,top:u,right:p,bottom:v}=s;return!(As({x:r,y:u},l)||As({x:r,y:v},l)||As({x:p,y:u},l)||As({x:p,y:v},l))}function Of(s,l,r){const{left:u,top:p,right:v,bottom:E}=r,{backdropColor:I}=l;if(!Yt(I)){const L=uo(l.borderRadius),H=Nr(l.backdropPadding);s.fillStyle=I;const Q=u-H.left,pe=p-H.top,Me=v-u+H.width,Re=E-p+H.height;Object.values(L).some(qe=>0!==qe)?(s.beginPath(),co(s,{x:Q,y:pe,w:Me,h:Re,radius:L}),s.fill()):s.fillRect(Q,pe,Me,Re)}}function rf(s,l,r,u){const{ctx:p}=s;if(r)p.arc(s.xCenter,s.yCenter,l,0,me);else{let v=s.getPointPosition(0,l);p.moveTo(v.x,v.y);for(let E=1;E<u;E++)v=s.getPointPosition(E,l),p.lineTo(v.x,v.y)}}Ze(Ku,"id","logarithmic"),Ze(Ku,"defaults",{ticks:{callback:qa.formatters.logarithmic,major:{enabled:!0}}});class Id extends Td{constructor(l){super(l),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const l=this._padding=Nr(Md(this.options)/2),r=this.width=this.maxWidth-l.width,u=this.height=this.maxHeight-l.height;this.xCenter=Math.floor(this.left+r/2+l.left),this.yCenter=Math.floor(this.top+u/2+l.top),this.drawingArea=Math.floor(Math.min(r,u)/2)}determineDataLimits(){const{min:l,max:r}=this.getMinMax(!1);this.min=qt(l)&&!isNaN(l)?l:0,this.max=qt(r)&&!isNaN(r)?r:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Md(this.options))}generateTickLabels(l){Td.prototype.generateTickLabels.call(this,l),this._pointLabels=this.getLabels().map((r,u)=>{const p=On(this.options.pointLabels.callback,[r,u],this);return p||0===p?p:""}).filter((r,u)=>this.chart.getDataVisibility(u))}fit(){const l=this.options;l.display&&l.pointLabels.display?function Mc(s){const l={l:s.left+s._padding.left,r:s.right-s._padding.right,t:s.top+s._padding.top,b:s.bottom-s._padding.bottom},r=Object.assign({},l),u=[],p=[],v=s._pointLabels.length,E=s.options.pointLabels,I=E.centerPointLabels?we/v:0;for(let L=0;L<v;L++){const H=E.setContext(s.getPointLabelContext(L));p[L]=H.padding;const Q=s.getPointPosition(L,s.drawingArea+p[L],I),pe=Er(H.font),Me=tf(s.ctx,pe,s._pointLabels[L]);u[L]=Me;const Re=ji(s.getIndexAngle(L)+I),qe=Math.round(Wt(Re));nu(r,l,Re,Sc(qe,Q.x,Me.w,0,180),Sc(qe,Q.y,Me.h,90,270))}s.setCenterPoint(l.l-r.l,r.r-l.r,l.t-r.t,r.b-l.b),s._pointLabelItems=function Up(s,l,r){const u=[],p=s._pointLabels.length,v=s.options,{centerPointLabels:E,display:I}=v.pointLabels,L={extra:Md(v)/2,additionalAngle:E?we/p:0};let H;for(let Q=0;Q<p;Q++){L.padding=r[Q],L.size=l[Q];const pe=nf(s,Q,L);u.push(pe),"auto"===I&&(pe.visible=If(pe,H),pe.visible&&(H=pe))}return u}(s,u,p)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(l,r,u,p){this.xCenter+=Math.floor((l-r)/2),this.yCenter+=Math.floor((u-p)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(l,r,u,p))}getIndexAngle(l){return ji(l*(me/(this._pointLabels.length||1))+tn(this.options.startAngle||0))}getDistanceFromCenterForValue(l){if(Yt(l))return NaN;const r=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-l)*r:(l-this.min)*r}getValueForDistanceFromCenter(l){if(Yt(l))return NaN;const r=l/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-r:this.min+r}getPointLabelContext(l){const r=this._pointLabels||[];if(l>=0&&l<r.length){const u=r[l];return function Pf(s,l,r){return ta(s,{label:r,index:l,type:"pointLabel"})}(this.getContext(),l,u)}}getPointPosition(l,r,u=0){const p=this.getIndexAngle(l)-Xe+u;return{x:Math.cos(p)*r+this.xCenter,y:Math.sin(p)*r+this.yCenter,angle:p}}getPointPositionForValue(l,r){return this.getPointPosition(l,this.getDistanceFromCenterForValue(r))}getBasePosition(l){return this.getPointPositionForValue(l||0,this.getBaseValue())}getPointLabelPosition(l){const{left:r,top:u,right:p,bottom:v}=this._pointLabelItems[l];return{left:r,top:u,right:p,bottom:v}}drawBackground(){const{backgroundColor:l,grid:{circular:r}}=this.options;if(l){const u=this.ctx;u.save(),u.beginPath(),rf(this,this.getDistanceFromCenterForValue(this._endValue),r,this._pointLabels.length),u.closePath(),u.fillStyle=l,u.fill(),u.restore()}}drawGrid(){const l=this.ctx,r=this.options,{angleLines:u,grid:p,border:v}=r,E=this._pointLabels.length;let I,L,H;if(r.pointLabels.display&&function Cu(s,l){const{ctx:r,options:{pointLabels:u}}=s;for(let p=l-1;p>=0;p--){const v=s._pointLabelItems[p];if(!v.visible)continue;const E=u.setContext(s.getPointLabelContext(p));Of(r,E,v);const I=Er(E.font),{x:L,y:H,textAlign:Q}=v;jo(r,s._pointLabels[p],L,H+I.lineHeight/2,I,{color:E.color,textAlign:Q,textBaseline:"middle"})}}(this,E),p.display&&this.ticks.forEach((Q,pe)=>{if(0!==pe){L=this.getDistanceFromCenterForValue(Q.value);const Me=this.getContext(pe),Re=p.setContext(Me),qe=v.setContext(Me);!function Ad(s,l,r,u,p){const v=s.ctx,E=l.circular,{color:I,lineWidth:L}=l;!E&&!u||!I||!L||r<0||(v.save(),v.strokeStyle=I,v.lineWidth=L,v.setLineDash(p.dash),v.lineDashOffset=p.dashOffset,v.beginPath(),rf(s,r,E,u),v.closePath(),v.stroke(),v.restore())}(this,Re,L,E,qe)}}),u.display){for(l.save(),I=E-1;I>=0;I--){const Q=u.setContext(this.getPointLabelContext(I)),{color:pe,lineWidth:Me}=Q;!Me||!pe||(l.lineWidth=Me,l.strokeStyle=pe,l.setLineDash(Q.borderDash),l.lineDashOffset=Q.borderDashOffset,L=this.getDistanceFromCenterForValue(r.ticks.reverse?this.min:this.max),H=this.getPointPosition(I,L),l.beginPath(),l.moveTo(this.xCenter,this.yCenter),l.lineTo(H.x,H.y),l.stroke())}l.restore()}}drawBorder(){}drawLabels(){const l=this.ctx,r=this.options,u=r.ticks;if(!u.display)return;const p=this.getIndexAngle(0);let v,E;l.save(),l.translate(this.xCenter,this.yCenter),l.rotate(p),l.textAlign="center",l.textBaseline="middle",this.ticks.forEach((I,L)=>{if(0===L&&!r.reverse)return;const H=u.setContext(this.getContext(L)),Q=Er(H.font);if(v=this.getDistanceFromCenterForValue(this.ticks[L].value),H.showLabelBackdrop){l.font=Q.string,E=l.measureText(I.label).width,l.fillStyle=H.backdropColor;const pe=Nr(H.backdropPadding);l.fillRect(-E/2-pe.left,-v-Q.size/2-pe.top,E+pe.width,Q.size+pe.height)}jo(l,I.label,0,-v,Q,{color:H.color})}),l.restore()}drawTitle(){}}Ze(Id,"id","radialLinear"),Ze(Id,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:qa.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:s=>s,padding:5,centerPointLabels:!1}}),Ze(Id,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Ze(Id,"descriptors",{angleLines:{_fallback:"grid"}});const Eu={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ga=Object.keys(Eu);function Tu(s,l){return s-l}function Od(s,l){if(Yt(l))return null;const r=s._adapter,{parser:u,round:p,isoWeekday:v}=s._parseOpts;let E=l;return"function"==typeof u&&(E=u(E)),qt(E)||(E="string"==typeof u?r.parse(E,u):r.parse(E)),null===E?null:(p&&(E="week"!==p||!Oe(v)&&!0!==v?r.startOf(E,p):r.startOf(E,"isoWeek",v)),+E)}function sf(s,l,r,u){const p=Ga.length;for(let v=Ga.indexOf(s);v<p-1;++v){const E=Eu[Ga[v]];if(E.common&&Math.ceil((r-l)/((E.steps?E.steps:Number.MAX_SAFE_INTEGER)*E.size))<=u)return Ga[v]}return Ga[p-1]}function uh(s,l,r){if(r){if(r.length){const{lo:u,hi:p}=Hi(r,l);s[r[u]>=l?r[u]:r[p]]=!0}}else s[l]=!0}function kf(s,l,r){const u=[],p={},v=l.length;let E,I;for(E=0;E<v;++E)I=l[E],p[I]=E,u.push({value:I,major:!1});return 0!==v&&r?function Rf(s,l,r,u){const p=s._adapter,v=+p.startOf(l[0].value,u),E=l[l.length-1].value;let I,L;for(I=v;I<=E;I=+p.add(I,1,u))L=r[I],L>=0&&(l[L].major=!0);return l}(s,u,p,r):u}let b=(()=>{class s extends ya{constructor(r){super(r),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(r,u={}){const p=r.time||(r.time={}),v=this._adapter=new hu__date(r.adapters.date);v.init(u),_r(p.displayFormats,v.formats()),this._parseOpts={parser:p.parser,round:p.round,isoWeekday:p.isoWeekday},super.init(r),this._normalized=u.normalized}parse(r,u){return void 0===r?null:Od(this,r)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const r=this.options,u=this._adapter,p=r.time.unit||"day";let{min:v,max:E,minDefined:I,maxDefined:L}=this.getUserBounds();function H(Q){!I&&!isNaN(Q.min)&&(v=Math.min(v,Q.min)),!L&&!isNaN(Q.max)&&(E=Math.max(E,Q.max))}(!I||!L)&&(H(this._getLabelBounds()),("ticks"!==r.bounds||"labels"!==r.ticks.source)&&H(this.getMinMax(!1))),v=qt(v)&&!isNaN(v)?v:+u.startOf(Date.now(),p),E=qt(E)&&!isNaN(E)?E:+u.endOf(Date.now(),p)+1,this.min=Math.min(v,E-1),this.max=Math.max(v+1,E)}_getLabelBounds(){const r=this.getLabelTimestamps();let u=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY;return r.length&&(u=r[0],p=r[r.length-1]),{min:u,max:p}}buildTicks(){const r=this.options,u=r.time,p=r.ticks,v="labels"===p.source?this.getLabelTimestamps():this._generate();"ticks"===r.bounds&&v.length&&(this.min=this._userMin||v[0],this.max=this._userMax||v[v.length-1]);const E=this.min,L=function mo(s,l,r){let u=0,p=s.length;for(;u<p&&s[u]<l;)u++;for(;p>u&&s[p-1]>r;)p--;return u>0||p<s.length?s.slice(u,p):s}(v,E,this.max);return this._unit=u.unit||(p.autoSkip?sf(u.minUnit,this.min,this.max,this._getLabelCapacity(E)):function Nf(s,l,r,u,p){for(let v=Ga.length-1;v>=Ga.indexOf(r);v--){const E=Ga[v];if(Eu[E].common&&s._adapter.diff(p,u,E)>=l-1)return E}return Ga[r?Ga.indexOf(r):0]}(this,L.length,u.minUnit,this.min,this.max)),this._majorUnit=p.major.enabled&&"year"!==this._unit?function mp(s){for(let l=Ga.indexOf(s)+1,r=Ga.length;l<r;++l)if(Eu[Ga[l]].common)return Ga[l]}(this._unit):void 0,this.initOffsets(v),r.reverse&&L.reverse(),kf(this,L,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(r=>+r.value))}initOffsets(r=[]){let v,E,u=0,p=0;this.options.offset&&r.length&&(v=this.getDecimalForValue(r[0]),u=1===r.length?1-v:(this.getDecimalForValue(r[1])-v)/2,E=this.getDecimalForValue(r[r.length-1]),p=1===r.length?E:(E-this.getDecimalForValue(r[r.length-2]))/2);const I=r.length<3?.5:.25;u=Ki(u,0,I),p=Ki(p,0,I),this._offsets={start:u,end:p,factor:1/(u+1+p)}}_generate(){const r=this._adapter,u=this.min,p=this.max,v=this.options,E=v.time,I=E.unit||sf(E.minUnit,u,p,this._getLabelCapacity(u)),L=Kn(v.ticks.stepSize,1),H="week"===I&&E.isoWeekday,Q=Oe(H)||!0===H,pe={};let Re,qe,Me=u;if(Q&&(Me=+r.startOf(Me,"isoWeek",H)),Me=+r.startOf(Me,Q?"day":I),r.diff(p,u,I)>1e5*L)throw new Error(u+" and "+p+" are too far apart with stepSize of "+L+" "+I);const Qe="data"===v.ticks.source&&this.getDataTimestamps();for(Re=Me,qe=0;Re<p;Re=+r.add(Re,L,I),qe++)uh(pe,Re,Qe);return(Re===p||"ticks"===v.bounds||1===qe)&&uh(pe,Re,Qe),Object.keys(pe).sort((rt,jt)=>rt-jt).map(rt=>+rt)}getLabelForValue(r){const p=this.options.time;return this._adapter.format(r,p.tooltipFormat?p.tooltipFormat:p.displayFormats.datetime)}format(r,u){return this._adapter.format(r,u||this.options.time.displayFormats[this._unit])}_tickFormatFunction(r,u,p,v){const E=this.options,I=E.ticks.callback;if(I)return On(I,[r,u,p],this);const L=E.time.displayFormats,H=this._unit,Q=this._majorUnit,Me=Q&&L[Q],Re=p[u];return this._adapter.format(r,v||(Q&&Me&&Re&&Re.major?Me:H&&L[H]))}generateTickLabels(r){let u,p,v;for(u=0,p=r.length;u<p;++u)v=r[u],v.label=this._tickFormatFunction(v.value,u,r)}getDecimalForValue(r){return null===r?NaN:(r-this.min)/(this.max-this.min)}getPixelForValue(r){const u=this._offsets,p=this.getDecimalForValue(r);return this.getPixelForDecimal((u.start+p)*u.factor)}getValueForPixel(r){const u=this._offsets,p=this.getDecimalForPixel(r)/u.factor-u.end;return this.min+p*(this.max-this.min)}_getLabelSize(r){const u=this.options.ticks,p=this.ctx.measureText(r).width,v=tn(this.isHorizontal()?u.maxRotation:u.minRotation),E=Math.cos(v),I=Math.sin(v),L=this._resolveTickFontOptions(0).size;return{w:p*E+L*I,h:p*I+L*E}}_getLabelCapacity(r){const u=this.options.time,p=u.displayFormats,v=p[u.unit]||p.millisecond,E=this._tickFormatFunction(r,0,kf(this,[r],this._majorUnit),v),I=this._getLabelSize(E),L=Math.floor(this.isHorizontal()?this.width/I.w:this.height/I.h)-1;return L>0?L:1}getDataTimestamps(){let u,p,r=this._cache.data||[];if(r.length)return r;const v=this.getMatchingVisibleMetas();if(this._normalized&&v.length)return this._cache.data=v[0].controller.getAllParsedValues(this);for(u=0,p=v.length;u<p;++u)r=r.concat(v[u].controller.getAllParsedValues(this));return this._cache.data=this.normalize(r)}getLabelTimestamps(){const r=this._cache.labels||[];let u,p;if(r.length)return r;const v=this.getLabels();for(u=0,p=v.length;u<p;++u)r.push(Od(this,v[u]));return this._cache.labels=this._normalized?r:this.normalize(r)}normalize(r){return ds(r.sort(Tu))}}return Ze(s,"id","time"),Ze(s,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}}),s})();function A(s,l,r){let v,E,I,L,u=0,p=s.length-1;r?(l>=s[u].pos&&l<=s[p].pos&&({lo:u,hi:p}=hi(s,"pos",l)),({pos:v,time:I}=s[u]),({pos:E,time:L}=s[p])):(l>=s[u].time&&l<=s[p].time&&({lo:u,hi:p}=hi(s,"time",l)),({time:v,pos:I}=s[u]),({time:E,pos:L}=s[p]));const H=E-v;return H?I+(L-I)*(l-v)/H:I}class f extends b{constructor(l){super(l),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const l=this._getTimestampsForTable(),r=this._table=this.buildLookupTable(l);this._minPos=A(r,this.min),this._tableRange=A(r,this.max)-this._minPos,super.initOffsets(l)}buildLookupTable(l){const{min:r,max:u}=this,p=[],v=[];let E,I,L,H,Q;for(E=0,I=l.length;E<I;++E)H=l[E],H>=r&&H<=u&&p.push(H);if(p.length<2)return[{time:r,pos:0},{time:u,pos:1}];for(E=0,I=p.length;E<I;++E)Q=p[E+1],L=p[E-1],H=p[E],Math.round((Q+L)/2)!==H&&v.push({time:H,pos:E/(I-1)});return v}_getTimestampsForTable(){let l=this._cache.all||[];if(l.length)return l;const r=this.getDataTimestamps(),u=this.getLabelTimestamps();return l=r.length&&u.length?this.normalize(r.concat(u)):r.length?r:u,l=this._cache.all=l,l}getDecimalForValue(l){return(A(this._table,l)-this._minPos)/this._tableRange}getValueForPixel(l){const r=this._offsets,u=this.getDecimalForPixel(l)/r.factor-r.end;return A(this._table,u*this._tableRange+this._minPos,!0)}}Ze(f,"id","timeseries"),Ze(f,"defaults",b.defaults);const U=[za,Ph,ic,Object.freeze({__proto__:null,CategoryScale:Ec,LinearScale:ah,LogarithmicScale:Ku,RadialLinearScale:Id,TimeScale:b,TimeSeriesScale:f})];var te=_e(3997);const Dt=function ot(s,l){return s===l||s!=s&&l!=l},zn=function Rt(s,l){for(var r=s.length;r--;)if(Dt(s[r][0],l))return r;return-1};var Wn=Array.prototype.splice;function Qi(s){var l=-1,r=null==s?0:s.length;for(this.clear();++l<r;){var u=s[l];this.set(u[0],u[1])}}Qi.prototype.clear=function Fe(){this.__data__=[],this.size=0},Qi.prototype.delete=function Tr(s){var l=this.__data__,r=zn(l,s);return!(r<0||(r==l.length-1?l.pop():Wn.call(l,r,1),--this.size,0))},Qi.prototype.get=function Ji(s){var l=this.__data__,r=zn(l,s);return r<0?void 0:l[r][1]},Qi.prototype.has=function Gi(s){return zn(this.__data__,s)>-1},Qi.prototype.set=function hr(s,l){var r=this.__data__,u=zn(r,s);return u<0?(++this.size,r.push([s,l])):r[u][1]=l,this};const go=Qi,nl="object"==typeof global&&global&&global.Object===Object&&global;var Su="object"==typeof self&&self&&self.Object===Object&&self;const wa=nl||Su||Function("return this")();var af=wa.Symbol,Pd=Object.prototype,ko=Pd.hasOwnProperty,il=Pd.toString,zl=af?af.toStringTag:void 0;var Ff=Object.prototype.toString;var cf=af?af.toStringTag:void 0;const wr=function Mu(s){return null==s?void 0===s?"[object Undefined]":"[object Null]":cf&&cf in Object(s)?function Ju(s){var l=ko.call(s,zl),r=s[zl];try{s[zl]=void 0;var u=!0}catch{}var p=il.call(s);return u&&(l?s[zl]=r:delete s[zl]),p}(s):function dh(s){return Ff.call(s)}(s)},Ac=function Au(s){var l=typeof s;return null!=s&&("object"==l||"function"==l)},Iu=function Qu(s){if(!Ac(s))return!1;var l=wr(s);return"[object Function]"==l||"[object GeneratorFunction]"==l||"[object AsyncFunction]"==l||"[object Proxy]"==l};var s,ph=wa["__core-js_shared__"],t=(s=/[^.]+$/.exec(ph&&ph.keys&&ph.keys.IE_PROTO||""))?"Symbol(src)_1."+s:"";var M=Function.prototype.toString;var ee=/^\[object .+?Constructor\]$/,Te=RegExp("^"+Function.prototype.toString.call(Object.prototype.hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const Ue=function je(s){return!(!Ac(s)||function c(s){return!!t&&t in s}(s))&&(Iu(s)?Te:ee).test(function P(s){if(null!=s){try{return M.call(s)}catch{}try{return s+""}catch{}}return""}(s))},Ct=function Je(s,l){var r=function it(s,l){return s?.[l]}(s,l);return Ue(r)?r:void 0},Xt=Ct(wa,"Map"),ei=Ct(Object,"create");var xi=Object.prototype.hasOwnProperty;var Fo=Object.prototype.hasOwnProperty;function Lo(s){var l=-1,r=null==s?0:s.length;for(this.clear();++l<r;){var u=s[l];this.set(u[0],u[1])}}Lo.prototype.clear=function $n(){this.__data__=ei?ei(null):{},this.size=0},Lo.prototype.delete=function In(s){var l=this.has(s)&&delete this.__data__[s];return this.size-=l?1:0,l},Lo.prototype.get=function _i(s){var l=this.__data__;if(ei){var r=l[s];return"__lodash_hash_undefined__"===r?void 0:r}return xi.call(l,s)?l[s]:void 0},Lo.prototype.has=function ss(s){var l=this.__data__;return ei?void 0!==l[s]:Fo.call(l,s)},Lo.prototype.set=function Qo(s,l){var r=this.__data__;return this.size+=this.has(s)?0:1,r[s]=ei&&void 0===l?"__lodash_hash_undefined__":l,this};const Ns=Lo,Hs=function ol(s,l){var r=s.__data__;return function Us(s){var l=typeof s;return"string"==l||"number"==l||"symbol"==l||"boolean"==l?"__proto__"!==s:null===s}(l)?r["string"==typeof l?"string":"hash"]:r.map};function al(s){var l=-1,r=null==s?0:s.length;for(this.clear();++l<r;){var u=s[l];this.set(u[0],u[1])}}al.prototype.clear=function Ks(){this.size=0,this.__data__={hash:new Ns,map:new(Xt||go),string:new Ns}},al.prototype.delete=function Da(s){var l=Hs(this,s).delete(s);return this.size-=l?1:0,l},al.prototype.get=function ca(s){return Hs(this,s).get(s)},al.prototype.has=function sl(s){return Hs(this,s).has(s)},al.prototype.set=function Ca(s,l){var r=Hs(this,s),u=r.size;return r.set(s,l),this.size+=r.size==u?0:1,this};const Ic=al;function Rs(s){var l=this.__data__=new go(s);this.size=l.size}Rs.prototype.clear=function Ao(){this.__data__=new go,this.size=0},Rs.prototype.delete=function Jo(s){var l=this.__data__,r=l.delete(s);return this.size=l.size,r},Rs.prototype.get=function rc(s){return this.__data__.get(s)},Rs.prototype.has=function tl(s){return this.__data__.has(s)},Rs.prototype.set=function wl(s,l){var r=this.__data__;if(r instanceof go){var u=r.__data__;if(!Xt||u.length<199)return u.push([s,l]),this.size=++r.size,this;r=this.__data__=new Ic(u)}return r.set(s,l),this.size=r.size,this};const Pc=Rs;var ed=function(){try{var s=Ct(Object,"defineProperty");return s({},"",{}),s}catch{}}();const uf=ed,df=function Bf(s,l,r){"__proto__"==l&&uf?uf(s,l,{configurable:!0,enumerable:!0,value:r,writable:!0}):s[l]=r},yp=function su(s,l,r){(void 0!==r&&!Dt(s[l],r)||void 0===r&&!(l in s))&&df(s,l,r)};var jp=function vp(s){return function(l,r,u){for(var p=-1,v=Object(l),E=u(l),I=E.length;I--;){var L=E[s?I:++p];if(!1===r(v[L],L,v))break}return l}}();const gh=jp;var mh="object"==typeof exports&&exports&&!exports.nodeType&&exports,Hp=mh&&"object"==typeof module&&module&&!module.nodeType&&module,Gp=Hp&&Hp.exports===mh?wa.Buffer:void 0,Wp=Gp?Gp.allocUnsafe:void 0;const Nd=wa.Uint8Array,Rd=function Ou(s,l){var r=l?function _h(s){var l=new s.constructor(s.byteLength);return new Nd(l).set(new Nd(s)),l}(s.buffer):s.buffer;return new s.constructor(r,s.byteOffset,s.length)};var Pu=Object.create,im=function(){function s(){}return function(l){if(!Ac(l))return{};if(Pu)return Pu(l);s.prototype=l;var r=new s;return s.prototype=void 0,r}}();const p_=im;var m_=function g_(s,l){return function(r){return s(l(r))}}(Object.getPrototypeOf,Object);const rm=m_;var __=Object.prototype;const pf=function om(s){var l=s&&s.constructor;return s===("function"==typeof l&&l.prototype||__)},bp=function gv(s){return null!=s&&"object"==typeof s},vg=function _v(s){return bp(s)&&"[object Arguments]"==wr(s)};var bg=Object.prototype,yv=bg.hasOwnProperty,am=bg.propertyIsEnumerable,Yp=vg(function(){return arguments}())?vg:function(s){return bp(s)&&yv.call(s,"callee")&&!am.call(s,"callee")};const qp=Yp,Kp=Array.isArray,xg=function cm(s){return"number"==typeof s&&s>-1&&s%1==0&&s<=9007199254740991},wg=function vv(s){return null!=s&&xg(s.length)&&!Iu(s)};var hm="object"==typeof exports&&exports&&!exports.nodeType&&exports,Dg=hm&&"object"==typeof module&&module&&!module.nodeType&&module,fm=Dg&&Dg.exports===hm?wa.Buffer:void 0;const Cg=(fm?fm.isBuffer:void 0)||function v_(){return!1};var mm=Function.prototype.toString,Xp=Object.prototype.hasOwnProperty,Vf=mm.call(Object);var ls={};ls["[object Float32Array]"]=ls["[object Float64Array]"]=ls["[object Int8Array]"]=ls["[object Int16Array]"]=ls["[object Int32Array]"]=ls["[object Uint8Array]"]=ls["[object Uint8ClampedArray]"]=ls["[object Uint16Array]"]=ls["[object Uint32Array]"]=!0,ls["[object Arguments]"]=ls["[object Array]"]=ls["[object ArrayBuffer]"]=ls["[object Boolean]"]=ls["[object DataView]"]=ls["[object Date]"]=ls["[object Error]"]=ls["[object Function]"]=ls["[object Map]"]=ls["[object Number]"]=ls["[object Object]"]=ls["[object RegExp]"]=ls["[object Set]"]=ls["[object String]"]=ls["[object WeakMap]"]=!1;var Cm="object"==typeof exports&&exports&&!exports.nodeType&&exports,gf=Cm&&"object"==typeof module&&module&&!module.nodeType&&module,Og=gf&&gf.exports===Cm&&nl.process,F_=function(){try{return gf&&gf.require&&gf.require("util").types||Og&&Og.binding&&Og.binding("util")}catch{}}(),Tm=F_&&F_.isTypedArray;const Jp=Tm?function Dm(s){return function(l){return s(l)}}(Tm):function P_(s){return bp(s)&&xg(s.length)&&!!ls[wr(s)]},Qp=function L_(s,l){if(("constructor"!==l||"function"!=typeof s[l])&&"__proto__"!=l)return s[l]};var Sm=Object.prototype.hasOwnProperty;const eg=function Mm(s,l,r){var u=s[l];(!Sm.call(s,l)||!Dt(u,r)||void 0===r&&!(l in s))&&df(s,l,r)};var Pm=/^(?:0|[1-9]\d*)$/;const nd=function Ng(s,l){var r=typeof s;return!!(l=l??9007199254740991)&&("number"==r||"symbol"!=r&&Pm.test(s))&&s>-1&&s%1==0&&s<l};var V_=Object.prototype.hasOwnProperty;const U_=function Rg(s,l){var r=Kp(s),u=!r&&qp(s),p=!r&&!u&&Cg(s),v=!r&&!u&&!p&&Jp(s),E=r||u||p||v,I=E?function Am(s,l){for(var r=-1,u=Array(s);++r<s;)u[r]=l(r);return u}(s.length,String):[],L=I.length;for(var H in s)(l||V_.call(s,H))&&(!E||!("length"==H||p&&("offset"==H||"parent"==H)||v&&("buffer"==H||"byteLength"==H||"byteOffset"==H)||nd(H,L)))&&I.push(H);return I};var Nm=Object.prototype.hasOwnProperty;const tg=function $_(s){if(!Ac(s))return function j_(s){var l=[];if(null!=s)for(var r in Object(s))l.push(r);return l}(s);var l=pf(s),r=[];for(var u in s)"constructor"==u&&(l||!Nm.call(s,u))||r.push(u);return r},Dp=function wp(s){return wg(s)?U_(s,!0):tg(s)},G_=function Cv(s){return function Pg(s,l,r,u){var p=!r;r||(r={});for(var v=-1,E=l.length;++v<E;){var I=l[v],L=u?u(r[I],s[I],I,r,s):void 0;void 0===L&&(L=s[I]),p?df(r,I,L):eg(r,I,L)}return r}(s,Dp(s))},km=function Rm(s,l,r,u,p,v,E){var I=Qp(s,r),L=Qp(l,r),H=E.get(L);if(H)yp(s,r,H);else{var Q=v?v(I,L,r+"",s,l,E):void 0,pe=void 0===Q;if(pe){var Me=Kp(L),Re=!Me&&Cg(L),qe=!Me&&!Re&&Jp(L);Q=L,Me||Re||qe?Kp(I)?Q=I:function um(s){return bp(s)&&wg(s)}(I)?Q=function au(s,l){var r=-1,u=s.length;for(l||(l=Array(u));++r<u;)l[r]=s[r];return l}(I):Re?(pe=!1,Q=function yg(s,l){if(l)return s.slice();var r=s.length,u=Wp?Wp(r):new s.constructor(r);return s.copy(u),u}(L,!0)):qe?(pe=!1,Q=Rd(L,!0)):Q=[]:function Eg(s){if(!bp(s)||"[object Object]"!=wr(s))return!1;var l=rm(s);if(null===l)return!0;var r=Xp.call(l,"constructor")&&l.constructor;return"function"==typeof r&&r instanceof r&&mm.call(r)==Vf}(L)||qp(L)?(Q=I,qp(I)?Q=G_(I):(!Ac(I)||Iu(I))&&(Q=function kd(s){return"function"!=typeof s.constructor||pf(s)?{}:p_(rm(s))}(L))):pe=!1}pe&&(E.set(L,Q),p(Q,L,u,v,E),E.delete(L)),yp(s,r,Q)}},W_=function Fm(s,l,r,u,p){s!==l&&gh(l,function(v,E){if(p||(p=new Pc),Ac(v))km(s,l,E,r,Fm,u,p);else{var I=u?u(Qp(s,E),v,E+"",s,l,p):void 0;void 0===I&&(I=v),yp(s,E,I)}},Dp)},kg=function Lm(s){return s};var Fg=Math.max;const Ep=function q_(s){return function(){return s}};var K_=uf?function(s,l){return uf(s,"toString",{configurable:!0,enumerable:!1,value:Ep(l),writable:!0})}:kg,Q_=Date.now,ty=function ey(s){var l=0,r=0;return function(){var u=Q_(),p=16-(u-r);if(r=u,p>0){if(++l>=800)return arguments[0]}else l=0;return s.apply(void 0,arguments)}}(K_);const ny=ty,Lg=function zm(s,l){return ny(function Bm(s,l,r){return l=Fg(void 0===l?s.length-1:l,0),function(){for(var u=arguments,p=-1,v=Fg(u.length-l,0),E=Array(v);++p<v;)E[p]=u[l+p];p=-1;for(var I=Array(l+1);++p<l;)I[p]=u[p];return I[l]=r(E),function Cp(s,l,r){switch(r.length){case 0:return s.call(l);case 1:return s.call(l,r[0]);case 2:return s.call(l,r[0],r[1]);case 3:return s.call(l,r[0],r[1],r[2])}return s.apply(l,r)}(s,this,I)}}(s,l,kg),s+"")};var oy=function ry(s){return Lg(function(l,r){var u=-1,p=r.length,v=p>1?r[p-1]:void 0,E=p>2?r[2]:void 0;for(v=s.length>3&&"function"==typeof v?(p--,v):void 0,E&&function iy(s,l,r){if(!Ac(r))return!1;var u=typeof l;return!!("number"==u?wg(r)&&nd(l,r.length):"string"==u&&l in r)&&Dt(r[l],s)}(r[0],r[1],E)&&(v=p<3?void 0:v,p=1),l=Object(l);++u<p;){var I=r[u];I&&s(l,I,u,v)}return l})}(function(s,l,r){W_(s,l,r)});const Vm=oy;var sy=_e(5619);let ay=(()=>{class s{constructor(){this.colorschemesOptions=new sy.X(void 0)}setColorschemesOptions(r){this.pColorschemesOptions=r,this.colorschemesOptions.next(r)}getColorschemesOptions(){return this.pColorschemesOptions}}return s.\u0275fac=function(r){return new(r||s)},s.\u0275prov=ge.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Nu=(()=>{class s{constructor(r,u,p){this.zone=u,this.themeService=p,this.type="bar",this.plugins=[],this.chartClick=new ge.vpe,this.chartHover=new ge.vpe,this.subs=[],this.themeOverrides={},this.ctx=r.nativeElement.getContext("2d"),this.subs.push(this.themeService.colorschemesOptions.pipe((0,te.x)()).subscribe(v=>this.themeChanged(v)))}ngOnChanges(r){const u=["type"],p=Object.getOwnPropertyNames(r);if(p.some(v=>u.includes(v))||p.every(v=>r[v].isFirstChange()))this.render();else{const v=this.getChartConfiguration();this.chart&&(Object.assign(this.chart.config.data,v.data),this.chart.config.plugins&&Object.assign(this.chart.config.plugins,v.plugins),this.chart.config.options&&Object.assign(this.chart.config.options,v.options)),this.update()}}ngOnDestroy(){this.chart&&(this.chart.destroy(),this.chart=void 0),this.subs.forEach(r=>r.unsubscribe())}render(){return this.chart&&this.chart.destroy(),this.zone.runOutsideAngular(()=>this.chart=new el(this.ctx,this.getChartConfiguration()))}update(r){this.chart&&this.zone.runOutsideAngular(()=>this.chart?.update(r))}hideDataset(r,u){this.chart&&(this.chart.getDatasetMeta(r).hidden=u,this.update())}isDatasetHidden(r){return this.chart?.getDatasetMeta(r)?.hidden}toBase64Image(){return this.chart?.toBase64Image()}themeChanged(r){this.themeOverrides=r,this.chart&&(this.chart.config.options&&Object.assign(this.chart.config.options,this.getChartOptions()),this.update())}getChartOptions(){return Vm({onHover:(r,u)=>{!this.chartHover.observed&&!this.chartHover.observers?.length||this.zone.run(()=>this.chartHover.emit({event:r,active:u}))},onClick:(r,u)=>{!this.chartClick.observed&&!this.chartClick.observers?.length||this.zone.run(()=>this.chartClick.emit({event:r,active:u}))}},this.themeOverrides,this.options,{plugins:{legend:{display:this.legend}}})}getChartConfiguration(){return{type:this.type,data:this.getChartData(),options:this.getChartOptions(),plugins:this.plugins}}getChartData(){return this.data?this.data:{labels:this.labels||[],datasets:this.datasets||[]}}}return s.\u0275fac=function(r){return new(r||s)(ge.Y36(ge.SBq),ge.Y36(ge.R0b),ge.Y36(ay))},s.\u0275dir=ge.lG2({type:s,selectors:[["canvas","baseChart",""]],inputs:{type:"type",legend:"legend",data:"data",options:"options",plugins:"plugins",labels:"labels",datasets:"datasets"},outputs:{chartClick:"chartClick",chartHover:"chartHover"},exportAs:["base-chart"],features:[ge.TTD]}),s})();const Um=[[255,99,132],[54,162,235],[255,206,86],[231,233,237],[75,192,192],[151,187,205],[220,220,220],[247,70,74],[70,191,189],[253,180,92],[148,159,177],[77,83,96]],jm={plugins:{colors:{enabled:!1}},datasets:{line:{backgroundColor:s=>vh(Fd(s.datasetIndex),.4),borderColor:s=>vh(Fd(s.datasetIndex),1),pointBackgroundColor:s=>vh(Fd(s.datasetIndex),1),pointBorderColor:"#fff"},bar:{backgroundColor:s=>vh(Fd(s.datasetIndex),.6),borderColor:s=>vh(Fd(s.datasetIndex),1)},get radar(){return this.line},doughnut:{backgroundColor:s=>vh(Fd(s.dataIndex),.6),borderColor:"#fff"},get pie(){return this.doughnut},polarArea:{backgroundColor:s=>vh(Fd(s.dataIndex),.6),borderColor:s=>vh(Fd(s.dataIndex),1)},get bubble(){return this.doughnut},get scatter(){return this.doughnut},get area(){return this.polarArea}}};function vh(s,l){return"rgba("+s.concat(l).join(",")+")"}function Hm(s,l){return Math.floor(Math.random()*(l-s+1))+s}function Fd(s=0){return Um[s]||function $m(){return[Hm(0,255),Hm(0,255),Hm(0,255)]}()}let ly=(()=>{class s{constructor(){this.generateColors=!0}}return s.\u0275fac=function(r){return new(r||s)},s.\u0275prov=ge.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();el.register(...U);let ig=(()=>{class s{constructor(r){r?.plugins&&el.register(...r?.plugins);const u=Vm(r?.generateColors?jm:{},r?.defaults||{});$i.set(u)}static forRoot(r){return{ngModule:s,providers:[{provide:ly,useValue:r}]}}}return s.\u0275fac=function(r){return new(r||s)(ge.LFG(ly,8))},s.\u0275mod=ge.oAB({type:s}),s.\u0275inj=ge.cJS({}),s})();var Gm=function(){if(typeof window<"u"){if(window.devicePixelRatio)return window.devicePixelRatio;var s=window.screen;if(s)return(s.deviceXDPI||1)/(s.logicalXDPI||1)}return 1}(),Tp_textSize=function(s,l,r){var I,u=[].concat(l),p=u.length,v=s.font,E=0;for(s.font=r.string,I=0;I<p;++I)E=Math.max(s.measureText(u[I]).width,E);return s.font=v,{height:p*r.lineHeight,width:E}};function Sp(s,l){var r=l.x,u=l.y;if(null===r)return{x:0,y:-1};if(null===u)return{x:1,y:0};var p=s.x-r,v=s.y-u,E=Math.sqrt(p*p+v*v);return{x:E?p/E:0,y:E?v/E:-1}}var id=0,Uf=1,ll=2,bh=4,Mp=8;function Ul(s,l,r){var u=id;return s<r.left?u|=Uf:s>r.right&&(u|=ll),l<r.top?u|=Mp:l>r.bottom&&(u|=bh),u}function Ld(s,l){var p,v,r=l.anchor,u=s;return l.clamp&&(u=function Bg(s,l){for(var L,H,Q,r=s.x0,u=s.y0,p=s.x1,v=s.y1,E=Ul(r,u,l),I=Ul(p,v,l);E|I&&!(E&I);)(L=E||I)&Mp?(H=r+(p-r)*(l.top-u)/(v-u),Q=l.top):L&bh?(H=r+(p-r)*(l.bottom-u)/(v-u),Q=l.bottom):L&ll?(Q=u+(v-u)*(l.right-r)/(p-r),H=l.right):L&Uf&&(Q=u+(v-u)*(l.left-r)/(p-r),H=l.left),L===E?E=Ul(r=H,u=Q,l):I=Ul(p=H,v=Q,l);return{x0:r,x1:p,y0:u,y1:v}}(u,l.area)),"start"===r?(p=u.x0,v=u.y0):"end"===r?(p=u.x1,v=u.y1):(p=(u.x0+u.x1)/2,v=(u.y0+u.y1)/2),function cy(s,l,r,u,p){switch(p){case"center":r=u=0;break;case"bottom":r=0,u=1;break;case"right":r=1,u=0;break;case"left":r=-1,u=0;break;case"top":r=0,u=-1;break;case"start":r=-r,u=-u;break;case"end":break;default:p*=Math.PI/180,r=Math.cos(p),u=Math.sin(p)}return{x:s,y:l,vx:r,vy:u}}(p,v,s.vx,s.vy,l.align)}var Bd={arc:function(s,l){var r=(s.startAngle+s.endAngle)/2,u=Math.cos(r),p=Math.sin(r),v=s.innerRadius,E=s.outerRadius;return Ld({x0:s.x+u*v,y0:s.y+p*v,x1:s.x+u*E,y1:s.y+p*E,vx:u,vy:p},l)},point:function(s,l){var r=Sp(s,l.origin),u=r.x*s.options.radius,p=r.y*s.options.radius;return Ld({x0:s.x-u,y0:s.y-p,x1:s.x+u,y1:s.y+p,vx:r.x,vy:r.y},l)},bar:function(s,l){var r=Sp(s,l.origin),u=s.x,p=s.y,v=0,E=0;return s.horizontal?(u=Math.min(s.x,s.base),v=Math.abs(s.base-s.x)):(p=Math.min(s.y,s.base),E=Math.abs(s.base-s.y)),Ld({x0:u,y0:p+E,x1:u+v,y1:p,vx:r.x,vy:r.y},l)},fallback:function(s,l){var r=Sp(s,l.origin);return Ld({x0:s.x,y0:s.y,x1:s.x+(s.width||0),y1:s.y+(s.height||0),vx:r.x,vy:r.y},l)}},cc=function(s){return Math.round(s*Gm)/Gm};function Hf(s,l){var r=l.chart.getDatasetMeta(l.datasetIndex).vScale;if(!r)return null;if(void 0!==r.xCenter&&void 0!==r.yCenter)return{x:r.xCenter,y:r.yCenter};var u=r.getBasePixel();return s.horizontal?{x:u,y:null}:{x:null,y:u}}function $f(s){return s instanceof bc?Bd.arc:s instanceof gd?Bd.point:s instanceof ju?Bd.bar:Bd.fallback}function Wm(s,l,r){var u=s.shadowBlur,p=r.stroked,v=cc(r.x),E=cc(r.y),I=cc(r.w);p&&s.strokeText(l,v,E,I),r.filled&&(u&&p&&(s.shadowBlur=0),s.fillText(l,v,E,I),u&&p&&(s.shadowBlur=u))}var zg=function(s,l,r,u){var p=this;p._config=s,p._index=u,p._model=null,p._rects=null,p._ctx=l,p._el=r};Lr(zg.prototype,{_modelize:function(s,l,r,u){var p=this,v=p._index,E=Er(or([r.font,{}],u,v)),I=or([r.color,$i.color],u,v);return{align:or([r.align,"center"],u,v),anchor:or([r.anchor,"center"],u,v),area:u.chart.chartArea,backgroundColor:or([r.backgroundColor,null],u,v),borderColor:or([r.borderColor,null],u,v),borderRadius:or([r.borderRadius,0],u,v),borderWidth:or([r.borderWidth,0],u,v),clamp:or([r.clamp,!1],u,v),clip:or([r.clip,!1],u,v),color:I,display:s,font:E,lines:l,offset:or([r.offset,4],u,v),opacity:or([r.opacity,1],u,v),origin:Hf(p._el,u),padding:Nr(or([r.padding,4],u,v)),positioner:$f(p._el),rotation:or([r.rotation,0],u,v)*(Math.PI/180),size:Tp_textSize(p._ctx,l,E),textAlign:or([r.textAlign,"start"],u,v),textShadowBlur:or([r.textShadowBlur,0],u,v),textShadowColor:or([r.textShadowColor,I],u,v),textStrokeColor:or([r.textStrokeColor,I],u,v),textStrokeWidth:or([r.textStrokeWidth,0],u,v)}},update:function(s){var E,I,L,l=this,r=null,u=null,p=l._index,v=l._config,H=or([v.display,!0],s,p);H&&(L=Yt(I=Kn(On(v.formatter,[E=s.dataset.data[p],s]),E))?[]:function(s){var r,l=[];for(s=[].concat(s);s.length;)"string"==typeof(r=s.pop())?l.unshift.apply(l,r.split("\n")):Array.isArray(r)?s.push.apply(s,r):Yt(s)||l.unshift(""+r);return l}(I)).length&&(u=function jf(s){var l=s.borderWidth||0,r=s.padding,u=s.size.height,p=s.size.width,v=-p/2,E=-u/2;return{frame:{x:v-r.left-l,y:E-r.top-l,w:p+r.width+2*l,h:u+r.height+2*l},text:{x:v,y:E,w:p,h:u}}}(r=l._modelize(H,L,v,s))),l._model=r,l._rects=u},geometry:function(){return this._rects?this._rects.frame:{}},rotation:function(){return this._model?this._model.rotation:0},visible:function(){return this._model&&this._model.opacity},model:function(){return this._model},draw:function(s,l){var E,u=s.ctx,p=this._model,v=this._rects;this.visible()&&(u.save(),p.clip&&(E=p.area,u.beginPath(),u.rect(E.left,E.top,E.right-E.left,E.bottom-E.top),u.clip()),u.globalAlpha=function(s,l,r){return Math.max(s,Math.min(l,r))}(0,p.opacity,1),u.translate(cc(l.x),cc(l.y)),u.rotate(p.rotation),function Wf(s,l,r){var u=r.backgroundColor,p=r.borderColor,v=r.borderWidth;!u&&(!p||!v)||(s.beginPath(),function Gf(s,l,r,u,p,v){var E=Math.PI/2;if(v){var I=Math.min(v,p/2,u/2),L=l+I,H=r+I,Q=l+u-I,pe=r+p-I;s.moveTo(l,H),L<Q&&H<pe?(s.arc(L,H,I,-Math.PI,-E),s.arc(Q,H,I,-E,0),s.arc(Q,pe,I,0,E),s.arc(L,pe,I,E,Math.PI)):L<Q?(s.moveTo(L,r),s.arc(Q,H,I,-E,E),s.arc(L,H,I,E,Math.PI+E)):H<pe?(s.arc(L,H,I,-Math.PI,0),s.arc(L,pe,I,0,Math.PI)):s.arc(L,H,I,-Math.PI,Math.PI),s.closePath(),s.moveTo(l,r)}else s.rect(l,r,u,p)}(s,cc(l.x)+v/2,cc(l.y)+v/2,cc(l.w)-v,cc(l.h)-v,r.borderRadius),s.closePath(),u&&(s.fillStyle=u,s.fill()),p&&v&&(s.strokeStyle=p,s.lineWidth=v,s.lineJoin="miter",s.stroke()))}(u,v.frame,p),function Zm(s,l,r,u){var Me,p=u.textAlign,v=u.color,E=!!v,I=u.font,L=l.length,H=u.textStrokeColor,Q=u.textStrokeWidth,pe=H&&Q;if(L&&(E||pe))for(r=function Zf(s,l,r){var u=r.lineHeight,p=s.w,v=s.x;return"center"===l?v+=p/2:("end"===l||"right"===l)&&(v+=p),{h:u,w:p,x:v,y:s.y+u/2}}(r,p,I),s.font=I.string,s.textAlign=p,s.textBaseline="middle",s.shadowBlur=u.textShadowBlur,s.shadowColor=u.textShadowColor,E&&(s.fillStyle=v),pe&&(s.lineJoin="round",s.lineWidth=Q,s.strokeStyle=H),Me=0,L=l.length;Me<L;++Me)Wm(s,l[Me],{stroked:pe,filled:E,w:r.w,x:r.x,y:r.y+r.h*Me})}(u,p.lines,v.text,p),u.restore())}});var Ym=Number.MIN_SAFE_INTEGER||-9007199254740991,qm=Number.MAX_SAFE_INTEGER||9007199254740991;function Yf(s,l,r){var u=Math.cos(r),p=Math.sin(r),v=l.x,E=l.y;return{x:v+u*(s.x-v)-p*(s.y-E),y:E+p*(s.x-v)+u*(s.y-E)}}function Vg(s,l){var v,E,H,r=qm,u=Ym,p=l.origin;for(v=0;v<s.length;++v)H=l.vx*((E=s[v]).x-p.x)+l.vy*(E.y-p.y),r=Math.min(r,H),u=Math.max(u,H);return{min:r,max:u}}function Ap(s,l){var r=l.x-s.x,u=l.y-s.y,p=Math.sqrt(r*r+u*u);return{vx:(l.x-s.x)/p,vy:(l.y-s.y)/p,origin:s,ln:p}}var Ug=function(){this._rotation=0,this._rect={x:0,y:0,w:0,h:0}};function rg(s,l,r){var u=l.positioner(s,l),p=u.vx,v=u.vy;if(!p&&!v)return{x:u.x,y:u.y};var E=r.w,I=r.h,L=l.rotation,H=Math.abs(E/2*Math.cos(L))+Math.abs(I/2*Math.sin(L)),Q=Math.abs(E/2*Math.sin(L))+Math.abs(I/2*Math.cos(L)),pe=1/Math.max(Math.abs(p),Math.abs(v));return H*=p*pe,Q*=v*pe,{x:u.x+(H+=l.offset*p),y:u.y+(Q+=l.offset*v)}}Lr(Ug.prototype,{center:function(){var s=this._rect;return{x:s.x+s.w/2,y:s.y+s.h/2}},update:function(s,l,r){this._rotation=r,this._rect={x:l.x+s.x,y:l.y+s.y,w:l.w,h:l.h}},contains:function(s){var l=this,u=l._rect;return!((s=Yf(s,l.center(),-l._rotation)).x<u.x-1||s.y<u.y-1||s.x>u.x+u.w+2||s.y>u.y+u.h+2)},intersects:function(s){var p,v,E,l=this._points(),r=s._points(),u=[Ap(l[0],l[1]),Ap(l[0],l[3])];for(this._rotation!==s._rotation&&u.push(Ap(r[0],r[1]),Ap(r[0],r[3])),p=0;p<u.length;++p)if(v=Vg(l,u[p]),E=Vg(r,u[p]),v.max<E.min||E.max<v.min)return!1;return!0},_points:function(){var s=this,l=s._rect,r=s._rotation,u=s.center();return[Yf({x:l.x,y:l.y},u,r),Yf({x:l.x+l.w,y:l.y},u,r),Yf({x:l.x+l.w,y:l.y+l.h},u,r),Yf({x:l.x,y:l.y+l.h},u,r)]}});var og={prepare:function(s){var r,u,p,v,E,l=[];for(r=0,p=s.length;r<p;++r)for(u=0,v=s[r].length;u<v;++u)l.push(E=s[r][u]),E.$layout={_box:new Ug,_hidable:!1,_visible:!0,_set:r,_idx:E._index};return l.sort(function(I,L){var H=I.$layout,Q=L.$layout;return H._idx===Q._idx?Q._set-H._set:Q._idx-H._idx}),this.update(l),l},update:function(s){var r,u,p,v,E,l=!1;for(r=0,u=s.length;r<u;++r)v=(p=s[r]).model(),(E=p.$layout)._hidable=v&&"auto"===v.display,E._visible=p.visible(),l|=E._hidable;l&&function Mv(s){var l,r,u,p,v,E,I;for(l=0,r=s.length;l<r;++l)(p=(u=s[l]).$layout)._visible&&(I=new Proxy(u._el,{get:(L,H)=>L.getProps([H],!0)[H]}),v=u.geometry(),E=rg(I,u.model(),v),p._box.update(E,v,u.rotation()));(function uy(s,l){var r,u,p,v;for(r=s.length-1;r>=0;--r)for(p=s[r].$layout,u=r-1;u>=0&&p._visible;--u)(v=s[u].$layout)._visible&&p._box.intersects(v._box)&&l(p,v)})(s,function(L,H){var Q=L._hidable,pe=H._hidable;Q&&pe||pe?H._visible=!1:Q&&(L._visible=!1)})}(s)},lookup:function(s,l){var r,u;for(r=s.length-1;r>=0;--r)if((u=s[r].$layout)&&u._visible&&u._box.contains(l))return s[r];return null},draw:function(s,l){var r,u,p,v,E,I;for(r=0,u=l.length;r<u;++r)(v=(p=l[r]).$layout)._visible&&(E=p.geometry(),I=rg(p._el,p.model(),E),v._box.update(I,E,p.rotation()),p.draw(s,I))}},hy={align:"center",anchor:"center",backgroundColor:null,borderColor:null,borderRadius:0,borderWidth:0,clamp:!1,clip:!1,color:void 0,display:!0,font:{family:void 0,lineHeight:1.2,size:void 0,style:void 0,weight:null},formatter:function(s){if(Yt(s))return null;var r,u,p,l=s;if(at(s))if(Yt(s.label))if(Yt(s.r))for(l="",p=0,u=(r=Object.keys(s)).length;p<u;++p)l+=(0!==p?", ":"")+r[p]+": "+s[r[p]];else l=s.r;else l=s.label;return""+l},labels:void 0,listeners:{},offset:4,opacity:1,padding:{top:4,right:4,bottom:4,left:4},rotation:0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,textShadowBlur:0,textShadowColor:void 0},kc="$datalabels",Km="$default";function jg(s,l,r,u){if(l){var E,p=r.$context,v=r.$groups;l[v._set]&&(E=l[v._set][v._key])&&!0===On(E,[p,u])&&(s[kc]._dirty=!0,r.update(p))}}var xh={id:"datalabels",defaults:hy,beforeInit:function(s){s[kc]={_actives:[]}},beforeUpdate:function(s){var l=s[kc];l._listened=!1,l._listeners={},l._datasets=[],l._labels=[]},afterDatasetUpdate:function(s,l,r){var pe,Me,Re,qe,Qe,rt,jt,Ut,u=l.index,p=s[kc],v=p._datasets[u]=[],E=s.isDatasetVisible(u),I=s.data.datasets[u],L=function Av(s,l){var v,E,r=s.datalabels,u={},p=[];return!1===r?null:(!0===r&&(r={}),l=Lr({},[l,r]),v=l.labels||{},E=Object.keys(v),delete l.labels,E.length?E.forEach(function(I){v[I]&&p.push(Lr({},[l,v[I],{_key:I}]))}):p.push(l),u=p.reduce(function(I,L){return Qt(L.listeners||{},function(H,Q){I[Q]=I[Q]||{},I[Q][L._key||Km]=H}),delete L.listeners,I},{}),{labels:p,listeners:u})}(I,r),H=l.meta.data||[],Q=s.ctx;for(Q.save(),pe=0,Re=H.length;pe<Re;++pe)if((jt=H[pe])[kc]=[],E&&jt&&s.getDataVisibility(pe)&&!jt.skip)for(Me=0,qe=L.labels.length;Me<qe;++Me)rt=(Qe=L.labels[Me])._key,(Ut=new zg(Qe,Q,jt,pe)).$groups={_set:u,_key:rt||Km},Ut.$context={active:!1,chart:s,dataIndex:pe,dataset:I,datasetIndex:u},Ut.update(Ut.$context),jt[kc].push(Ut),v.push(Ut);Q.restore(),Lr(p._listeners,L.listeners,{merger:function(vn,Sn,fn){Sn[vn]=Sn[vn]||{},Sn[vn][l.index]=fn[vn],p._listened=!0}})},afterUpdate:function(s){s[kc]._labels=og.prepare(s[kc]._datasets)},afterDatasetsDraw:function(s){og.draw(s,s[kc]._labels)},beforeEvent:function(s,l){if(s[kc]._listened){var r=l.event;switch(r.type){case"mousemove":case"mouseout":!function py(s,l){var p,v,r=s[kc],u=r._listeners;if(u.enter||u.leave){if("mousemove"===l.type)v=og.lookup(r._labels,l);else if("mouseout"!==l.type)return;p=r._hovered,r._hovered=v,function fy(s,l,r,u,p){var v,E;!r&&!u||(r?u?r!==u&&(E=v=!0):E=!0:v=!0,E&&jg(s,l.leave,r,p),v&&jg(s,l.enter,u,p))}(s,u,p,v,l)}}(s,r);break;case"click":!function Hg(s,l){var r=s[kc],u=r._listeners.click,p=u&&og.lookup(r._labels,l);p&&jg(s,u,p,l)}(s,r)}}},afterEvent:function(s){var v,E,I,L,H,Q,pe,l=s[kc],p=function(s,l){var p,v,E,I,r=s.slice(),u=[];for(p=0,E=l.length;p<E;++p)-1===(v=r.indexOf(I=l[p]))?u.push([I,1]):r.splice(v,1);for(p=0,E=r.length;p<E;++p)u.push([r[p],-1]);return u}(l._actives,l._actives=s.getActiveElements());for(v=0,E=p.length;v<E;++v)if((H=p[v])[1])for(I=0,L=(pe=H[0].element[kc]||[]).length;I<L;++I)(Q=pe[I]).$context.active=1===H[1],Q.update(Q.$context);(l._dirty||p.length)&&(og.update(l._labels),s.render()),delete l._dirty}},$g=_e(9315),sg=_e(9862);let qf=(()=>{class s{constructor(r){this.http=r,this.staticsUrl="http://mapa-contaminantes-backend-dev.us-east-2.elasticbeanstalk.com/api/statistics"}getActivityCountCompanyStatistics(){return this.http.get(`${this.staticsUrl}/activity-count-company`)}getResidualCountActivitiesStatistics(){return this.http.get(`${this.staticsUrl}/residual-count-activity`)}getResidualCountCompaniesStatistics(){return this.http.get(`${this.staticsUrl}/residual-count-company`)}getCompaniesCountResidualsAndActivities(){return this.http.get(`${this.staticsUrl}/company-count-residual-activity`)}getAllCountCompaniesResidualsAndActivities(){return this.http.get(`${this.staticsUrl}/total-statistics`)}getCountAllCompanysActivitiesResiduals(){return this.http.get(`${this.staticsUrl}/total-all-statistics`)}}return s.\u0275fac=function(r){return new(r||s)(ge.LFG(sg.eN))},s.\u0275prov=ge.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var wh=_e(6814),Xm=_e(9729);function gy(s,l){if(1&s&&(ge.TgZ(0,"div")(1,"li",8)(2,"p",9),ge._UZ(3,"i",10),ge._uU(4),ge.qZA(),ge.TgZ(5,"p",11),ge._uU(6),ge.qZA()()()),2&s){const r=l.$implicit;ge.xp6(4),ge.hij("C\xf3digo CIIU: ",r.code,""),ge.xp6(2),ge.Oqu(r.name)}}let Ip=(()=>{class s{constructor(r){this.stattisticsService=r,this.data=[],this.codes=[],this.counts=[],this.barChartOptions={responsive:!0,scales:{x:{},y:{}},plugins:{legend:{display:!0},datalabels:{anchor:"end",align:"bottom"}},backgroundColor:"#9eeaf9"},this.barChartType="bar",this.barChartPlugins=[xh],this.barChartData={labels:[],datasets:[{data:[],label:"Cantidad de empresas a la que est\xe1 asociada esta actividad econ\xf3mica"}]}}ngOnInit(){this.getStatistics()}getStatistics(){this.stattisticsService.getActivityCountCompanyStatistics().subscribe(r=>{this.data=r,this.codes=r.map(u=>`CIIU: ${u.code}`),this.counts=r.map(u=>Number(u.count)),this.barChartData.labels=this.codes,this.barChartData.datasets[0].data=this.counts,this.chart?.chart?.update()})}}return s.\u0275fac=function(r){return new(r||s)(ge.Y36(qf))},s.\u0275cmp=ge.Xpm({type:s,selectors:[["app-graphic-activity-count-company"]],viewQuery:function(r,u){if(1&r&&ge.Gf(Nu,5),2&r){let p;ge.iGM(p=ge.CRH())&&(u.chart=p.first)}},decls:10,vars:5,consts:[[1,"row"],[1,"mb-3","mt-5"],[1,"col-md-7","col-lg-7","col-sm-12","mt-5"],["baseChart","",1,"chart",3,"data","options","plugins","type"],[1,"col-md-5","col-lg-5","col-sm-12","mt-5"],[1,"mb-3"],[1,"scroll-acordeon","list-group","overflow-auto",2,"max-height","50vh"],[4,"ngFor","ngForOf"],[1,"list-group-item"],[1,"text-body-secondary"],[1,"bi","bi-gear","me-2"],[1,"mt-3"]],template:function(r,u){1&r&&(ge.TgZ(0,"div",0)(1,"h3",1),ge._uU(2,"Actividades econ\xf3micas m\xe1s comunes por empresa"),ge.qZA(),ge.TgZ(3,"div",2),ge._UZ(4,"canvas",3),ge.qZA(),ge.TgZ(5,"div",4)(6,"h6",5),ge._uU(7,"Descripci\xf3n de la actividad econ\xf3mica"),ge.qZA(),ge.TgZ(8,"ul",6),ge.YNc(9,gy,7,2,"div",7),ge.qZA()()()),2&r&&(ge.xp6(4),ge.Q6J("data",u.barChartData)("options",u.barChartOptions)("plugins",u.barChartPlugins)("type",u.barChartType),ge.xp6(5),ge.Q6J("ngForOf",u.data))},dependencies:[wh.sg,Nu],styles:[".bd-callout-info[_ngcontent-%COMP%]{background-color:#cff4fc;border-left:solid 5px #9eeaf9;color:#106ebb}.scroll-acordeon[_ngcontent-%COMP%]{overflow-y:auto!important;max-height:50vh;position:relative}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#cfe2ff;border-radius:4px}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background-color:#8ebbff}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#f1f1f1}"]}),s})(),my=(()=>{class s{constructor(r){this.statisticsService=r,this.totalStatistics=[],this.companiesNames=[],this.residualsCount=[],this.economyActivitiesCount=[],this.radarChartOptions={responsive:!0},this.radarChartData={labels:[],datasets:[{data:[],label:"Actividades econ\xf3micas asociadas esta empresa"},{data:[],label:"Corrientes de residuos asociados a esta empresa"}]},this.radarChartType="radar"}ngOnInit(){this.getStatistics()}getStatistics(){this.statisticsService.getCompaniesCountResidualsAndActivities().subscribe(r=>{this.companiesNames=r.map(u=>String(u.companyName)),this.economyActivitiesCount=r.map(u=>u.activityCount),this.residualsCount=r.map(u=>u.residualCount),this.totalStatistics=r,this.radarChartData.labels=this.companiesNames,this.radarChartData.datasets[0].data=this.economyActivitiesCount,this.radarChartData.datasets[1].data=this.residualsCount,this.chart?.chart?.update()})}}return s.\u0275fac=function(r){return new(r||s)(ge.Y36(qf))},s.\u0275cmp=ge.Xpm({type:s,selectors:[["app-graphic-companies-count-residuals-activities"]],viewQuery:function(r,u){if(1&r&&ge.Gf(Nu,5),2&r){let p;ge.iGM(p=ge.CRH())&&(u.chart=p.first)}},decls:5,vars:3,consts:[[1,"row","justify-content-center"],[1,"mb-3","mt-5"],[1,"col-md-10","col-lg-10","col-sm-12","mt-5"],["baseChart","",1,"chart",3,"data","options","type"]],template:function(r,u){1&r&&(ge.TgZ(0,"div",0)(1,"h3",1),ge._uU(2," Empresas con el mayor n\xfamero de residuos y actividades econ\xf3micas asociadas "),ge.qZA(),ge.TgZ(3,"div",2),ge._UZ(4,"canvas",3),ge.qZA()()),2&r&&(ge.xp6(4),ge.Q6J("data",u.radarChartData)("options",u.radarChartOptions)("type",u.radarChartType))},dependencies:[Nu],styles:[".bd-callout-info[_ngcontent-%COMP%]{background-color:#fccff4;border-left:solid 5px #f99ef1;color:#be4ba2}"]}),s})();function _y(s,l){if(1&s&&(ge.TgZ(0,"div")(1,"span",8),ge._UZ(2,"i",9),ge._uU(3),ge.qZA(),ge.TgZ(4,"p",10),ge._uU(5),ge.qZA()()),2&s){const r=l.$implicit;ge.xp6(3),ge.hij("Corriente de residuo: ",r.code,""),ge.xp6(2),ge.Oqu(r.name)}}let yy=(()=>{class s{constructor(r){this.stattisticsService=r,this.data=[],this.codes=[],this.counts=[],this.max=0,this.barChartOptions={responsive:!0,scales:{x:{},y:{}},plugins:{legend:{display:!0,position:"top"},datalabels:{anchor:"end",align:"bottom"}},backgroundColor:"#ffa1b5"},this.barChartType="bar",this.barChartPlugins=[xh],this.barChartData={labels:[],datasets:[{data:[],label:"Cantidad de actividades econ\xf3micas asociadas a este residuo"}]}}ngOnInit(){this.getStatistics()}getStatistics(){this.stattisticsService.getResidualCountActivitiesStatistics().subscribe(r=>{this.data=r,this.codes=r.map(u=>`Corriente: ${u.code}`),this.counts=r.map(u=>Number(u.count)),this.max=Math.max(...this.counts)+100,this.barChartData.labels=this.codes,this.barChartData.datasets[0].data=this.counts,this.chart?.chart?.update()})}}return s.\u0275fac=function(r){return new(r||s)(ge.Y36(qf))},s.\u0275cmp=ge.Xpm({type:s,selectors:[["app-graphic-residuals-count-activities"]],viewQuery:function(r,u){if(1&r&&ge.Gf(Nu,5),2&r){let p;ge.iGM(p=ge.CRH())&&(u.chart=p.first)}},decls:10,vars:5,consts:[[1,"row","align-items-center"],[1,"mb-3","mt-5"],[1,"col-md-5","col-lg-5","col-sm-12","mt-5"],[1,"mb-5"],[1,"scroll-acordeon","list-group","overflow-auto",2,"max-height","50vh"],[4,"ngFor","ngForOf"],[1,"col-md-7","col-lg-7","col-sm-12","mt-5"],["baseChart","",1,"chart",3,"data","options","plugins","type"],[1,"text-body-secondary"],[1,"bi","bi-radioactive","me-3"],[1,"mt-3"]],template:function(r,u){1&r&&(ge.TgZ(0,"div",0)(1,"h3",1),ge._uU(2,"Corrientes de residuos m\xe1s comunes por actividad econ\xf3mica"),ge.qZA(),ge.TgZ(3,"div",2)(4,"h6",3),ge._uU(5,"Descripci\xf3n de la corriente de residuo"),ge.qZA(),ge.TgZ(6,"ul",4),ge.YNc(7,_y,6,2,"div",5),ge.qZA()(),ge.TgZ(8,"div",6),ge._UZ(9,"canvas",7),ge.qZA()()),2&r&&(ge.xp6(7),ge.Q6J("ngForOf",u.data),ge.xp6(2),ge.Q6J("data",u.barChartData)("options",u.barChartOptions)("plugins",u.barChartPlugins)("type",u.barChartType))},dependencies:[wh.sg,Nu],styles:[".scroll-acordeon[_ngcontent-%COMP%]{overflow-y:auto!important;max-height:50vh;position:relative}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#ffbac9;border-radius:4px}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background-color:#ffa1b5}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#f1f1f1}"]}),s})();function vy(s,l){if(1&s&&(ge.TgZ(0,"div")(1,"span",7),ge._UZ(2,"i",8),ge._uU(3),ge.qZA(),ge.TgZ(4,"p",9),ge._uU(5),ge.qZA()()),2&s){const r=l.$implicit;ge.xp6(3),ge.hij("Corriente de residuo: ",r.code,""),ge.xp6(2),ge.Oqu(r.name)}}let Gg=(()=>{class s{constructor(r){this.stattisticsService=r,this.data=[],this.codes=[],this.counts=[],this.max=0,this.pieChartOptions={responsive:!0,plugins:{legend:{display:!0,position:"bottom"},datalabels:{formatter:(u,p)=>{if(p.chart.data.labels)return p.chart.data.labels[p.dataIndex]}}}},this.pieChartData={labels:[],datasets:[{data:[],label:"cantidad de empresas asociadas a este residuo"}]},this.pieChartType="pie",this.pieChartPlugins=[xh]}ngOnInit(){this.getStatistics()}getStatistics(){this.stattisticsService.getResidualCountCompaniesStatistics().subscribe(r=>{this.data=r,this.codes=r.map(u=>`Corriente: ${u.code}`),this.counts=r.map(u=>Number(u.count)),this.max=Math.max(...this.counts)+100,this.pieChartData.labels=this.codes,this.pieChartData.datasets[0].data=this.counts,this.chart?.chart?.update()})}}return s.\u0275fac=function(r){return new(r||s)(ge.Y36(qf))},s.\u0275cmp=ge.Xpm({type:s,selectors:[["app-graphic-residuals-count-companies"]],viewQuery:function(r,u){if(1&r&&ge.Gf(Nu,5),2&r){let p;ge.iGM(p=ge.CRH())&&(u.chart=p.first)}},decls:10,vars:5,consts:[[1,"row","align-items-center"],[1,"mb-3","mt-5"],[1,"col-md-6","col-lg-6","col-sm-12","mt-5"],["baseChart","",1,"chart",3,"data","type","options","plugins"],[1,"mb-5"],[1,"scroll-acordeon","list-group","overflow-auto",2,"max-height","50vh"],[4,"ngFor","ngForOf"],[1,"text-body-secondary"],[1,"bi","bi-radioactive","me-3"],[1,"mt-3"]],template:function(r,u){1&r&&(ge.TgZ(0,"div",0)(1,"h3",1),ge._uU(2,"Corrientes de residuos m\xe1s comunes por empresa"),ge.qZA(),ge.TgZ(3,"div",2),ge._UZ(4,"canvas",3),ge.qZA(),ge.TgZ(5,"div",2)(6,"h6",4),ge._uU(7,"Descripci\xf3n de la corriente de residuo"),ge.qZA(),ge.TgZ(8,"ul",5),ge.YNc(9,vy,6,2,"div",6),ge.qZA()()()),2&r&&(ge.xp6(4),ge.Q6J("data",u.pieChartData)("type",u.pieChartType)("options",u.pieChartOptions)("plugins",u.pieChartPlugins),ge.xp6(5),ge.Q6J("ngForOf",u.data))},dependencies:[wh.sg,Nu],styles:[".scroll-acordeon[_ngcontent-%COMP%]{overflow-y:auto!important;max-height:50vh;position:relative}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#cfe2ff;border-radius:4px}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background-color:#8ebbff}.scroll-acordeon[_ngcontent-%COMP%]::-webkit-scrollbar-track{background-color:#f1f1f1}"]}),s})();function ag(s,l){1&s&&ge._UZ(0,"app-sppiner")}const Iv=[{path:"dashboard",component:(()=>{class s{constructor(r){this.stattisticsService=r,this.AsoComData=[],this.totalData=[],this.loading=!0,this.barChartOptions={responsive:!0,scales:{x:{},y:{min:10}},plugins:{legend:{display:!0},datalabels:{anchor:"end",align:"end"}}},this.barChartType="bar",this.barChartPlugins=[xh],this.barChartData={labels:["Empresas","Actividades Econ\xf3micas","Corrientes de residuos"],datasets:[{data:[],label:"Asociados con empresas"},{data:[],label:"Registros totales"}]}}getTotalStatistics(){(0,$g.D)([this.stattisticsService.getCountAllCompanysActivitiesResiduals(),this.stattisticsService.getAllCountCompaniesResidualsAndActivities()]).subscribe(([r,u])=>{this.totalAllStatistics=r,this.totalStatisticsByCompanies=u,this.totalData.push(this.totalAllStatistics.countCompany),this.totalData.push(this.totalAllStatistics.countEconomyActivities),this.totalData.push(this.totalAllStatistics.countResidualsCurrents),this.AsoComData.push(0),this.AsoComData.push(this.totalStatisticsByCompanies.countEconomyActivities),this.AsoComData.push(this.totalStatisticsByCompanies.countResidualsCurrents),this.barChartData.datasets[0].data=this.AsoComData,this.barChartData.datasets[1].data=this.totalData,this.chart?.chart?.update(),console.log(this.totalData),console.log(this.totalStatisticsByCompanies),this.loading=!1})}ngOnInit(){this.getTotalStatistics()}}return s.\u0275fac=function(r){return new(r||s)(ge.Y36(qf))},s.\u0275cmp=ge.Xpm({type:s,selectors:[["app-dashboard"]],viewQuery:function(r,u){if(1&r&&ge.Gf(Nu,5),2&r){let p;ge.iGM(p=ge.CRH())&&(u.chart=p.first)}},decls:33,vars:8,consts:[[1,"container","pt-lg-5","pt-md-5","pt-sm-0","mb-5"],[1,"row","align-items-center","mt-5","mb-5","d-flex","position-relative"],[4,"ngIf"],[1,"col-md-5","col-lg-5","col-sm-12"],[1,"card","mb-3"],[1,"card-body","text-white",2,"background-color","#86c7f3"],[1,"card-title"],[1,"card-text"],[1,"d-flex"],[1,"card","me-3"],[1,"card-body","text-white",2,"background-color","#e686f3"],[1,"card"],[1,"card-body","text-white",2,"background-color","#86f3aa"],[1,"col-md-7","col-lg-7","col-sm-12"],["baseChart","",1,"chart",3,"data","options","plugins","type"],[1,"mt-5"]],template:function(r,u){1&r&&(ge.TgZ(0,"div",0)(1,"div",1),ge.YNc(2,ag,1,0,"app-sppiner",2),ge.TgZ(3,"div",3)(4,"div",4)(5,"div",5)(6,"h5",6),ge._uU(7,"Empresas registradas"),ge.qZA(),ge.TgZ(8,"h2",7),ge._uU(9),ge.qZA()()(),ge.TgZ(10,"div",8)(11,"div",9)(12,"div",10)(13,"h5",6),ge._uU(14,"Actividades econ\xf3micas"),ge.qZA(),ge.TgZ(15,"h2",7),ge._uU(16),ge.qZA()()(),ge.TgZ(17,"div",11)(18,"div",12)(19,"h5",6),ge._uU(20,"Corrientes de residuos"),ge.qZA(),ge.TgZ(21,"h2",7),ge._uU(22),ge.qZA()()()()(),ge.TgZ(23,"div",13),ge._UZ(24,"canvas",14),ge.qZA()(),ge.TgZ(25,"div",15),ge._UZ(26,"app-graphic-activity-count-company"),ge.qZA(),ge.TgZ(27,"div",15),ge._UZ(28,"app-graphic-companies-count-residuals-activities"),ge.qZA(),ge.TgZ(29,"div",15),ge._UZ(30,"app-graphic-residuals-count-activities"),ge.qZA(),ge.TgZ(31,"div",15),ge._UZ(32,"app-graphic-residuals-count-companies"),ge.qZA()()),2&r&&(ge.xp6(2),ge.Q6J("ngIf",u.loading),ge.xp6(7),ge.Oqu(null==u.totalStatisticsByCompanies?null:u.totalStatisticsByCompanies.countCompany),ge.xp6(7),ge.Oqu(null==u.totalStatisticsByCompanies?null:u.totalStatisticsByCompanies.countEconomyActivities),ge.xp6(6),ge.Oqu(null==u.totalStatisticsByCompanies?null:u.totalStatisticsByCompanies.countResidualsCurrents),ge.xp6(2),ge.Q6J("data",u.barChartData)("options",u.barChartOptions)("plugins",u.barChartPlugins)("type",u.barChartType))},dependencies:[wh.O5,Xm.O,Nu,Ip,my,yy,Gg]}),s})()}];let by=(()=>{class s{}return s.\u0275fac=function(r){return new(r||s)},s.\u0275mod=ge.oAB({type:s}),s.\u0275inj=ge.cJS({imports:[be.Bz.forChild(Iv),be.Bz]}),s})(),xy=(()=>{class s{}return s.\u0275fac=function(r){return new(r||s)},s.\u0275mod=ge.oAB({type:s}),s.\u0275inj=ge.cJS({imports:[m.m,by,ig]}),s})()},8043:(ri,Lt,_e)=>{"use strict";_e.r(Lt),_e.d(Lt,{MapFeatureModule:()=>Vt});var m=_e(594),be=_e(5624),ge=_e(9315),x=_e(9468),tt=_e(6303);const Pe=["class","map"];let Ze=(()=>{class Tt{constructor(Et,Bt){this.acttiveModal=Et,this.modalService=Bt}closeModal(){this.acttiveModal.close()}dismissModal(){this.acttiveModal.dismiss()}}return Tt.\u0275fac=function(Et){return new(Et||Tt)(x.Y36(tt.Kz),x.Y36(tt.FF))},Tt.\u0275cmp=x.Xpm({type:Tt,selectors:[["app-modal",8,"map"]],attrs:Pe,decls:14,vars:0,consts:[[1,"modal-header"],[1,"modal-title"],[1,"bi","bi-exclamation-triangle-fill","text-warning"],[1,"modal-body"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-primary",3,"click"]],template:function(Et,Bt){1&Et&&(x.TgZ(0,"div")(1,"div",0)(2,"h4",1),x._UZ(3,"i",2),x._uU(4," Informaci\xf3n sobre las capas del mapa "),x.qZA()(),x.TgZ(5,"div",3)(6,"p"),x._uU(7,'Al activar la opci\xf3n "Visualizar capas", se visualizar\xe1n los cuerpos de agua registrados en el departamento de Bol\xedvar, as\xed como una l\xednea que conecta las diferentes empresas con el cuerpo de agua m\xe1s cercano. '),x._UZ(8,"br")(9,"br"),x._uU(10," No obstante, es importante tener en cuenta que la informaci\xf3n sobre las fuentes de agua proviene del proyecto OpenStreetMap, el cual es un proyecto colaborativo donde los usuarios pueden registrar y editar datos geogr\xe1ficos. Por lo tanto, es posible que la representaci\xf3n de los cuerpos de agua en este mapa no sea completamente precisa. "),x.qZA()(),x.TgZ(11,"div",4)(12,"button",5),x.NdJ("click",function(){return Bt.closeModal()}),x._uU(13,"Aceptar"),x.qZA()()())}}),Tt})();var yt=_e(6075),Ht=_e(9862);let $t=(()=>{class Tt{constructor(Et){this.http=Et,this.waterUrl="http://mapa-contaminantes-backend-dev.us-east-2.elasticbeanstalk.com/api/geojson/data_water_bolivar"}getWater(){return this.http.get(this.waterUrl)}}return Tt.\u0275fac=function(Et){return new(Et||Tt)(x.LFG(Ht.eN))},Tt.\u0275prov=x.Yz7({token:Tt,factory:Tt.\u0275fac,providedIn:"root"}),Tt})();var It=_e(6814),bt=_e(6223),Zt=_e(9729);const dt=["map"];function nn(Tt,wt){1&Tt&&x._UZ(0,"app-sppiner")}let Tn=(()=>{class Tt{constructor(Et,Bt,lt,zt,nt){this.companyService=Et,this.waterService=Bt,this.modalService=lt,this.route=zt,this.activatedRoute=nt,this.companies=[],this.allCoordinatesLine=[],this.allCoordinatesPolygon=[],this.companyWaterCoords=[],this.hasParams=!1,this.initialState={lat:10.327510146503977,lng:-75.5022481625158,zoom:10},this.showLayers=!1,this.addedSources=[],this.addedLayers=[],this.loading=!0}ngOnInit(){const Et=localStorage.getItem("showLayers");this.showLayers=!!Et&&JSON.parse(Et),this.verifyParams()}ngAfterViewInit(){this.initializeMap(),this.getCompaniesAndWaterCoords()}ngOnDestroy(){this.map?.remove()}initializeMap(){this.map=new be.Map({container:this.mapContainer.nativeElement,style:"https://api.maptiler.com/maps/streets-v2/style.json?key=xs2zdJT6IQ73XlwWH5an",center:[this.initialState.lng,this.initialState.lat],zoom:this.initialState.zoom}),this.map.addControl(new be.NavigationControl({}),"top-right")}getCompaniesAndWaterCoords(){(0,ge.D)([this.companyService.getCompanies(),this.waterService.getWater()]).subscribe(([Et,Bt])=>{this.companies=Et,this.water=Bt,console.log("ya se cargaron los datos"),console.log(Et),console.log(Bt),this.extractCoordinatesFromFeatures(this.water),this.calculateMinDistanceAndaddLayersToMap(this.companies),this.loading=!1})}verifyParams(){const Et=this.activatedRoute.snapshot.params;if(this.hasParams=Et.hasOwnProperty("lat")&&Et.hasOwnProperty("lng"),this.hasParams){const Bt=Number(Et.lat),lt=Number(Et.lng);this.initialState.lat=Bt,this.initialState.lng=lt,this.initialState.zoom=20}}loadPopupAndMarker(Et,Bt){const zt=this.companyService.getEconomyActivities(Et);var nt=new be.Popup({offset:25,className:"card-container"}).setMaxWidth("350px").setHTML(` \n      \n              <div class="card">\n                  <div class="card-body">\n                      <h5 class="card-title text-primary">${Et.name}</h5>\n                  </div>\n                  <ul class="list-group list-group-flush">\n                      <li  class="list-group-item">\n                          <h6><i class="bi bi-pin-map-fill me-3"></i>Direcci\xf3n:</h6>\n                          <p>${Et.adress}</p>       \n                      </li>\n                      <li class="list-group-item">\n                          <h6 ><i class="bi bi-gear me-3"></i>Actividades econ\xf3micas</h6>\n                          <p>${zt}</p>\n                          \n                      </li>\n                    \n                  </ul>\n                  <div class="card-body">\n                    <a href="http://localhost:4200/company/detail/${Et.id}" class="btn btn-outline-primary w-100">Detalles</a>\n              \n                  </div>\n                  <div class="card-footer">\n                    Distancia al cuerpo de agua m\xe1s cercano: ${Bt.toFixed(3)} Km.\n                  </div>\n                </div>\n            `);new be.Marker({color:"#FF0000"}).setLngLat([parseFloat(Et.longitude),parseFloat(Et.latitude)]).setPopup(nt).addTo(this.map)}loadLayersMap(Et){const Bt=this.companyWaterCoords[0][0],lt=this.companyWaterCoords[0][1],zt=this.companyWaterCoords[1][0],nt=this.companyWaterCoords[1][1];this.map?.on("load",()=>{this.map?.getSource("water-bodies")||(this.map?.addSource("water-bodies",{type:"geojson",data:"http://mapa-contaminantes-backend-dev.us-east-2.elasticbeanstalk.com/api/geojson/data_water_bolivar"}),this.map?.addLayer({id:"water-bodies-layer",type:"line",source:"water-bodies",paint:{"line-color":"blue","line-width":3}})),this.map?.addSource(`line-source-${Et.name}`,{type:"geojson",data:{type:"Feature",geometry:{type:"LineString",coordinates:[[Bt,lt],[zt,nt]]}}}),this.map?.addLayer({id:`line-layer-${Et.name}`,type:"line",source:`line-source-${Et.name}`,paint:{"line-color":"red","line-width":1}}),this.removeLayers()})}removeLayers(){this.map?.setLayoutProperty("water-bodies-layer","visibility",this.showLayers?"visible":"none");for(const Et of this.addedLayers)this.map?.getLayer(Et)&&this.map?.setLayoutProperty(Et,"visibility",this.showLayers?"visible":"none")}extractCoordinatesFromFeatures(Et){Et.features.forEach(Bt=>{"LineString"===Bt.geometry.type?this.allCoordinatesLine.push(...Bt.geometry.coordinates):this.allCoordinatesPolygon=this.allCoordinatesPolygon.concat(...Bt.geometry.coordinates)})}calculateMinDistanceAndaddLayersToMap(Et){for(const Bt of Et){const lt=Number(Bt.latitude),zt=Number(Bt.longitude),nt=this.findNearestRiverPoint(lt,zt,this.allCoordinatesPolygon),xt=this.findNearestRiverPoint(lt,zt,this.allCoordinatesLine),bn=this.calculateDistance(lt,zt,nt[1],nt[0]),en=this.calculateDistance(lt,zt,xt[1],xt[0]);this.companyWaterCoords.push([zt,lt]),bn<=en?(this.companyWaterCoords.push(nt),this.loadPopupAndMarker(Bt,bn)):(this.companyWaterCoords.push(xt),this.loadPopupAndMarker(Bt,en)),this.addedSources.push(`line-source-${Bt.name}`),this.addedLayers.push(`line-layer-${Bt.name}`),this.loadLayersMap(Bt),this.companyWaterCoords.splice(0)}}calculateDistance(Et,Bt,lt,zt){const xt=(lt-Et)*(Math.PI/180),bn=(zt-Bt)*(Math.PI/180),en=Math.sin(xt/2)*Math.sin(xt/2)+Math.cos(Et*(Math.PI/180))*Math.cos(lt*(Math.PI/180))*Math.sin(bn/2)*Math.sin(bn/2);return 2*Math.atan2(Math.sqrt(en),Math.sqrt(1-en))*6371}findNearestRiverPoint(Et,Bt,lt){let zt=1/0,nt=null;for(const xt of lt){const Jt=this.calculateDistance(Et,Bt,xt[1],xt[0]);Jt<zt&&(zt=Jt,nt=xt)}return nt}updateComponent(){localStorage.setItem("showLayers",JSON.stringify(this.showLayers)),window.location.reload()}openModal(){this.modalService.open(Ze)}}return Tt.\u0275fac=function(Et){return new(Et||Tt)(x.Y36(yt.J),x.Y36($t),x.Y36(tt.FF),x.Y36(m.F0),x.Y36(m.gz))},Tt.\u0275cmp=x.Xpm({type:Tt,selectors:[["app-map"]],viewQuery:function(Et,Bt){if(1&Et&&x.Gf(dt,5),2&Et){let lt;x.iGM(lt=x.CRH())&&(Bt.mapContainer=lt.first)}},decls:13,vars:3,consts:[[1,"map-wrap","position-relative"],[4,"ngIf"],[1,"d-flex","align-items-center","ms-3","mt-3","form-check","position-absolute","top-0","start-0","z-1"],[1,"me-2"],["type","checkbox","value","","id","flexCheckDefault",1,"form-check-input",3,"ngModel","ngModelChange"],["for","flexCheckDefault",1,"form-check-label"],[3,"click"],[1,"bi","bi-question-square",2,"font-size","1rem","color","rgb(0, 0, 0)"],["href","https://www.maptiler.com",1,"watermark"],["src","https://api.maptiler.com/resources/logo.svg","alt","MapTiler logo"],[1,"map"],["map",""]],template:function(Et,Bt){1&Et&&(x.TgZ(0,"div",0),x.YNc(1,nn,1,0,"app-sppiner",1),x.TgZ(2,"div",2)(3,"div",3)(4,"input",4),x.NdJ("ngModelChange",function(zt){return Bt.showLayers=zt})("ngModelChange",function(){return Bt.updateComponent()}),x.qZA(),x.TgZ(5,"label",5),x._uU(6),x.qZA()(),x.TgZ(7,"a",6),x.NdJ("click",function(){return Bt.openModal()}),x._UZ(8,"i",7),x.qZA()(),x.TgZ(9,"a",8),x._UZ(10,"img",9),x.qZA(),x._UZ(11,"div",10,11),x.qZA()),2&Et&&(x.xp6(1),x.Q6J("ngIf",Bt.loading),x.xp6(3),x.Q6J("ngModel",Bt.showLayers),x.xp6(2),x.hij(" ",Bt.showLayers?"Ocultar Capas":"Visualizar Capas"," "))},dependencies:[It.O5,bt.Wl,bt.JJ,bt.On,Zt.O],styles:[".map-wrap[_ngcontent-%COMP%]{position:relative;width:100%;height:calc(100vh - 55px)}.map[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%}.watermark[_ngcontent-%COMP%]{position:absolute;left:10px;bottom:10px;z-index:999}.map-control[_ngcontent-%COMP%]{position:absolute;top:10px;left:10px;z-index:1;padding:10px}"]}),Tt})();const Gn=[{path:"map",component:Tn},{path:"map/:lat/:lng",component:Tn}];let yi=(()=>{class Tt{}return Tt.\u0275fac=function(Et){return new(Et||Tt)},Tt.\u0275mod=x.oAB({type:Tt}),Tt.\u0275inj=x.cJS({imports:[m.Bz.forChild(Gn),m.Bz]}),Tt})();var vi=_e(6208);let Vt=(()=>{class Tt{}return Tt.\u0275fac=function(Et){return new(Et||Tt)},Tt.\u0275mod=x.oAB({type:Tt}),Tt.\u0275inj=x.cJS({imports:[yi,vi.m]}),Tt})()},9729:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{O:()=>be});var m=_e(9468);let be=(()=>{class ge{}return ge.\u0275fac=function(tt){return new(tt||ge)},ge.\u0275cmp=m.Xpm({type:ge,selectors:[["app-sppiner"]],decls:4,vars:0,consts:[[1,"overlay","d-flex","align-items-center","justify-content-center"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"]],template:function(tt,Pe){1&tt&&(m.TgZ(0,"div",0)(1,"div",1)(2,"span",2),m._uU(3,"Loading..."),m.qZA()()())},styles:[".parent-container[_ngcontent-%COMP%]{position:relative}.overlay[_ngcontent-%COMP%]{position:absolute;inset:0;z-index:9999}"]}),ge})()},7417:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{k:()=>be});var m=_e(9468);let be=(()=>{class ge{constructor(){this.toasts=[]}show(tt,Pe={}){console.log("se llamo al toast pero no se mostro"),this.toasts.push({textOrTpl:tt,...Pe})}remove(tt){const Pe=this.toasts.indexOf(tt);-1!==Pe&&this.toasts.splice(Pe,1)}clear(){this.toasts.splice(0,this.toasts.length)}}return ge.\u0275fac=function(tt){return new(tt||ge)},ge.\u0275prov=m.Yz7({token:ge,factory:ge.\u0275fac,providedIn:"root"}),ge})()},6208:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{m:()=>Ze});var m=_e(6814),be=_e(594),ge=_e(9862),x=_e(6223),tt=_e(6303),Pe=_e(9468);let Ze=(()=>{class yt{}return yt.\u0275fac=function($t){return new($t||yt)},yt.\u0275mod=Pe.oAB({type:yt}),yt.\u0275inj=Pe.cJS({imports:[m.ez,ge.JF,x.u5,be.Bz,tt.IJ,m.ez,ge.JF,x.u5,be.Bz,tt.IJ]}),yt})()},8442:(ri,Lt,_e)=>{"use strict";var m=_e(6593),be=_e(9468),ge=_e(594);let x=(()=>{class nt{}return nt.\u0275fac=function(bn){return new(bn||nt)},nt.\u0275cmp=be.Xpm({type:nt,selectors:[["app-header"]],decls:17,vars:0,consts:[["data-bs-theme","dark",1,"navbar","bg-primary","navbar-expand-lg"],[1,"container"],["href","#",1,"navbar-brand"],["type","button","data-bs-toggle","collapse","data-bs-target","#navbarTogglerDemo02","aria-controls","navbarTogglerDemo02","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarTogglerDemo02",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-2","mb-lg-0"],[1,"nav-item"],["routerLink","/map",1,"nav-link"],["routerLink","/company/list",1,"nav-link"],["routerLink","/dashboard",1,"nav-link"]],template:function(bn,en){1&bn&&(be.TgZ(0,"nav",0)(1,"div",1)(2,"a",2),be._uU(3,"Mapa Contaminantes"),be.qZA(),be.TgZ(4,"button",3),be._UZ(5,"span",4),be.qZA(),be.TgZ(6,"div",5)(7,"ul",6)(8,"li",7)(9,"a",8),be._uU(10,"Mapa interactivo"),be.qZA()(),be.TgZ(11,"li",7)(12,"a",9),be._uU(13,"Empresas"),be.qZA()(),be.TgZ(14,"li",7)(15,"a",10),be._uU(16,"Dashboard"),be.qZA()()()()()())},dependencies:[ge.rH]}),nt})();var tt=_e(7417),Pe=_e(6814),Ze=_e(6303);function yt(nt,xt){}function Ht(nt,xt){if(1&nt&&be.YNc(0,yt,0,0,"ng-template",4),2&nt){const bn=be.oxw().$implicit;be.Q6J("ngTemplateOutlet",bn.textOrTpl)}}function $t(nt,xt){if(1&nt&&be._uU(0),2&nt){const bn=be.oxw().$implicit;be.Oqu(bn.textOrTpl)}}function It(nt,xt){if(1&nt){const bn=be.EpF();be.TgZ(0,"ngb-toast",1),be.NdJ("hidden",function(){const Jt=be.CHM(bn).$implicit,Pn=be.oxw();return be.KtG(Pn.remove(Jt))}),be.YNc(1,Ht,1,1,"ng-template",2),be.YNc(2,$t,1,1,"ng-template",null,3,be.W1O),be.qZA()}if(2&nt){const bn=xt.$implicit,en=be.MAs(3),ui=be.oxw();be.Tol("custom-toast "+bn.classname),be.Q6J("autohide",!0)("delay",bn.delay||5e3),be.xp6(1),be.Q6J("ngIf",ui.isTemplate(bn))("ngIfElse",en)}}let bt=(()=>{class nt{constructor(bn){this.toastService=bn,this.toasts=this.toastService.toasts}isTemplate(bn){return bn.textOrTpl instanceof be.Rgc}remove(bn){this.toastService.remove(bn)}}return nt.\u0275fac=function(bn){return new(bn||nt)(be.Y36(tt.k))},nt.\u0275cmp=be.Xpm({type:nt,selectors:[["app-toast"]],decls:1,vars:1,consts:[["header","Cerrar",3,"class","autohide","delay","hidden",4,"ngFor","ngForOf"],["header","Cerrar",3,"autohide","delay","hidden"],[3,"ngIf","ngIfElse"],["text",""],[3,"ngTemplateOutlet"]],template:function(bn,en){1&bn&&be.YNc(0,It,4,6,"ngb-toast",0),2&bn&&be.Q6J("ngForOf",en.toasts)},dependencies:[Pe.sg,Pe.O5,Pe.tP,Ze.Iv],styles:[".custom-toast[_ngcontent-%COMP%]{position:fixed;z-index:99999;bottom:1rem;right:1rem}"]}),nt})(),Zt=(()=>{class nt{constructor(){this.title="mapa_contaminantes_frontend"}}return nt.\u0275fac=function(bn){return new(bn||nt)},nt.\u0275cmp=be.Xpm({type:nt,selectors:[["app-root"]],decls:3,vars:0,template:function(bn,en){1&bn&&be._UZ(0,"app-header")(1,"app-toast")(2,"router-outlet")},dependencies:[ge.lC,x,bt]}),nt})();var dt=_e(8043),nn=_e(3691),Tn=_e(1014),Gn=_e(7787);let yi=(()=>{class nt{}return nt.\u0275fac=function(bn){return new(bn||nt)},nt.\u0275mod=be.oAB({type:nt}),nt.\u0275inj=be.cJS({imports:[Pe.ez,dt.MapFeatureModule,nn.CompanyDetailsModule,Tn.CompanyListModule,Gn.DashboardFeatureModule]}),nt})();const Tt=[{path:"",redirectTo:"/map",pathMatch:"full"},{path:"company/detail/:id",loadChildren:()=>Promise.resolve().then(_e.bind(_e,3691)).then(nt=>nt.CompanyDetailsModule)},{path:"map",loadChildren:()=>Promise.resolve().then(_e.bind(_e,8043)).then(nt=>nt.MapFeatureModule)},{path:"company/list",loadChildren:()=>Promise.resolve().then(_e.bind(_e,1014)).then(nt=>nt.CompanyListModule)},{path:"dashboard",loadChildren:()=>Promise.resolve().then(_e.bind(_e,7787)).then(nt=>nt.DashboardFeatureModule)},{path:"error",component:(()=>{class nt{}return nt.\u0275fac=function(bn){return new(bn||nt)},nt.\u0275cmp=be.Xpm({type:nt,selectors:[["app-error"]],decls:12,vars:0,consts:[[1,"container"],[1,"row","d-flex","align-items-center","justify-content-center",2,"height","80vh"],[1,"mt-5","mb-5","col-12"],["src","../../../../assets/error.svg","alt","",2,"width","40vw","display","block","margin","auto"],[1,"d-flex","justify-content-center","align-items-center"],[1,"mt-3"],["href",""],[1,"ms-3","bi","bi-house-fill",2,"font-size","2rem"]],template:function(bn,en){1&bn&&(be.TgZ(0,"div",0)(1,"div",1)(2,"div",2),be._UZ(3,"img",3),be.TgZ(4,"div",4)(5,"div",5)(6,"h2"),be._uU(7,"Parece que ha ocurrido un error. "),be.qZA(),be.TgZ(8,"h6"),be._uU(9,"Por favor, int\xe9ntalo de nuevo m\xe1s tarde."),be.TgZ(10,"a",6),be._UZ(11,"i",7),be.qZA()()()()()()())}}),nt})()},{path:"**",component:(()=>{class nt{}return nt.\u0275fac=function(bn){return new(bn||nt)},nt.\u0275cmp=be.Xpm({type:nt,selectors:[["app-notfound"]],decls:11,vars:0,consts:[[1,"container"],[1,"row","d-flex","align-items-center","justify-content-center",2,"height","80vh"],[1,"mt-5","mb-5","col-12"],["src","../../../../assets/page_not_found.svg","alt","",2,"width","40vw","display","block","margin","auto"],[1,"d-flex","justify-content-center","align-items-center"],[1,"mt-3"],["href",""],[1,"ms-3","bi","bi-house-fill",2,"font-size","2rem"]],template:function(bn,en){1&bn&&(be.TgZ(0,"div",0)(1,"div",1)(2,"div",2),be._UZ(3,"img",3),be.TgZ(4,"div",4)(5,"div",5)(6,"h2"),be._uU(7,"Page Not Found "),be.qZA()(),be.TgZ(8,"div")(9,"a",6),be._UZ(10,"i",7),be.qZA()()()()()())}}),nt})()}];let wt=(()=>{class nt{}return nt.\u0275fac=function(bn){return new(bn||nt)},nt.\u0275mod=be.oAB({type:nt}),nt.\u0275inj=be.cJS({imports:[ge.Bz.forRoot(Tt),ge.Bz]}),nt})();var Et=_e(6208);_e(9862);let lt=(()=>{class nt{constructor(bn){this.route=bn}handleError(bn){this.route.navigateByUrl("/error")}}return nt.\u0275fac=function(bn){return new(bn||nt)(be.LFG(ge.F0))},nt.\u0275prov=be.Yz7({token:nt,factory:nt.\u0275fac}),nt})(),zt=(()=>{class nt{}return nt.\u0275fac=function(bn){return new(bn||nt)},nt.\u0275mod=be.oAB({type:nt,bootstrap:[Zt]}),nt.\u0275inj=be.cJS({providers:[{provide:be.qLn,useClass:lt}],imports:[yi,wt,Et.m,m.b2]}),nt})();m.q6().bootstrapModule(zt).catch(nt=>console.error(nt))},5619:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{X:()=>be});var m=_e(8645);class be extends m.x{constructor(x){super(),this._value=x}get value(){return this.getValue()}_subscribe(x){const tt=super._subscribe(x);return!tt.closed&&x.next(this._value),tt}getValue(){const{hasError:x,thrownError:tt,_value:Pe}=this;if(x)throw tt;return this._throwIfClosed(),Pe}next(x){super.next(this._value=x)}}},5592:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{y:()=>yt});var m=_e(305),be=_e(7394),ge=_e(4850),x=_e(8407),tt=_e(2653),Pe=_e(4674),Ze=_e(1441);let yt=(()=>{class bt{constructor(dt){dt&&(this._subscribe=dt)}lift(dt){const nn=new bt;return nn.source=this,nn.operator=dt,nn}subscribe(dt,nn,Tn){const Gn=function It(bt){return bt&&bt instanceof m.Lv||function $t(bt){return bt&&(0,Pe.m)(bt.next)&&(0,Pe.m)(bt.error)&&(0,Pe.m)(bt.complete)}(bt)&&(0,be.Nn)(bt)}(dt)?dt:new m.Hp(dt,nn,Tn);return(0,Ze.x)(()=>{const{operator:yi,source:vi}=this;Gn.add(yi?yi.call(Gn,vi):vi?this._subscribe(Gn):this._trySubscribe(Gn))}),Gn}_trySubscribe(dt){try{return this._subscribe(dt)}catch(nn){dt.error(nn)}}forEach(dt,nn){return new(nn=Ht(nn))((Tn,Gn)=>{const yi=new m.Hp({next:vi=>{try{dt(vi)}catch(Vt){Gn(Vt),yi.unsubscribe()}},error:Gn,complete:Tn});this.subscribe(yi)})}_subscribe(dt){var nn;return null===(nn=this.source)||void 0===nn?void 0:nn.subscribe(dt)}[ge.L](){return this}pipe(...dt){return(0,x.U)(dt)(this)}toPromise(dt){return new(dt=Ht(dt))((nn,Tn)=>{let Gn;this.subscribe(yi=>Gn=yi,yi=>Tn(yi),()=>nn(Gn))})}}return bt.create=Zt=>new bt(Zt),bt})();function Ht(bt){var Zt;return null!==(Zt=bt??tt.config.Promise)&&void 0!==Zt?Zt:Promise}},8645:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{x:()=>Ze});var m=_e(5592),be=_e(7394);const x=(0,_e(2306).d)(Ht=>function(){Ht(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var tt=_e(9039),Pe=_e(1441);let Ze=(()=>{class Ht extends m.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(It){const bt=new yt(this,this);return bt.operator=It,bt}_throwIfClosed(){if(this.closed)throw new x}next(It){(0,Pe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const bt of this.currentObservers)bt.next(It)}})}error(It){(0,Pe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=It;const{observers:bt}=this;for(;bt.length;)bt.shift().error(It)}})}complete(){(0,Pe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:It}=this;for(;It.length;)It.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var It;return(null===(It=this.observers)||void 0===It?void 0:It.length)>0}_trySubscribe(It){return this._throwIfClosed(),super._trySubscribe(It)}_subscribe(It){return this._throwIfClosed(),this._checkFinalizedStatuses(It),this._innerSubscribe(It)}_innerSubscribe(It){const{hasError:bt,isStopped:Zt,observers:dt}=this;return bt||Zt?be.Lc:(this.currentObservers=null,dt.push(It),new be.w0(()=>{this.currentObservers=null,(0,tt.P)(dt,It)}))}_checkFinalizedStatuses(It){const{hasError:bt,thrownError:Zt,isStopped:dt}=this;bt?It.error(Zt):dt&&It.complete()}asObservable(){const It=new m.y;return It.source=this,It}}return Ht.create=($t,It)=>new yt($t,It),Ht})();class yt extends Ze{constructor($t,It){super(),this.destination=$t,this.source=It}next($t){var It,bt;null===(bt=null===(It=this.destination)||void 0===It?void 0:It.next)||void 0===bt||bt.call(It,$t)}error($t){var It,bt;null===(bt=null===(It=this.destination)||void 0===It?void 0:It.error)||void 0===bt||bt.call(It,$t)}complete(){var $t,It;null===(It=null===($t=this.destination)||void 0===$t?void 0:$t.complete)||void 0===It||It.call($t)}_subscribe($t){var It,bt;return null!==(bt=null===(It=this.source)||void 0===It?void 0:It.subscribe($t))&&void 0!==bt?bt:be.Lc}}},305:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{Hp:()=>Tn,Lv:()=>bt});var m=_e(4674),be=_e(7394),ge=_e(2653),x=_e(3894),tt=_e(2420);const Pe=Ht("C",void 0,void 0);function Ht(Tt,wt,Et){return{kind:Tt,value:wt,error:Et}}var $t=_e(7599),It=_e(1441);class bt extends be.w0{constructor(wt){super(),this.isStopped=!1,wt?(this.destination=wt,(0,be.Nn)(wt)&&wt.add(this)):this.destination=Vt}static create(wt,Et,Bt){return new Tn(wt,Et,Bt)}next(wt){this.isStopped?vi(function yt(Tt){return Ht("N",Tt,void 0)}(wt),this):this._next(wt)}error(wt){this.isStopped?vi(function Ze(Tt){return Ht("E",void 0,Tt)}(wt),this):(this.isStopped=!0,this._error(wt))}complete(){this.isStopped?vi(Pe,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(wt){this.destination.next(wt)}_error(wt){try{this.destination.error(wt)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Zt=Function.prototype.bind;function dt(Tt,wt){return Zt.call(Tt,wt)}class nn{constructor(wt){this.partialObserver=wt}next(wt){const{partialObserver:Et}=this;if(Et.next)try{Et.next(wt)}catch(Bt){Gn(Bt)}}error(wt){const{partialObserver:Et}=this;if(Et.error)try{Et.error(wt)}catch(Bt){Gn(Bt)}else Gn(wt)}complete(){const{partialObserver:wt}=this;if(wt.complete)try{wt.complete()}catch(Et){Gn(Et)}}}class Tn extends bt{constructor(wt,Et,Bt){let lt;if(super(),(0,m.m)(wt)||!wt)lt={next:wt??void 0,error:Et??void 0,complete:Bt??void 0};else{let zt;this&&ge.config.useDeprecatedNextContext?(zt=Object.create(wt),zt.unsubscribe=()=>this.unsubscribe(),lt={next:wt.next&&dt(wt.next,zt),error:wt.error&&dt(wt.error,zt),complete:wt.complete&&dt(wt.complete,zt)}):lt=wt}this.destination=new nn(lt)}}function Gn(Tt){ge.config.useDeprecatedSynchronousErrorHandling?(0,It.O)(Tt):(0,x.h)(Tt)}function vi(Tt,wt){const{onStoppedNotification:Et}=ge.config;Et&&$t.z.setTimeout(()=>Et(Tt,wt))}const Vt={closed:!0,next:tt.Z,error:function yi(Tt){throw Tt},complete:tt.Z}},7394:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{Lc:()=>Pe,w0:()=>tt,Nn:()=>Ze});var m=_e(4674);const ge=(0,_e(2306).d)(Ht=>function(It){Ht(this),this.message=It?`${It.length} errors occurred during unsubscription:\n${It.map((bt,Zt)=>`${Zt+1}) ${bt.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=It});var x=_e(9039);class tt{constructor($t){this.initialTeardown=$t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let $t;if(!this.closed){this.closed=!0;const{_parentage:It}=this;if(It)if(this._parentage=null,Array.isArray(It))for(const dt of It)dt.remove(this);else It.remove(this);const{initialTeardown:bt}=this;if((0,m.m)(bt))try{bt()}catch(dt){$t=dt instanceof ge?dt.errors:[dt]}const{_finalizers:Zt}=this;if(Zt){this._finalizers=null;for(const dt of Zt)try{yt(dt)}catch(nn){$t=$t??[],nn instanceof ge?$t=[...$t,...nn.errors]:$t.push(nn)}}if($t)throw new ge($t)}}add($t){var It;if($t&&$t!==this)if(this.closed)yt($t);else{if($t instanceof tt){if($t.closed||$t._hasParent(this))return;$t._addParent(this)}(this._finalizers=null!==(It=this._finalizers)&&void 0!==It?It:[]).push($t)}}_hasParent($t){const{_parentage:It}=this;return It===$t||Array.isArray(It)&&It.includes($t)}_addParent($t){const{_parentage:It}=this;this._parentage=Array.isArray(It)?(It.push($t),It):It?[It,$t]:$t}_removeParent($t){const{_parentage:It}=this;It===$t?this._parentage=null:Array.isArray(It)&&(0,x.P)(It,$t)}remove($t){const{_finalizers:It}=this;It&&(0,x.P)(It,$t),$t instanceof tt&&$t._removeParent(this)}}tt.EMPTY=(()=>{const Ht=new tt;return Ht.closed=!0,Ht})();const Pe=tt.EMPTY;function Ze(Ht){return Ht instanceof tt||Ht&&"closed"in Ht&&(0,m.m)(Ht.remove)&&(0,m.m)(Ht.add)&&(0,m.m)(Ht.unsubscribe)}function yt(Ht){(0,m.m)(Ht)?Ht():Ht.unsubscribe()}},2653:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{config:()=>m});const m={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},5211:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{z:()=>tt});var m=_e(7537),ge=_e(9940),x=_e(7715);function tt(...Pe){return function be(){return(0,m.J)(1)}()((0,x.D)(Pe,(0,ge.yG)(Pe)))}},6232:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{E:()=>be});const be=new(_e(5592).y)(tt=>tt.complete())},9315:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{D:()=>yt});var m=_e(5592),be=_e(7453),ge=_e(4829),x=_e(9940),tt=_e(8251),Pe=_e(7400),Ze=_e(2714);function yt(...Ht){const $t=(0,x.jO)(Ht),{args:It,keys:bt}=(0,be.D)(Ht),Zt=new m.y(dt=>{const{length:nn}=It;if(!nn)return void dt.complete();const Tn=new Array(nn);let Gn=nn,yi=nn;for(let vi=0;vi<nn;vi++){let Vt=!1;(0,ge.Xf)(It[vi]).subscribe((0,tt.x)(dt,Tt=>{Vt||(Vt=!0,yi--),Tn[vi]=Tt},()=>Gn--,void 0,()=>{(!Gn||!Vt)&&(yi||dt.next(bt?(0,Ze.n)(bt,Tn):Tn),dt.complete())}))}});return $t?Zt.pipe((0,Pe.Z)($t)):Zt}},7715:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{D:()=>Bt});var m=_e(4829),be=_e(7103),ge=_e(9360),x=_e(8251);function tt(lt,zt=0){return(0,ge.e)((nt,xt)=>{nt.subscribe((0,x.x)(xt,bn=>(0,be.f)(xt,lt,()=>xt.next(bn),zt),()=>(0,be.f)(xt,lt,()=>xt.complete(),zt),bn=>(0,be.f)(xt,lt,()=>xt.error(bn),zt)))})}function Pe(lt,zt=0){return(0,ge.e)((nt,xt)=>{xt.add(lt.schedule(()=>nt.subscribe(xt),zt))})}var Ht=_e(5592),It=_e(4971),bt=_e(4674);function dt(lt,zt){if(!lt)throw new Error("Iterable cannot be null");return new Ht.y(nt=>{(0,be.f)(nt,zt,()=>{const xt=lt[Symbol.asyncIterator]();(0,be.f)(nt,zt,()=>{xt.next().then(bn=>{bn.done?nt.complete():nt.next(bn.value)})},0,!0)})})}var nn=_e(8382),Tn=_e(4026),Gn=_e(4266),yi=_e(3664),vi=_e(5726),Vt=_e(9853),Tt=_e(541);function Bt(lt,zt){return zt?function Et(lt,zt){if(null!=lt){if((0,nn.c)(lt))return function Ze(lt,zt){return(0,m.Xf)(lt).pipe(Pe(zt),tt(zt))}(lt,zt);if((0,Gn.z)(lt))return function $t(lt,zt){return new Ht.y(nt=>{let xt=0;return zt.schedule(function(){xt===lt.length?nt.complete():(nt.next(lt[xt++]),nt.closed||this.schedule())})})}(lt,zt);if((0,Tn.t)(lt))return function yt(lt,zt){return(0,m.Xf)(lt).pipe(Pe(zt),tt(zt))}(lt,zt);if((0,vi.D)(lt))return dt(lt,zt);if((0,yi.T)(lt))return function Zt(lt,zt){return new Ht.y(nt=>{let xt;return(0,be.f)(nt,zt,()=>{xt=lt[It.h](),(0,be.f)(nt,zt,()=>{let bn,en;try{({value:bn,done:en}=xt.next())}catch(ui){return void nt.error(ui)}en?nt.complete():nt.next(bn)},0,!0)}),()=>(0,bt.m)(xt?.return)&&xt.return()})}(lt,zt);if((0,Tt.L)(lt))return function wt(lt,zt){return dt((0,Tt.Q)(lt),zt)}(lt,zt)}throw(0,Vt.z)(lt)}(lt,zt):(0,m.Xf)(lt)}},4829:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{Xf:()=>Zt});var m=_e(7582),be=_e(4266),ge=_e(4026),x=_e(5592),tt=_e(8382),Pe=_e(5726),Ze=_e(9853),yt=_e(3664),Ht=_e(541),$t=_e(4674),It=_e(3894),bt=_e(4850);function Zt(Tt){if(Tt instanceof x.y)return Tt;if(null!=Tt){if((0,tt.c)(Tt))return function dt(Tt){return new x.y(wt=>{const Et=Tt[bt.L]();if((0,$t.m)(Et.subscribe))return Et.subscribe(wt);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Tt);if((0,be.z)(Tt))return function nn(Tt){return new x.y(wt=>{for(let Et=0;Et<Tt.length&&!wt.closed;Et++)wt.next(Tt[Et]);wt.complete()})}(Tt);if((0,ge.t)(Tt))return function Tn(Tt){return new x.y(wt=>{Tt.then(Et=>{wt.closed||(wt.next(Et),wt.complete())},Et=>wt.error(Et)).then(null,It.h)})}(Tt);if((0,Pe.D)(Tt))return yi(Tt);if((0,yt.T)(Tt))return function Gn(Tt){return new x.y(wt=>{for(const Et of Tt)if(wt.next(Et),wt.closed)return;wt.complete()})}(Tt);if((0,Ht.L)(Tt))return function vi(Tt){return yi((0,Ht.Q)(Tt))}(Tt)}throw(0,Ze.z)(Tt)}function yi(Tt){return new x.y(wt=>{(function Vt(Tt,wt){var Et,Bt,lt,zt;return(0,m.mG)(this,void 0,void 0,function*(){try{for(Et=(0,m.KL)(Tt);!(Bt=yield Et.next()).done;)if(wt.next(Bt.value),wt.closed)return}catch(nt){lt={error:nt}}finally{try{Bt&&!Bt.done&&(zt=Et.return)&&(yield zt.call(Et))}finally{if(lt)throw lt.error}}wt.complete()})})(Tt,wt).catch(Et=>wt.error(Et))})}},3019:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{T:()=>Pe});var m=_e(7537),be=_e(4829),ge=_e(6232),x=_e(9940),tt=_e(7715);function Pe(...Ze){const yt=(0,x.yG)(Ze),Ht=(0,x._6)(Ze,1/0),$t=Ze;return $t.length?1===$t.length?(0,be.Xf)($t[0]):(0,m.J)(Ht)((0,tt.D)($t,yt)):ge.E}},2096:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{of:()=>ge});var m=_e(9940),be=_e(7715);function ge(...x){const tt=(0,m.yG)(x);return(0,be.D)(x,tt)}},8251:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{x:()=>be});var m=_e(305);function be(x,tt,Pe,Ze,yt){return new ge(x,tt,Pe,Ze,yt)}class ge extends m.Lv{constructor(tt,Pe,Ze,yt,Ht,$t){super(tt),this.onFinalize=Ht,this.shouldUnsubscribe=$t,this._next=Pe?function(It){try{Pe(It)}catch(bt){tt.error(bt)}}:super._next,this._error=yt?function(It){try{yt(It)}catch(bt){tt.error(bt)}finally{this.unsubscribe()}}:super._error,this._complete=Ze?function(){try{Ze()}catch(It){tt.error(It)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var tt;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Pe}=this;super.unsubscribe(),!Pe&&(null===(tt=this.onFinalize)||void 0===tt||tt.call(this))}}}},6328:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{b:()=>ge});var m=_e(1631),be=_e(4674);function ge(x,tt){return(0,be.m)(tt)?(0,m.z)(x,tt,1):(0,m.z)(x,1)}},3997:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{x:()=>x});var m=_e(2737),be=_e(9360),ge=_e(8251);function x(Pe,Ze=m.y){return Pe=Pe??tt,(0,be.e)((yt,Ht)=>{let $t,It=!0;yt.subscribe((0,ge.x)(Ht,bt=>{const Zt=Ze(bt);(It||!Pe($t,Zt))&&(It=!1,$t=Zt,Ht.next(bt))}))})}function tt(Pe,Ze){return Pe===Ze}},2181:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{h:()=>ge});var m=_e(9360),be=_e(8251);function ge(x,tt){return(0,m.e)((Pe,Ze)=>{let yt=0;Pe.subscribe((0,be.x)(Ze,Ht=>x.call(tt,Ht,yt++)&&Ze.next(Ht)))})}},4716:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{x:()=>be});var m=_e(9360);function be(ge){return(0,m.e)((x,tt)=>{try{x.subscribe(tt)}finally{tt.add(ge)}})}},7398:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{U:()=>ge});var m=_e(9360),be=_e(8251);function ge(x,tt){return(0,m.e)((Pe,Ze)=>{let yt=0;Pe.subscribe((0,be.x)(Ze,Ht=>{Ze.next(x.call(tt,Ht,yt++))}))})}},975:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{h:()=>be});var m=_e(7398);function be(ge){return(0,m.U)(()=>ge)}},7537:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{J:()=>ge});var m=_e(1631),be=_e(2737);function ge(x=1/0){return(0,m.z)(be.y,x)}},1631:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{z:()=>yt});var m=_e(7398),be=_e(4829),ge=_e(9360),x=_e(7103),tt=_e(8251),Ze=_e(4674);function yt(Ht,$t,It=1/0){return(0,Ze.m)($t)?yt((bt,Zt)=>(0,m.U)((dt,nn)=>$t(bt,dt,Zt,nn))((0,be.Xf)(Ht(bt,Zt))),It):("number"==typeof $t&&(It=$t),(0,ge.e)((bt,Zt)=>function Pe(Ht,$t,It,bt,Zt,dt,nn,Tn){const Gn=[];let yi=0,vi=0,Vt=!1;const Tt=()=>{Vt&&!Gn.length&&!yi&&$t.complete()},wt=Bt=>yi<bt?Et(Bt):Gn.push(Bt),Et=Bt=>{dt&&$t.next(Bt),yi++;let lt=!1;(0,be.Xf)(It(Bt,vi++)).subscribe((0,tt.x)($t,zt=>{Zt?.(zt),dt?wt(zt):$t.next(zt)},()=>{lt=!0},void 0,()=>{if(lt)try{for(yi--;Gn.length&&yi<bt;){const zt=Gn.shift();nn?(0,x.f)($t,nn,()=>Et(zt)):Et(zt)}Tt()}catch(zt){$t.error(zt)}}))};return Ht.subscribe((0,tt.x)($t,wt,()=>{Vt=!0,Tt()})),()=>{Tn?.()}}(bt,Zt,Ht,It)))}},7921:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{O:()=>x});var m=_e(5211),be=_e(9940),ge=_e(9360);function x(...tt){const Pe=(0,be.yG)(tt);return(0,ge.e)((Ze,yt)=>{(Pe?(0,m.z)(tt,Ze,Pe):(0,m.z)(tt,Ze)).subscribe(yt)})}},4664:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{w:()=>x});var m=_e(4829),be=_e(9360),ge=_e(8251);function x(tt,Pe){return(0,be.e)((Ze,yt)=>{let Ht=null,$t=0,It=!1;const bt=()=>It&&!Ht&&yt.complete();Ze.subscribe((0,ge.x)(yt,Zt=>{Ht?.unsubscribe();let dt=0;const nn=$t++;(0,m.Xf)(tt(Zt,nn)).subscribe(Ht=(0,ge.x)(yt,Tn=>yt.next(Pe?Pe(Zt,Tn,nn,dt++):Tn),()=>{Ht=null,bt()}))},()=>{It=!0,bt()}))})}},8180:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{q:()=>x});var m=_e(6232),be=_e(9360),ge=_e(8251);function x(tt){return tt<=0?()=>m.E:(0,be.e)((Pe,Ze)=>{let yt=0;Pe.subscribe((0,ge.x)(Ze,Ht=>{++yt<=tt&&(Ze.next(Ht),tt<=yt&&Ze.complete())}))})}},9397:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{b:()=>tt});var m=_e(4674),be=_e(9360),ge=_e(8251),x=_e(2737);function tt(Pe,Ze,yt){const Ht=(0,m.m)(Pe)||Ze||yt?{next:Pe,error:Ze,complete:yt}:Pe;return Ht?(0,be.e)(($t,It)=>{var bt;null===(bt=Ht.subscribe)||void 0===bt||bt.call(Ht);let Zt=!0;$t.subscribe((0,ge.x)(It,dt=>{var nn;null===(nn=Ht.next)||void 0===nn||nn.call(Ht,dt),It.next(dt)},()=>{var dt;Zt=!1,null===(dt=Ht.complete)||void 0===dt||dt.call(Ht),It.complete()},dt=>{var nn;Zt=!1,null===(nn=Ht.error)||void 0===nn||nn.call(Ht,dt),It.error(dt)},()=>{var dt,nn;Zt&&(null===(dt=Ht.unsubscribe)||void 0===dt||dt.call(Ht)),null===(nn=Ht.finalize)||void 0===nn||nn.call(Ht)}))}):x.y}},4352:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{P:()=>$t,z:()=>Ht});var m=_e(7394);class be extends m.w0{constructor(bt,Zt){super()}schedule(bt,Zt=0){return this}}const ge={setInterval(It,bt,...Zt){const{delegate:dt}=ge;return dt?.setInterval?dt.setInterval(It,bt,...Zt):setInterval(It,bt,...Zt)},clearInterval(It){const{delegate:bt}=ge;return(bt?.clearInterval||clearInterval)(It)},delegate:void 0};var x=_e(9039);const Pe={now:()=>(Pe.delegate||Date).now(),delegate:void 0};class Ze{constructor(bt,Zt=Ze.now){this.schedulerActionCtor=bt,this.now=Zt}schedule(bt,Zt=0,dt){return new this.schedulerActionCtor(this,bt).schedule(dt,Zt)}}Ze.now=Pe.now;const Ht=new class yt extends Ze{constructor(bt,Zt=Ze.now){super(bt,Zt),this.actions=[],this._active=!1}flush(bt){const{actions:Zt}=this;if(this._active)return void Zt.push(bt);let dt;this._active=!0;do{if(dt=bt.execute(bt.state,bt.delay))break}while(bt=Zt.shift());if(this._active=!1,dt){for(;bt=Zt.shift();)bt.unsubscribe();throw dt}}}(class tt extends be{constructor(bt,Zt){super(bt,Zt),this.scheduler=bt,this.work=Zt,this.pending=!1}schedule(bt,Zt=0){var dt;if(this.closed)return this;this.state=bt;const nn=this.id,Tn=this.scheduler;return null!=nn&&(this.id=this.recycleAsyncId(Tn,nn,Zt)),this.pending=!0,this.delay=Zt,this.id=null!==(dt=this.id)&&void 0!==dt?dt:this.requestAsyncId(Tn,this.id,Zt),this}requestAsyncId(bt,Zt,dt=0){return ge.setInterval(bt.flush.bind(bt,this),dt)}recycleAsyncId(bt,Zt,dt=0){if(null!=dt&&this.delay===dt&&!1===this.pending)return Zt;null!=Zt&&ge.clearInterval(Zt)}execute(bt,Zt){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const dt=this._execute(bt,Zt);if(dt)return dt;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(bt,Zt){let nn,dt=!1;try{this.work(bt)}catch(Tn){dt=!0,nn=Tn||new Error("Scheduled action threw falsy error")}if(dt)return this.unsubscribe(),nn}unsubscribe(){if(!this.closed){const{id:bt,scheduler:Zt}=this,{actions:dt}=Zt;this.work=this.state=this.scheduler=null,this.pending=!1,(0,x.P)(dt,this),null!=bt&&(this.id=this.recycleAsyncId(Zt,bt,null)),this.delay=null,super.unsubscribe()}}}),$t=Ht},7599:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{z:()=>m});const m={setTimeout(be,ge,...x){const{delegate:tt}=m;return tt?.setTimeout?tt.setTimeout(be,ge,...x):setTimeout(be,ge,...x)},clearTimeout(be){const{delegate:ge}=m;return(ge?.clearTimeout||clearTimeout)(be)},delegate:void 0}},4971:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{h:()=>be});const be=function m(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{L:()=>m});const m="function"==typeof Symbol&&Symbol.observable||"@@observable"},9940:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{_6:()=>Pe,jO:()=>x,yG:()=>tt});var m=_e(4674),be=_e(671);function ge(Ze){return Ze[Ze.length-1]}function x(Ze){return(0,m.m)(ge(Ze))?Ze.pop():void 0}function tt(Ze){return(0,be.K)(ge(Ze))?Ze.pop():void 0}function Pe(Ze,yt){return"number"==typeof ge(Ze)?Ze.pop():yt}},7453:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{D:()=>tt});const{isArray:m}=Array,{getPrototypeOf:be,prototype:ge,keys:x}=Object;function tt(Ze){if(1===Ze.length){const yt=Ze[0];if(m(yt))return{args:yt,keys:null};if(function Pe(Ze){return Ze&&"object"==typeof Ze&&be(Ze)===ge}(yt)){const Ht=x(yt);return{args:Ht.map($t=>yt[$t]),keys:Ht}}}return{args:Ze,keys:null}}},9039:(ri,Lt,_e)=>{"use strict";function m(be,ge){if(be){const x=be.indexOf(ge);0<=x&&be.splice(x,1)}}_e.d(Lt,{P:()=>m})},2306:(ri,Lt,_e)=>{"use strict";function m(be){const x=be(tt=>{Error.call(tt),tt.stack=(new Error).stack});return x.prototype=Object.create(Error.prototype),x.prototype.constructor=x,x}_e.d(Lt,{d:()=>m})},2714:(ri,Lt,_e)=>{"use strict";function m(be,ge){return be.reduce((x,tt,Pe)=>(x[tt]=ge[Pe],x),{})}_e.d(Lt,{n:()=>m})},1441:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{O:()=>x,x:()=>ge});var m=_e(2653);let be=null;function ge(tt){if(m.config.useDeprecatedSynchronousErrorHandling){const Pe=!be;if(Pe&&(be={errorThrown:!1,error:null}),tt(),Pe){const{errorThrown:Ze,error:yt}=be;if(be=null,Ze)throw yt}}else tt()}function x(tt){m.config.useDeprecatedSynchronousErrorHandling&&be&&(be.errorThrown=!0,be.error=tt)}},7103:(ri,Lt,_e)=>{"use strict";function m(be,ge,x,tt=0,Pe=!1){const Ze=ge.schedule(function(){x(),Pe?be.add(this.schedule(null,tt)):this.unsubscribe()},tt);if(be.add(Ze),!Pe)return Ze}_e.d(Lt,{f:()=>m})},2737:(ri,Lt,_e)=>{"use strict";function m(be){return be}_e.d(Lt,{y:()=>m})},4266:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{z:()=>m});const m=be=>be&&"number"==typeof be.length&&"function"!=typeof be},5726:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{D:()=>be});var m=_e(4674);function be(ge){return Symbol.asyncIterator&&(0,m.m)(ge?.[Symbol.asyncIterator])}},4674:(ri,Lt,_e)=>{"use strict";function m(be){return"function"==typeof be}_e.d(Lt,{m:()=>m})},8382:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{c:()=>ge});var m=_e(4850),be=_e(4674);function ge(x){return(0,be.m)(x[m.L])}},3664:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{T:()=>ge});var m=_e(4971),be=_e(4674);function ge(x){return(0,be.m)(x?.[m.h])}},4026:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{t:()=>be});var m=_e(4674);function be(ge){return(0,m.m)(ge?.then)}},541:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{L:()=>x,Q:()=>ge});var m=_e(7582),be=_e(4674);function ge(tt){return(0,m.FC)(this,arguments,function*(){const Ze=tt.getReader();try{for(;;){const{value:yt,done:Ht}=yield(0,m.qq)(Ze.read());if(Ht)return yield(0,m.qq)(void 0);yield yield(0,m.qq)(yt)}}finally{Ze.releaseLock()}})}function x(tt){return(0,be.m)(tt?.getReader)}},671:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{K:()=>be});var m=_e(4674);function be(ge){return ge&&(0,m.m)(ge.schedule)}},9360:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{A:()=>be,e:()=>ge});var m=_e(4674);function be(x){return(0,m.m)(x?.lift)}function ge(x){return tt=>{if(be(tt))return tt.lift(function(Pe){try{return x(Pe,this)}catch(Ze){this.error(Ze)}});throw new TypeError("Unable to lift unknown Observable type")}}},7400:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{Z:()=>x});var m=_e(7398);const{isArray:be}=Array;function x(tt){return(0,m.U)(Pe=>function ge(tt,Pe){return be(Pe)?tt(...Pe):tt(Pe)}(tt,Pe))}},2420:(ri,Lt,_e)=>{"use strict";function m(){}_e.d(Lt,{Z:()=>m})},8407:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{U:()=>ge,z:()=>be});var m=_e(2737);function be(...x){return ge(x)}function ge(x){return 0===x.length?m.y:1===x.length?x[0]:function(Pe){return x.reduce((Ze,yt)=>yt(Ze),Pe)}}},3894:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{h:()=>ge});var m=_e(2653),be=_e(7599);function ge(x){be.z.setTimeout(()=>{const{onUnhandledError:tt}=m.config;if(!tt)throw x;tt(x)})}},9853:(ri,Lt,_e)=>{"use strict";function m(be){return new TypeError(`You provided ${null!==be&&"object"==typeof be?"an invalid object":`'${be}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}_e.d(Lt,{z:()=>m})},5624:function(ri){ri.exports=function(){"use strict";var Lt,_e,m;function be(x,tt){if(Lt)if(_e){var Pe="var sharedChunk = {}; ("+Lt+")(sharedChunk); ("+_e+")(sharedChunk);",Ze={};Lt(Ze),m=tt(Ze),typeof window<"u"&&(m.workerUrl=window.URL.createObjectURL(new Blob([Pe],{type:"text/javascript"})))}else _e=tt;else Lt=tt}return be(0,function(x){function tt(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Pe=Ze;function Ze(o,t){this.x=o,this.y=t}Ze.prototype={clone:function(){return new Ze(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,t){return this.clone()._rotateAround(o,t)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var t=o.x-this.x,c=o.y-this.y;return t*t+c*c},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,t){return Math.atan2(this.x*t-this.y*o,this.x*o+this.y*t)},_matMult:function(o){var t=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=t,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var t=Math.cos(o),c=Math.sin(o),g=c*this.x+t*this.y;return this.x=t*this.x-c*this.y,this.y=g,this},_rotateAround:function(o,t){var c=Math.cos(o),g=Math.sin(o),D=t.y+g*(this.x-t.x)+c*(this.y-t.y);return this.x=t.x+c*(this.x-t.x)-g*(this.y-t.y),this.y=D,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ze.convert=function(o){return o instanceof Ze?o:Array.isArray(o)?new Ze(o[0],o[1]):o};var yt=tt(Pe),Ht=$t;function $t(o,t,c,g){this.cx=3*o,this.bx=3*(c-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(g-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=t,this.p2x=c,this.p2y=g}$t.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,t){if(void 0===t&&(t=1e-6),o<0)return 0;if(o>1)return 1;for(var c=o,g=0;g<8;g++){var D=this.sampleCurveX(c)-o;if(Math.abs(D)<t)return c;var M=this.sampleCurveDerivativeX(c);if(Math.abs(M)<1e-6)break;c-=D/M}var P=0,B=1;for(c=o,g=0;g<20&&(D=this.sampleCurveX(c),!(Math.abs(D-o)<t));g++)o>D?P=c:B=c,c=.5*(B-P)+P;return c},solve:function(o,t){return this.sampleCurveY(this.solveCurveX(o,t))}};var It=tt(Ht);function bt(o,t,c,g){const D=new It(o,t,c,g);return function(M){return D.solve(M)}}const Zt=bt(.25,.1,.25,1);function dt(o,t,c){return Math.min(c,Math.max(t,o))}function nn(o,t,c){const g=c-t,D=((o-t)%g+g)%g+t;return D===t?c:D}function Tn(o,...t){for(const c of t)for(const g in c)o[g]=c[g];return o}let Gn=1;function yi(o,t){o.forEach(c=>{t[c]&&(t[c]=t[c].bind(t))})}function vi(o,t,c){const g={};for(const D in o)g[D]=t.call(c||this,o[D],D,o);return g}function Vt(o,t,c){const g={};for(const D in o)t.call(c||this,o[D],D,o)&&(g[D]=o[D]);return g}function Tt(o){return Array.isArray(o)?o.map(Tt):"object"==typeof o&&o?vi(o,Tt):o}const wt={};function Et(o){wt[o]||(typeof console<"u"&&console.warn(o),wt[o]=!0)}function Bt(o,t,c){return(c.y-o.y)*(t.x-o.x)>(t.y-o.y)*(c.x-o.x)}function lt(o){let t=0;for(let c,g,D=0,M=o.length,P=M-1;D<M;P=D++)c=o[D],g=o[P],t+=(g.x-c.x)*(c.y+g.y);return t}function zt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let nt=null;function xt(o){if(null==nt){const t=o.navigator?o.navigator.userAgent:null;nt=!!o.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return nt}function bn(o){return typeof ImageBitmap<"u"&&o instanceof ImageBitmap}const en="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ui,Jt;const Pn={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(o){const t=requestAnimationFrame(o);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(o,t=0){return this.getImageCanvasContext(o).getImageData(-t,-t,o.width+2*t,o.height+2*t)},getImageCanvasContext(o){const t=window.document.createElement("canvas"),c=t.getContext("2d",{willReadFrequently:!0});if(!c)throw new Error("failed to create canvas 2d context");return t.width=o.width,t.height=o.height,c.drawImage(o,0,0,o.width,o.height),c},resolveURL:o=>(ui||(ui=document.createElement("a")),ui.href=o,ui.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==Jt&&(Jt=matchMedia("(prefers-reduced-motion: reduce)")),Jt.matches)}},Mi={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class bi extends Error{constructor(t,c,g,D){super(`AJAXError: ${c} (${t}): ${g}`),this.status=t,this.statusText=c,this.url=g,this.body=D}}const ft=zt()?()=>self.worker&&self.worker.referrer:()=>("blob:"===window.location.protocol?window.parent:window).location.href,ht=o=>Mi.REGISTERED_PROTOCOLS[o.substring(0,o.indexOf("://"))];function Pt(o,t){const c=new AbortController,g=new Request(o.url,{method:o.method||"GET",body:o.body,credentials:o.credentials,headers:o.headers,referrer:ft(),signal:c.signal});let D=!1,M=!1;return"json"===o.type&&g.headers.set("Accept","application/json"),M||fetch(g).then(P=>{return P.ok?(B=P,void("arrayBuffer"===o.type||"image"===o.type?B.arrayBuffer():"json"===o.type?B.json():B.text()).then($=>{M||(D=!0,t(null,$,B.headers.get("Cache-Control"),B.headers.get("Expires")))}).catch($=>{M||t(new Error($.message))})):P.blob().then(B=>t(new bi(P.status,P.statusText,o.url,B)));var B}).catch(P=>{20!==P.code&&t(new Error(P.message))}),{cancel:()=>{M=!0,D||c.abort()}}}const Nt=function(o,t){if(/:\/\//.test(o.url)&&!/^https?:|^file:/.test(o.url)){if(zt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,t);if(!zt())return(ht(o.url)||Pt)(o,t)}if(!(/^file:/.test(c=o.url)||/^file:/.test(ft())&&!/^\w+:/.test(c))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Pt(o,t);if(zt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,t,void 0,!0)}var c;return function(g,D){const M=new XMLHttpRequest;M.open(g.method||"GET",g.url,!0),"arrayBuffer"!==g.type&&"image"!==g.type||(M.responseType="arraybuffer");for(const P in g.headers)M.setRequestHeader(P,g.headers[P]);return"json"===g.type&&(M.responseType="text",M.setRequestHeader("Accept","application/json")),M.withCredentials="include"===g.credentials,M.onerror=()=>{D(new Error(M.statusText))},M.onload=()=>{if((M.status>=200&&M.status<300||0===M.status)&&null!==M.response){let P=M.response;if("json"===g.type)try{P=JSON.parse(M.response)}catch(B){return D(B)}D(null,P,M.getResponseHeader("Cache-Control"),M.getResponseHeader("Expires"))}else{const P=new Blob([M.response],{type:M.getResponseHeader("Content-Type")});D(new bi(M.status,M.statusText,g.url,P))}},M.send(g.body),{cancel:()=>M.abort()}}(o,t)},hn=function(o,t){return Nt(Tn(o,{type:"arrayBuffer"}),t)};function ln(o){if(!o||o.indexOf("://")<=0||0===o.indexOf("data:image/")||0===o.indexOf("blob:"))return!0;const t=new URL(o),c=window.location;return t.protocol===c.protocol&&t.host===c.host}function oi(o,t,c){c[o]&&-1!==c[o].indexOf(t)||(c[o]=c[o]||[],c[o].push(t))}function mi(o,t,c){if(c&&c[o]){const g=c[o].indexOf(t);-1!==g&&c[o].splice(g,1)}}class zi{constructor(t,c={}){Tn(this,c),this.type=t}}class di extends zi{constructor(t,c={}){super("error",Tn({error:t},c))}}class Si{on(t,c){return this._listeners=this._listeners||{},oi(t,c,this._listeners),this}off(t,c){return mi(t,c,this._listeners),mi(t,c,this._oneTimeListeners),this}once(t,c){return c?(this._oneTimeListeners=this._oneTimeListeners||{},oi(t,c,this._oneTimeListeners),this):new Promise(g=>this.once(t,g))}fire(t,c){"string"==typeof t&&(t=new zi(t,c||{}));const g=t.type;if(this.listens(g)){t.target=this;const D=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const B of D)B.call(this,t);const M=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const B of M)mi(g,B,this._oneTimeListeners),B.call(this,t);const P=this._eventedParent;P&&(Tn(t,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),P.fire(t))}else t instanceof di&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,c){return this._eventedParent=t,this._eventedParentData=c,this}}var st={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ci=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function er(o,t){const c={};for(const g in o)"ref"!==g&&(c[g]=o[g]);return Ci.forEach(g=>{g in t&&(c[g]=t[g])}),c}function Mn(o,t){if(Array.isArray(o)){if(!Array.isArray(t)||o.length!==t.length)return!1;for(let c=0;c<o.length;c++)if(!Mn(o[c],t[c]))return!1;return!0}if("object"==typeof o&&null!==o&&null!==t){if("object"!=typeof t||Object.keys(o).length!==Object.keys(t).length)return!1;for(const c in o)if(!Mn(o[c],t[c]))return!1;return!0}return o===t}const An={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function mt(o,t,c){c.push({command:An.addSource,args:[o,t[o]]})}function We(o,t,c){t.push({command:An.removeSource,args:[o]}),c[o]=!0}function Ot(o,t,c,g){We(o,c,g),mt(o,t,c)}function kt(o,t,c){let g;for(g in o[c])if(Object.prototype.hasOwnProperty.call(o[c],g)&&"data"!==g&&!Mn(o[c][g],t[c][g]))return!1;for(g in t[c])if(Object.prototype.hasOwnProperty.call(t[c],g)&&"data"!==g&&!Mn(o[c][g],t[c][g]))return!1;return!0}function gn(o,t,c,g,D,M){let P;for(P in t=t||{},o=o||{})Object.prototype.hasOwnProperty.call(o,P)&&(Mn(o[P],t[P])||c.push({command:M,args:[g,P,t[P],D]}));for(P in t)Object.prototype.hasOwnProperty.call(t,P)&&!Object.prototype.hasOwnProperty.call(o,P)&&(Mn(o[P],t[P])||c.push({command:M,args:[g,P,t[P],D]}))}function Yt(o){return o.id}function jn(o,t){return o[t.id]=t,o}class at{constructor(t,c,g,D){this.message=(t?`${t}: `:"")+g,D&&(this.identifier=D),null!=c&&c.__line__&&(this.line=c.__line__)}}function qt(o,...t){for(const c of t)for(const g in c)o[g]=c[g];return o}class yn extends Error{constructor(t,c){super(c),this.message=c,this.key=t}}class Kn{constructor(t,c=[]){this.parent=t,this.bindings={};for(const[g,D]of c)this.bindings[g]=D}concat(t){return new Kn(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const qn={kind:"null"},rn={kind:"number"},On={kind:"string"},Qt={kind:"boolean"},mr={kind:"color"},ii={kind:"object"},Rn={kind:"value"},Li={kind:"collator"},Lr={kind:"formatted"},_r={kind:"padding"},Ai={kind:"resolvedImage"};function ur(o,t){return{kind:"array",itemType:o,N:t}}function si(o){if("array"===o.kind){const t=si(o.itemType);return"number"==typeof o.N?`array<${t}, ${o.N}>`:"value"===o.itemType.kind?"array":`array<${t}>`}return o.kind}const Br=[qn,rn,On,Qt,mr,Lr,ii,ur(Rn),_r,Ai];function Vo(o,t){if("error"===t.kind)return null;if("array"===o.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!Vo(o.itemType,t.itemType))&&("number"!=typeof o.N||o.N===t.N))return null}else{if(o.kind===t.kind)return null;if("value"===o.kind)for(const c of Br)if(!Vo(c,t))return null}return`Expected ${si(o)} but found ${si(t)} instead.`}function Le(o,t){return t.some(c=>c.kind===o.kind)}function he(o,t){return t.some(c=>"null"===c?null===o:"array"===c?Array.isArray(o):"object"===c?o&&!Array.isArray(o)&&"object"==typeof o:c===typeof o)}function ye(o,t){return"array"===o.kind&&"array"===t.kind?o.itemType.kind===t.itemType.kind&&"number"==typeof o.N:o.kind===t.kind}const $e=4/29,we=6/29,me=3*we*we,oe=we*we*we,Se=Math.PI/180,Ye=180/Math.PI;function Xe(o){return(o%=360)<0&&(o+=360),o}function gt([o,t,c,g]){let D,M;const P=wn((.2225045*(o=mn(o))+.7168786*(t=mn(t))+.0606169*(c=mn(c)))/1);o===t&&t===c?D=M=P:(D=wn((.4360747*o+.3850649*t+.1430804*c)/.96422),M=wn((.0139322*o+.0971045*t+.7141733*c)/.82521));const B=116*P-16;return[B<0?0:B,500*(D-P),200*(P-M),g]}function mn(o){return o<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function wn(o){return o>oe?Math.pow(o,1/3):o/me+$e}function sn([o,t,c,g]){let D=(o+16)/116,M=isNaN(t)?D:D+t/500,P=isNaN(c)?D:D-c/200;return D=1*Fn(D),M=.96422*Fn(M),P=.82521*Fn(P),[Cn(3.1338561*M-1.6168667*D-.4906146*P),Cn(-.9787684*M+1.9161415*D+.033454*P),Cn(.0719453*M-.2289914*D+1.4052427*P),g]}function Cn(o){return(o=o<=.00304?12.92*o:1.055*Math.pow(o,1/2.4)-.055)<0?0:o>1?1:o}function Fn(o){return o>we?o*o*o:me*(o-$e)}function ut(o){return parseInt(o.padEnd(2,o),16)/255}function Oe(o,t){return Ge(t?o/100:o,0,1)}function Ge(o,t,c){return Math.min(Math.max(t,o),c)}function Gt(o){return!o.some(Number.isNaN)}const tn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Wt{constructor(t,c,g,D=1,M=!0){this.r=t,this.g=c,this.b=g,this.a=D,M||(this.r*=D,this.g*=D,this.b*=D,D||this.overwriteGetter("rgb",[t,c,g,D]))}static parse(t){if(t instanceof Wt)return t;if("string"!=typeof t)return;const c=function(g){if("transparent"===(g=g.toLowerCase()))return[0,0,0,0];const D=tn[g];if(D){const[P,B,$]=D;return[P/255,B/255,$/255,1]}if(g.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(g)){const P=g.length<6?1:2;let B=1;return[ut(g.slice(B,B+=P)),ut(g.slice(B,B+=P)),ut(g.slice(B,B+=P)),ut(g.slice(B,B+P)||"ff")]}if(g.startsWith("rgb")){const P=g.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(P){const[B,$,ee,se,fe,ve,xe,Te,je,Ue,it,pt]=P,Je=[se||" ",xe||" ",Ue].join("");if("  "===Je||"  /"===Je||",,"===Je||",,,"===Je){const Ct=[ee,ve,je].join(""),At="%%%"===Ct?100:""===Ct?255:0;if(At){const Xt=[Ge(+$/At,0,1),Ge(+fe/At,0,1),Ge(+Te/At,0,1),it?Oe(+it,pt):1];if(Gt(Xt))return Xt}}return}}const M=g.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(M){const[P,B,$,ee,se,fe,ve,xe,Te]=M,je=[$||" ",se||" ",ve].join("");if("  "===je||"  /"===je||",,"===je||",,,"===je){const Ue=[+B,Ge(+ee,0,100),Ge(+fe,0,100),xe?Oe(+xe,Te):1];if(Gt(Ue))return function([it,pt,Je,Ct]){function At(Xt){const Jn=(Xt+it/30)%12,ei=pt*Math.min(Je,1-Je);return Je-ei*Math.max(-1,Math.min(Jn-3,9-Jn,1))}return it=Xe(it),pt/=100,Je/=100,[At(0),At(8),At(4),Ct]}(Ue)}}}(t);return c?new Wt(...c,!1):void 0}get rgb(){const{r:t,g:c,b:g,a:D}=this,M=D||1/0;return this.overwriteGetter("rgb",[t/M,c/M,g/M,D])}get hcl(){return this.overwriteGetter("hcl",function(t){const[c,g,D,M]=gt(t),P=Math.sqrt(g*g+D*D);return[Math.round(1e4*P)?Xe(Math.atan2(D,g)*Ye):NaN,P,c,M]}(this.rgb))}get lab(){return this.overwriteGetter("lab",gt(this.rgb))}overwriteGetter(t,c){return Object.defineProperty(this,t,{value:c}),c}toString(){const[t,c,g,D]=this.rgb;return`rgba(${[t,c,g].map(M=>Math.round(255*M)).join(",")},${D})`}}Wt.black=new Wt(0,0,0,1),Wt.white=new Wt(1,1,1,1),Wt.transparent=new Wt(0,0,0,0),Wt.red=new Wt(1,0,0,1);class cn{constructor(t,c,g){this.sensitivity=t?c?"variant":"case":c?"accent":"base",this.locale=g,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,c){return this.collator.compare(t,c)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Zi{constructor(t,c,g,D,M){this.text=t,this.image=c,this.scale=g,this.fontStack=D,this.textColor=M}}class Qn{constructor(t){this.sections=t}static fromString(t){return new Qn([new Zi(t,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(t=>0!==t.text.length||t.image&&0!==t.image.name.length)}static factory(t){return t instanceof Qn?t:Qn.fromString(t)}toString(){return 0===this.sections.length?"":this.sections.map(t=>t.text).join("")}}class nr{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof nr)return t;if("number"==typeof t)return new nr([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const c of t)if("number"!=typeof c)return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new nr(t)}}toString(){return JSON.stringify(this.values)}}class ji{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new ji({name:t,available:!1}):null}}function Pr(o,t,c,g){return"number"==typeof o&&o>=0&&o<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof c&&c>=0&&c<=255?void 0===g||"number"==typeof g&&g>=0&&g<=1?null:`Invalid rgba value [${[o,t,c,g].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof g?[o,t,c,g]:[o,t,c]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ki(o){if(null===o||"string"==typeof o||"boolean"==typeof o||"number"==typeof o||o instanceof Wt||o instanceof cn||o instanceof Qn||o instanceof nr||o instanceof ji)return!0;if(Array.isArray(o)){for(const t of o)if(!Ki(t))return!1;return!0}if("object"==typeof o){for(const t in o)if(!Ki(o[t]))return!1;return!0}return!1}function tr(o){if(null===o)return qn;if("string"==typeof o)return On;if("boolean"==typeof o)return Qt;if("number"==typeof o)return rn;if(o instanceof Wt)return mr;if(o instanceof cn)return Li;if(o instanceof Qn)return Lr;if(o instanceof nr)return _r;if(o instanceof ji)return Ai;if(Array.isArray(o)){const t=o.length;let c;for(const g of o){const D=tr(g);if(c){if(c===D)continue;c=Rn;break}c=D}return ur(c||Rn,t)}return ii}function Hr(o){const t=typeof o;return null===o?"":"string"===t||"number"===t||"boolean"===t?String(o):o instanceof Wt||o instanceof Qn||o instanceof nr||o instanceof ji?o.toString():JSON.stringify(o)}class Hi{constructor(t,c){this.type=t,this.value=c}static parse(t,c){if(2!==t.length)return c.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Ki(t[1]))return c.error("invalid value");const g=t[1];let D=tr(g);const M=c.expectedType;return"array"!==D.kind||0!==D.N||!M||"array"!==M.kind||"number"==typeof M.N&&0!==M.N||(D=M),new Hi(D,g)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class hi{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Uo={string:On,number:rn,boolean:Qt,object:ii};class mo{constructor(t,c){this.type=t,this.args=c}static parse(t,c){if(t.length<2)return c.error("Expected at least one argument.");let g,D=1;const M=t[0];if("array"===M){let B,$;if(t.length>2){const ee=t[1];if("string"!=typeof ee||!(ee in Uo)||"object"===ee)return c.error('The item type argument of "array" must be one of string, number, boolean',1);B=Uo[ee],D++}else B=Rn;if(t.length>3){if(null!==t[2]&&("number"!=typeof t[2]||t[2]<0||t[2]!==Math.floor(t[2])))return c.error('The length argument to "array" must be a positive integer literal',2);$=t[2],D++}g=ur(B,$)}else{if(!Uo[M])throw new Error(`Types doesn't contain name = ${M}`);g=Uo[M]}const P=[];for(;D<t.length;D++){const B=c.parse(t[D],D,Rn);if(!B)return null;P.push(B)}return new mo(g,P)}evaluate(t){for(let c=0;c<this.args.length;c++){const g=this.args[c].evaluate(t);if(!Vo(this.type,tr(g)))return g;if(c===this.args.length-1)throw new hi(`Expected value to be of type ${si(this.type)}, but found ${si(tr(g))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const lo={"to-boolean":Qt,"to-color":mr,"to-number":rn,"to-string":On};class Vi{constructor(t,c){this.type=t,this.args=c}static parse(t,c){if(t.length<2)return c.error("Expected at least one argument.");const g=t[0];if(!lo[g])throw new Error(`Can't parse ${g} as it is not part of the known types`);if(("to-boolean"===g||"to-string"===g)&&2!==t.length)return c.error("Expected one argument.");const D=lo[g],M=[];for(let P=1;P<t.length;P++){const B=c.parse(t[P],P,Rn);if(!B)return null;M.push(B)}return new Vi(D,M)}evaluate(t){if("boolean"===this.type.kind)return!!this.args[0].evaluate(t);if("color"===this.type.kind){let c,g;for(const D of this.args){if(c=D.evaluate(t),g=null,c instanceof Wt)return c;if("string"==typeof c){const M=t.parseColor(c);if(M)return M}else if(Array.isArray(c)&&(g=c.length<3||c.length>4?`Invalid rbga value ${JSON.stringify(c)}: expected an array containing either three or four numeric values.`:Pr(c[0],c[1],c[2],c[3]),!g))return new Wt(c[0]/255,c[1]/255,c[2]/255,c[3])}throw new hi(g||`Could not parse color from value '${"string"==typeof c?c:JSON.stringify(c)}'`)}if("padding"===this.type.kind){let c;for(const g of this.args){c=g.evaluate(t);const D=nr.parse(c);if(D)return D}throw new hi(`Could not parse padding from value '${"string"==typeof c?c:JSON.stringify(c)}'`)}if("number"===this.type.kind){let c=null;for(const g of this.args){if(c=g.evaluate(t),null===c)return 0;const D=Number(c);if(!isNaN(D))return D}throw new hi(`Could not convert ${JSON.stringify(c)} to number.`)}return"formatted"===this.type.kind?Qn.fromString(Hr(this.args[0].evaluate(t))):"resolvedImage"===this.type.kind?ji.fromString(Hr(this.args[0].evaluate(t))):Hr(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const us=["Unknown","Point","LineString","Polygon"];class ds{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?us[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let c=this._parseColorCache[t];return c||(c=this._parseColorCache[t]=Wt.parse(t)),c}}class es{constructor(t,c,g=[],D,M=new Kn,P=[]){this.registry=t,this.path=g,this.key=g.map(B=>`[${B}]`).join(""),this.scope=M,this.errors=P,this.expectedType=D,this._isConstant=c}parse(t,c,g,D,M={}){return c?this.concat(c,g,D)._parse(t,M):this._parse(t,M)}_parse(t,c){function g(D,M,P){return"assert"===P?new mo(M,[D]):"coerce"===P?new Vi(M,[D]):D}if(null!==t&&"string"!=typeof t&&"boolean"!=typeof t&&"number"!=typeof t||(t=["literal",t]),Array.isArray(t)){if(0===t.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const D=t[0];if("string"!=typeof D)return this.error(`Expression name must be a string, but found ${typeof D} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const M=this.registry[D];if(M){let P=M.parse(t,this);if(!P)return null;if(this.expectedType){const B=this.expectedType,$=P.type;if("string"!==B.kind&&"number"!==B.kind&&"boolean"!==B.kind&&"object"!==B.kind&&"array"!==B.kind||"value"!==$.kind)if("color"!==B.kind&&"formatted"!==B.kind&&"resolvedImage"!==B.kind||"value"!==$.kind&&"string"!==$.kind)if("padding"!==B.kind||"value"!==$.kind&&"number"!==$.kind&&"array"!==$.kind){if(this.checkSubtype(B,$))return null}else P=g(P,B,c.typeAnnotation||"coerce");else P=g(P,B,c.typeAnnotation||"coerce");else P=g(P,B,c.typeAnnotation||"assert")}if(!(P instanceof Hi)&&"resolvedImage"!==P.type.kind&&this._isConstant(P)){const B=new ds;try{P=new Hi(P.type,P.evaluate(B))}catch($){return this.error($.message),null}}return P}return this.error(`Unknown expression "${D}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===t?"'undefined' value invalid. Use null instead.":"object"==typeof t?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,c,g){const D="number"==typeof t?this.path.concat(t):this.path,M=g?this.scope.concat(g):this.scope;return new es(this.registry,this._isConstant,D,c||null,M,this.errors)}error(t,...c){const g=`${this.key}${c.map(D=>`[${D}]`).join("")}`;this.errors.push(new yn(g,t))}checkSubtype(t,c){const g=Vo(t,c);return g&&this.error(g),g}}class ir{constructor(t,c,g){this.type=Li,this.locale=g,this.caseSensitive=t,this.diacriticSensitive=c}static parse(t,c){if(2!==t.length)return c.error("Expected one argument.");const g=t[1];if("object"!=typeof g||Array.isArray(g))return c.error("Collator options argument must be an object.");const D=c.parse(void 0!==g["case-sensitive"]&&g["case-sensitive"],1,Qt);if(!D)return null;const M=c.parse(void 0!==g["diacritic-sensitive"]&&g["diacritic-sensitive"],1,Qt);if(!M)return null;let P=null;return g.locale&&(P=c.parse(g.locale,1,On),!P)?null:new ir(D,M,P)}evaluate(t){return new cn(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}const Ts=8192;function da(o,t){o[0]=Math.min(o[0],t[0]),o[1]=Math.min(o[1],t[1]),o[2]=Math.max(o[2],t[0]),o[3]=Math.max(o[3],t[1])}function Ss(o,t){return!(o[0]<=t[0]||o[2]>=t[2]||o[1]<=t[1]||o[3]>=t[3])}function io(o,t){const c=(180+o[0])/360,g=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,D=Math.pow(2,t.z);return[Math.round(c*D*Ts),Math.round(g*D*Ts)]}function Za(o,t,c){const g=o[0]-t[0],D=o[1]-t[1],M=o[0]-c[0],P=o[1]-c[1];return g*P-M*D==0&&g*M<=0&&D*P<=0}function ts(o,t){let c=!1;for(let P=0,B=t.length;P<B;P++){const $=t[P];for(let ee=0,se=$.length;ee<se-1;ee++){if(Za(o,$[ee],$[ee+1]))return!1;(D=$[ee])[1]>(g=o)[1]!=(M=$[ee+1])[1]>g[1]&&g[0]<(M[0]-D[0])*(g[1]-D[1])/(M[1]-D[1])+D[0]&&(c=!c)}}var g,D,M;return c}function Ta(o,t){for(let c=0;c<t.length;c++)if(ts(o,t[c]))return!0;return!1}function hs(o,t,c,g){const D=g[0]-c[0],M=g[1]-c[1],P=(o[0]-c[0])*M-D*(o[1]-c[1]),B=(t[0]-c[0])*M-D*(t[1]-c[1]);return P>0&&B<0||P<0&&B>0}function Sa(o,t,c){for(const ee of c)for(let se=0;se<ee.length-1;++se)if((B=[(P=ee[se+1])[0]-(M=ee[se])[0],P[1]-M[1]])[0]*($=[(D=t)[0]-(g=o)[0],D[1]-g[1]])[1]-B[1]*$[0]!=0&&hs(g,D,M,P)&&hs(M,P,g,D))return!0;var g,D,M,P,B,$;return!1}function Qs(o,t){for(let c=0;c<o.length;++c)if(!ts(o[c],t))return!1;for(let c=0;c<o.length-1;++c)if(Sa(o[c],o[c+1],t))return!1;return!0}function $s(o,t){for(let c=0;c<t.length;c++)if(Qs(o,t[c]))return!0;return!1}function Oo(o,t,c){const g=[];for(let D=0;D<o.length;D++){const M=[];for(let P=0;P<o[D].length;P++){const B=io(o[D][P],c);da(t,B),M.push(B)}g.push(M)}return g}function Ya(o,t,c){const g=[];for(let D=0;D<o.length;D++){const M=Oo(o[D],t,c);g.push(M)}return g}function Ma(o,t,c,g){if(o[0]<c[0]||o[0]>c[2]){const D=.5*g;let M=o[0]-c[0]>D?-g:c[0]-o[0]>D?g:0;0===M&&(M=o[0]-c[2]>D?-g:c[2]-o[0]>D?g:0),o[0]+=M}da(t,o)}function dl(o,t,c,g){const D=Math.pow(2,g.z)*Ts,M=[g.x*Ts,g.y*Ts],P=[];for(const B of o)for(const $ of B){const ee=[$.x+M[0],$.y+M[1]];Ma(ee,t,c,D),P.push(ee)}return P}function dr(o,t,c,g){const D=Math.pow(2,g.z)*Ts,M=[g.x*Ts,g.y*Ts],P=[];for(const $ of o){const ee=[];for(const se of $){const fe=[se.x+M[0],se.y+M[1]];da(t,fe),ee.push(fe)}P.push(ee)}if(t[2]-t[0]<=D/2){(B=t)[0]=B[1]=1/0,B[2]=B[3]=-1/0;for(const $ of P)for(const ee of $)Ma(ee,t,c,D)}var B;return P}class $r{constructor(t,c){this.type=Qt,this.geojson=t,this.geometries=c}static parse(t,c){if(2!==t.length)return c.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Ki(t[1])){const g=t[1];if("FeatureCollection"===g.type)for(let D=0;D<g.features.length;++D){const M=g.features[D].geometry.type;if("Polygon"===M||"MultiPolygon"===M)return new $r(g,g.features[D].geometry)}else if("Feature"===g.type){const D=g.geometry.type;if("Polygon"===D||"MultiPolygon"===D)return new $r(g,g.geometry)}else if("Polygon"===g.type||"MultiPolygon"===g.type)return new $r(g,g)}return c.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(null!=t.geometry()&&null!=t.canonicalID()){if("Point"===t.geometryType())return function(c,g){const D=[1/0,1/0,-1/0,-1/0],M=[1/0,1/0,-1/0,-1/0],P=c.canonicalID();if("Polygon"===g.type){const B=Oo(g.coordinates,M,P),$=dl(c.geometry(),D,M,P);if(!Ss(D,M))return!1;for(const ee of $)if(!ts(ee,B))return!1}if("MultiPolygon"===g.type){const B=Ya(g.coordinates,M,P),$=dl(c.geometry(),D,M,P);if(!Ss(D,M))return!1;for(const ee of $)if(!Ta(ee,B))return!1}return!0}(t,this.geometries);if("LineString"===t.geometryType())return function(c,g){const D=[1/0,1/0,-1/0,-1/0],M=[1/0,1/0,-1/0,-1/0],P=c.canonicalID();if("Polygon"===g.type){const B=Oo(g.coordinates,M,P),$=dr(c.geometry(),D,M,P);if(!Ss(D,M))return!1;for(const ee of $)if(!Qs(ee,B))return!1}if("MultiPolygon"===g.type){const B=Ya(g.coordinates,M,P),$=dr(c.geometry(),D,M,P);if(!Ss(D,M))return!1;for(const ee of $)if(!$s(ee,B))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class bo{constructor(t,c){this.type=c.type,this.name=t,this.boundExpression=c}static parse(t,c){if(2!==t.length||"string"!=typeof t[1])return c.error("'var' expression requires exactly one string literal argument.");const g=t[1];return c.scope.has(g)?new bo(g,c.scope.get(g)):c.error(`Unknown variable "${g}". Make sure "${g}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class xo{constructor(t,c,g,D){this.name=t,this.type=c,this._evaluate=g,this.args=D}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,c){const g=t[0],D=xo.definitions[g];if(!D)return c.error(`Unknown expression "${g}". If you wanted a literal array, use ["literal", [...]].`,0);const M=Array.isArray(D)?D[0]:D.type,P=Array.isArray(D)?[[D[1],D[2]]]:D.overloads,B=P.filter(([ee])=>!Array.isArray(ee)||ee.length===t.length-1);let $=null;for(const[ee,se]of B){$=new es(c.registry,Po,c.path,null,c.scope);const fe=[];let ve=!1;for(let xe=1;xe<t.length;xe++){const Te=t[xe],je=Array.isArray(ee)?ee[xe-1]:ee.type,Ue=$.parse(Te,1+fe.length,je);if(!Ue){ve=!0;break}fe.push(Ue)}if(!ve)if(Array.isArray(ee)&&ee.length!==fe.length)$.error(`Expected ${ee.length} arguments, but found ${fe.length} instead.`);else{for(let xe=0;xe<fe.length;xe++){const Te=Array.isArray(ee)?ee[xe]:ee.type,je=fe[xe];$.concat(xe+1).checkSubtype(Te,je.type)}if(0===$.errors.length)return new xo(g,M,se,fe)}}if(1===B.length)c.errors.push(...$.errors);else{const ee=(B.length?B:P).map(([fe])=>{return ve=fe,Array.isArray(ve)?`(${ve.map(si).join(", ")})`:`(${si(ve.type)}...)`;var ve}).join(" | "),se=[];for(let fe=1;fe<t.length;fe++){const ve=c.parse(t[fe],1+se.length);if(!ve)return null;se.push(si(ve.type))}c.error(`Expected arguments of type ${ee}, but found (${se.join(", ")}) instead.`)}return null}static register(t,c){xo.definitions=c;for(const g in c)t[g]=xo}}function Po(o){if(o instanceof bo)return Po(o.boundExpression);if(o instanceof xo&&"error"===o.name||o instanceof ir||o instanceof $r)return!1;const t=o instanceof Vi||o instanceof mo;let c=!0;return o.eachChild(g=>{c=t?c&&Po(g):c&&g instanceof Hi}),!!c&&Ms(o)&&Gs(o,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Ms(o){if(o instanceof xo&&("get"===o.name&&1===o.args.length||"feature-state"===o.name||"has"===o.name&&1===o.args.length||"properties"===o.name||"geometry-type"===o.name||"id"===o.name||/^filter-/.test(o.name))||o instanceof $r)return!1;let t=!0;return o.eachChild(c=>{t&&!Ms(c)&&(t=!1)}),t}function ks(o){if(o instanceof xo&&"feature-state"===o.name)return!1;let t=!0;return o.eachChild(c=>{t&&!ks(c)&&(t=!1)}),t}function Gs(o,t){if(o instanceof xo&&t.indexOf(o.name)>=0)return!1;let c=!0;return o.eachChild(g=>{c&&!Gs(g,t)&&(c=!1)}),c}function qa(o,t){const c=o.length-1;let g,D,M=0,P=c,B=0;for(;M<=P;)if(B=Math.floor((M+P)/2),g=o[B],D=o[B+1],g<=t){if(B===c||t<D)return B;M=B+1}else{if(!(g>t))throw new hi("Input is not a number.");P=B-1}return 0}class Fs{constructor(t,c,g){this.type=t,this.input=c,this.labels=[],this.outputs=[];for(const[D,M]of g)this.labels.push(D),this.outputs.push(M)}static parse(t,c){if(t.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return c.error("Expected an even number of arguments.");const g=c.parse(t[1],1,rn);if(!g)return null;const D=[];let M=null;c.expectedType&&"value"!==c.expectedType.kind&&(M=c.expectedType);for(let P=1;P<t.length;P+=2){const B=1===P?-1/0:t[P],$=t[P+1],ee=P,se=P+1;if("number"!=typeof B)return c.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ee);if(D.length&&D[D.length-1][0]>=B)return c.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ee);const fe=c.parse($,se,M);if(!fe)return null;M=M||fe.type,D.push([B,fe])}return new Fs(M,g,D)}evaluate(t){const c=this.labels,g=this.outputs;if(1===c.length)return g[0].evaluate(t);const D=this.input.evaluate(t);if(D<=c[0])return g[0].evaluate(t);const M=c.length;return D>=c[M-1]?g[M-1].evaluate(t):g[qa(c,D)].evaluate(t)}eachChild(t){t(this.input);for(const c of this.outputs)t(c)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function rr(o,t,c){return o+c*(t-o)}function Ln(o,t,c){return o.map((g,D)=>rr(g,t[D],c))}const ai={number:rr,color:function(o,t,c,g="rgb"){switch(g){case"rgb":{const[D,M,P,B]=Ln(o.rgb,t.rgb,c);return new Wt(D,M,P,B,!1)}case"hcl":{const[D,M,P,B]=o.hcl,[$,ee,se,fe]=t.hcl;let ve,xe;if(isNaN(D)||isNaN($))isNaN(D)?isNaN($)?ve=NaN:(ve=$,1!==P&&0!==P||(xe=ee)):(ve=D,1!==se&&0!==se||(xe=M));else{let pt=$-D;$>D&&pt>180?pt-=360:$<D&&D-$>180&&(pt+=360),ve=D+c*pt}const[Te,je,Ue,it]=function([pt,Je,Ct,At]){return pt=isNaN(pt)?0:pt*Se,sn([Ct,Math.cos(pt)*Je,Math.sin(pt)*Je,At])}([ve,xe??rr(M,ee,c),rr(P,se,c),rr(B,fe,c)]);return new Wt(Te,je,Ue,it,!1)}case"lab":{const[D,M,P,B]=sn(Ln(o.lab,t.lab,c));return new Wt(D,M,P,B,!1)}}},array:Ln,padding:function(o,t,c){return new nr(Ln(o.values,t.values,c))}};class Fi{constructor(t,c,g,D,M){this.type=t,this.operator=c,this.interpolation=g,this.input=D,this.labels=[],this.outputs=[];for(const[P,B]of M)this.labels.push(P),this.outputs.push(B)}static interpolationFactor(t,c,g,D){let M=0;if("exponential"===t.name)M=ro(c,t.base,g,D);else if("linear"===t.name)M=ro(c,1,g,D);else if("cubic-bezier"===t.name){const P=t.controlPoints;M=new It(P[0],P[1],P[2],P[3]).solve(ro(c,1,g,D))}return M}static parse(t,c){let[g,D,M,...P]=t;if(!Array.isArray(D)||0===D.length)return c.error("Expected an interpolation type expression.",1);if("linear"===D[0])D={name:"linear"};else if("exponential"===D[0]){const ee=D[1];if("number"!=typeof ee)return c.error("Exponential interpolation requires a numeric base.",1,1);D={name:"exponential",base:ee}}else{if("cubic-bezier"!==D[0])return c.error(`Unknown interpolation type ${String(D[0])}`,1,0);{const ee=D.slice(1);if(4!==ee.length||ee.some(se=>"number"!=typeof se||se<0||se>1))return c.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);D={name:"cubic-bezier",controlPoints:ee}}}if(t.length-1<4)return c.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return c.error("Expected an even number of arguments.");if(M=c.parse(M,2,rn),!M)return null;const B=[];let $=null;"interpolate-hcl"===g||"interpolate-lab"===g?$=mr:c.expectedType&&"value"!==c.expectedType.kind&&($=c.expectedType);for(let ee=0;ee<P.length;ee+=2){const se=P[ee],fe=P[ee+1],ve=ee+3,xe=ee+4;if("number"!=typeof se)return c.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ve);if(B.length&&B[B.length-1][0]>=se)return c.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ve);const Te=c.parse(fe,xe,$);if(!Te)return null;$=$||Te.type,B.push([se,Te])}return ye($,rn)||ye($,mr)||ye($,_r)||ye($,ur(rn))?new Fi($,g,D,M,B):c.error(`Type ${si($)} is not interpolatable.`)}evaluate(t){const c=this.labels,g=this.outputs;if(1===c.length)return g[0].evaluate(t);const D=this.input.evaluate(t);if(D<=c[0])return g[0].evaluate(t);const M=c.length;if(D>=c[M-1])return g[M-1].evaluate(t);const P=qa(c,D),B=Fi.interpolationFactor(this.interpolation,D,c[P],c[P+1]),$=g[P].evaluate(t),ee=g[P+1].evaluate(t);switch(this.operator){case"interpolate":return ai[this.type.kind]($,ee,B);case"interpolate-hcl":return ai.color($,ee,B,"hcl");case"interpolate-lab":return ai.color($,ee,B,"lab")}}eachChild(t){t(this.input);for(const c of this.outputs)t(c)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function ro(o,t,c,g){const D=g-c,M=o-c;return 0===D?0:1===t?M/D:(Math.pow(t,M)-1)/(Math.pow(t,D)-1)}class $i{constructor(t,c){this.type=t,this.args=c}static parse(t,c){if(t.length<2)return c.error("Expectected at least one argument.");let g=null;const D=c.expectedType;D&&"value"!==D.kind&&(g=D);const M=[];for(const B of t.slice(1)){const $=c.parse(B,1+M.length,g,void 0,{typeAnnotation:"omit"});if(!$)return null;g=g||$.type,M.push($)}if(!g)throw new Error("No output type");const P=D&&M.some(B=>Vo(D,B.type));return new $i(P?Rn:g,M)}evaluate(t){let c,g=null,D=0;for(const M of this.args)if(D++,g=M.evaluate(t),g&&g instanceof ji&&!g.available&&(c||(c=g.name),g=null,D===this.args.length&&(g=c)),null!==g)break;return g}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}class Zr{constructor(t,c){this.type=c.type,this.bindings=[].concat(t),this.result=c}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const c of this.bindings)t(c[1]);t(this.result)}static parse(t,c){if(t.length<4)return c.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const g=[];for(let M=1;M<t.length-1;M+=2){const P=t[M];if("string"!=typeof P)return c.error(`Expected string, but found ${typeof P} instead.`,M);if(/[^a-zA-Z0-9_]/.test(P))return c.error("Variable names must contain only alphanumeric characters or '_'.",M);const B=c.parse(t[M+1],M+1);if(!B)return null;g.push([P,B])}const D=c.parse(t[t.length-1],t.length-1,c.expectedType,g);return D?new Zr(g,D):null}outputDefined(){return this.result.outputDefined()}}class fs{constructor(t,c,g){this.type=t,this.index=c,this.input=g}static parse(t,c){if(3!==t.length)return c.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const g=c.parse(t[1],1,rn),D=c.parse(t[2],2,ur(c.expectedType||Rn));return g&&D?new fs(D.type.itemType,g,D):null}evaluate(t){const c=this.index.evaluate(t),g=this.input.evaluate(t);if(c<0)throw new hi(`Array index out of bounds: ${c} < 0.`);if(c>=g.length)throw new hi(`Array index out of bounds: ${c} > ${g.length-1}.`);if(c!==Math.floor(c))throw new hi(`Array index must be an integer, but found ${c} instead.`);return g[c]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class zr{constructor(t,c){this.type=Qt,this.needle=t,this.haystack=c}static parse(t,c){if(3!==t.length)return c.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const g=c.parse(t[1],1,Rn),D=c.parse(t[2],2,Rn);return g&&D?Le(g.type,[Qt,On,rn,qn,Rn])?new zr(g,D):c.error(`Expected first argument to be of type boolean, string, number or null, but found ${si(g.type)} instead`):null}evaluate(t){const c=this.needle.evaluate(t),g=this.haystack.evaluate(t);if(!g)return!1;if(!he(c,["boolean","string","number","null"]))throw new hi(`Expected first argument to be of type boolean, string, number or null, but found ${si(tr(c))} instead.`);if(!he(g,["string","array"]))throw new hi(`Expected second argument to be of type array or string, but found ${si(tr(g))} instead.`);return g.indexOf(c)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Gr{constructor(t,c,g){this.type=rn,this.needle=t,this.haystack=c,this.fromIndex=g}static parse(t,c){if(t.length<=2||t.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const g=c.parse(t[1],1,Rn),D=c.parse(t[2],2,Rn);if(!g||!D)return null;if(!Le(g.type,[Qt,On,rn,qn,Rn]))return c.error(`Expected first argument to be of type boolean, string, number or null, but found ${si(g.type)} instead`);if(4===t.length){const M=c.parse(t[3],3,rn);return M?new Gr(g,D,M):null}return new Gr(g,D)}evaluate(t){const c=this.needle.evaluate(t),g=this.haystack.evaluate(t);if(!he(c,["boolean","string","number","null"]))throw new hi(`Expected first argument to be of type boolean, string, number or null, but found ${si(tr(c))} instead.`);if(!he(g,["string","array"]))throw new hi(`Expected second argument to be of type array or string, but found ${si(tr(g))} instead.`);if(this.fromIndex){const D=this.fromIndex.evaluate(t);return g.indexOf(c,D)}return g.indexOf(c)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Ni{constructor(t,c,g,D,M,P){this.inputType=t,this.type=c,this.input=g,this.cases=D,this.outputs=M,this.otherwise=P}static parse(t,c){if(t.length<5)return c.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return c.error("Expected an even number of arguments.");let g,D;c.expectedType&&"value"!==c.expectedType.kind&&(D=c.expectedType);const M={},P=[];for(let ee=2;ee<t.length-1;ee+=2){let se=t[ee];const fe=t[ee+1];Array.isArray(se)||(se=[se]);const ve=c.concat(ee);if(0===se.length)return ve.error("Expected at least one branch label.");for(const Te of se){if("number"!=typeof Te&&"string"!=typeof Te)return ve.error("Branch labels must be numbers or strings.");if("number"==typeof Te&&Math.abs(Te)>Number.MAX_SAFE_INTEGER)return ve.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof Te&&Math.floor(Te)!==Te)return ve.error("Numeric branch labels must be integer values.");if(g){if(ve.checkSubtype(g,tr(Te)))return null}else g=tr(Te);if(void 0!==M[String(Te)])return ve.error("Branch labels must be unique.");M[String(Te)]=P.length}const xe=c.parse(fe,ee,D);if(!xe)return null;D=D||xe.type,P.push(xe)}const B=c.parse(t[1],1,Rn);if(!B)return null;const $=c.parse(t[t.length-1],t.length-1,D);return $?"value"!==B.type.kind&&c.concat(1).checkSubtype(g,B.type)?null:new Ni(g,D,B,M,P,$):null}evaluate(t){const c=this.input.evaluate(t);return(tr(c)===this.inputType&&this.outputs[this.cases[c]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class Ei{constructor(t,c,g){this.type=t,this.branches=c,this.otherwise=g}static parse(t,c){if(t.length<4)return c.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return c.error("Expected an odd number of arguments.");let g;c.expectedType&&"value"!==c.expectedType.kind&&(g=c.expectedType);const D=[];for(let P=1;P<t.length-1;P+=2){const B=c.parse(t[P],P,Qt);if(!B)return null;const $=c.parse(t[P+1],P+1,g);if(!$)return null;D.push([B,$]),g=g||$.type}const M=c.parse(t[t.length-1],t.length-1,g);if(!M)return null;if(!g)throw new Error("Can't infer output type");return new Ei(g,D,M)}evaluate(t){for(const[c,g]of this.branches)if(c.evaluate(t))return g.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[c,g]of this.branches)t(c),t(g);t(this.otherwise)}outputDefined(){return this.branches.every(([t,c])=>c.outputDefined())&&this.otherwise.outputDefined()}}class ns{constructor(t,c,g,D){this.type=t,this.input=c,this.beginIndex=g,this.endIndex=D}static parse(t,c){if(t.length<=2||t.length>=5)return c.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const g=c.parse(t[1],1,Rn),D=c.parse(t[2],2,rn);if(!g||!D)return null;if(!Le(g.type,[ur(Rn),On,Rn]))return c.error(`Expected first argument to be of type array or string, but found ${si(g.type)} instead`);if(4===t.length){const M=c.parse(t[3],3,rn);return M?new ns(g.type,g,D,M):null}return new ns(g.type,g,D)}evaluate(t){const c=this.input.evaluate(t),g=this.beginIndex.evaluate(t);if(!he(c,["string","array"]))throw new hi(`Expected first argument to be of type array or string, but found ${si(tr(c))} instead.`);if(this.endIndex){const D=this.endIndex.evaluate(t);return c.slice(g,D)}return c.slice(g)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function As(o,t){return"=="===o||"!="===o?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function ps(o,t,c,g){return 0===g.compare(t,c)}function yr(o,t,c){const g="=="!==o&&"!="!==o;return class B1{constructor(M,P,B){this.type=Qt,this.lhs=M,this.rhs=P,this.collator=B,this.hasUntypedArgument="value"===M.type.kind||"value"===P.type.kind}static parse(M,P){if(3!==M.length&&4!==M.length)return P.error("Expected two or three arguments.");const B=M[0];let $=P.parse(M[1],1,Rn);if(!$)return null;if(!As(B,$.type))return P.concat(1).error(`"${B}" comparisons are not supported for type '${si($.type)}'.`);let ee=P.parse(M[2],2,Rn);if(!ee)return null;if(!As(B,ee.type))return P.concat(2).error(`"${B}" comparisons are not supported for type '${si(ee.type)}'.`);if($.type.kind!==ee.type.kind&&"value"!==$.type.kind&&"value"!==ee.type.kind)return P.error(`Cannot compare types '${si($.type)}' and '${si(ee.type)}'.`);g&&("value"===$.type.kind&&"value"!==ee.type.kind?$=new mo(ee.type,[$]):"value"!==$.type.kind&&"value"===ee.type.kind&&(ee=new mo($.type,[ee])));let se=null;if(4===M.length){if("string"!==$.type.kind&&"string"!==ee.type.kind&&"value"!==$.type.kind&&"value"!==ee.type.kind)return P.error("Cannot use collator to compare non-string types.");if(se=P.parse(M[3],3,Li),!se)return null}return new B1($,ee,se)}evaluate(M){const P=this.lhs.evaluate(M),B=this.rhs.evaluate(M);if(g&&this.hasUntypedArgument){const $=tr(P),ee=tr(B);if($.kind!==ee.kind||"string"!==$.kind&&"number"!==$.kind)throw new hi(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${$.kind}, ${ee.kind}) instead.`)}if(this.collator&&!g&&this.hasUntypedArgument){const $=tr(P),ee=tr(B);if("string"!==$.kind||"string"!==ee.kind)return t(M,P,B)}return this.collator?c(M,P,B,this.collator.evaluate(M)):t(M,P,B)}eachChild(M){M(this.lhs),M(this.rhs),this.collator&&M(this.collator)}outputDefined(){return!0}}}const ha=yr("==",function(o,t,c){return t===c},ps),fa=yr("!=",function(o,t,c){return t!==c},function(o,t,c,g){return!ps(0,t,c,g)}),Zo=yr("<",function(o,t,c){return t<c},function(o,t,c,g){return g.compare(t,c)<0}),hl=yr(">",function(o,t,c){return t>c},function(o,t,c,g){return g.compare(t,c)>0}),Aa=yr("<=",function(o,t,c){return t<=c},function(o,t,c,g){return g.compare(t,c)<=0}),jo=yr(">=",function(o,t,c){return t>=c},function(o,t,c,g){return g.compare(t,c)>=0});class co{constructor(t,c,g,D,M){this.type=On,this.number=t,this.locale=c,this.currency=g,this.minFractionDigits=D,this.maxFractionDigits=M}static parse(t,c){if(3!==t.length)return c.error("Expected two arguments.");const g=c.parse(t[1],1,rn);if(!g)return null;const D=t[2];if("object"!=typeof D||Array.isArray(D))return c.error("NumberFormat options argument must be an object.");let M=null;if(D.locale&&(M=c.parse(D.locale,1,On),!M))return null;let P=null;if(D.currency&&(P=c.parse(D.currency,1,On),!P))return null;let B=null;if(D["min-fraction-digits"]&&(B=c.parse(D["min-fraction-digits"],1,rn),!B))return null;let $=null;return D["max-fraction-digits"]&&($=c.parse(D["max-fraction-digits"],1,rn),!$)?null:new co(g,M,P,B,$)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class Ls{constructor(t){this.type=Lr,this.sections=t}static parse(t,c){if(t.length<2)return c.error("Expected at least one argument.");const g=t[1];if(!Array.isArray(g)&&"object"==typeof g)return c.error("First argument must be an image or text section.");const D=[];let M=!1;for(let P=1;P<=t.length-1;++P){const B=t[P];if(M&&"object"==typeof B&&!Array.isArray(B)){M=!1;let $=null;if(B["font-scale"]&&($=c.parse(B["font-scale"],1,rn),!$))return null;let ee=null;if(B["text-font"]&&(ee=c.parse(B["text-font"],1,ur(On)),!ee))return null;let se=null;if(B["text-color"]&&(se=c.parse(B["text-color"],1,mr),!se))return null;const fe=D[D.length-1];fe.scale=$,fe.font=ee,fe.textColor=se}else{const $=c.parse(t[P],1,Rn);if(!$)return null;const ee=$.type.kind;if("string"!==ee&&"value"!==ee&&"null"!==ee&&"resolvedImage"!==ee)return c.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");M=!0,D.push({content:$,scale:null,font:null,textColor:null})}}return new Ls(D)}evaluate(t){return new Qn(this.sections.map(c=>{const g=c.content.evaluate(t);return tr(g)===Ai?new Zi("",g,null,null,null):new Zi(Hr(g),null,c.scale?c.scale.evaluate(t):null,c.font?c.font.evaluate(t).join(","):null,c.textColor?c.textColor.evaluate(t):null)}))}eachChild(t){for(const c of this.sections)t(c.content),c.scale&&t(c.scale),c.font&&t(c.font),c.textColor&&t(c.textColor)}outputDefined(){return!1}}class Ia{constructor(t){this.type=Ai,this.input=t}static parse(t,c){if(2!==t.length)return c.error("Expected two arguments.");const g=c.parse(t[1],1,On);return g?new Ia(g):c.error("No image name provided.")}evaluate(t){const c=this.input.evaluate(t),g=ji.fromString(c);return g&&t.availableImages&&(g.available=t.availableImages.indexOf(c)>-1),g}eachChild(t){t(this.input)}outputDefined(){return!1}}class Ui{constructor(t){this.type=rn,this.input=t}static parse(t,c){if(2!==t.length)return c.error(`Expected 1 argument, but found ${t.length-1} instead.`);const g=c.parse(t[1],1);return g?"array"!==g.type.kind&&"string"!==g.type.kind&&"value"!==g.type.kind?c.error(`Expected argument of type string or array, but found ${si(g.type)} instead.`):new Ui(g):null}evaluate(t){const c=this.input.evaluate(t);if("string"==typeof c||Array.isArray(c))return c.length;throw new hi(`Expected value to be of type string or array, but found ${si(tr(c))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const ea={"==":ha,"!=":fa,">":hl,"<":Zo,">=":jo,"<=":Aa,array:mo,at:fs,boolean:mo,case:Ei,coalesce:$i,collator:ir,format:Ls,image:Ia,in:zr,"index-of":Gr,interpolate:Fi,"interpolate-hcl":Fi,"interpolate-lab":Fi,length:Ui,let:Zr,literal:Hi,match:Ni,number:mo,"number-format":co,object:mo,slice:ns,step:Fs,string:mo,"to-boolean":Vi,"to-color":Vi,"to-number":Vi,"to-string":Vi,var:bo,within:$r};function pa(o,[t,c,g,D]){t=t.evaluate(o),c=c.evaluate(o),g=g.evaluate(o);const M=D?D.evaluate(o):1,P=Pr(t,c,g,M);if(P)throw new hi(P);return new Wt(t/255,c/255,g/255,M,!1)}function Dl(o,t){return o in t}function uo(o,t){const c=t[o];return void 0===c?null:c}function Nr(o){return{type:o}}function Er(o){return{result:"success",value:o}}function or(o){return{result:"error",value:o}}function ho(o){return"data-driven"===o["property-type"]||"cross-faded-data-driven"===o["property-type"]}function ta(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function Bo(o){return!!o.expression&&o.expression.interpolated}function wi(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":null===o?"null":typeof o}function ga(o){return"object"==typeof o&&null!==o&&!Array.isArray(o)}function Oa(o){return o}function Pa(o,t){const c="color"===t.type,g=o.stops&&"object"==typeof o.stops[0][0],D=g||!(g||void 0!==o.property),M=o.type||(Bo(t)?"exponential":"interval");if(c||"padding"===t.type){const se=c?Wt.parse:nr.parse;(o=qt({},o)).stops&&(o.stops=o.stops.map(fe=>[fe[0],se(fe[1])])),o.default=se(o.default?o.default:t.default)}if(o.colorSpace&&"rgb"!==(P=o.colorSpace)&&"hcl"!==P&&"lab"!==P)throw new Error(`Unknown color space: "${o.colorSpace}"`);var P;let B,$,ee;if("exponential"===M)B=jl;else if("interval"===M)B=gs;else if("categorical"===M){B=Cl,$=Object.create(null);for(const se of o.stops)$[se[0]]=se[1];ee=typeof o.stops[0][0]}else{if("identity"!==M)throw new Error(`Unknown function type "${M}"`);B=fl}if(g){const se={},fe=[];for(let Te=0;Te<o.stops.length;Te++){const je=o.stops[Te],Ue=je[0].zoom;void 0===se[Ue]&&(se[Ue]={zoom:Ue,type:o.type,property:o.property,default:o.default,stops:[]},fe.push(Ue)),se[Ue].stops.push([je[0].value,je[1]])}const ve=[];for(const Te of fe)ve.push([se[Te].zoom,Pa(se[Te],t)]);const xe={name:"linear"};return{kind:"composite",interpolationType:xe,interpolationFactor:Fi.interpolationFactor.bind(void 0,xe),zoomStops:ve.map(Te=>Te[0]),evaluate:({zoom:Te},je)=>jl({stops:ve,base:o.base},t,Te).evaluate(Te,je)}}if(D){const se="exponential"===M?{name:"exponential",base:void 0!==o.base?o.base:1}:null;return{kind:"camera",interpolationType:se,interpolationFactor:Fi.interpolationFactor.bind(void 0,se),zoomStops:o.stops.map(fe=>fe[0]),evaluate:({zoom:fe})=>B(o,t,fe,$,ee)}}return{kind:"source",evaluate(se,fe){const ve=fe&&fe.properties?fe.properties[o.property]:void 0;return void 0===ve?Ho(o.default,t.default):B(o,t,ve,$,ee)}}}function Ho(o,t,c){return void 0!==o?o:void 0!==t?t:void 0!==c?c:void 0}function Cl(o,t,c,g,D){return Ho(typeof c===D?g[c]:void 0,o.default,t.default)}function gs(o,t,c){if("number"!==wi(c))return Ho(o.default,t.default);const g=o.stops.length;if(1===g||c<=o.stops[0][0])return o.stops[0][1];if(c>=o.stops[g-1][0])return o.stops[g-1][1];const D=qa(o.stops.map(M=>M[0]),c);return o.stops[D][1]}function jl(o,t,c){const g=void 0!==o.base?o.base:1;if("number"!==wi(c))return Ho(o.default,t.default);const D=o.stops.length;if(1===D||c<=o.stops[0][0])return o.stops[0][1];if(c>=o.stops[D-1][0])return o.stops[D-1][1];const M=qa(o.stops.map(se=>se[0]),c),P=function(se,fe,ve,xe){const Te=xe-ve,je=se-ve;return 0===Te?0:1===fe?je/Te:(Math.pow(fe,je)-1)/(Math.pow(fe,Te)-1)}(c,g,o.stops[M][0],o.stops[M+1][0]),B=o.stops[M][1],$=o.stops[M+1][1],ee=ai[t.type]||Oa;return"function"==typeof B.evaluate?{evaluate(...se){const fe=B.evaluate.apply(void 0,se),ve=$.evaluate.apply(void 0,se);if(void 0!==fe&&void 0!==ve)return ee(fe,ve,P,o.colorSpace)}}:ee(B,$,P,o.colorSpace)}function fl(o,t,c){switch(t.type){case"color":c=Wt.parse(c);break;case"formatted":c=Qn.fromString(c.toString());break;case"resolvedImage":c=ji.fromString(c.toString());break;case"padding":c=nr.parse(c);break;default:wi(c)===t.type||"enum"===t.type&&t.values[c]||(c=void 0)}return Ho(c,o.default,t.default)}xo.register(ea,{error:[{kind:"error"},[On],(o,[t])=>{throw new hi(t.evaluate(o))}],typeof:[On,[Rn],(o,[t])=>si(tr(t.evaluate(o)))],"to-rgba":[ur(rn,4),[mr],(o,[t])=>{const[c,g,D,M]=t.evaluate(o).rgb;return[255*c,255*g,255*D,M]}],rgb:[mr,[rn,rn,rn],pa],rgba:[mr,[rn,rn,rn,rn],pa],has:{type:Qt,overloads:[[[On],(o,[t])=>Dl(t.evaluate(o),o.properties())],[[On,ii],(o,[t,c])=>Dl(t.evaluate(o),c.evaluate(o))]]},get:{type:Rn,overloads:[[[On],(o,[t])=>uo(t.evaluate(o),o.properties())],[[On,ii],(o,[t,c])=>uo(t.evaluate(o),c.evaluate(o))]]},"feature-state":[Rn,[On],(o,[t])=>uo(t.evaluate(o),o.featureState||{})],properties:[ii,[],o=>o.properties()],"geometry-type":[On,[],o=>o.geometryType()],id:[Rn,[],o=>o.id()],zoom:[rn,[],o=>o.globals.zoom],"heatmap-density":[rn,[],o=>o.globals.heatmapDensity||0],"line-progress":[rn,[],o=>o.globals.lineProgress||0],accumulated:[Rn,[],o=>void 0===o.globals.accumulated?null:o.globals.accumulated],"+":[rn,Nr(rn),(o,t)=>{let c=0;for(const g of t)c+=g.evaluate(o);return c}],"*":[rn,Nr(rn),(o,t)=>{let c=1;for(const g of t)c*=g.evaluate(o);return c}],"-":{type:rn,overloads:[[[rn,rn],(o,[t,c])=>t.evaluate(o)-c.evaluate(o)],[[rn],(o,[t])=>-t.evaluate(o)]]},"/":[rn,[rn,rn],(o,[t,c])=>t.evaluate(o)/c.evaluate(o)],"%":[rn,[rn,rn],(o,[t,c])=>t.evaluate(o)%c.evaluate(o)],ln2:[rn,[],()=>Math.LN2],pi:[rn,[],()=>Math.PI],e:[rn,[],()=>Math.E],"^":[rn,[rn,rn],(o,[t,c])=>Math.pow(t.evaluate(o),c.evaluate(o))],sqrt:[rn,[rn],(o,[t])=>Math.sqrt(t.evaluate(o))],log10:[rn,[rn],(o,[t])=>Math.log(t.evaluate(o))/Math.LN10],ln:[rn,[rn],(o,[t])=>Math.log(t.evaluate(o))],log2:[rn,[rn],(o,[t])=>Math.log(t.evaluate(o))/Math.LN2],sin:[rn,[rn],(o,[t])=>Math.sin(t.evaluate(o))],cos:[rn,[rn],(o,[t])=>Math.cos(t.evaluate(o))],tan:[rn,[rn],(o,[t])=>Math.tan(t.evaluate(o))],asin:[rn,[rn],(o,[t])=>Math.asin(t.evaluate(o))],acos:[rn,[rn],(o,[t])=>Math.acos(t.evaluate(o))],atan:[rn,[rn],(o,[t])=>Math.atan(t.evaluate(o))],min:[rn,Nr(rn),(o,t)=>Math.min(...t.map(c=>c.evaluate(o)))],max:[rn,Nr(rn),(o,t)=>Math.max(...t.map(c=>c.evaluate(o)))],abs:[rn,[rn],(o,[t])=>Math.abs(t.evaluate(o))],round:[rn,[rn],(o,[t])=>{const c=t.evaluate(o);return c<0?-Math.round(-c):Math.round(c)}],floor:[rn,[rn],(o,[t])=>Math.floor(t.evaluate(o))],ceil:[rn,[rn],(o,[t])=>Math.ceil(t.evaluate(o))],"filter-==":[Qt,[On,Rn],(o,[t,c])=>o.properties()[t.value]===c.value],"filter-id-==":[Qt,[Rn],(o,[t])=>o.id()===t.value],"filter-type-==":[Qt,[On],(o,[t])=>o.geometryType()===t.value],"filter-<":[Qt,[On,Rn],(o,[t,c])=>{const g=o.properties()[t.value],D=c.value;return typeof g==typeof D&&g<D}],"filter-id-<":[Qt,[Rn],(o,[t])=>{const c=o.id(),g=t.value;return typeof c==typeof g&&c<g}],"filter->":[Qt,[On,Rn],(o,[t,c])=>{const g=o.properties()[t.value],D=c.value;return typeof g==typeof D&&g>D}],"filter-id->":[Qt,[Rn],(o,[t])=>{const c=o.id(),g=t.value;return typeof c==typeof g&&c>g}],"filter-<=":[Qt,[On,Rn],(o,[t,c])=>{const g=o.properties()[t.value],D=c.value;return typeof g==typeof D&&g<=D}],"filter-id-<=":[Qt,[Rn],(o,[t])=>{const c=o.id(),g=t.value;return typeof c==typeof g&&c<=g}],"filter->=":[Qt,[On,Rn],(o,[t,c])=>{const g=o.properties()[t.value],D=c.value;return typeof g==typeof D&&g>=D}],"filter-id->=":[Qt,[Rn],(o,[t])=>{const c=o.id(),g=t.value;return typeof c==typeof g&&c>=g}],"filter-has":[Qt,[Rn],(o,[t])=>t.value in o.properties()],"filter-has-id":[Qt,[],o=>null!==o.id()&&void 0!==o.id()],"filter-type-in":[Qt,[ur(On)],(o,[t])=>t.value.indexOf(o.geometryType())>=0],"filter-id-in":[Qt,[ur(Rn)],(o,[t])=>t.value.indexOf(o.id())>=0],"filter-in-small":[Qt,[On,ur(Rn)],(o,[t,c])=>c.value.indexOf(o.properties()[t.value])>=0],"filter-in-large":[Qt,[On,ur(Rn)],(o,[t,c])=>function(g,D,M,P){for(;M<=P;){const B=M+P>>1;if(D[B]===g)return!0;D[B]>g?P=B-1:M=B+1}return!1}(o.properties()[t.value],c.value,0,c.value.length-1)],all:{type:Qt,overloads:[[[Qt,Qt],(o,[t,c])=>t.evaluate(o)&&c.evaluate(o)],[Nr(Qt),(o,t)=>{for(const c of t)if(!c.evaluate(o))return!1;return!0}]]},any:{type:Qt,overloads:[[[Qt,Qt],(o,[t,c])=>t.evaluate(o)||c.evaluate(o)],[Nr(Qt),(o,t)=>{for(const c of t)if(c.evaluate(o))return!0;return!1}]]},"!":[Qt,[Qt],(o,[t])=>!t.evaluate(o)],"is-supported-script":[Qt,[On],(o,[t])=>{const c=o.globals&&o.globals.isSupportedScript;return!c||c(t.evaluate(o))}],upcase:[On,[On],(o,[t])=>t.evaluate(o).toUpperCase()],downcase:[On,[On],(o,[t])=>t.evaluate(o).toLowerCase()],concat:[On,Nr(Rn),(o,t)=>t.map(c=>Hr(c.evaluate(o))).join("")],"resolved-locale":[On,[Li],(o,[t])=>t.evaluate(o).resolvedLocale()]});class hc{constructor(t,c){var g;this.expression=t,this._warningHistory={},this._evaluator=new ds,this._defaultValue=c?"color"===(g=c).type&&ga(g.default)?new Wt(0,0,0,0):"color"===g.type?Wt.parse(g.default)||null:"padding"===g.type?nr.parse(g.default)||null:void 0===g.default?null:g.default:null,this._enumValues=c&&"enum"===c.type?c.values:null}evaluateWithoutErrorHandling(t,c,g,D,M,P){return this._evaluator.globals=t,this._evaluator.feature=c,this._evaluator.featureState=g,this._evaluator.canonical=D,this._evaluator.availableImages=M||null,this._evaluator.formattedSection=P,this.expression.evaluate(this._evaluator)}evaluate(t,c,g,D,M,P){this._evaluator.globals=t,this._evaluator.feature=c||null,this._evaluator.featureState=g||null,this._evaluator.canonical=D,this._evaluator.availableImages=M||null,this._evaluator.formattedSection=P||null;try{const B=this.expression.evaluate(this._evaluator);if(null==B||"number"==typeof B&&B!=B)return this._defaultValue;if(this._enumValues&&!(B in this._enumValues))throw new hi(`Expected value to be one of ${Object.keys(this._enumValues).map($=>JSON.stringify($)).join(", ")}, but found ${JSON.stringify(B)} instead.`);return B}catch(B){return this._warningHistory[B.message]||(this._warningHistory[B.message]=!0,typeof console<"u"&&console.warn(B.message)),this._defaultValue}}}function Hl(o){return Array.isArray(o)&&o.length>0&&"string"==typeof o[0]&&o[0]in ea}function Yr(o,t){const c=new es(ea,Po,[],t?function(D){const M={color:mr,string:On,number:rn,enum:On,boolean:Qt,formatted:Lr,padding:_r,resolvedImage:Ai};return"array"===D.type?ur(M[D.value]||Rn,D.length):M[D.type]}(t):void 0),g=c.parse(o,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return g?Er(new hc(g,t)):or(c.errors)}class El{constructor(t,c){this.kind=t,this._styleExpression=c,this.isStateDependent="constant"!==t&&!ks(c.expression)}evaluateWithoutErrorHandling(t,c,g,D,M,P){return this._styleExpression.evaluateWithoutErrorHandling(t,c,g,D,M,P)}evaluate(t,c,g,D,M,P){return this._styleExpression.evaluate(t,c,g,D,M,P)}}class Bi{constructor(t,c,g,D){this.kind=t,this.zoomStops=g,this._styleExpression=c,this.isStateDependent="camera"!==t&&!ks(c.expression),this.interpolationType=D}evaluateWithoutErrorHandling(t,c,g,D,M,P){return this._styleExpression.evaluateWithoutErrorHandling(t,c,g,D,M,P)}evaluate(t,c,g,D,M,P){return this._styleExpression.evaluate(t,c,g,D,M,P)}interpolationFactor(t,c,g){return this.interpolationType?Fi.interpolationFactor(this.interpolationType,t,c,g):0}}function $l(o,t){const c=Yr(o,t);if("error"===c.result)return c;const g=c.value.expression,D=Ms(g);if(!D&&!ho(t))return or([new yn("","data expressions not supported")]);const M=Gs(g,["zoom"]);if(!M&&!ta(t))return or([new yn("","zoom expressions not supported")]);const P=vr(g);return P||M?P instanceof yn?or([P]):P instanceof Fi&&!Bo(t)?or([new yn("",'"interpolate" expressions cannot be used with this property')]):Er(P?new Bi(D?"camera":"composite",c.value,P.labels,P instanceof Fi?P.interpolation:void 0):new El(D?"constant":"source",c.value)):or([new yn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Rr{constructor(t,c){this._parameters=t,this._specification=c,qt(this,Pa(this._parameters,this._specification))}static deserialize(t){return new Rr(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function vr(o){let t=null;if(o instanceof Zr)t=vr(o.result);else if(o instanceof $i){for(const c of o.args)if(t=vr(c),t)break}else(o instanceof Fs||o instanceof Fi)&&o.input instanceof xo&&"zoom"===o.input.name&&(t=o);return t instanceof yn||o.eachChild(c=>{const g=vr(c);g instanceof yn?t=g:!t&&g?t=new yn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&g&&t!==g&&(t=new yn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function re(o){if(!0===o||!1===o)return!0;if(!Array.isArray(o)||0===o.length)return!1;switch(o[0]){case"has":return o.length>=2&&"$id"!==o[1]&&"$type"!==o[1];case"in":return o.length>=3&&("string"!=typeof o[1]||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==o.length||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const t of o.slice(1))if(!re(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}const ne={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function J(o){if(null==o)return{filter:()=>!0,needGeometry:!1};re(o)||(o=Vn(o));const t=Yr(o,ne);if("error"===t.result)throw new Error(t.value.map(c=>`${c.key}: ${c.message}`).join(", "));return{filter:(c,g,D)=>t.value.evaluate(c,g,{},D),needGeometry:Ft(o)}}function Ae(o,t){return o<t?-1:o>t?1:0}function Ft(o){if(!Array.isArray(o))return!1;if("within"===o[0])return!0;for(let t=1;t<o.length;t++)if(Ft(o[t]))return!0;return!1}function Vn(o){if(!o)return!0;const t=o[0];return o.length<=1?"any"!==t:"=="===t?Jr(o[1],o[2],"=="):"!="===t?na(Jr(o[1],o[2],"==")):"<"===t||">"===t||"<="===t||">="===t?Jr(o[1],o[2],t):"any"===t?(c=o.slice(1),["any"].concat(c.map(Vn))):"all"===t?["all"].concat(o.slice(1).map(Vn)):"none"===t?["all"].concat(o.slice(1).map(Vn).map(na)):"in"===t?Is(o[1],o.slice(2)):"!in"===t?na(Is(o[1],o.slice(2))):"has"===t?pl(o[1]):"!has"===t?na(pl(o[1])):"within"!==t||o;var c}function Jr(o,t,c){switch(o){case"$type":return[`filter-type-${c}`,t];case"$id":return[`filter-id-${c}`,t];default:return[`filter-${c}`,o,t]}}function Is(o,t){if(0===t.length)return!1;switch(o){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(c=>typeof c!=typeof t[0])?["filter-in-large",o,["literal",t.sort(Ae)]]:["filter-in-small",o,["literal",t]]}}function pl(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function na(o){return["!",o]}function fc(o){const t=typeof o;if("number"===t||"boolean"===t||"string"===t||null==o)return JSON.stringify(o);if(Array.isArray(o)){let D="[";for(const M of o)D+=`${fc(M)},`;return`${D}]`}const c=Object.keys(o).sort();let g="{";for(let D=0;D<c.length;D++)g+=`${JSON.stringify(c[D])}:${fc(o[c[D]])},`;return`${g}}`}function Tl(o){let t="";for(const c of Ci)t+=`/${fc(o[c])}`;return t}function Gl(o){const t=o.value;return t?[new at(o.key,t,"constants have been deprecated as of v8")]:[]}function fo(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function ms(o){if(Array.isArray(o))return o.map(ms);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const t={};for(const c in o)t[c]=ms(o[c]);return t}return fo(o)}function wo(o){const t=o.key,c=o.value,g=o.valueSpec||{},D=o.objectElementValidators||{},M=o.style,P=o.styleSpec,B=o.validateSpec;let $=[];const ee=wi(c);if("object"!==ee)return[new at(t,c,`object expected, ${ee} found`)];for(const se in c){const fe=se.split(".")[0],ve=g[fe]||g["*"];let xe;if(D[fe])xe=D[fe];else if(g[fe])xe=B;else if(D["*"])xe=D["*"];else{if(!g["*"]){$.push(new at(t,c[se],`unknown property "${se}"`));continue}xe=B}$=$.concat(xe({key:(t&&`${t}.`)+se,value:c[se],valueSpec:ve,style:M,styleSpec:P,object:c,objectKey:se,validateSpec:B},c))}for(const se in g)D[se]||g[se].required&&void 0===g[se].default&&void 0===c[se]&&$.push(new at(t,c,`missing required property "${se}"`));return $}function pc(o){const t=o.value,c=o.valueSpec,g=o.style,D=o.styleSpec,M=o.key,P=o.arrayElementValidator||o.validateSpec;if("array"!==wi(t))return[new at(M,t,`array expected, ${wi(t)} found`)];if(c.length&&t.length!==c.length)return[new at(M,t,`array length ${c.length} expected, length ${t.length} found`)];if(c["min-length"]&&t.length<c["min-length"])return[new at(M,t,`array length at least ${c["min-length"]} expected, length ${t.length} found`)];let B={type:c.value,values:c.values};D.$version<7&&(B.function=c.function),"object"===wi(c.value)&&(B=c.value);let $=[];for(let ee=0;ee<t.length;ee++)$=$.concat(P({array:t,arrayIndex:ee,value:t[ee],valueSpec:B,validateSpec:o.validateSpec,style:g,styleSpec:D,key:`${M}[${ee}]`}));return $}function gc(o){const t=o.key,c=o.value,g=o.valueSpec;let D=wi(c);return"number"===D&&c!=c&&(D="NaN"),"number"!==D?[new at(t,c,`number expected, ${D} found`)]:"minimum"in g&&c<g.minimum?[new at(t,c,`${c} is less than the minimum value ${g.minimum}`)]:"maximum"in g&&c>g.maximum?[new at(t,c,`${c} is greater than the maximum value ${g.maximum}`)]:[]}function Na(o){const t=o.valueSpec,c=fo(o.value.type);let g,D,M,P={};const B="categorical"!==c&&void 0===o.value.property,$=!B,ee="array"===wi(o.value.stops)&&"array"===wi(o.value.stops[0])&&"object"===wi(o.value.stops[0][0]),se=wo({key:o.key,value:o.value,valueSpec:o.styleSpec.function,validateSpec:o.validateSpec,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(xe){if("identity"===c)return[new at(xe.key,xe.value,'identity function may not have a "stops" property')];let Te=[];const je=xe.value;return Te=Te.concat(pc({key:xe.key,value:je,valueSpec:xe.valueSpec,validateSpec:xe.validateSpec,style:xe.style,styleSpec:xe.styleSpec,arrayElementValidator:fe})),"array"===wi(je)&&0===je.length&&Te.push(new at(xe.key,je,"array must have at least one stop")),Te},default:function(xe){return xe.validateSpec({key:xe.key,value:xe.value,valueSpec:t,validateSpec:xe.validateSpec,style:xe.style,styleSpec:xe.styleSpec})}}});return"identity"===c&&B&&se.push(new at(o.key,o.value,'missing required property "property"')),"identity"===c||o.value.stops||se.push(new at(o.key,o.value,'missing required property "stops"')),"exponential"===c&&o.valueSpec.expression&&!Bo(o.valueSpec)&&se.push(new at(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&($&&!ho(o.valueSpec)?se.push(new at(o.key,o.value,"property functions not supported")):B&&!ta(o.valueSpec)&&se.push(new at(o.key,o.value,"zoom functions not supported"))),"categorical"!==c&&!ee||void 0!==o.value.property||se.push(new at(o.key,o.value,'"property" property is required')),se;function fe(xe){let Te=[];const je=xe.value,Ue=xe.key;if("array"!==wi(je))return[new at(Ue,je,`array expected, ${wi(je)} found`)];if(2!==je.length)return[new at(Ue,je,`array length 2 expected, length ${je.length} found`)];if(ee){if("object"!==wi(je[0]))return[new at(Ue,je,`object expected, ${wi(je[0])} found`)];if(void 0===je[0].zoom)return[new at(Ue,je,"object stop key must have zoom")];if(void 0===je[0].value)return[new at(Ue,je,"object stop key must have value")];if(M&&M>fo(je[0].zoom))return[new at(Ue,je[0].zoom,"stop zoom values must appear in ascending order")];fo(je[0].zoom)!==M&&(M=fo(je[0].zoom),D=void 0,P={}),Te=Te.concat(wo({key:`${Ue}[0]`,value:je[0],valueSpec:{zoom:{}},validateSpec:xe.validateSpec,style:xe.style,styleSpec:xe.styleSpec,objectElementValidators:{zoom:gc,value:ve}}))}else Te=Te.concat(ve({key:`${Ue}[0]`,value:je[0],valueSpec:{},validateSpec:xe.validateSpec,style:xe.style,styleSpec:xe.styleSpec},je));return Hl(ms(je[1]))?Te.concat([new at(`${Ue}[1]`,je[1],"expressions are not allowed in function stops.")]):Te.concat(xe.validateSpec({key:`${Ue}[1]`,value:je[1],valueSpec:t,validateSpec:xe.validateSpec,style:xe.style,styleSpec:xe.styleSpec}))}function ve(xe,Te){const je=wi(xe.value),Ue=fo(xe.value),it=null!==xe.value?xe.value:Te;if(g){if(je!==g)return[new at(xe.key,it,`${je} stop domain type must match previous stop domain type ${g}`)]}else g=je;if("number"!==je&&"string"!==je&&"boolean"!==je)return[new at(xe.key,it,"stop domain value must be a number, string, or boolean")];if("number"!==je&&"categorical"!==c){let pt=`number expected, ${je} found`;return ho(t)&&void 0===c&&(pt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new at(xe.key,it,pt)]}return"categorical"!==c||"number"!==je||isFinite(Ue)&&Math.floor(Ue)===Ue?"categorical"!==c&&"number"===je&&void 0!==D&&Ue<D?[new at(xe.key,it,"stop domain values must appear in ascending order")]:(D=Ue,"categorical"===c&&Ue in P?[new at(xe.key,it,"stop domain values must be unique")]:(P[Ue]=!0,[])):[new at(xe.key,it,`integer expected, found ${Ue}`)]}}function Ra(o){const t=("property"===o.expressionContext?$l:Yr)(ms(o.value),o.valueSpec);if("error"===t.result)return t.value.map(g=>new at(`${o.key}${g.key}`,o.value,g.message));const c=t.value.expression||t.value._styleExpression.expression;if("property"===o.expressionContext&&"text-font"===o.propertyKey&&!c.outputDefined())return[new at(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===o.expressionContext&&"layout"===o.propertyType&&!ks(c))return[new at(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===o.expressionContext&&!ks(c))return[new at(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&0===o.expressionContext.indexOf("cluster")){if(!Gs(c,["zoom","feature-state"]))return[new at(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===o.expressionContext&&!Ms(c))return[new at(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ma(o){const t=o.key,c=o.value,g=o.valueSpec,D=[];return Array.isArray(g.values)?-1===g.values.indexOf(fo(c))&&D.push(new at(t,c,`expected one of [${g.values.join(", ")}], ${JSON.stringify(c)} found`)):-1===Object.keys(g.values).indexOf(fo(c))&&D.push(new at(t,c,`expected one of [${Object.keys(g.values).join(", ")}], ${JSON.stringify(c)} found`)),D}function Do(o){return re(ms(o.value))?Ra(qt({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Wl(o)}function Wl(o){const t=o.value,c=o.key;if("array"!==wi(t))return[new at(c,t,`array expected, ${wi(t)} found`)];const g=o.styleSpec;let D,M=[];if(t.length<1)return[new at(c,t,"filter array must have at least 1 element")];switch(M=M.concat(ma({key:`${c}[0]`,value:t[0],valueSpec:g.filter_operator,style:o.style,styleSpec:o.styleSpec})),fo(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===fo(t[1])&&M.push(new at(c,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&M.push(new at(c,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(D=wi(t[1]),"string"!==D&&M.push(new at(`${c}[1]`,t[1],`string expected, ${D} found`)));for(let P=2;P<t.length;P++)D=wi(t[P]),"$type"===fo(t[1])?M=M.concat(ma({key:`${c}[${P}]`,value:t[P],valueSpec:g.geometry_type,style:o.style,styleSpec:o.styleSpec})):"string"!==D&&"number"!==D&&"boolean"!==D&&M.push(new at(`${c}[${P}]`,t[P],`string, number, or boolean expected, ${D} found`));break;case"any":case"all":case"none":for(let P=1;P<t.length;P++)M=M.concat(Wl({key:`${c}[${P}]`,value:t[P],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":D=wi(t[1]),2!==t.length?M.push(new at(c,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==D&&M.push(new at(`${c}[1]`,t[1],`string expected, ${D} found`));break;case"within":D=wi(t[1]),2!==t.length?M.push(new at(c,t,`filter array for "${t[0]}" operator must have 2 elements`)):"object"!==D&&M.push(new at(`${c}[1]`,t[1],`object expected, ${D} found`))}return M}function Qr(o,t){const c=o.key,g=o.validateSpec,D=o.style,M=o.styleSpec,P=o.value,B=o.objectKey,$=M[`${t}_${o.layerType}`];if(!$)return[];const ee=B.match(/^(.*)-transition$/);if("paint"===t&&ee&&$[ee[1]]&&$[ee[1]].transition)return g({key:c,value:P,valueSpec:M.transition,style:D,styleSpec:M});const se=o.valueSpec||$[B];if(!se)return[new at(c,P,`unknown property "${B}"`)];let fe;if("string"===wi(P)&&ho(se)&&!se.tokens&&(fe=/^{([^}]+)}$/.exec(P)))return[new at(c,P,`"${B}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(fe[1])} }\`.`)];const ve=[];return"symbol"===o.layerType&&("text-field"===B&&D&&!D.glyphs&&ve.push(new at(c,P,'use of "text-field" requires a style "glyphs" property')),"text-font"===B&&ga(ms(P))&&"identity"===fo(P.type)&&ve.push(new at(c,P,'"text-font" does not support identity functions'))),ve.concat(g({key:o.key,value:P,valueSpec:se,style:D,styleSpec:M,expressionContext:"property",propertyType:t,propertyKey:B}))}function Sl(o){return Qr(o,"paint")}function Bc(o){return Qr(o,"layout")}function Ml(o){let t=[];const c=o.value,g=o.key,D=o.style,M=o.styleSpec;c.type||c.ref||t.push(new at(g,c,'either "type" or "ref" is required'));let P=fo(c.type);const B=fo(c.ref);if(c.id){const $=fo(c.id);for(let ee=0;ee<o.arrayIndex;ee++){const se=D.layers[ee];fo(se.id)===$&&t.push(new at(g,c.id,`duplicate layer id "${c.id}", previously used at line ${se.id.__line__}`))}}if("ref"in c){let $;["type","source","source-layer","filter","layout"].forEach(ee=>{ee in c&&t.push(new at(g,c[ee],`"${ee}" is prohibited for ref layers`))}),D.layers.forEach(ee=>{fo(ee.id)===B&&($=ee)}),$?$.ref?t.push(new at(g,c.ref,"ref cannot reference another ref layer")):P=fo($.type):t.push(new at(g,c.ref,`ref layer "${B}" not found`))}else if("background"!==P)if(c.source){const $=D.sources&&D.sources[c.source],ee=$&&fo($.type);$?"vector"===ee&&"raster"===P?t.push(new at(g,c.source,`layer "${c.id}" requires a raster source`)):"raster"===ee&&"raster"!==P?t.push(new at(g,c.source,`layer "${c.id}" requires a vector source`)):"vector"!==ee||c["source-layer"]?"raster-dem"===ee&&"hillshade"!==P?t.push(new at(g,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==P||!c.paint||!c.paint["line-gradient"]||"geojson"===ee&&$.lineMetrics||t.push(new at(g,c,`layer "${c.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new at(g,c,`layer "${c.id}" must specify a "source-layer"`)):t.push(new at(g,c.source,`source "${c.source}" not found`))}else t.push(new at(g,c,'missing required property "source"'));return t=t.concat(wo({key:g,value:c,valueSpec:M.layer,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,objectElementValidators:{"*":()=>[],type:()=>o.validateSpec({key:`${g}.type`,value:c.type,valueSpec:M.layer.type,style:o.style,styleSpec:o.styleSpec,validateSpec:o.validateSpec,object:c,objectKey:"type"}),filter:Do,layout:$=>wo({layer:c,key:$.key,value:$.value,style:$.style,styleSpec:$.styleSpec,validateSpec:$.validateSpec,objectElementValidators:{"*":ee=>Bc(qt({layerType:P},ee))}}),paint:$=>wo({layer:c,key:$.key,value:$.value,style:$.style,styleSpec:$.styleSpec,validateSpec:$.validateSpec,objectElementValidators:{"*":ee=>Sl(qt({layerType:P},ee))}})}})),t}function zo(o){const t=o.value,c=o.key,g=wi(t);return"string"!==g?[new at(c,t,`string expected, ${g} found`)]:[]}const is={promoteId:function({key:o,value:t}){if("string"===wi(t))return zo({key:o,value:t});{const c=[];for(const g in t)c.push(...zo({key:`${o}.${g}`,value:t[g]}));return c}}};function ka(o){const t=o.value,c=o.key,g=o.styleSpec,D=o.style,M=o.validateSpec;if(!t.type)return[new at(c,t,'"type" is required')];const P=fo(t.type);let B;switch(P){case"vector":case"raster":case"raster-dem":return B=wo({key:c,value:t,valueSpec:g[`source_${P.replace("-","_")}`],style:o.style,styleSpec:g,objectElementValidators:is,validateSpec:M}),B;case"geojson":if(B=wo({key:c,value:t,valueSpec:g.source_geojson,style:D,styleSpec:g,validateSpec:M,objectElementValidators:is}),t.cluster)for(const $ in t.clusterProperties){const[ee,se]=t.clusterProperties[$],fe="string"==typeof ee?[ee,["accumulated"],["get",$]]:ee;B.push(...Ra({key:`${c}.${$}.map`,value:se,validateSpec:M,expressionContext:"cluster-map"})),B.push(...Ra({key:`${c}.${$}.reduce`,value:fe,validateSpec:M,expressionContext:"cluster-reduce"}))}return B;case"video":return wo({key:c,value:t,valueSpec:g.source_video,style:D,validateSpec:M,styleSpec:g});case"image":return wo({key:c,value:t,valueSpec:g.source_image,style:D,validateSpec:M,styleSpec:g});case"canvas":return[new at(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ma({key:`${c}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:D,validateSpec:M,styleSpec:g})}}function cu(o){const t=o.value,c=o.styleSpec,g=c.light,D=o.style;let M=[];const P=wi(t);if(void 0===t)return M;if("object"!==P)return M=M.concat([new at("light",t,`object expected, ${P} found`)]),M;for(const B in t){const $=B.match(/^(.*)-transition$/);M=M.concat($&&g[$[1]]&&g[$[1]].transition?o.validateSpec({key:B,value:t[B],valueSpec:c.transition,validateSpec:o.validateSpec,style:D,styleSpec:c}):g[B]?o.validateSpec({key:B,value:t[B],valueSpec:g[B],validateSpec:o.validateSpec,style:D,styleSpec:c}):[new at(B,t[B],`unknown property "${B}"`)])}return M}function Al(o){const t=o.value,c=o.styleSpec,g=c.terrain,D=o.style;let M=[];const P=wi(t);if(void 0===t)return M;if("object"!==P)return M=M.concat([new at("terrain",t,`object expected, ${P} found`)]),M;for(const B in t)M=M.concat(g[B]?o.validateSpec({key:B,value:t[B],valueSpec:g[B],validateSpec:o.validateSpec,style:D,styleSpec:c}):[new at(B,t[B],`unknown property "${B}"`)]);return M}function mc(o){let t=[];const c=o.value,g=o.key;if(Array.isArray(c)){const D=[],M=[];for(const P in c)c[P].id&&D.includes(c[P].id)&&t.push(new at(g,c,`all the sprites' ids must be unique, but ${c[P].id} is duplicated`)),D.push(c[P].id),c[P].url&&M.includes(c[P].url)&&t.push(new at(g,c,`all the sprites' URLs must be unique, but ${c[P].url} is duplicated`)),M.push(c[P].url),t=t.concat(wo({key:`${g}[${P}]`,value:c[P],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:o.validateSpec}));return t}return zo({key:g,value:c})}const gl={"*":()=>[],array:pc,boolean:function(o){const t=o.value,c=o.key,g=wi(t);return"boolean"!==g?[new at(c,t,`boolean expected, ${g} found`)]:[]},number:gc,color:function(o){const t=o.key,c=o.value,g=wi(c);return"string"!==g?[new at(t,c,`color expected, ${g} found`)]:Wt.parse(String(c))?[]:[new at(t,c,`color expected, "${c}" found`)]},constants:Gl,enum:ma,filter:Do,function:Na,layer:Ml,object:wo,source:ka,light:cu,terrain:Al,string:zo,formatted:function(o){return 0===zo(o).length?[]:Ra(o)},resolvedImage:function(o){return 0===zo(o).length?[]:Ra(o)},padding:function(o){const t=o.key,c=o.value;if("array"===wi(c)){if(c.length<1||c.length>4)return[new at(t,c,`padding requires 1 to 4 values; ${c.length} values found`)];const g={type:"number"};let D=[];for(let M=0;M<c.length;M++)D=D.concat(o.validateSpec({key:`${t}[${M}]`,value:c[M],validateSpec:o.validateSpec,valueSpec:g}));return D}return gc({key:t,value:c,valueSpec:{}})},sprite:mc};function ia(o){const t=o.value,c=o.valueSpec,g=o.styleSpec;return o.validateSpec=ia,c.expression&&ga(fo(t))?Na(o):c.expression&&Hl(ms(t))?Ra(o):c.type&&gl[c.type]?gl[c.type](o):wo(qt({},o,{valueSpec:c.type?g[c.type]:c}))}function zc(o){const t=o.value,c=o.key,g=zo(o);return g.length||(-1===t.indexOf("{fontstack}")&&g.push(new at(c,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&g.push(new at(c,t,'"glyphs" url must include a "{range}" token'))),g}function Ws(o,t=st){let c=[];return c=c.concat(ia({key:"",value:o,valueSpec:t.$root,styleSpec:t,style:o,validateSpec:ia,objectElementValidators:{glyphs:zc,"*":()=>[]}})),o.constants&&(c=c.concat(Gl({key:"constants",value:o.constants,style:o,styleSpec:t,validateSpec:ia}))),Zl(c)}function Os(o){return function(t){return o({...t,validateSpec:ia})}}function Zl(o){return[].concat(o).sort((t,c)=>t.line-c.line)}function po(o){return function(...t){return Zl(o.apply(this,t))}}Ws.source=po(Os(ka)),Ws.sprite=po(Os(mc)),Ws.glyphs=po(Os(zc)),Ws.light=po(Os(cu)),Ws.terrain=po(Os(Al)),Ws.layer=po(Os(Ml)),Ws.filter=po(Os(Do)),Ws.paintProperty=po(Os(Sl)),Ws.layoutProperty=po(Os(Bc));const Fa=Ws,rd=Fa.light,Yl=Fa.paintProperty,uu=Fa.layoutProperty;function Il(o,t){let c=!1;if(t&&t.length)for(const g of t)o.fire(new di(new Error(g.message))),c=!0;return c}class _c{constructor(t,c,g){const D=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const P=new Int32Array(this.arrayBuffer);t=P[0],this.d=(c=P[1])+2*(g=P[2]);for(let $=0;$<this.d*this.d;$++){const ee=P[3+$],se=P[3+$+1];D.push(ee===se?null:P.subarray(ee,se))}const B=P[3+D.length+1];this.keys=P.subarray(P[3+D.length],B),this.bboxes=P.subarray(B),this.insert=this._insertReadonly}else{this.d=c+2*g;for(let P=0;P<this.d*this.d;P++)D.push([]);this.keys=[],this.bboxes=[]}this.n=c,this.extent=t,this.padding=g,this.scale=c/t,this.uid=0;const M=g/c*t;this.min=-M,this.max=t+M}insert(t,c,g,D,M){this._forEachCell(c,g,D,M,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(c),this.bboxes.push(g),this.bboxes.push(D),this.bboxes.push(M)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,c,g,D,M,P){this.cells[M].push(P)}query(t,c,g,D,M){const P=this.min,B=this.max;if(t<=P&&c<=P&&B<=g&&B<=D&&!M)return Array.prototype.slice.call(this.keys);{const $=[];return this._forEachCell(t,c,g,D,this._queryCell,$,{},M),$}}_queryCell(t,c,g,D,M,P,B,$){const ee=this.cells[M];if(null!==ee){const se=this.keys,fe=this.bboxes;for(let ve=0;ve<ee.length;ve++){const xe=ee[ve];if(void 0===B[xe]){const Te=4*xe;($?$(fe[Te+0],fe[Te+1],fe[Te+2],fe[Te+3]):t<=fe[Te+2]&&c<=fe[Te+3]&&g>=fe[Te+0]&&D>=fe[Te+1])?(B[xe]=!0,P.push(se[xe])):B[xe]=!1}}}}_forEachCell(t,c,g,D,M,P,B,$){const ee=this._convertToCellCoord(t),se=this._convertToCellCoord(c),fe=this._convertToCellCoord(g),ve=this._convertToCellCoord(D);for(let xe=ee;xe<=fe;xe++)for(let Te=se;Te<=ve;Te++){const je=this.d*Te+xe;if((!$||$(this._convertFromCellCoord(xe),this._convertFromCellCoord(Te),this._convertFromCellCoord(xe+1),this._convertFromCellCoord(Te+1)))&&M.call(this,t,c,g,D,je,P,B,$))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,c=3+this.cells.length+1+1;let g=0;for(let P=0;P<this.cells.length;P++)g+=this.cells[P].length;const D=new Int32Array(c+g+this.keys.length+this.bboxes.length);D[0]=this.extent,D[1]=this.n,D[2]=this.padding;let M=c;for(let P=0;P<t.length;P++){const B=t[P];D[3+P]=M,D.set(B,M),M+=B.length}return D[3+t.length]=M,D.set(this.keys,M),M+=this.keys.length,D[3+t.length+1]=M,D.set(this.bboxes,M),M+=this.bboxes.length,D.buffer}static serialize(t,c){const g=t.toArrayBuffer();return c&&c.push(g),{buffer:g}}static deserialize(t){return new _c(t.buffer)}}const ra={};function Xn(o,t,c={}){if(ra[o])throw new Error(`${o} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:o,writeable:!1}),ra[o]={klass:t,omit:c.omit||[],shallow:c.shallow||[]}}Xn("Object",Object),Xn("TransferableGridIndex",_c),Xn("Color",Wt),Xn("Error",Error),Xn("AJAXError",bi),Xn("ResolvedImage",ji),Xn("StylePropertyFunction",Rr),Xn("StyleExpression",hc,{omit:["_evaluator"]}),Xn("ZoomDependentExpression",Bi),Xn("ZoomConstantExpression",El),Xn("CompoundExpression",xo,{omit:["_evaluate"]});for(const o in ea)ea[o]._classRegistryKey||Xn(`Expression_${o}`,ea[o]);function Vc(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&"ArrayBuffer"===o.constructor.name)}function _s(o,t){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob)return o;if(Vc(o)||bn(o))return t&&t.push(o),o;if(ArrayBuffer.isView(o)){const c=o;return t&&t.push(c.buffer),c}if(o instanceof ImageData)return t&&t.push(o.data.buffer),o;if(Array.isArray(o)){const c=[];for(const g of o)c.push(_s(g,t));return c}if("object"==typeof o){const c=o.constructor,g=c._classRegistryKey;if(!g)throw new Error("can't serialize object of unregistered class");if(!ra[g])throw new Error(`${g} is not registered.`);const D=c.serialize?c.serialize(o,t):{};if(c.serialize){if(t&&D===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const M in o){if(!o.hasOwnProperty(M)||ra[g].omit.indexOf(M)>=0)continue;const P=o[M];D[M]=ra[g].shallow.indexOf(M)>=0?P:_s(P,t)}o instanceof Error&&(D.message=o.message)}if(D.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==g&&(D.$name=g),D}throw new Error("can't serialize object of type "+typeof o)}function La(o){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||o instanceof Blob||Vc(o)||bn(o)||ArrayBuffer.isView(o)||o instanceof ImageData)return o;if(Array.isArray(o))return o.map(La);if("object"==typeof o){const t=o.$name||"Object";if(!ra[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:c}=ra[t];if(!c)throw new Error(`can't deserialize unregistered class ${t}`);if(c.deserialize)return c.deserialize(o);const g=Object.create(c.prototype);for(const D of Object.keys(o)){if("$name"===D)continue;const M=o[D];g[D]=ra[t].shallow.indexOf(D)>=0?M:La(M)}return g}throw new Error("can't deserialize object of type "+typeof o)}class rs{constructor(){this.first=!0}update(t,c){const g=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=g,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=g,!0):(this.lastFloorZoom>g?(this.lastIntegerZoom=g+1,this.lastIntegerZoomTime=c):this.lastFloorZoom<g&&(this.lastIntegerZoom=g,this.lastIntegerZoomTime=c),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=g,!0))}}const G={"Latin-1 Supplement":o=>o>=128&&o<=255,Arabic:o=>o>=1536&&o<=1791,"Arabic Supplement":o=>o>=1872&&o<=1919,"Arabic Extended-A":o=>o>=2208&&o<=2303,"Hangul Jamo":o=>o>=4352&&o<=4607,"Unified Canadian Aboriginal Syllabics":o=>o>=5120&&o<=5759,Khmer:o=>o>=6016&&o<=6143,"Unified Canadian Aboriginal Syllabics Extended":o=>o>=6320&&o<=6399,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"CJK Radicals Supplement":o=>o>=11904&&o<=12031,"Kangxi Radicals":o=>o>=12032&&o<=12255,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Bopomofo:o=>o>=12544&&o<=12591,"Hangul Compatibility Jamo":o=>o>=12592&&o<=12687,Kanbun:o=>o>=12688&&o<=12703,"Bopomofo Extended":o=>o>=12704&&o<=12735,"CJK Strokes":o=>o>=12736&&o<=12783,"Katakana Phonetic Extensions":o=>o>=12784&&o<=12799,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"CJK Unified Ideographs Extension A":o=>o>=13312&&o<=19903,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Yi Syllables":o=>o>=40960&&o<=42127,"Yi Radicals":o=>o>=42128&&o<=42191,"Hangul Jamo Extended-A":o=>o>=43360&&o<=43391,"Hangul Syllables":o=>o>=44032&&o<=55215,"Hangul Jamo Extended-B":o=>o>=55216&&o<=55295,"Private Use Area":o=>o>=57344&&o<=63743,"CJK Compatibility Ideographs":o=>o>=63744&&o<=64255,"Arabic Presentation Forms-A":o=>o>=64336&&o<=65023,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Arabic Presentation Forms-B":o=>o>=65136&&o<=65279,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function de(o){for(const t of o)if(He(t.charCodeAt(0)))return!0;return!1}function K(o){for(const t of o)if(!Ee(t.charCodeAt(0)))return!1;return!0}function Ee(o){return!(G.Arabic(o)||G["Arabic Supplement"](o)||G["Arabic Extended-A"](o)||G["Arabic Presentation Forms-A"](o)||G["Arabic Presentation Forms-B"](o))}function He(o){return!(746!==o&&747!==o&&(o<4352||!(G["Bopomofo Extended"](o)||G.Bopomofo(o)||G["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||G["CJK Compatibility Ideographs"](o)||G["CJK Compatibility"](o)||G["CJK Radicals Supplement"](o)||G["CJK Strokes"](o)||!(!G["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||12336===o)||G["CJK Unified Ideographs Extension A"](o)||G["CJK Unified Ideographs"](o)||G["Enclosed CJK Letters and Months"](o)||G["Hangul Compatibility Jamo"](o)||G["Hangul Jamo Extended-A"](o)||G["Hangul Jamo Extended-B"](o)||G["Hangul Jamo"](o)||G["Hangul Syllables"](o)||G.Hiragana(o)||G["Ideographic Description Characters"](o)||G.Kanbun(o)||G["Kangxi Radicals"](o)||G["Katakana Phonetic Extensions"](o)||G.Katakana(o)&&12540!==o||!(!G["Halfwidth and Fullwidth Forms"](o)||65288===o||65289===o||65293===o||o>=65306&&o<=65310||65339===o||65341===o||65343===o||o>=65371&&o<=65503||65507===o||o>=65512&&o<=65519)||!(!G["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||G["Unified Canadian Aboriginal Syllabics"](o)||G["Unified Canadian Aboriginal Syllabics Extended"](o)||G["Vertical Forms"](o)||G["Yijing Hexagram Symbols"](o)||G["Yi Syllables"](o)||G["Yi Radicals"](o))))}function St(o){return!(He(o)||(t=o,G["Latin-1 Supplement"](t)&&(167===t||169===t||174===t||177===t||188===t||189===t||190===t||215===t||247===t)||G["General Punctuation"](t)&&(8214===t||8224===t||8225===t||8240===t||8241===t||8251===t||8252===t||8258===t||8263===t||8264===t||8265===t||8273===t)||G["Letterlike Symbols"](t)||G["Number Forms"](t)||G["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||9003===t||t>=9085&&t<=9114||t>=9150&&t<=9165||9167===t||t>=9169&&t<=9179||t>=9186&&t<=9215)||G["Control Pictures"](t)&&9251!==t||G["Optical Character Recognition"](t)||G["Enclosed Alphanumerics"](t)||G["Geometric Shapes"](t)||G["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||G["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||G["CJK Symbols and Punctuation"](t)||G.Katakana(t)||G["Private Use Area"](t)||G["CJK Compatibility Forms"](t)||G["Small Form Variants"](t)||G["Halfwidth and Fullwidth Forms"](t)||8734===t||8756===t||8757===t||t>=9984&&t<=10087||t>=10102&&t<=10131||65532===t||65533===t));var t}function Kt(o){return o>=1424&&o<=2303||G["Arabic Presentation Forms-A"](o)||G["Arabic Presentation Forms-B"](o)}function ni(o,t){return!(!t&&Kt(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||G.Khmer(o))}function sr(o){for(const t of o)if(Kt(t.charCodeAt(0)))return!0;return!1}const Ri="deferred",lr="loading",Yi="loaded";let Wr=null,Ii="unavailable",Vr=null;const eo=function(o){o&&"string"==typeof o&&o.indexOf("NetworkError")>-1&&(Ii="error"),Wr&&Wr(o)};function Ps(){oa.fire(new zi("pluginStateChange",{pluginStatus:Ii,pluginURL:Vr}))}const oa=new Si,Co=function(){return Ii},kr=function(){if(Ii!==Ri||!Vr)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ii=lr,Ps(),Vr&&hn({url:Vr},o=>{o?eo(o):(Ii=Yi,Ps())})},Nn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ii===Yi||null!=Nn.applyArabicShaping,isLoading:()=>Ii===lr,setState(o){if(!zt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Ii=o.pluginStatus,Vr=o.pluginURL},isParsed(){if(!zt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return null!=Nn.applyArabicShaping&&null!=Nn.processBidirectionalText&&null!=Nn.processStyledBidirectionalText},getPluginURL(){if(!zt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return Vr}};class Xi{constructor(t,c){this.zoom=t,c?(this.now=c.now,this.fadeDuration=c.fadeDuration,this.zoomHistory=c.zoomHistory,this.transition=c.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new rs,this.transition={})}isSupportedScript(t){return function(c,g){for(const D of c)if(!ni(D.charCodeAt(0),g))return!1;return!0}(t,Nn.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,c=t-Math.floor(t),g=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:c+(1-c)*g}:{fromScale:.5,toScale:1,t:1-(1-g)*c}}}class Uc{constructor(t,c){this.property=t,this.value=c,this.expression=function(g,D){if(ga(g))return new Rr(g,D);if(Hl(g)){const M=$l(g,D);if("error"===M.result)throw new Error(M.value.map(P=>`${P.key}: ${P.message}`).join(", "));return M.value}{let M=g;return"color"===D.type&&"string"==typeof g?M=Wt.parse(g):"padding"!==D.type||"number"!=typeof g&&!Array.isArray(g)||(M=nr.parse(g)),{kind:"constant",evaluate:()=>M}}}(void 0===c?t.specification.default:c,t.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(t,c,g){return this.property.possiblyEvaluate(this,t,c,g)}}class _o{constructor(t){this.property=t,this.value=new Uc(t,void 0)}transitioned(t,c){return new ql(this.property,this.value,c,Tn({},t.transition,this.transition),t.now)}untransitioned(){return new ql(this.property,this.value,null,{},0)}}class Ru{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Tt(this._values[t].value.value)}setValue(t,c){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new _o(this._values[t].property)),this._values[t].value=new Uc(this._values[t].property,null===c?void 0:Tt(c))}getTransition(t){return Tt(this._values[t].transition)}setTransition(t,c){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new _o(this._values[t].property)),this._values[t].transition=Tt(c)||void 0}serialize(){const t={};for(const c of Object.keys(this._values)){const g=this.getValue(c);void 0!==g&&(t[c]=g);const D=this.getTransition(c);void 0!==D&&(t[`${c}-transition`]=D)}return t}transitioned(t,c){const g=new du(this._properties);for(const D of Object.keys(this._values))g._values[D]=this._values[D].transitioned(t,c._values[D]);return g}untransitioned(){const t=new du(this._properties);for(const c of Object.keys(this._values))t._values[c]=this._values[c].untransitioned();return t}}class ql{constructor(t,c,g,D,M){this.property=t,this.value=c,this.begin=M+D.delay||0,this.end=this.begin+D.duration||0,t.specification.transition&&(D.delay||D.duration)&&(this.prior=g)}possiblyEvaluate(t,c,g){const D=t.now||0,M=this.value.possiblyEvaluate(t,c,g),P=this.prior;if(P){if(D>this.end)return this.prior=null,M;if(this.value.isDataDriven())return this.prior=null,M;if(D<this.begin)return P.possiblyEvaluate(t,c,g);{const B=(D-this.begin)/(this.end-this.begin);return this.property.interpolate(P.possiblyEvaluate(t,c,g),M,function($){if($<=0)return 0;if($>=1)return 1;const ee=$*$,se=ee*$;return 4*($<.5?se:3*($-ee)+se-.75)}(B))}}return M}}class du{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,c,g){const D=new ys(this._properties);for(const M of Object.keys(this._values))D._values[M]=this._values[M].possiblyEvaluate(t,c,g);return D}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Zs{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return Tt(this._values[t].value)}setValue(t,c){this._values[t]=new Uc(this._values[t].property,null===c?void 0:Tt(c))}serialize(){const t={};for(const c of Object.keys(this._values)){const g=this.getValue(c);void 0!==g&&(t[c]=g)}return t}possiblyEvaluate(t,c,g){const D=new ys(this._properties);for(const M of Object.keys(this._values))D._values[M]=this._values[M].possiblyEvaluate(t,c,g);return D}}class Ba{constructor(t,c,g){this.property=t,this.value=c,this.parameters=g}isConstant(){return"constant"===this.value.kind}constantOr(t){return"constant"===this.value.kind?this.value.value:t}evaluate(t,c,g,D){return this.property.evaluate(this.value,this.parameters,t,c,g,D)}}class ys{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class li{constructor(t){this.specification=t}possiblyEvaluate(t,c){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(c)}interpolate(t,c,g){const D=ai[this.specification.type];return D?D(t,c,g):t}}class pi{constructor(t,c){this.specification=t,this.overrides=c}possiblyEvaluate(t,c,g,D){return new Ba(this,"constant"===t.expression.kind||"camera"===t.expression.kind?{kind:"constant",value:t.expression.evaluate(c,null,{},g,D)}:t.expression,c)}interpolate(t,c,g){if("constant"!==t.value.kind||"constant"!==c.value.kind)return t;if(void 0===t.value.value||void 0===c.value.value)return new Ba(this,{kind:"constant",value:void 0},t.parameters);const D=ai[this.specification.type];if(D){const M=D(t.value.value,c.value.value,g);return new Ba(this,{kind:"constant",value:M},t.parameters)}return t}evaluate(t,c,g,D,M,P){return"constant"===t.kind?t.value:t.evaluate(c,g,D,M,P)}}class yc extends pi{possiblyEvaluate(t,c,g,D){if(void 0===t.value)return new Ba(this,{kind:"constant",value:void 0},c);if("constant"===t.expression.kind){const M=t.expression.evaluate(c,null,{},g,D),P="resolvedImage"===t.property.specification.type&&"string"!=typeof M?M.name:M,B=this._calculate(P,P,P,c);return new Ba(this,{kind:"constant",value:B},c)}if("camera"===t.expression.kind){const M=this._calculate(t.expression.evaluate({zoom:c.zoom-1}),t.expression.evaluate({zoom:c.zoom}),t.expression.evaluate({zoom:c.zoom+1}),c);return new Ba(this,{kind:"constant",value:M},c)}return new Ba(this,t.expression,c)}evaluate(t,c,g,D,M,P){if("source"===t.kind){const B=t.evaluate(c,g,D,M,P);return this._calculate(B,B,B,c)}return"composite"===t.kind?this._calculate(t.evaluate({zoom:Math.floor(c.zoom)-1},g,D),t.evaluate({zoom:Math.floor(c.zoom)},g,D),t.evaluate({zoom:Math.floor(c.zoom)+1},g,D),c):t.value}_calculate(t,c,g,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:t,to:c}:{from:g,to:c}}interpolate(t){return t}}class dn{constructor(t){this.specification=t}possiblyEvaluate(t,c,g,D){if(void 0!==t.value){if("constant"===t.expression.kind){const M=t.expression.evaluate(c,null,{},g,D);return this._calculate(M,M,M,c)}return this._calculate(t.expression.evaluate(new Xi(Math.floor(c.zoom-1),c)),t.expression.evaluate(new Xi(Math.floor(c.zoom),c)),t.expression.evaluate(new Xi(Math.floor(c.zoom+1),c)),c)}}_calculate(t,c,g,D){return D.zoom>D.zoomHistory.lastIntegerZoom?{from:t,to:c}:{from:g,to:c}}interpolate(t){return t}}class qi{constructor(t){this.specification=t}possiblyEvaluate(t,c,g,D){return!!t.expression.evaluate(c,null,{},g,D)}interpolate(){return!1}}class Fr{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const c in t){const g=t[c];g.specification.overridable&&this.overridableProperties.push(c);const D=this.defaultPropertyValues[c]=new Uc(g,void 0),M=this.defaultTransitionablePropertyValues[c]=new _o(g);this.defaultTransitioningPropertyValues[c]=M.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=D.possiblyEvaluate({})}}}Xn("DataDrivenProperty",pi),Xn("DataConstantProperty",li),Xn("CrossFadedDataDrivenProperty",yc),Xn("CrossFadedProperty",dn),Xn("ColorRampProperty",qi);const od="-transition";class qr extends Si{constructor(t,c){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==t.type&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,"background"!==t.type&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),c.layout&&(this._unevaluatedLayout=new Zs(c.layout)),c.paint)){this._transitionablePaint=new Ru(c.paint);for(const g in t.paint)this.setPaintProperty(g,t.paint[g],{validate:!1});for(const g in t.layout)this.setLayoutProperty(g,t.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ys(c.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return"visibility"===t?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,c,g={}){null!=c&&this._validate(uu,`layers.${this.id}.layout.${t}`,t,c,g)||("visibility"!==t?this._unevaluatedLayout.setValue(t,c):this.visibility=c)}getPaintProperty(t){return t.endsWith(od)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,c,g={}){if(null!=c&&this._validate(Yl,`layers.${this.id}.paint.${t}`,t,c,g))return!1;if(t.endsWith(od))return this._transitionablePaint.setTransition(t.slice(0,-11),c||void 0),!1;{const D=this._transitionablePaint._values[t],M="cross-faded-data-driven"===D.property.specification["property-type"],P=D.value.isDataDriven(),B=D.value;this._transitionablePaint.setValue(t,c),this._handleSpecialPaintPropertyUpdate(t);const $=this._transitionablePaint._values[t].value;return $.isDataDriven()||P||M||this._handleOverridablePaintPropertyUpdate(t,B,$)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,c,g){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||"none"===this.visibility}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,c){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,c)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Vt(t,(c,g)=>!(void 0===c||"layout"===g&&!Object.keys(c).length||"paint"===g&&!Object.keys(c).length))}_validate(t,c,g,D,M={}){return(!M||!1!==M.validate)&&Il(this,t.call(Fa,{key:c,layerType:this.type,objectKey:g,value:D,styleSpec:st,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const c=this.paint.get(t);if(c instanceof Ba&&ho(c.property.specification)&&("source"===c.value.kind||"composite"===c.value.kind)&&c.value.isStateDependent)return!0}return!1}}const Kl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Yo{constructor(t,c){this._structArray=t,this._pos1=c*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ar{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,c){return t._trim(),c&&(t.isTransferred=!0,c.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const c=Object.create(this.prototype);return c.arrayBuffer=t.arrayBuffer,c.length=t.length,c.capacity=t.arrayBuffer.byteLength/c.bytesPerElement,c._refreshViews(),c}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const c=this.uint8;this._refreshViews(),c&&this.uint8.set(c)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function yo(o,t=1){let c=0,g=0;return{members:o.map(D=>{const M=Kl[D.type].BYTES_PER_ELEMENT,P=c=vs(c,Math.max(t,M)),B=D.components||1;return g=Math.max(g,M),c+=M*B,{name:D.name,type:D.type,components:B,offset:P}}),size:vs(c,Math.max(g,t)),alignment:t}}function vs(o,t){return Math.ceil(o/t)*t}class Ol extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,c){const g=this.length;return this.resize(g+1),this.emplace(g,t,c)}emplace(t,c,g){const D=2*t;return this.int16[D+0]=c,this.int16[D+1]=g,t}}Ol.prototype.bytesPerElement=4,Xn("StructArrayLayout2i4",Ol);class jc extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,c,g){const D=this.length;return this.resize(D+1),this.emplace(D,t,c,g)}emplace(t,c,g,D){const M=3*t;return this.int16[M+0]=c,this.int16[M+1]=g,this.int16[M+2]=D,t}}jc.prototype.bytesPerElement=6,Xn("StructArrayLayout3i6",jc);class Hc extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,c,g,D){const M=this.length;return this.resize(M+1),this.emplace(M,t,c,g,D)}emplace(t,c,g,D,M){const P=4*t;return this.int16[P+0]=c,this.int16[P+1]=g,this.int16[P+2]=D,this.int16[P+3]=M,t}}Hc.prototype.bytesPerElement=8,Xn("StructArrayLayout4i8",Hc);class Eo extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,c,g,D,M,P){const B=this.length;return this.resize(B+1),this.emplace(B,t,c,g,D,M,P)}emplace(t,c,g,D,M,P,B){const $=6*t;return this.int16[$+0]=c,this.int16[$+1]=g,this.int16[$+2]=D,this.int16[$+3]=M,this.int16[$+4]=P,this.int16[$+5]=B,t}}Eo.prototype.bytesPerElement=12,Xn("StructArrayLayout2i4i12",Eo);class Ys extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,c,g,D,M,P){const B=this.length;return this.resize(B+1),this.emplace(B,t,c,g,D,M,P)}emplace(t,c,g,D,M,P,B){const $=4*t,ee=8*t;return this.int16[$+0]=c,this.int16[$+1]=g,this.uint8[ee+4]=D,this.uint8[ee+5]=M,this.uint8[ee+6]=P,this.uint8[ee+7]=B,t}}Ys.prototype.bytesPerElement=8,Xn("StructArrayLayout2i4ub8",Ys);class za extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,c){const g=this.length;return this.resize(g+1),this.emplace(g,t,c)}emplace(t,c,g){const D=2*t;return this.float32[D+0]=c,this.float32[D+1]=g,t}}za.prototype.bytesPerElement=8,Xn("StructArrayLayout2f8",za);class os extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,c,g,D,M,P,B,$,ee,se){const fe=this.length;return this.resize(fe+1),this.emplace(fe,t,c,g,D,M,P,B,$,ee,se)}emplace(t,c,g,D,M,P,B,$,ee,se,fe){const ve=10*t;return this.uint16[ve+0]=c,this.uint16[ve+1]=g,this.uint16[ve+2]=D,this.uint16[ve+3]=M,this.uint16[ve+4]=P,this.uint16[ve+5]=B,this.uint16[ve+6]=$,this.uint16[ve+7]=ee,this.uint16[ve+8]=se,this.uint16[ve+9]=fe,t}}os.prototype.bytesPerElement=20,Xn("StructArrayLayout10ui20",os);class bs extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,c,g,D,M,P,B,$,ee,se,fe,ve){const xe=this.length;return this.resize(xe+1),this.emplace(xe,t,c,g,D,M,P,B,$,ee,se,fe,ve)}emplace(t,c,g,D,M,P,B,$,ee,se,fe,ve,xe){const Te=12*t;return this.int16[Te+0]=c,this.int16[Te+1]=g,this.int16[Te+2]=D,this.int16[Te+3]=M,this.uint16[Te+4]=P,this.uint16[Te+5]=B,this.uint16[Te+6]=$,this.uint16[Te+7]=ee,this.int16[Te+8]=se,this.int16[Te+9]=fe,this.int16[Te+10]=ve,this.int16[Te+11]=xe,t}}bs.prototype.bytesPerElement=24,Xn("StructArrayLayout4i4ui4i24",bs);class hu extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,c,g){const D=this.length;return this.resize(D+1),this.emplace(D,t,c,g)}emplace(t,c,g,D){const M=3*t;return this.float32[M+0]=c,this.float32[M+1]=g,this.float32[M+2]=D,t}}hu.prototype.bytesPerElement=12,Xn("StructArrayLayout3f12",hu);class Pl extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const c=this.length;return this.resize(c+1),this.emplace(c,t)}emplace(t,c){return this.uint32[1*t+0]=c,t}}Pl.prototype.bytesPerElement=4,Xn("StructArrayLayout1ul4",Pl);class Bs extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,c,g,D,M,P,B,$,ee){const se=this.length;return this.resize(se+1),this.emplace(se,t,c,g,D,M,P,B,$,ee)}emplace(t,c,g,D,M,P,B,$,ee,se){const fe=10*t,ve=5*t;return this.int16[fe+0]=c,this.int16[fe+1]=g,this.int16[fe+2]=D,this.int16[fe+3]=M,this.int16[fe+4]=P,this.int16[fe+5]=B,this.uint32[ve+3]=$,this.uint16[fe+8]=ee,this.uint16[fe+9]=se,t}}Bs.prototype.bytesPerElement=20,Xn("StructArrayLayout6i1ul2ui20",Bs);class $c extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,c,g,D,M,P){const B=this.length;return this.resize(B+1),this.emplace(B,t,c,g,D,M,P)}emplace(t,c,g,D,M,P,B){const $=6*t;return this.int16[$+0]=c,this.int16[$+1]=g,this.int16[$+2]=D,this.int16[$+3]=M,this.int16[$+4]=P,this.int16[$+5]=B,t}}$c.prototype.bytesPerElement=12,Xn("StructArrayLayout2i2i2i12",$c);class ml extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,c,g,D,M){const P=this.length;return this.resize(P+1),this.emplace(P,t,c,g,D,M)}emplace(t,c,g,D,M,P){const B=4*t,$=8*t;return this.float32[B+0]=c,this.float32[B+1]=g,this.float32[B+2]=D,this.int16[$+6]=M,this.int16[$+7]=P,t}}ml.prototype.bytesPerElement=16,Xn("StructArrayLayout2f1f2i16",ml);class Ka extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,c,g,D){const M=this.length;return this.resize(M+1),this.emplace(M,t,c,g,D)}emplace(t,c,g,D,M){const P=12*t,B=3*t;return this.uint8[P+0]=c,this.uint8[P+1]=g,this.float32[B+1]=D,this.float32[B+2]=M,t}}Ka.prototype.bytesPerElement=12,Xn("StructArrayLayout2ub2f12",Ka);class _a extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,c,g){const D=this.length;return this.resize(D+1),this.emplace(D,t,c,g)}emplace(t,c,g,D){const M=3*t;return this.uint16[M+0]=c,this.uint16[M+1]=g,this.uint16[M+2]=D,t}}_a.prototype.bytesPerElement=6,Xn("StructArrayLayout3ui6",_a);class Va extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,c,g,D,M,P,B,$,ee,se,fe,ve,xe,Te,je,Ue,it){const pt=this.length;return this.resize(pt+1),this.emplace(pt,t,c,g,D,M,P,B,$,ee,se,fe,ve,xe,Te,je,Ue,it)}emplace(t,c,g,D,M,P,B,$,ee,se,fe,ve,xe,Te,je,Ue,it,pt){const Je=24*t,Ct=12*t,At=48*t;return this.int16[Je+0]=c,this.int16[Je+1]=g,this.uint16[Je+2]=D,this.uint16[Je+3]=M,this.uint32[Ct+2]=P,this.uint32[Ct+3]=B,this.uint32[Ct+4]=$,this.uint16[Je+10]=ee,this.uint16[Je+11]=se,this.uint16[Je+12]=fe,this.float32[Ct+7]=ve,this.float32[Ct+8]=xe,this.uint8[At+36]=Te,this.uint8[At+37]=je,this.uint8[At+38]=Ue,this.uint32[Ct+10]=it,this.int16[Je+22]=pt,t}}Va.prototype.bytesPerElement=48,Xn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Va);class fu extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,c,g,D,M,P,B,$,ee,se,fe,ve,xe,Te,je,Ue,it,pt,Je,Ct,At,Xt,Jn,ei,$n,kn,In,Zn){const Un=this.length;return this.resize(Un+1),this.emplace(Un,t,c,g,D,M,P,B,$,ee,se,fe,ve,xe,Te,je,Ue,it,pt,Je,Ct,At,Xt,Jn,ei,$n,kn,In,Zn)}emplace(t,c,g,D,M,P,B,$,ee,se,fe,ve,xe,Te,je,Ue,it,pt,Je,Ct,At,Xt,Jn,ei,$n,kn,In,Zn,Un){const _n=34*t,xi=17*t;return this.int16[_n+0]=c,this.int16[_n+1]=g,this.int16[_n+2]=D,this.int16[_n+3]=M,this.int16[_n+4]=P,this.int16[_n+5]=B,this.int16[_n+6]=$,this.int16[_n+7]=ee,this.uint16[_n+8]=se,this.uint16[_n+9]=fe,this.uint16[_n+10]=ve,this.uint16[_n+11]=xe,this.uint16[_n+12]=Te,this.uint16[_n+13]=je,this.uint16[_n+14]=Ue,this.uint16[_n+15]=it,this.uint16[_n+16]=pt,this.uint16[_n+17]=Je,this.uint16[_n+18]=Ct,this.uint16[_n+19]=At,this.uint16[_n+20]=Xt,this.uint16[_n+21]=Jn,this.uint16[_n+22]=ei,this.uint32[xi+12]=$n,this.float32[xi+13]=kn,this.float32[xi+14]=In,this.float32[xi+15]=Zn,this.float32[xi+16]=Un,t}}fu.prototype.bytesPerElement=68,Xn("StructArrayLayout8i15ui1ul4f68",fu);class Nl extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const c=this.length;return this.resize(c+1),this.emplace(c,t)}emplace(t,c){return this.float32[1*t+0]=c,t}}Nl.prototype.bytesPerElement=4,Xn("StructArrayLayout1f4",Nl);class Xl extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,c,g){const D=this.length;return this.resize(D+1),this.emplace(D,t,c,g)}emplace(t,c,g,D){const M=4*t;return this.uint32[2*t+0]=c,this.uint16[M+2]=g,this.uint16[M+3]=D,t}}Xl.prototype.bytesPerElement=8,Xn("StructArrayLayout1ul2ui8",Xl);class w extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,c){const g=this.length;return this.resize(g+1),this.emplace(g,t,c)}emplace(t,c,g){const D=2*t;return this.uint16[D+0]=c,this.uint16[D+1]=g,t}}w.prototype.bytesPerElement=4,Xn("StructArrayLayout2ui4",w);class n extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const c=this.length;return this.resize(c+1),this.emplace(c,t)}emplace(t,c){return this.uint16[1*t+0]=c,t}}n.prototype.bytesPerElement=2,Xn("StructArrayLayout1ui2",n);class d extends Ar{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,c,g,D){const M=this.length;return this.resize(M+1),this.emplace(M,t,c,g,D)}emplace(t,c,g,D,M){const P=4*t;return this.float32[P+0]=c,this.float32[P+1]=g,this.float32[P+2]=D,this.float32[P+3]=M,t}}d.prototype.bytesPerElement=16,Xn("StructArrayLayout4f16",d);class y extends Yo{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new yt(this.anchorPointX,this.anchorPointY)}}y.prototype.size=20;class C extends Bs{get(t){return new y(this,t)}}Xn("CollisionBoxArray",C);class N extends Yo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}N.prototype.size=48;class V extends Va{get(t){return new N(this,t)}}Xn("PlacedSymbolArray",V);class Z extends Yo{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}Z.prototype.size=68;class Y extends fu{get(t){return new Z(this,t)}}Xn("SymbolInstanceArray",Y);class X extends Nl{getoffsetX(t){return this.float32[1*t+0]}}Xn("GlyphOffsetArray",X);class le extends jc{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Xn("SymbolLineVertexArray",le);class ae extends Yo{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ae.prototype.size=8;class De extends Xl{get(t){return new ae(this,t)}}Xn("FeatureIndexArray",De);class ze extends Ol{}class ke extends Ol{}class R extends Ol{}class k extends Eo{}class O extends Ys{}class z extends za{}class W extends os{}class ie extends bs{}class ue extends hu{}class Ne extends Pl{}class et extends $c{}class Mt extends Ka{}class vt extends _a{}class on extends w{}const Hn=yo([{name:"a_pos",components:2,type:"Int16"}],4),{members:Pi}=Hn;class Dn{constructor(t=[]){this.segments=t}prepareSegment(t,c,g,D){let M=this.segments[this.segments.length-1];return t>Dn.MAX_VERTEX_ARRAY_LENGTH&&Et(`Max vertices per segment is ${Dn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!M||M.vertexLength+t>Dn.MAX_VERTEX_ARRAY_LENGTH||M.sortKey!==D)&&(M={vertexOffset:c.length,primitiveOffset:g.length,vertexLength:0,primitiveLength:0},void 0!==D&&(M.sortKey=D),this.segments.push(M)),M}get(){return this.segments}destroy(){for(const t of this.segments)for(const c in t.vaos)t.vaos[c].destroy()}static simpleSegment(t,c,g,D){return new Dn([{vertexOffset:t,primitiveOffset:c,vertexLength:g,primitiveLength:D,vaos:{},sortKey:0}])}}function gi(o,t){return 256*(o=dt(Math.floor(o),0,255))+dt(Math.floor(t),0,255)}Dn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Xn("SegmentVector",Dn);const Bn=yo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var cr={exports:{}},Kr=function(o,t){var c,g,D,M,P,B,$,ee;for(g=o.length-(c=3&o.length),D=t,P=3432918353,B=461845907,ee=0;ee<g;)$=255&o.charCodeAt(ee)|(255&o.charCodeAt(++ee))<<8|(255&o.charCodeAt(++ee))<<16|(255&o.charCodeAt(++ee))<<24,++ee,D=27492+(65535&(M=5*(65535&(D=(D^=$=(65535&($=($=(65535&$)*P+((($>>>16)*P&65535)<<16)&4294967295)<<15|$>>>17))*B+((($>>>16)*B&65535)<<16)&4294967295)<<13|D>>>19))+((5*(D>>>16)&65535)<<16)&4294967295))+((58964+(M>>>16)&65535)<<16);switch($=0,c){case 3:$^=(255&o.charCodeAt(ee+2))<<16;case 2:$^=(255&o.charCodeAt(ee+1))<<8;case 1:D^=$=(65535&($=($=(65535&($^=255&o.charCodeAt(ee)))*P+((($>>>16)*P&65535)<<16)&4294967295)<<15|$>>>17))*B+((($>>>16)*B&65535)<<16)&4294967295}return D^=o.length,D=2246822507*(65535&(D^=D>>>16))+((2246822507*(D>>>16)&65535)<<16)&4294967295,D=3266489909*(65535&(D^=D>>>13))+((3266489909*(D>>>16)&65535)<<16)&4294967295,(D^=D>>>16)>>>0},xs=function(o,t){for(var c,g=o.length,D=t^g,M=0;g>=4;)c=1540483477*(65535&(c=255&o.charCodeAt(M)|(255&o.charCodeAt(++M))<<8|(255&o.charCodeAt(++M))<<16|(255&o.charCodeAt(++M))<<24))+((1540483477*(c>>>16)&65535)<<16),D=1540483477*(65535&D)+((1540483477*(D>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),g-=4,++M;switch(g){case 3:D^=(255&o.charCodeAt(M+2))<<16;case 2:D^=(255&o.charCodeAt(M+1))<<8;case 1:D=1540483477*(65535&(D^=255&o.charCodeAt(M)))+((1540483477*(D>>>16)&65535)<<16)}return D=1540483477*(65535&(D^=D>>>13))+((1540483477*(D>>>16)&65535)<<16),(D^=D>>>15)>>>0};cr.exports=Kr,cr.exports.murmur3=Kr,cr.exports.murmur2=xs;var No=tt(cr.exports);class ar{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,c,g,D){this.ids.push(qs(t)),this.positions.push(c,g,D)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const c=qs(t);let g=0,D=this.ids.length-1;for(;g<D;){const P=g+D>>1;this.ids[P]>=c?D=P:g=P+1}const M=[];for(;this.ids[g]===c;)M.push({index:this.positions[3*g],start:this.positions[3*g+1],end:this.positions[3*g+2]}),g++;return M}static serialize(t,c){const g=new Float64Array(t.ids),D=new Uint32Array(t.positions);return sa(g,D,0,g.length-1),c&&c.push(g.buffer,D.buffer),{ids:g,positions:D}}static deserialize(t){const c=new ar;return c.ids=t.ids,c.positions=t.positions,c.indexed=!0,c}}function qs(o){const t=+o;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:No(String(o))}function sa(o,t,c,g){for(;c<g;){const D=o[c+g>>1];let M=c-1,P=g+1;for(;;){do{M++}while(o[M]<D);do{P--}while(o[P]>D);if(M>=P)break;_l(o,M,P),_l(t,3*M,3*P),_l(t,3*M+1,3*P+1),_l(t,3*M+2,3*P+2)}P-c<g-P?(sa(o,t,c,P),c=P+1):(sa(o,t,P+1,g),g=P)}}function _l(o,t,c){const g=o[t];o[t]=o[c],o[c]=g}Xn("FeaturePositionMap",ar);class ci{constructor(t,c){this.gl=t.gl,this.location=c}}class Xa extends ci{constructor(t,c){super(t,c),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class yl extends ci{constructor(t,c){super(t,c),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class vo extends ci{constructor(t,c){super(t,c),this.current=Wt.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const qo=new Float32Array(16);function br(o){return[gi(255*o.r,255*o.g),gi(255*o.b,255*o.a)]}class Ro{constructor(t,c,g){this.value=t,this.uniformNames=c.map(D=>`u_${D}`),this.type=g}setUniform(t,c,g){t.set(g.constantOr(this.value))}getBinding(t,c,g){return"color"===this.type?new vo(t,c):new Xa(t,c)}}class $o{constructor(t,c){this.uniformNames=c.map(g=>`u_${g}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,c){this.pixelRatioFrom=c.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=c.tlbr,this.patternTo=t.tlbr}setUniform(t,c,g,D){const M="u_pattern_to"===D?this.patternTo:"u_pattern_from"===D?this.patternFrom:"u_pixel_ratio_to"===D?this.pixelRatioTo:"u_pixel_ratio_from"===D?this.pixelRatioFrom:null;M&&t.set(M)}getBinding(t,c,g){return"u_pattern"===g.substr(0,9)?new yl(t,c):new Xa(t,c)}}class Cr{constructor(t,c,g,D){this.expression=t,this.type=g,this.maxValue=0,this.paintVertexAttributes=c.map(M=>({name:`a_${M}`,type:"Float32",components:"color"===g?2:1,offset:0})),this.paintVertexArray=new D}populatePaintArray(t,c,g,D,M){const P=this.paintVertexArray.length,B=this.expression.evaluate(new Xi(0),c,{},D,[],M);this.paintVertexArray.resize(t),this._setPaintValue(P,t,B)}updatePaintArray(t,c,g,D){const M=this.expression.evaluate({zoom:0},g,D);this._setPaintValue(t,c,M)}_setPaintValue(t,c,g){if("color"===this.type){const D=br(g);for(let M=t;M<c;M++)this.paintVertexArray.emplace(M,D[0],D[1])}else{for(let D=t;D<c;D++)this.paintVertexArray.emplace(D,g);this.maxValue=Math.max(this.maxValue,Math.abs(g))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class So{constructor(t,c,g,D,M,P){this.expression=t,this.uniformNames=c.map(B=>`u_${B}_t`),this.type=g,this.useIntegerZoom=D,this.zoom=M,this.maxValue=0,this.paintVertexAttributes=c.map(B=>({name:`a_${B}`,type:"Float32",components:"color"===g?4:2,offset:0})),this.paintVertexArray=new P}populatePaintArray(t,c,g,D,M){const P=this.expression.evaluate(new Xi(this.zoom),c,{},D,[],M),B=this.expression.evaluate(new Xi(this.zoom+1),c,{},D,[],M),$=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue($,t,P,B)}updatePaintArray(t,c,g,D){const M=this.expression.evaluate({zoom:this.zoom},g,D),P=this.expression.evaluate({zoom:this.zoom+1},g,D);this._setPaintValue(t,c,M,P)}_setPaintValue(t,c,g,D){if("color"===this.type){const M=br(g),P=br(D);for(let B=t;B<c;B++)this.paintVertexArray.emplace(B,M[0],M[1],P[0],P[1])}else{for(let M=t;M<c;M++)this.paintVertexArray.emplace(M,g,D);this.maxValue=Math.max(this.maxValue,Math.abs(g),Math.abs(D))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,c){const g=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,D=dt(this.expression.interpolationFactor(g,this.zoom,this.zoom+1),0,1);t.set(D)}getBinding(t,c,g){return new Xa(t,c)}}class ws{constructor(t,c,g,D,M,P){this.expression=t,this.type=c,this.useIntegerZoom=g,this.zoom=D,this.layerId=P,this.zoomInPaintVertexArray=new M,this.zoomOutPaintVertexArray=new M}populatePaintArray(t,c,g){const D=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(D,t,c.patterns&&c.patterns[this.layerId],g)}updatePaintArray(t,c,g,D,M){this._setPaintValues(t,c,g.patterns&&g.patterns[this.layerId],M)}_setPaintValues(t,c,g,D){if(!D||!g)return;const{min:M,mid:P,max:B}=g,$=D[M],ee=D[P],se=D[B];if($&&ee&&se)for(let fe=t;fe<c;fe++)this.zoomInPaintVertexArray.emplace(fe,ee.tl[0],ee.tl[1],ee.br[0],ee.br[1],$.tl[0],$.tl[1],$.br[0],$.br[1],ee.pixelRatio,$.pixelRatio),this.zoomOutPaintVertexArray.emplace(fe,ee.tl[0],ee.tl[1],ee.br[0],ee.br[1],se.tl[0],se.tl[1],se.br[0],se.br[1],ee.pixelRatio,se.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,Bn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,Bn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Gc{constructor(t,c,g){this.binders={},this._buffers=[];const D=[];for(const M in t.paint._values){if(!g(M))continue;const P=t.paint.get(M);if(!(P instanceof Ba&&ho(P.property.specification)))continue;const B=sd(M,t.type),$=P.value,ee=P.property.specification.type,se=P.property.useIntegerZoom,fe=P.property.specification["property-type"],ve="cross-faded"===fe||"cross-faded-data-driven"===fe;if("constant"===$.kind)this.binders[M]=ve?new $o($.value,B):new Ro($.value,B,ee),D.push(`/u_${M}`);else if("source"===$.kind||ve){const xe=ku(M,ee,"source");this.binders[M]=ve?new ws($,ee,se,c,xe,t.id):new Cr($,B,ee,xe),D.push(`/a_${M}`)}else{const xe=ku(M,ee,"composite");this.binders[M]=new So($,B,ee,se,c,xe),D.push(`/z_${M}`)}}this.cacheKey=D.sort().join("")}getMaxValue(t){const c=this.binders[t];return c instanceof Cr||c instanceof So?c.maxValue:0}populatePaintArrays(t,c,g,D,M){for(const P in this.binders){const B=this.binders[P];(B instanceof Cr||B instanceof So||B instanceof ws)&&B.populatePaintArray(t,c,g,D,M)}}setConstantPatternPositions(t,c){for(const g in this.binders){const D=this.binders[g];D instanceof $o&&D.setConstantPatternPositions(t,c)}}updatePaintArrays(t,c,g,D,M){let P=!1;for(const B in t){const $=c.getPositions(B);for(const ee of $){const se=g.feature(ee.index);for(const fe in this.binders){const ve=this.binders[fe];if((ve instanceof Cr||ve instanceof So||ve instanceof ws)&&!0===ve.expression.isStateDependent){const xe=D.paint.get(fe);ve.expression=xe.value,ve.updatePaintArray(ee.start,ee.end,se,t[B],M),P=!0}}}}return P}defines(){const t=[];for(const c in this.binders){const g=this.binders[c];(g instanceof Ro||g instanceof $o)&&t.push(...g.uniformNames.map(D=>`#define HAS_UNIFORM_${D}`))}return t}getBinderAttributes(){const t=[];for(const c in this.binders){const g=this.binders[c];if(g instanceof Cr||g instanceof So)for(let D=0;D<g.paintVertexAttributes.length;D++)t.push(g.paintVertexAttributes[D].name);else if(g instanceof ws)for(let D=0;D<Bn.members.length;D++)t.push(Bn.members[D].name)}return t}getBinderUniforms(){const t=[];for(const c in this.binders){const g=this.binders[c];if(g instanceof Ro||g instanceof $o||g instanceof So)for(const D of g.uniformNames)t.push(D)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,c){const g=[];for(const D in this.binders){const M=this.binders[D];if(M instanceof Ro||M instanceof $o||M instanceof So)for(const P of M.uniformNames)if(c[P]){const B=M.getBinding(t,c[P],P);g.push({name:P,property:D,binding:B})}}return g}setUniforms(t,c,g,D){for(const{name:M,property:P,binding:B}of c)this.binders[P].setUniform(B,D,g.get(P),M)}updatePaintBuffers(t){this._buffers=[];for(const c in this.binders){const g=this.binders[c];if(t&&g instanceof ws){const D=2===t.fromScale?g.zoomInPaintVertexBuffer:g.zoomOutPaintVertexBuffer;D&&this._buffers.push(D)}else(g instanceof Cr||g instanceof So)&&g.paintVertexBuffer&&this._buffers.push(g.paintVertexBuffer)}}upload(t){for(const c in this.binders){const g=this.binders[c];(g instanceof Cr||g instanceof So||g instanceof ws)&&g.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const c=this.binders[t];(c instanceof Cr||c instanceof So||c instanceof ws)&&c.destroy()}}}class vl{constructor(t,c,g=(()=>!0)){this.programConfigurations={};for(const D of t)this.programConfigurations[D.id]=new Gc(D,c,g);this.needsUpload=!1,this._featureMap=new ar,this._bufferOffset=0}populatePaintArrays(t,c,g,D,M,P){for(const B in this.programConfigurations)this.programConfigurations[B].populatePaintArrays(t,c,D,M,P);void 0!==c.id&&this._featureMap.add(c.id,g,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,c,g,D){for(const M of g)this.needsUpload=this.programConfigurations[M.id].updatePaintArrays(t,this._featureMap,c,M,D)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const c in this.programConfigurations)this.programConfigurations[c].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function sd(o,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[o]||[o.replace(`${t}-`,"").replace(/-/g,"_")]}function ku(o,t,c){const D={"line-pattern":{source:W,composite:W},"fill-pattern":{source:W,composite:W},"fill-extrusion-pattern":{source:W,composite:W}}[o];return D&&D[c]||{color:{source:za,composite:d},number:{source:Nl,composite:za}}[t][c]}Xn("ConstantBinder",Ro),Xn("CrossFadedConstantBinder",$o),Xn("SourceExpressionBinder",Cr),Xn("CrossFadedCompositeBinder",ws),Xn("CompositeExpressionBinder",So),Xn("ProgramConfiguration",Gc,{omit:["_buffers"]}),Xn("ProgramConfigurationSet",vl);var oo=8192;const ya=Math.pow(2,14)-1,aa=-ya-1;function Rl(o){const t=oo/o.extent,c=o.loadGeometry();for(let g=0;g<c.length;g++){const D=c[g];for(let M=0;M<D.length;M++){const P=D[M],B=Math.round(P.x*t),$=Math.round(P.y*t);P.x=dt(B,aa,ya),P.y=dt($,aa,ya),(B<P.x||B>P.x+1||$<P.y||$>P.y+1)&&Et("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return c}function Wc(o,t){return{type:o.type,id:o.id,properties:o.properties,geometry:t?Rl(o):[]}}function ad(o,t,c,g,D){o.emplaceBack(2*t+(g+1)/2,2*c+(D+1)/2)}class Zc{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(c=>c.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ke,this.indexArray=new vt,this.segments=new Dn,this.programConfigurations=new vl(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(t,c,g){const D=this.layers[0],M=[];let P=null,B=!1;"circle"===D.type&&(P=D.layout.get("circle-sort-key"),B=!P.isConstant());for(const{feature:$,id:ee,index:se,sourceLayerIndex:fe}of t){const ve=this.layers[0]._featureFilter.needGeometry,xe=Wc($,ve);if(!this.layers[0]._featureFilter.filter(new Xi(this.zoom),xe,g))continue;const Te=B?P.evaluate(xe,{},g):void 0,je={id:ee,properties:$.properties,type:$.type,sourceLayerIndex:fe,index:se,geometry:ve?xe.geometry:Rl($),patterns:{},sortKey:Te};M.push(je)}B&&M.sort(($,ee)=>$.sortKey-ee.sortKey);for(const $ of M){const{geometry:ee,index:se,sourceLayerIndex:fe}=$,ve=t[se].feature;this.addFeature($,ee,se,g),c.featureIndex.insert(ve,ee,se,fe,this.index)}}update(t,c,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,c,this.stateDependentLayers,g)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Pi),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,c,g,D){for(const M of c)for(const P of M){const B=P.x,$=P.y;if(B<0||B>=oo||$<0||$>=oo)continue;const ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),se=ee.vertexLength;ad(this.layoutVertexArray,B,$,-1,-1),ad(this.layoutVertexArray,B,$,1,-1),ad(this.layoutVertexArray,B,$,1,1),ad(this.layoutVertexArray,B,$,-1,1),this.indexArray.emplaceBack(se,se+1,se+2),this.indexArray.emplaceBack(se,se+3,se+2),ee.vertexLength+=4,ee.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,g,{},D)}}function kl(o,t){for(let c=0;c<o.length;c++)if(vc(t,o[c]))return!0;for(let c=0;c<t.length;c++)if(vc(o,t[c]))return!0;return!!Hd(o,t)}function yf(o,t,c){return!!vc(o,t)||!!Fl(t,o,c)}function jd(o,t){if(1===o.length)return qc(t,o[0]);for(let c=0;c<t.length;c++){const g=t[c];for(let D=0;D<g.length;D++)if(vc(o,g[D]))return!0}for(let c=0;c<o.length;c++)if(qc(t,o[c]))return!0;for(let c=0;c<t.length;c++)if(Hd(o,t[c]))return!0;return!1}function tp(o,t,c){if(o.length>1){if(Hd(o,t))return!0;for(let g=0;g<t.length;g++)if(Fl(t[g],o,c))return!0}for(let g=0;g<o.length;g++)if(Fl(o[g],t,c))return!0;return!1}function Hd(o,t){if(0===o.length||0===t.length)return!1;for(let c=0;c<o.length-1;c++){const g=o[c],D=o[c+1];for(let M=0;M<t.length-1;M++)if($d(g,D,t[M],t[M+1]))return!0}return!1}function $d(o,t,c,g){return Bt(o,c,g)!==Bt(t,c,g)&&Bt(o,t,c)!==Bt(o,t,g)}function Fl(o,t,c){const g=c*c;if(1===t.length)return o.distSqr(t[0])<g;for(let D=1;D<t.length;D++)if(Yc(o,t[D-1],t[D])<g)return!0;return!1}function Yc(o,t,c){const g=t.distSqr(c);if(0===g)return o.distSqr(t);const D=((o.x-t.x)*(c.x-t.x)+(o.y-t.y)*(c.y-t.y))/g;return o.distSqr(D<0?t:D>1?c:c.sub(t)._mult(D)._add(t))}function qc(o,t){let c,g,D,M=!1;for(let P=0;P<o.length;P++){c=o[P];for(let B=0,$=c.length-1;B<c.length;$=B++)g=c[B],D=c[$],g.y>t.y!=D.y>t.y&&t.x<(D.x-g.x)*(t.y-g.y)/(D.y-g.y)+g.x&&(M=!M)}return M}function vc(o,t){let c=!1;for(let g=0,D=o.length-1;g<o.length;D=g++){const M=o[g],P=o[D];M.y>t.y!=P.y>t.y&&t.x<(P.x-M.x)*(t.y-M.y)/(P.y-M.y)+M.x&&(c=!c)}return c}function Sh(o,t,c){const g=c[0],D=c[2];if(o.x<g.x&&t.x<g.x||o.x>D.x&&t.x>D.x||o.y<g.y&&t.y<g.y||o.y>D.y&&t.y>D.y)return!1;const M=Bt(o,t,c[0]);return M!==Bt(o,t,c[1])||M!==Bt(o,t,c[2])||M!==Bt(o,t,c[3])}function Ja(o,t,c){const g=t.paint.get(o).value;return"constant"===g.kind?g.value:c.programConfigurations.get(t.id).getMaxValue(o)}function Gd(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function Wd(o,t,c,g,D){if(!t[0]&&!t[1])return o;const M=yt.convert(t)._mult(D);"viewport"===c&&M._rotate(-g);const P=[];for(let B=0;B<o.length;B++)P.push(o[B].sub(M));return P}let kp,np;Xn("CircleBucket",Zc,{omit:["layers"]});var Fp={get paint(){return np=np||new Fr({"circle-radius":new pi(st.paint_circle["circle-radius"]),"circle-color":new pi(st.paint_circle["circle-color"]),"circle-blur":new pi(st.paint_circle["circle-blur"]),"circle-opacity":new pi(st.paint_circle["circle-opacity"]),"circle-translate":new li(st.paint_circle["circle-translate"]),"circle-translate-anchor":new li(st.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new li(st.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new li(st.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new pi(st.paint_circle["circle-stroke-width"]),"circle-stroke-color":new pi(st.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new pi(st.paint_circle["circle-stroke-opacity"])})},get layout(){return kp=kp||new Fr({"circle-sort-key":new pi(st.layout_circle["circle-sort-key"])})}},Ua=1e-6,ld=typeof Float32Array<"u"?Float32Array:Array;function vf(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Kc(o,t,c){var g=t[0],D=t[1],M=t[2],P=t[3],B=t[4],$=t[5],ee=t[6],se=t[7],fe=t[8],ve=t[9],xe=t[10],Te=t[11],je=t[12],Ue=t[13],it=t[14],pt=t[15],Je=c[0],Ct=c[1],At=c[2],Xt=c[3];return o[0]=Je*g+Ct*B+At*fe+Xt*je,o[1]=Je*D+Ct*$+At*ve+Xt*Ue,o[2]=Je*M+Ct*ee+At*xe+Xt*it,o[3]=Je*P+Ct*se+At*Te+Xt*pt,o[4]=(Je=c[4])*g+(Ct=c[5])*B+(At=c[6])*fe+(Xt=c[7])*je,o[5]=Je*D+Ct*$+At*ve+Xt*Ue,o[6]=Je*M+Ct*ee+At*xe+Xt*it,o[7]=Je*P+Ct*se+At*Te+Xt*pt,o[8]=(Je=c[8])*g+(Ct=c[9])*B+(At=c[10])*fe+(Xt=c[11])*je,o[9]=Je*D+Ct*$+At*ve+Xt*Ue,o[10]=Je*M+Ct*ee+At*xe+Xt*it,o[11]=Je*P+Ct*se+At*Te+Xt*pt,o[12]=(Je=c[12])*g+(Ct=c[13])*B+(At=c[14])*fe+(Xt=c[15])*je,o[13]=Je*D+Ct*$+At*ve+Xt*Ue,o[14]=Je*M+Ct*ee+At*xe+Xt*it,o[15]=Je*P+Ct*se+At*Te+Xt*pt,o}Math.hypot||(Math.hypot=function(){for(var o=0,t=arguments.length;t--;)o+=arguments[t]*arguments[t];return Math.sqrt(o)});var pu,gg=Kc;function Ko(o,t,c){var g=t[0],D=t[1],M=t[2],P=t[3];return o[0]=c[0]*g+c[4]*D+c[8]*M+c[12]*P,o[1]=c[1]*g+c[5]*D+c[9]*M+c[13]*P,o[2]=c[2]*g+c[6]*D+c[10]*M+c[14]*P,o[3]=c[3]*g+c[7]*D+c[11]*M+c[15]*P,o}function ip(o,t){const c=Ko([],[o.x,o.y,0,1],t);return new yt(c[0]/c[3],c[1]/c[3])}pu=new ld(4),ld!=Float32Array&&(pu[0]=0,pu[1]=0,pu[2]=0,pu[3]=0);class cd extends Zc{}let rp;Xn("HeatmapBucket",cd,{omit:["layers"]});var bl={get paint(){return rp=rp||new Fr({"heatmap-radius":new pi(st.paint_heatmap["heatmap-radius"]),"heatmap-weight":new pi(st.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new li(st.paint_heatmap["heatmap-intensity"]),"heatmap-color":new qi(st.paint_heatmap["heatmap-color"]),"heatmap-opacity":new li(st.paint_heatmap["heatmap-opacity"])})}};function gu(o,{width:t,height:c},g,D){if(D){if(D instanceof Uint8ClampedArray)D=new Uint8Array(D.buffer);else if(D.length!==t*c*g)throw new RangeError(`mismatched image size. expected: ${D.length} but got: ${t*c*g}`)}else D=new Uint8Array(t*c*g);return o.width=t,o.height=c,o.data=D,o}function Mh(o,{width:t,height:c},g){if(t===o.width&&c===o.height)return;const D=gu({},{width:t,height:c},g);Fu(o,D,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,t),height:Math.min(o.height,c)},g),o.width=t,o.height=c,o.data=D.data}function Fu(o,t,c,g,D,M){if(0===D.width||0===D.height)return t;if(D.width>o.width||D.height>o.height||c.x>o.width-D.width||c.y>o.height-D.height)throw new RangeError("out of range source coordinates for image copy");if(D.width>t.width||D.height>t.height||g.x>t.width-D.width||g.y>t.height-D.height)throw new RangeError("out of range destination coordinates for image copy");const P=o.data,B=t.data;if(P===B)throw new Error("srcData equals dstData, so image is already copied");for(let $=0;$<D.height;$++){const ee=((c.y+$)*o.width+c.x)*M,se=((g.y+$)*t.width+g.x)*M;for(let fe=0;fe<D.width*M;fe++)B[se+fe]=P[ee+fe]}return t}class Xc{constructor(t,c){gu(this,t,1,c)}resize(t){Mh(this,t,1)}clone(){return new Xc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,c,g,D,M){Fu(t,c,g,D,M,1)}}class Qa{constructor(t,c){gu(this,t,4,c)}resize(t){Mh(this,t,4)}replace(t,c){c?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Qa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,c,g,D,M){Fu(t,c,g,D,M,4)}}function Ah(o){const t={},c=o.resolution||256,g=o.clips?o.clips.length:1,D=o.image||new Qa({width:c,height:g});if(Math.log(c)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${c}`);const M=(P,B,$)=>{t[o.evaluationKey]=$;const ee=o.expression.evaluate(t);D.data[P+B+0]=Math.floor(255*ee.r/ee.a),D.data[P+B+1]=Math.floor(255*ee.g/ee.a),D.data[P+B+2]=Math.floor(255*ee.b/ee.a),D.data[P+B+3]=Math.floor(255*ee.a)};if(o.clips)for(let P=0,B=0;P<g;++P,B+=4*c)for(let $=0,ee=0;$<c;$++,ee+=4){const se=$/(c-1),{start:fe,end:ve}=o.clips[P];M(B,ee,fe*(1-se)+ve*se)}else for(let P=0,B=0;P<c;P++,B+=4)M(0,B,P/(c-1));return D}let Zd;Xn("AlphaImage",Xc),Xn("RGBAImage",Qa);var mg={get paint(){return Zd=Zd||new Fr({"hillshade-illumination-direction":new li(st.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new li(st.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new li(st.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new li(st.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new li(st.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new li(st.paint_hillshade["hillshade-accent-color"])})}};const Go=yo([{name:"a_pos",components:2,type:"Int16"}],4),{members:Mo}=Go;var el={exports:{}};function ud(o,t,c){c=c||2;var g,D,M,P,B,$,ee,se=t&&t.length,fe=se?t[0]*c:o.length,ve=dd(o,0,fe,c,!0),xe=[];if(!ve||ve.next===ve.prev)return xe;if(se&&(ve=function(je,Ue,it,pt){var Je,Ct,At,Xt=[];for(Je=0,Ct=Ue.length;Je<Ct;Je++)(At=dd(je,Ue[Je]*pt,Je<Ct-1?Ue[Je+1]*pt:je.length,pt,!1))===At.next&&(At.steiner=!0),Xt.push(bf(At));for(Xt.sort(bc),Je=0;Je<Xt.length;Je++)it=pd(Xt[Je],it);return it}(o,t,ve,c)),o.length>80*c){g=M=o[0],D=P=o[1];for(var Te=c;Te<fe;Te+=c)(B=o[Te])<g&&(g=B),($=o[Te+1])<D&&(D=$),B>M&&(M=B),$>P&&(P=$);ee=0!==(ee=Math.max(M-g,P-D))?32767/ee:0}return hd(ve,xe,c,g,D,ee,0),xe}function dd(o,t,c,g,D){var M,P;if(D===Ql(o,t,c,g)>0)for(M=t;M<c;M+=g)P=Vu(M,o[M],o[M+1],P);else for(M=c-g;M>=t;M-=g)P=Vu(M,o[M],o[M+1],P);return P&&xc(P,P.next)&&(gd(P),P=P.next),P}function mu(o,t){if(!o)return o;t||(t=o);var c,g=o;do{if(c=!1,g.steiner||!xc(g,g.next)&&0!==to(g.prev,g,g.next))g=g.next;else{if(gd(g),(g=t=g.prev)===g.next)break;c=!0}}while(c||g!==t);return t}function hd(o,t,c,g,D,M,P){if(o){!P&&M&&function(se,fe,ve,xe){var Te=se;do{0===Te.z&&(Te.z=Lu(Te.x,Te.y,fe,ve,xe)),Te.prevZ=Te.prev,Te.nextZ=Te.next,Te=Te.next}while(Te!==se);Te.prevZ.nextZ=null,Te.prevZ=null,function(je){var Ue,it,pt,Je,Ct,At,Xt,Jn,ei=1;do{for(it=je,je=null,Ct=null,At=0;it;){for(At++,pt=it,Xt=0,Ue=0;Ue<ei&&(Xt++,pt=pt.nextZ);Ue++);for(Jn=ei;Xt>0||Jn>0&&pt;)0!==Xt&&(0===Jn||!pt||it.z<=pt.z)?(Je=it,it=it.nextZ,Xt--):(Je=pt,pt=pt.nextZ,Jn--),Ct?Ct.nextZ=Je:je=Je,Je.prevZ=Ct,Ct=Je;it=pt}Ct.nextZ=null,ei*=2}while(At>1)}(Te)}(o,g,D,M);for(var B,$,ee=o;o.prev!==o.next;)if(B=o.prev,$=o.next,M?Ih(o,g,D,M):Jc(o))t.push(B.i/c|0),t.push(o.i/c|0),t.push($.i/c|0),gd(o),o=$.next,ee=$.next;else if((o=$)===ee){P?1===P?hd(o=fd(mu(o),t,c),t,c,g,D,M,2):2===P&&Yd(o,t,c,g,D,M):hd(mu(o),t,c,g,D,M,1);break}}}function Jc(o){var t=o.prev,c=o,g=o.next;if(to(t,c,g)>=0)return!1;for(var D=t.x,M=c.x,P=g.x,B=t.y,$=c.y,ee=g.y,se=D<M?D<P?D:P:M<P?M:P,fe=B<$?B<ee?B:ee:$<ee?$:ee,ve=D>M?D>P?D:P:M>P?M:P,xe=B>$?B>ee?B:ee:$>ee?$:ee,Te=g.next;Te!==t;){if(Te.x>=se&&Te.x<=ve&&Te.y>=fe&&Te.y<=xe&&ja(D,B,M,$,P,ee,Te.x,Te.y)&&to(Te.prev,Te,Te.next)>=0)return!1;Te=Te.next}return!0}function Ih(o,t,c,g){var D=o.prev,M=o,P=o.next;if(to(D,M,P)>=0)return!1;for(var B=D.x,$=M.x,ee=P.x,se=D.y,fe=M.y,ve=P.y,xe=B<$?B<ee?B:ee:$<ee?$:ee,Te=se<fe?se<ve?se:ve:fe<ve?fe:ve,je=B>$?B>ee?B:ee:$>ee?$:ee,Ue=se>fe?se>ve?se:ve:fe>ve?fe:ve,it=Lu(xe,Te,t,c,g),pt=Lu(je,Ue,t,c,g),Je=o.prevZ,Ct=o.nextZ;Je&&Je.z>=it&&Ct&&Ct.z<=pt;){if(Je.x>=xe&&Je.x<=je&&Je.y>=Te&&Je.y<=Ue&&Je!==D&&Je!==P&&ja(B,se,$,fe,ee,ve,Je.x,Je.y)&&to(Je.prev,Je,Je.next)>=0||(Je=Je.prevZ,Ct.x>=xe&&Ct.x<=je&&Ct.y>=Te&&Ct.y<=Ue&&Ct!==D&&Ct!==P&&ja(B,se,$,fe,ee,ve,Ct.x,Ct.y)&&to(Ct.prev,Ct,Ct.next)>=0))return!1;Ct=Ct.nextZ}for(;Je&&Je.z>=it;){if(Je.x>=xe&&Je.x<=je&&Je.y>=Te&&Je.y<=Ue&&Je!==D&&Je!==P&&ja(B,se,$,fe,ee,ve,Je.x,Je.y)&&to(Je.prev,Je,Je.next)>=0)return!1;Je=Je.prevZ}for(;Ct&&Ct.z<=pt;){if(Ct.x>=xe&&Ct.x<=je&&Ct.y>=Te&&Ct.y<=Ue&&Ct!==D&&Ct!==P&&ja(B,se,$,fe,ee,ve,Ct.x,Ct.y)&&to(Ct.prev,Ct,Ct.next)>=0)return!1;Ct=Ct.nextZ}return!0}function fd(o,t,c){var g=o;do{var D=g.prev,M=g.next.next;!xc(D,M)&&Bu(D,g,g.next,M)&&zu(D,M)&&zu(M,D)&&(t.push(D.i/c|0),t.push(g.i/c|0),t.push(M.i/c|0),gd(g),gd(g.next),g=o=M),g=g.next}while(g!==o);return mu(g)}function Yd(o,t,c,g,D,M){var P=o;do{for(var B=P.next.next;B!==P.prev;){if(P.i!==B.i&&_u(P,B)){var $=wc(P,B);return P=mu(P,P.next),$=mu($,$.next),hd(P,t,c,g,D,M,0),void hd($,t,c,g,D,M,0)}B=B.next}P=P.next}while(P!==o)}function bc(o,t){return o.x-t.x}function pd(o,t){var c=function(D,M){var P,B=M,$=D.x,ee=D.y,se=-1/0;do{if(ee<=B.y&&ee>=B.next.y&&B.next.y!==B.y){var fe=B.x+(ee-B.y)*(B.next.x-B.x)/(B.next.y-B.y);if(fe<=$&&fe>se&&(se=fe,P=B.x<B.next.x?B:B.next,fe===$))return P}B=B.next}while(B!==M);if(!P)return null;var ve,xe=P,Te=P.x,je=P.y,Ue=1/0;B=P;do{$>=B.x&&B.x>=Te&&$!==B.x&&ja(ee<je?$:se,ee,Te,je,ee<je?se:$,ee,B.x,B.y)&&(ve=Math.abs(ee-B.y)/($-B.x),zu(B,D)&&(ve<Ue||ve===Ue&&(B.x>P.x||B.x===P.x&&op(P,B)))&&(P=B,Ue=ve)),B=B.next}while(B!==xe);return P}(o,t);if(!c)return t;var g=wc(c,o);return mu(g,g.next),mu(c,c.next)}function op(o,t){return to(o.prev,o,t.prev)<0&&to(t.next,o,o.next)<0}function Lu(o,t,c,g,D){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-c)*D|0)|o<<8))|o<<4))|o<<2))|o<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-g)*D|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function bf(o){var t=o,c=o;do{(t.x<c.x||t.x===c.x&&t.y<c.y)&&(c=t),t=t.next}while(t!==o);return c}function ja(o,t,c,g,D,M,P,B){return(D-P)*(t-B)>=(o-P)*(M-B)&&(o-P)*(g-B)>=(c-P)*(t-B)&&(c-P)*(M-B)>=(D-P)*(g-B)}function _u(o,t){return o.next.i!==t.i&&o.prev.i!==t.i&&!function(c,g){var D=c;do{if(D.i!==c.i&&D.next.i!==c.i&&D.i!==g.i&&D.next.i!==g.i&&Bu(D,D.next,c,g))return!0;D=D.next}while(D!==c);return!1}(o,t)&&(zu(o,t)&&zu(t,o)&&function(c,g){var D=c,M=!1,P=(c.x+g.x)/2,B=(c.y+g.y)/2;do{D.y>B!=D.next.y>B&&D.next.y!==D.y&&P<(D.next.x-D.x)*(B-D.y)/(D.next.y-D.y)+D.x&&(M=!M),D=D.next}while(D!==c);return M}(o,t)&&(to(o.prev,o,t.prev)||to(o,t.prev,t))||xc(o,t)&&to(o.prev,o,o.next)>0&&to(t.prev,t,t.next)>0)}function to(o,t,c){return(t.y-o.y)*(c.x-t.x)-(t.x-o.x)*(c.y-t.y)}function xc(o,t){return o.x===t.x&&o.y===t.y}function Bu(o,t,c,g){var D=Jl(to(o,t,c)),M=Jl(to(o,t,g)),P=Jl(to(c,g,o)),B=Jl(to(c,g,t));return D!==M&&P!==B||!(0!==D||!Qc(o,c,t))||!(0!==M||!Qc(o,g,t))||!(0!==P||!Qc(c,o,g))||!(0!==B||!Qc(c,t,g))}function Qc(o,t,c){return t.x<=Math.max(o.x,c.x)&&t.x>=Math.min(o.x,c.x)&&t.y<=Math.max(o.y,c.y)&&t.y>=Math.min(o.y,c.y)}function Jl(o){return o>0?1:o<0?-1:0}function zu(o,t){return to(o.prev,o,o.next)<0?to(o,t,o.next)>=0&&to(o,o.prev,t)>=0:to(o,t,o.prev)<0||to(o,o.next,t)<0}function wc(o,t){var c=new xf(o.i,o.x,o.y),g=new xf(t.i,t.x,t.y),D=o.next,M=t.prev;return o.next=t,t.prev=o,c.next=D,D.prev=c,g.next=c,c.prev=g,M.next=g,g.prev=M,g}function Vu(o,t,c,g){var D=new xf(o,t,c);return g?(D.next=g.next,D.prev=g,g.next.prev=D,g.next=D):(D.prev=D,D.next=D),D}function gd(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function xf(o,t,c){this.i=o,this.x=t,this.y=c,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ql(o,t,c,g){for(var D=0,M=t,P=c-g;M<c;M+=g)D+=(o[P]-o[M])*(o[M+1]+o[P+1]),P=M;return D}el.exports=ud,el.exports.default=ud,ud.deviation=function(o,t,c,g){var D=t&&t.length,M=Math.abs(Ql(o,0,D?t[0]*c:o.length,c));if(D)for(var P=0,B=t.length;P<B;P++)M-=Math.abs(Ql(o,t[P]*c,P<B-1?t[P+1]*c:o.length,c));var $=0;for(P=0;P<g.length;P+=3){var ee=g[P]*c,se=g[P+1]*c,fe=g[P+2]*c;$+=Math.abs((o[ee]-o[fe])*(o[se+1]-o[ee+1])-(o[ee]-o[se])*(o[fe+1]-o[ee+1]))}return 0===M&&0===$?0:Math.abs(($-M)/M)},ud.flatten=function(o){for(var t=o[0][0].length,c={vertices:[],holes:[],dimensions:t},g=0,D=0;D<o.length;D++){for(var M=0;M<o[D].length;M++)for(var P=0;P<t;P++)c.vertices.push(o[D][M][P]);D>0&&c.holes.push(g+=o[D-1].length)}return c};var sp=tt(el.exports);function _g(o,t,c,g,D){ap(o,t,c||0,g||o.length-1,D||Lp)}function ap(o,t,c,g,D){for(;g>c;){if(g-c>600){var M=g-c+1,P=t-c+1,B=Math.log(M),$=.5*Math.exp(2*B/3),ee=.5*Math.sqrt(B*$*(M-$)/M)*(P-M/2<0?-1:1);ap(o,t,Math.max(c,Math.floor(t-P*$/M+ee)),Math.min(g,Math.floor(t+(M-P)*$/M+ee)),D)}var se=o[t],fe=c,ve=g;for(Uu(o,c,t),D(o[g],se)>0&&Uu(o,c,g);fe<ve;){for(Uu(o,fe,ve),fe++,ve--;D(o[fe],se)<0;)fe++;for(;D(o[ve],se)>0;)ve--}0===D(o[c],se)?Uu(o,c,ve):Uu(o,++ve,g),ve<=t&&(c=ve+1),t<=ve&&(g=ve-1)}}function Uu(o,t,c){var g=o[t];o[t]=o[c],o[c]=g}function Lp(o,t){return o<t?-1:o>t?1:0}function md(o,t){const c=o.length;if(c<=1)return[o];const g=[];let D,M;for(let P=0;P<c;P++){const B=lt(o[P]);0!==B&&(o[P].area=Math.abs(B),void 0===M&&(M=B<0),M===B<0?(D&&g.push(D),D=[o[P]]):D.push(o[P]))}if(D&&g.push(D),t>1)for(let P=0;P<g.length;P++)g[P].length<=t||(_g(g[P],t,1,g[P].length-1,Oh),g[P]=g[P].slice(0,t));return g}function Oh(o,t){return t.area-o.area}function ju(o,t,c){const g=c.patternDependencies;let D=!1;for(const M of t){const P=M.paint.get(`${o}-pattern`);P.isConstant()||(D=!0);const B=P.constantOr(null);B&&(D=!0,g[B.to]=!0,g[B.from]=!0)}return D}function Ph(o,t,c,g,D){const M=D.patternDependencies;for(const P of t){const B=P.paint.get(`${o}-pattern`).value;if("constant"!==B.kind){let $=B.evaluate({zoom:g-1},c,{},D.availableImages),ee=B.evaluate({zoom:g},c,{},D.availableImages),se=B.evaluate({zoom:g+1},c,{},D.availableImages);$=$&&$.name?$.name:$,ee=ee&&ee.name?ee.name:ee,se=se&&se.name?se.name:se,M[$]=!0,M[ee]=!0,M[se]=!0,c.patterns[P.id]={min:$,mid:ee,max:se}}}return c}class Nh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(c=>c.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new R,this.indexArray=new vt,this.indexArray2=new on,this.programConfigurations=new vl(t.layers,t.zoom),this.segments=new Dn,this.segments2=new Dn,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(t,c,g){this.hasPattern=ju("fill",this.layers,c);const D=this.layers[0].layout.get("fill-sort-key"),M=!D.isConstant(),P=[];for(const{feature:B,id:$,index:ee,sourceLayerIndex:se}of t){const fe=this.layers[0]._featureFilter.needGeometry,ve=Wc(B,fe);if(!this.layers[0]._featureFilter.filter(new Xi(this.zoom),ve,g))continue;const xe=M?D.evaluate(ve,{},g,c.availableImages):void 0,Te={id:$,properties:B.properties,type:B.type,sourceLayerIndex:se,index:ee,geometry:fe?ve.geometry:Rl(B),patterns:{},sortKey:xe};P.push(Te)}M&&P.sort((B,$)=>B.sortKey-$.sortKey);for(const B of P){const{geometry:$,index:ee,sourceLayerIndex:se}=B;if(this.hasPattern){const fe=Ph("fill",this.layers,B,this.zoom,c);this.patternFeatures.push(fe)}else this.addFeature(B,$,ee,g,{});c.featureIndex.insert(t[ee].feature,$,ee,se,this.index)}}update(t,c,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,c,this.stateDependentLayers,g)}addFeatures(t,c,g){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,c,g)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Mo),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,c,g,D,M){for(const P of md(c,500)){let B=0;for(const xe of P)B+=xe.length;const $=this.segments.prepareSegment(B,this.layoutVertexArray,this.indexArray),ee=$.vertexLength,se=[],fe=[];for(const xe of P){if(0===xe.length)continue;xe!==P[0]&&fe.push(se.length/2);const Te=this.segments2.prepareSegment(xe.length,this.layoutVertexArray,this.indexArray2),je=Te.vertexLength;this.layoutVertexArray.emplaceBack(xe[0].x,xe[0].y),this.indexArray2.emplaceBack(je+xe.length-1,je),se.push(xe[0].x),se.push(xe[0].y);for(let Ue=1;Ue<xe.length;Ue++)this.layoutVertexArray.emplaceBack(xe[Ue].x,xe[Ue].y),this.indexArray2.emplaceBack(je+Ue-1,je+Ue),se.push(xe[Ue].x),se.push(xe[Ue].y);Te.vertexLength+=xe.length,Te.primitiveLength+=xe.length}const ve=sp(se,fe);for(let xe=0;xe<ve.length;xe+=3)this.indexArray.emplaceBack(ee+ve[xe],ee+ve[xe+1],ee+ve[xe+2]);$.vertexLength+=B,$.primitiveLength+=ve.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,g,M,D)}}let Rh,kh;Xn("FillBucket",Nh,{omit:["layers","patternFeatures"]});var wf={get paint(){return kh=kh||new Fr({"fill-antialias":new li(st.paint_fill["fill-antialias"]),"fill-opacity":new pi(st.paint_fill["fill-opacity"]),"fill-color":new pi(st.paint_fill["fill-color"]),"fill-outline-color":new pi(st.paint_fill["fill-outline-color"]),"fill-translate":new li(st.paint_fill["fill-translate"]),"fill-translate-anchor":new li(st.paint_fill["fill-translate-anchor"]),"fill-pattern":new yc(st.paint_fill["fill-pattern"])})},get layout(){return Rh=Rh||new Fr({"fill-sort-key":new pi(st.layout_fill["fill-sort-key"])})}};const Bp=yo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),qd=yo([{name:"a_centroid",components:2,type:"Int16"}],4),{members:lp}=Bp;var ec={},Kd=Pe,Xd=Jd;function Jd(o,t,c,g,D){this.properties={},this.extent=c,this.type=0,this._pbf=o,this._geometry=-1,this._keys=g,this._values=D,o.readFields(cp,this,t)}function cp(o,t,c){1==o?t.id=c.readVarint():2==o?function(g,D){for(var M=g.readVarint()+g.pos;g.pos<M;){var P=D._keys[g.readVarint()],B=D._values[g.readVarint()];D.properties[P]=B}}(c,t):3==o?t.type=c.readVarint():4==o&&(t._geometry=c.pos)}function Hu(o){for(var t,c,g=0,D=0,M=o.length,P=M-1;D<M;P=D++)g+=((c=o[P]).x-(t=o[D]).x)*(t.y+c.y);return g}Jd.types=["Unknown","Point","LineString","Polygon"],Jd.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var t,c=o.readVarint()+o.pos,g=1,D=0,M=0,P=0,B=[];o.pos<c;){if(D<=0){var $=o.readVarint();g=7&$,D=$>>3}if(D--,1===g||2===g)M+=o.readSVarint(),P+=o.readSVarint(),1===g&&(t&&B.push(t),t=[]),t.push(new Kd(M,P));else{if(7!==g)throw new Error("unknown command "+g);t&&t.push(t[0].clone())}}return t&&B.push(t),B},Jd.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var t=o.readVarint()+o.pos,c=1,g=0,D=0,M=0,P=1/0,B=-1/0,$=1/0,ee=-1/0;o.pos<t;){if(g<=0){var se=o.readVarint();c=7&se,g=se>>3}if(g--,1===c||2===c)(D+=o.readSVarint())<P&&(P=D),D>B&&(B=D),(M+=o.readSVarint())<$&&($=M),M>ee&&(ee=M);else if(7!==c)throw new Error("unknown command "+c)}return[P,$,B,ee]},Jd.prototype.toGeoJSON=function(o,t,c){var g,D,M=this.extent*Math.pow(2,c),P=this.extent*o,B=this.extent*t,$=this.loadGeometry(),ee=Jd.types[this.type];function se(xe){for(var Te=0;Te<xe.length;Te++){var je=xe[Te];xe[Te]=[360*(je.x+P)/M-180,360/Math.PI*Math.atan(Math.exp((180-360*(je.y+B)/M)*Math.PI/180))-90]}}switch(this.type){case 1:var fe=[];for(g=0;g<$.length;g++)fe[g]=$[g][0];se($=fe);break;case 2:for(g=0;g<$.length;g++)se($[g]);break;case 3:for($=function(xe){var Te=xe.length;if(Te<=1)return[xe];for(var je,Ue,it=[],pt=0;pt<Te;pt++){var Je=Hu(xe[pt]);0!==Je&&(void 0===Ue&&(Ue=Je<0),Ue===Je<0?(je&&it.push(je),je=[xe[pt]]):je.push(xe[pt]))}return je&&it.push(je),it}($),g=0;g<$.length;g++)for(D=0;D<$[g].length;D++)se($[g][D])}1===$.length?$=$[0]:ee="Multi"+ee;var ve={type:"Feature",geometry:{type:ee,coordinates:$},properties:this.properties};return"id"in this&&(ve.id=this.id),ve};var zp=Xd,Fh=yu;function yu(o,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(Lh,this,t),this.length=this._features.length}function Lh(o,t,c){15===o?t.version=c.readVarint():1===o?t.name=c.readString():5===o?t.extent=c.readVarint():2===o?t._features.push(c.pos):3===o?t._keys.push(c.readString()):4===o&&t._values.push(function(g){for(var D=null,M=g.readVarint()+g.pos;g.pos<M;){var P=g.readVarint()>>3;D=1===P?g.readString():2===P?g.readFloat():3===P?g.readDouble():4===P?g.readVarint64():5===P?g.readVarint():6===P?g.readSVarint():7===P?g.readBoolean():null}return D}(c))}yu.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var t=this._pbf.readVarint()+this._pbf.pos;return new zp(this._pbf,t,this.extent,this._keys,this._values)};var Df=Fh;function Qd(o,t,c){if(3===o){var g=new Df(c,c.readVarint()+c.pos);g.length&&(t[g.name]=g)}}ec.VectorTile=function(o,t){this.layers=o.readFields(Qd,{},t)},ec.VectorTileFeature=Xd,ec.VectorTileLayer=Fh;const tc=ec.VectorTileFeature.types,nc=Math.pow(2,13);function vu(o,t,c,g,D,M,P,B){o.emplaceBack(t,c,2*Math.floor(g*nc)+P,D*nc*2,M*nc*2,Math.round(B))}class _d{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(c=>c.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new k,this.centroidVertexArray=new ze,this.indexArray=new vt,this.programConfigurations=new vl(t.layers,t.zoom),this.segments=new Dn,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(t,c,g){this.features=[],this.hasPattern=ju("fill-extrusion",this.layers,c);for(const{feature:D,id:M,index:P,sourceLayerIndex:B}of t){const $=this.layers[0]._featureFilter.needGeometry,ee=Wc(D,$);if(!this.layers[0]._featureFilter.filter(new Xi(this.zoom),ee,g))continue;const se={id:M,sourceLayerIndex:B,index:P,geometry:$?ee.geometry:Rl(D),properties:D.properties,type:D.type,patterns:{}};this.hasPattern?this.features.push(Ph("fill-extrusion",this.layers,se,this.zoom,c)):this.addFeature(se,se.geometry,P,g,{}),c.featureIndex.insert(D,se.geometry,P,B,this.index,!0)}}addFeatures(t,c,g){for(const D of this.features){const{geometry:M}=D;this.addFeature(D,M,D.index,c,g)}}update(t,c,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,c,this.stateDependentLayers,g)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,lp),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,qd.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,c,g,D,M){const P={x:0,y:0,vertexCount:0};for(const B of md(c,500)){let $=0;for(const Te of B)$+=Te.length;let ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const Te of B){if(0===Te.length||((o=Te).every(t=>t.x<0)||o.every(t=>t.x>oo)||o.every(t=>t.y<0)||o.every(t=>t.y>oo)))continue;let je=0;for(let Ue=0;Ue<Te.length;Ue++){const it=Te[Ue];if(Ue>=1){const pt=Te[Ue-1];if(!yd(it,pt)){ee.vertexLength+4>Dn.MAX_VERTEX_ARRAY_LENGTH&&(ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const Je=it.sub(pt)._perp()._unit(),Ct=pt.dist(it);je+Ct>32768&&(je=0),vu(this.layoutVertexArray,it.x,it.y,Je.x,Je.y,0,0,je),vu(this.layoutVertexArray,it.x,it.y,Je.x,Je.y,0,1,je),P.x+=2*it.x,P.y+=2*it.y,P.vertexCount+=2,je+=Ct,vu(this.layoutVertexArray,pt.x,pt.y,Je.x,Je.y,0,0,je),vu(this.layoutVertexArray,pt.x,pt.y,Je.x,Je.y,0,1,je),P.x+=2*pt.x,P.y+=2*pt.y,P.vertexCount+=2;const At=ee.vertexLength;this.indexArray.emplaceBack(At,At+2,At+1),this.indexArray.emplaceBack(At+1,At+2,At+3),ee.vertexLength+=4,ee.primitiveLength+=2}}}}if(ee.vertexLength+$>Dn.MAX_VERTEX_ARRAY_LENGTH&&(ee=this.segments.prepareSegment($,this.layoutVertexArray,this.indexArray)),"Polygon"!==tc[t.type])continue;const se=[],fe=[],ve=ee.vertexLength;for(const Te of B)if(0!==Te.length){Te!==B[0]&&fe.push(se.length/2);for(let je=0;je<Te.length;je++){const Ue=Te[je];vu(this.layoutVertexArray,Ue.x,Ue.y,0,0,1,1,0),P.x+=Ue.x,P.y+=Ue.y,P.vertexCount+=1,se.push(Ue.x),se.push(Ue.y)}}const xe=sp(se,fe);for(let Te=0;Te<xe.length;Te+=3)this.indexArray.emplaceBack(ve+xe[Te],ve+xe[Te+2],ve+xe[Te+1]);ee.primitiveLength+=xe.length/3,ee.vertexLength+=$}var o;for(let B=0;B<P.vertexCount;B++)this.centroidVertexArray.emplaceBack(Math.floor(P.x/P.vertexCount),Math.floor(P.y/P.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,g,M,D)}}function yd(o,t){return o.x===t.x&&(o.x<0||o.x>oo)||o.y===t.y&&(o.y<0||o.y>oo)}let xl;Xn("FillExtrusionBucket",_d,{omit:["layers","features"]});var up={get paint(){return xl=xl||new Fr({"fill-extrusion-opacity":new li(st["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new pi(st["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new li(st["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new li(st["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new yc(st["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new pi(st["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new pi(st["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new li(st["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};function $u(o,t){return o.x*t.x+o.y*t.y}function Cf(o,t){if(1===o.length){let c=0;const g=t[c++];let D;for(;!D||g.equals(D);)if(D=t[c++],!D)return 1/0;for(;c<t.length;c++){const M=t[c],P=o[0],B=D.sub(g),$=M.sub(g),ee=P.sub(g),se=$u(B,B),fe=$u(B,$),ve=$u($,$),xe=$u(ee,B),Te=$u(ee,$),je=se*ve-fe*fe,Ue=(ve*xe-fe*Te)/je,it=(se*Te-fe*xe)/je,pt=g.z*(1-Ue-it)+D.z*Ue+M.z*it;if(isFinite(pt))return pt}return 1/0}{let c=1/0;for(const g of t)c=Math.min(c,g.z);return c}}const Bh=yo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:zh}=Bh,bd=yo([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Gu}=bd,eh=ec.VectorTileFeature.types,Vh=Math.cos(Math.PI/180*37.5),Ef=Math.pow(2,14)/.5;class Uh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(c=>c.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(c=>{this.gradients[c.id]={}}),this.layoutVertexArray=new O,this.layoutVertexArray2=new z,this.indexArray=new vt,this.programConfigurations=new vl(t.layers,t.zoom),this.segments=new Dn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id)}populate(t,c,g){this.hasPattern=ju("line",this.layers,c);const D=this.layers[0].layout.get("line-sort-key"),M=!D.isConstant(),P=[];for(const{feature:B,id:$,index:ee,sourceLayerIndex:se}of t){const fe=this.layers[0]._featureFilter.needGeometry,ve=Wc(B,fe);if(!this.layers[0]._featureFilter.filter(new Xi(this.zoom),ve,g))continue;const xe=M?D.evaluate(ve,{},g):void 0,Te={id:$,properties:B.properties,type:B.type,sourceLayerIndex:se,index:ee,geometry:fe?ve.geometry:Rl(B),patterns:{},sortKey:xe};P.push(Te)}M&&P.sort((B,$)=>B.sortKey-$.sortKey);for(const B of P){const{geometry:$,index:ee,sourceLayerIndex:se}=B;if(this.hasPattern){const fe=Ph("line",this.layers,B,this.zoom,c);this.patternFeatures.push(fe)}else this.addFeature(B,$,ee,g,{});c.featureIndex.insert(t[ee].feature,$,ee,se,this.index)}}update(t,c,g){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,c,this.stateDependentLayers,g)}addFeatures(t,c,g){for(const D of this.patternFeatures)this.addFeature(D,D.geometry,D.index,c,g)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Gu)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,zh),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,c,g,D,M){const P=this.layers[0].layout,B=P.get("line-join").evaluate(t,{}),$=P.get("line-cap"),ee=P.get("line-miter-limit"),se=P.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const fe of c)this.addLine(fe,t,B,$,ee,se);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,g,M,D)}addLine(t,c,g,D,M,P){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let it=0;it<t.length-1;it++)this.totalDistance+=t[it].dist(t[it+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const B="Polygon"===eh[c.type];let $=t.length;for(;$>=2&&t[$-1].equals(t[$-2]);)$--;let ee=0;for(;ee<$-1&&t[ee].equals(t[ee+1]);)ee++;if($<(B?3:2))return;"bevel"===g&&(M=1.05);const se=this.overscaling<=16?15*oo/(512*this.overscaling):0,fe=this.segments.prepareSegment(10*$,this.layoutVertexArray,this.indexArray);let ve,xe,Te,je,Ue;this.e1=this.e2=-1,B&&(ve=t[$-2],Ue=t[ee].sub(ve)._unit()._perp());for(let it=ee;it<$;it++){if(Te=it===$-1?B?t[ee+1]:void 0:t[it+1],Te&&t[it].equals(Te))continue;Ue&&(je=Ue),ve&&(xe=ve),ve=t[it],Ue=Te?Te.sub(ve)._unit()._perp():je,je=je||Ue;let pt=je.add(Ue);0===pt.x&&0===pt.y||pt._unit();const Je=je.x*Ue.x+je.y*Ue.y,Ct=pt.x*Ue.x+pt.y*Ue.y,At=0!==Ct?1/Ct:1/0,Xt=2*Math.sqrt(2-2*Ct),Jn=Ct<Vh&&xe&&Te,ei=je.x*Ue.y-je.y*Ue.x>0;if(Jn&&it>ee){const In=ve.dist(xe);if(In>2*se){const Zn=ve.sub(ve.sub(xe)._mult(se/In)._round());this.updateDistance(xe,Zn),this.addCurrentVertex(Zn,je,0,0,fe),xe=Zn}}const $n=xe&&Te;let kn=$n?g:B?"butt":D;if($n&&"round"===kn&&(At<P?kn="miter":At<=2&&(kn="fakeround")),"miter"===kn&&At>M&&(kn="bevel"),"bevel"===kn&&(At>2&&(kn="flipbevel"),At<M&&(kn="miter")),xe&&this.updateDistance(xe,ve),"miter"===kn)pt._mult(At),this.addCurrentVertex(ve,pt,0,0,fe);else if("flipbevel"===kn){if(At>100)pt=Ue.mult(-1);else{const In=At*je.add(Ue).mag()/je.sub(Ue).mag();pt._perp()._mult(In*(ei?-1:1))}this.addCurrentVertex(ve,pt,0,0,fe),this.addCurrentVertex(ve,pt.mult(-1),0,0,fe)}else if("bevel"===kn||"fakeround"===kn){const In=-Math.sqrt(At*At-1),Zn=ei?In:0,Un=ei?0:In;if(xe&&this.addCurrentVertex(ve,je,Zn,Un,fe),"fakeround"===kn){const _n=Math.round(180*Xt/Math.PI/20);for(let xi=1;xi<_n;xi++){let _i=xi/_n;if(.5!==_i){const so=_i-.5;_i+=_i*so*(_i-1)*((1.0904+Je*(Je*(3.55645-1.43519*Je)-3.2452))*so*so+(.848013+Je*(.215638*Je-1.06021)))}const Dr=Ue.sub(je)._mult(_i)._add(je)._unit()._mult(ei?-1:1);this.addHalfVertex(ve,Dr.x,Dr.y,!1,ei,0,fe)}}Te&&this.addCurrentVertex(ve,Ue,-Zn,-Un,fe)}else if("butt"===kn)this.addCurrentVertex(ve,pt,0,0,fe);else if("square"===kn){const In=xe?1:-1;this.addCurrentVertex(ve,pt,In,In,fe)}else"round"===kn&&(xe&&(this.addCurrentVertex(ve,je,0,0,fe),this.addCurrentVertex(ve,je,1,1,fe,!0)),Te&&(this.addCurrentVertex(ve,Ue,-1,-1,fe,!0),this.addCurrentVertex(ve,Ue,0,0,fe)));if(Jn&&it<$-1){const In=ve.dist(Te);if(In>2*se){const Zn=ve.add(Te.sub(ve)._mult(se/In)._round());this.updateDistance(ve,Zn),this.addCurrentVertex(Zn,Ue,0,0,fe),ve=Zn}}}}addCurrentVertex(t,c,g,D,M,P=!1){const B=c.y*D-c.x,$=-c.y-c.x*D;this.addHalfVertex(t,c.x+c.y*g,c.y-c.x*g,P,!1,g,M),this.addHalfVertex(t,B,$,P,!0,-D,M),this.distance>Ef/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,c,g,D,M,P))}addHalfVertex({x:t,y:c},g,D,M,P,B,$){const ee=.5*(this.lineClips?this.scaledDistance*(Ef-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(M?1:0),(c<<1)+(P?1:0),Math.round(63*g)+128,Math.round(63*D)+128,1+(0===B?0:B<0?-1:1)|(63&ee)<<2,ee>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const se=$.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,se),$.primitiveLength++),P?this.e2=se:this.e1=se}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,c){this.distance+=t.dist(c),this.updateScaledDistance()}}let va,Wu;Xn("LineBucket",Uh,{omit:["layers","patternFeatures"]});var Tf={get paint(){return Wu=Wu||new Fr({"line-opacity":new pi(st.paint_line["line-opacity"]),"line-color":new pi(st.paint_line["line-color"]),"line-translate":new li(st.paint_line["line-translate"]),"line-translate-anchor":new li(st.paint_line["line-translate-anchor"]),"line-width":new pi(st.paint_line["line-width"]),"line-gap-width":new pi(st.paint_line["line-gap-width"]),"line-offset":new pi(st.paint_line["line-offset"]),"line-blur":new pi(st.paint_line["line-blur"]),"line-dasharray":new dn(st.paint_line["line-dasharray"]),"line-pattern":new yc(st.paint_line["line-pattern"]),"line-gradient":new qi(st.paint_line["line-gradient"])})},get layout(){return va=va||new Fr({"line-cap":new li(st.layout_line["line-cap"]),"line-join":new pi(st.layout_line["line-join"]),"line-miter-limit":new li(st.layout_line["line-miter-limit"]),"line-round-limit":new li(st.layout_line["line-round-limit"]),"line-sort-key":new pi(st.layout_line["line-sort-key"])})}};class th extends pi{possiblyEvaluate(t,c){return c=new Xi(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),super.possiblyEvaluate(t,c)}evaluate(t,c,g,D){return c=Tn({},c,{zoom:Math.floor(c.zoom)}),super.evaluate(t,c,g,D)}}let Ds;function bu(o,t){return t>0?t+2*o:o}const nh=yo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),jh=yo([{name:"a_projected_pos",components:3,type:"Float32"}],4);yo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Hh=yo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);yo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ih=yo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),$h=yo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Gh(o,t,c){return o.sections.forEach(g=>{g.text=function(D,M,P){const B=M.layout.get("text-transform").evaluate(P,{});return"uppercase"===B?D=D.toLocaleUpperCase():"lowercase"===B&&(D=D.toLocaleLowerCase()),Nn.applyArabicShaping&&(D=Nn.applyArabicShaping(D)),D}(g.text,t,c)}),o}yo([{name:"triangle",components:3,type:"Uint16"}]),yo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),yo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),yo([{type:"Float32",name:"offsetX"}]),yo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const xu={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};var Xo=24,dp=Ur,Wh=function(o,t,c,g,D){var M,P,B=8*D-g-1,$=(1<<B)-1,ee=$>>1,se=-7,fe=c?D-1:0,ve=c?-1:1,xe=o[t+fe];for(fe+=ve,M=xe&(1<<-se)-1,xe>>=-se,se+=B;se>0;M=256*M+o[t+fe],fe+=ve,se-=8);for(P=M&(1<<-se)-1,M>>=-se,se+=g;se>0;P=256*P+o[t+fe],fe+=ve,se-=8);if(0===M)M=1-ee;else{if(M===$)return P?NaN:1/0*(xe?-1:1);P+=Math.pow(2,g),M-=ee}return(xe?-1:1)*P*Math.pow(2,M-g)},xd=function(o,t,c,g,D,M){var P,B,$,ee=8*M-D-1,se=(1<<ee)-1,fe=se>>1,ve=23===D?Math.pow(2,-24)-Math.pow(2,-77):0,xe=g?0:M-1,Te=g?1:-1,je=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(B=isNaN(t)?1:0,P=se):(P=Math.floor(Math.log(t)/Math.LN2),t*($=Math.pow(2,-P))<1&&(P--,$*=2),(t+=P+fe>=1?ve/$:ve*Math.pow(2,1-fe))*$>=2&&(P++,$/=2),P+fe>=se?(B=0,P=se):P+fe>=1?(B=(t*$-1)*Math.pow(2,D),P+=fe):(B=t*Math.pow(2,fe-1)*Math.pow(2,D),P=0));D>=8;o[c+xe]=255&B,xe+=Te,B/=256,D-=8);for(P=P<<D|B,ee+=D;ee>0;o[c+xe]=255&P,xe+=Te,P/=256,ee-=8);o[c+xe-Te]|=128*je};function Ur(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}Ur.Varint=0,Ur.Fixed64=1,Ur.Bytes=2,Ur.Fixed32=5;var Zh=4294967296,eu=1/Zh,Yh=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Dc(o){return o.type===Ur.Bytes?o.readVarint()+o.pos:o.pos+1}function Sf(o,t,c){var g=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));c.realloc(g);for(var D=c.pos-1;D>=o;D--)c.buf[D+g]=c.buf[D]}function wd(o,t){for(var c=0;c<o.length;c++)t.writeVarint(o[c])}function Ha(o,t){for(var c=0;c<o.length;c++)t.writeSVarint(o[c])}function Ll(o,t){for(var c=0;c<o.length;c++)t.writeFloat(o[c])}function qh(o,t){for(var c=0;c<o.length;c++)t.writeDouble(o[c])}function Kh(o,t){for(var c=0;c<o.length;c++)t.writeBoolean(o[c])}function Xh(o,t){for(var c=0;c<o.length;c++)t.writeFixed32(o[c])}function Mf(o,t){for(var c=0;c<o.length;c++)t.writeSFixed32(o[c])}function Vp(o,t){for(var c=0;c<o.length;c++)t.writeFixed64(o[c])}function hp(o,t){for(var c=0;c<o.length;c++)t.writeSFixed64(o[c])}function Dd(o,t){return(o[t]|o[t+1]<<8|o[t+2]<<16)+16777216*o[t+3]}function Zu(o,t,c){o[c]=t,o[c+1]=t>>>8,o[c+2]=t>>>16,o[c+3]=t>>>24}function Jh(o,t){return(o[t]|o[t+1]<<8|o[t+2]<<16)+(o[t+3]<<24)}Ur.prototype={destroy:function(){this.buf=null},readFields:function(o,t,c){for(c=c||this.length;this.pos<c;){var g=this.readVarint(),D=g>>3,M=this.pos;this.type=7&g,o(D,t,this),this.pos===M&&this.skip(g)}return t},readMessage:function(o,t){return this.readFields(o,t,this.readVarint()+this.pos)},readFixed32:function(){var o=Dd(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=Jh(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=Dd(this.buf,this.pos)+Dd(this.buf,this.pos+4)*Zh;return this.pos+=8,o},readSFixed64:function(){var o=Dd(this.buf,this.pos)+Jh(this.buf,this.pos+4)*Zh;return this.pos+=8,o},readFloat:function(){var o=Wh(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=Wh(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var t,c,g=this.buf;return t=127&(c=g[this.pos++]),c<128?t:(t|=(127&(c=g[this.pos++]))<<7,c<128?t:(t|=(127&(c=g[this.pos++]))<<14,c<128?t:(t|=(127&(c=g[this.pos++]))<<21,c<128?t:function(D,M,P){var B,$,ee=P.buf;if(B=(112&($=ee[P.pos++]))>>4,$<128||(B|=(127&($=ee[P.pos++]))<<3,$<128)||(B|=(127&($=ee[P.pos++]))<<10,$<128)||(B|=(127&($=ee[P.pos++]))<<17,$<128)||(B|=(127&($=ee[P.pos++]))<<24,$<128)||(B|=(1&($=ee[P.pos++]))<<31,$<128))return function Cc(o,t,c){return c?4294967296*t+(o>>>0):4294967296*(t>>>0)+(o>>>0)}(D,B,M);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(c=g[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var o=this.readVarint()+this.pos,t=this.pos;return this.pos=o,o-t>=12&&Yh?Yh.decode(this.buf.subarray(t,o)):function(c,g,D){for(var M="",P=g;P<D;){var B,$,ee,se=c[P],fe=null,ve=se>239?4:se>223?3:se>191?2:1;if(P+ve>D)break;1===ve?se<128&&(fe=se):2===ve?128==(192&(B=c[P+1]))&&(fe=(31&se)<<6|63&B)<=127&&(fe=null):3===ve?($=c[P+2],128==(192&(B=c[P+1]))&&128==(192&$)&&((fe=(15&se)<<12|(63&B)<<6|63&$)<=2047||fe>=55296&&fe<=57343)&&(fe=null)):4===ve&&($=c[P+2],ee=c[P+3],128==(192&(B=c[P+1]))&&128==(192&$)&&128==(192&ee)&&((fe=(15&se)<<18|(63&B)<<12|(63&$)<<6|63&ee)<=65535||fe>=1114112)&&(fe=null)),null===fe?(fe=65533,ve=1):fe>65535&&(fe-=65536,M+=String.fromCharCode(fe>>>10&1023|55296),fe=56320|1023&fe),M+=String.fromCharCode(fe),P+=ve}return M}(this.buf,t,o)},readBytes:function(){var o=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,o);return this.pos=o,t},readPackedVarint:function(o,t){if(this.type!==Ur.Bytes)return o.push(this.readVarint(t));var c=Dc(this);for(o=o||[];this.pos<c;)o.push(this.readVarint(t));return o},readPackedSVarint:function(o){if(this.type!==Ur.Bytes)return o.push(this.readSVarint());var t=Dc(this);for(o=o||[];this.pos<t;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==Ur.Bytes)return o.push(this.readBoolean());var t=Dc(this);for(o=o||[];this.pos<t;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==Ur.Bytes)return o.push(this.readFloat());var t=Dc(this);for(o=o||[];this.pos<t;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==Ur.Bytes)return o.push(this.readDouble());var t=Dc(this);for(o=o||[];this.pos<t;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==Ur.Bytes)return o.push(this.readFixed32());var t=Dc(this);for(o=o||[];this.pos<t;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==Ur.Bytes)return o.push(this.readSFixed32());var t=Dc(this);for(o=o||[];this.pos<t;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==Ur.Bytes)return o.push(this.readFixed64());var t=Dc(this);for(o=o||[];this.pos<t;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==Ur.Bytes)return o.push(this.readSFixed64());var t=Dc(this);for(o=o||[];this.pos<t;)o.push(this.readSFixed64());return o},skip:function(o){var t=7&o;if(t===Ur.Varint)for(;this.buf[this.pos++]>127;);else if(t===Ur.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Ur.Fixed32)this.pos+=4;else{if(t!==Ur.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(o,t){this.writeVarint(o<<3|t)},realloc:function(o){for(var t=this.length||16;t<this.pos+o;)t*=2;if(t!==this.length){var c=new Uint8Array(t);c.set(this.buf),this.buf=c,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),Zu(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),Zu(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),Zu(this.buf,-1&o,this.pos),Zu(this.buf,Math.floor(o*eu),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),Zu(this.buf,-1&o,this.pos),Zu(this.buf,Math.floor(o*eu),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(t,c){var g,D,M,B;if(t>=0?(g=t%4294967296|0,D=t/4294967296|0):(D=~(-t/4294967296),4294967295^(g=~(-t%4294967296))?g=g+1|0:(g=0,D=D+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");c.realloc(10),M=g,(B=c).buf[B.pos++]=127&M|128,M>>>=7,B.buf[B.pos++]=127&M|128,M>>>=7,B.buf[B.pos++]=127&M|128,M>>>=7,B.buf[B.pos++]=127&M|128,B.buf[B.pos]=127&(M>>>=7),function(M,P){var B=(7&M)<<4;P.buf[P.pos++]|=B|((M>>>=3)?128:0),M&&(P.buf[P.pos++]=127&M|((M>>>=7)?128:0),M&&(P.buf[P.pos++]=127&M|((M>>>=7)?128:0),M&&(P.buf[P.pos++]=127&M|((M>>>=7)?128:0),M&&(P.buf[P.pos++]=127&M|((M>>>=7)?128:0),M&&(P.buf[P.pos++]=127&M)))))}(D,c)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(!!o)},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var t=this.pos;this.pos=function(g,D,M){for(var P,B,$=0;$<D.length;$++){if((P=D.charCodeAt($))>55295&&P<57344){if(!B){P>56319||$+1===D.length?(g[M++]=239,g[M++]=191,g[M++]=189):B=P;continue}if(P<56320){g[M++]=239,g[M++]=191,g[M++]=189,B=P;continue}P=B-55296<<10|P-56320|65536,B=null}else B&&(g[M++]=239,g[M++]=191,g[M++]=189,B=null);P<128?g[M++]=P:(P<2048?g[M++]=P>>6|192:(P<65536?g[M++]=P>>12|224:(g[M++]=P>>18|240,g[M++]=P>>12&63|128),g[M++]=P>>6&63|128),g[M++]=63&P|128)}return M}(this.buf,o,this.pos);var c=this.pos-t;c>=128&&Sf(t,c,this),this.pos=t-1,this.writeVarint(c),this.pos+=c},writeFloat:function(o){this.realloc(4),xd(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),xd(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var t=o.length;this.writeVarint(t),this.realloc(t);for(var c=0;c<t;c++)this.buf[this.pos++]=o[c]},writeRawMessage:function(o,t){this.pos++;var c=this.pos;o(t,this);var g=this.pos-c;g>=128&&Sf(c,g,this),this.pos=c-1,this.writeVarint(g),this.pos+=g},writeMessage:function(o,t,c){this.writeTag(o,Ur.Bytes),this.writeRawMessage(t,c)},writePackedVarint:function(o,t){t.length&&this.writeMessage(o,wd,t)},writePackedSVarint:function(o,t){t.length&&this.writeMessage(o,Ha,t)},writePackedBoolean:function(o,t){t.length&&this.writeMessage(o,Kh,t)},writePackedFloat:function(o,t){t.length&&this.writeMessage(o,Ll,t)},writePackedDouble:function(o,t){t.length&&this.writeMessage(o,qh,t)},writePackedFixed32:function(o,t){t.length&&this.writeMessage(o,Xh,t)},writePackedSFixed32:function(o,t){t.length&&this.writeMessage(o,Mf,t)},writePackedFixed64:function(o,t){t.length&&this.writeMessage(o,Vp,t)},writePackedSFixed64:function(o,t){t.length&&this.writeMessage(o,hp,t)},writeBytesField:function(o,t){this.writeTag(o,Ur.Bytes),this.writeBytes(t)},writeFixed32Field:function(o,t){this.writeTag(o,Ur.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(o,t){this.writeTag(o,Ur.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(o,t){this.writeTag(o,Ur.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(o,t){this.writeTag(o,Ur.Fixed64),this.writeSFixed64(t)},writeVarintField:function(o,t){this.writeTag(o,Ur.Varint),this.writeVarint(t)},writeSVarintField:function(o,t){this.writeTag(o,Ur.Varint),this.writeSVarint(t)},writeStringField:function(o,t){this.writeTag(o,Ur.Bytes),this.writeString(t)},writeFloatField:function(o,t){this.writeTag(o,Ur.Fixed32),this.writeFloat(t)},writeDoubleField:function(o,t){this.writeTag(o,Ur.Fixed64),this.writeDouble(t)},writeBooleanField:function(o,t){this.writeVarintField(o,!!t)}};var Yu=tt(dp);const Cd=3;function fp(o,t,c){1===o&&c.readMessage(Qh,t)}function Qh(o,t,c){if(3===o){const{id:g,bitmap:D,width:M,height:P,left:B,top:$,advance:ee}=c.readMessage(pp,{});t.push({id:g,bitmap:new Xc({width:M+2*Cd,height:P+2*Cd},D),metrics:{width:M,height:P,left:B,top:$,advance:ee}})}}function pp(o,t,c){1===o?t.id=c.readVarint():2===o?t.bitmap=c.readBytes():3===o?t.width=c.readVarint():4===o?t.height=c.readVarint():5===o?t.left=c.readSVarint():6===o?t.top=c.readSVarint():7===o&&(t.advance=c.readVarint())}const $a=Cd;function rh(o){let t=0,c=0;for(const P of o)t+=P.w*P.h,c=Math.max(c,P.w);o.sort((P,B)=>B.h-P.h);const g=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),c),h:1/0}];let D=0,M=0;for(const P of o)for(let B=g.length-1;B>=0;B--){const $=g[B];if(!(P.w>$.w||P.h>$.h)){if(P.x=$.x,P.y=$.y,M=Math.max(M,P.y+P.h),D=Math.max(D,P.x+P.w),P.w===$.w&&P.h===$.h){const ee=g.pop();B<g.length&&(g[B]=ee)}else P.h===$.h?($.x+=P.w,$.w-=P.w):P.w===$.w?($.y+=P.h,$.h-=P.h):(g.push({x:$.x+P.w,y:$.y,w:$.w-P.w,h:P.h}),$.y+=P.h,$.h-=P.h);break}}return{w:D,h:M,fill:t/(D*M)||0}}const ba=1;class ic{constructor(t,{pixelRatio:c,version:g,stretchX:D,stretchY:M,content:P}){this.paddedRect=t,this.pixelRatio=c,this.stretchX=D,this.stretchY=M,this.content=P,this.version=g}get tl(){return[this.paddedRect.x+ba,this.paddedRect.y+ba]}get br(){return[this.paddedRect.x+this.paddedRect.w-ba,this.paddedRect.y+this.paddedRect.h-ba]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*ba)/this.pixelRatio,(this.paddedRect.h-2*ba)/this.pixelRatio]}}class Af{constructor(t,c){const g={},D={};this.haveRenderCallbacks=[];const M=[];this.addImages(t,g,M),this.addImages(c,D,M);const{w:P,h:B}=rh(M),$=new Qa({width:P||1,height:B||1});for(const ee in t){const se=t[ee],fe=g[ee].paddedRect;Qa.copy(se.data,$,{x:0,y:0},{x:fe.x+ba,y:fe.y+ba},se.data)}for(const ee in c){const se=c[ee],fe=D[ee].paddedRect,ve=fe.x+ba,xe=fe.y+ba,Te=se.data.width,je=se.data.height;Qa.copy(se.data,$,{x:0,y:0},{x:ve,y:xe},se.data),Qa.copy(se.data,$,{x:0,y:je-1},{x:ve,y:xe-1},{width:Te,height:1}),Qa.copy(se.data,$,{x:0,y:0},{x:ve,y:xe+je},{width:Te,height:1}),Qa.copy(se.data,$,{x:Te-1,y:0},{x:ve-1,y:xe},{width:1,height:je}),Qa.copy(se.data,$,{x:0,y:0},{x:ve+Te,y:xe},{width:1,height:je})}this.image=$,this.iconPositions=g,this.patternPositions=D}addImages(t,c,g){for(const D in t){const M=t[D],P={x:0,y:0,w:M.data.width+2*ba,h:M.data.height+2*ba};g.push(P),c[D]=new ic(P,M),M.hasRenderCallback&&this.haveRenderCallbacks.push(D)}}patchUpdatedImages(t,c){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const g in t.updatedImages)this.patchUpdatedImage(this.iconPositions[g],t.getImage(g),c),this.patchUpdatedImage(this.patternPositions[g],t.getImage(g),c)}patchUpdatedImage(t,c,g){if(!t||!c||t.version===c.version)return;t.version=c.version;const[D,M]=t.tl;g.update(c.data,void 0,{x:D,y:M})}}var tu;Xn("ImagePosition",ic),Xn("ImageAtlas",Af),x.WritingMode=void 0,(tu=x.WritingMode||(x.WritingMode={}))[tu.none=0]="none",tu[tu.horizontal=1]="horizontal",tu[tu.vertical=2]="vertical",tu[tu.horizontalOnly=3]="horizontalOnly";const oh=-17;class sh{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,c){const g=new sh;return g.scale=t||1,g.fontStack=c,g}static forImage(t){const c=new sh;return c.imageName=t,c}}class Ec{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,c){const g=new Ec;for(let D=0;D<t.sections.length;D++){const M=t.sections[D];M.image?g.addImageSection(M):g.addTextSection(M,c)}return g}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let c="";for(let g=0;g<t.length;g++){const D=t.charCodeAt(g+1)||null,M=t.charCodeAt(g-1)||null;c+=D&&St(D)&&!xu[t[g+1]]||M&&St(M)&&!xu[t[g-1]]||!xu[t[g]]?t[g]:xu[t[g]]}return c}(this.text)}trim(){let t=0;for(let g=0;g<this.text.length&&Ed[this.text.charCodeAt(g)];g++)t++;let c=this.text.length;for(let g=this.text.length-1;g>=0&&g>=t&&Ed[this.text.charCodeAt(g)];g--)c--;this.text=this.text.substring(t,c),this.sectionIndex=this.sectionIndex.slice(t,c)}substring(t,c){const g=new Ec;return g.text=this.text.substring(t,c),g.sectionIndex=this.sectionIndex.slice(t,c),g.sections=this.sections,g}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,c)=>Math.max(t,this.sections[c].scale),0)}addTextSection(t,c){this.text+=t.text,this.sections.push(sh.forText(t.scale,t.fontStack||c));const g=this.sections.length-1;for(let D=0;D<t.text.length;++D)this.sectionIndex.push(g)}addImageSection(t){const c=t.image?t.image.name:"";if(0===c.length)return void Et("Can't add FormattedSection with an empty image.");const g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCharCode(g),this.sections.push(sh.forImage(c)),this.sectionIndex.push(this.sections.length-1)):Et("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function ef(o,t,c,g,D,M,P,B,$,ee,se,fe,ve,xe,Te,je){const Ue=Ec.fromFeature(o,D);let it;fe===x.WritingMode.vertical&&Ue.verticalizePunctuation();const{processBidirectionalText:pt,processStyledBidirectionalText:Je}=Nn;if(pt&&1===Ue.sections.length){it=[];const Xt=pt(Ue.toString(),lh(Ue,ee,M,t,g,xe,Te));for(const Jn of Xt){const ei=new Ec;ei.text=Jn,ei.sections=Ue.sections;for(let $n=0;$n<Jn.length;$n++)ei.sectionIndex.push(0);it.push(ei)}}else if(Je){it=[];const Xt=Je(Ue.text,Ue.sectionIndex,lh(Ue,ee,M,t,g,xe,Te));for(const Jn of Xt){const ei=new Ec;ei.text=Jn[0],ei.sectionIndex=Jn[1],ei.sections=Ue.sections,it.push(ei)}}else it=function(Xt,Jn){const ei=[],$n=Xt.text;let kn=0;for(const In of Jn)ei.push(Xt.substring(kn,In)),kn=In;return kn<$n.length&&ei.push(Xt.substring(kn,$n.length)),ei}(Ue,lh(Ue,ee,M,t,g,xe,Te));const Ct=[],At={positionedLines:Ct,text:Ue.toString(),top:se[1],bottom:se[1],left:se[0],right:se[0],writingMode:fe,iconsInText:!1,verticalizable:!1};return function(Xt,Jn,ei,$n,kn,In,Zn,Un,_n,xi,_i,Dr){let so=0,Fo=oh,ss=0,rl=0;const Cs="right"===Un?1:"left"===Un?0:.5;let Qo=0;for(const as of kn){as.trim();const Us=as.getMaxScale(),js=(Us-1)*Xo,ol={positionedGlyphs:[],lineOffset:0};Xt.positionedLines[Qo]=ol;const Hs=ol.positionedGlyphs;let Da=0;if(!as.length()){Fo+=In,++Qo;continue}for(let ca=0;ca<as.length();ca++){const fr=as.getSection(ca),sl=as.getSectionIndex(ca),Xs=as.getCharCode(ca);let Ca=0,lc=null,al=null,Ic=null,Oc=Xo;const wl=!(_n===x.WritingMode.horizontal||!_i&&!He(Xs)||_i&&(Ed[Xs]||(Es=Xs,G.Arabic(Es)||G["Arabic Supplement"](Es)||G["Arabic Extended-A"](Es)||G["Arabic Presentation Forms-A"](Es)||G["Arabic Presentation Forms-B"](Es))));if(fr.imageName){const Vl=$n[fr.imageName];if(!Vl)continue;Ic=fr.imageName,Xt.iconsInText=Xt.iconsInText||!0,al=Vl.paddedRect;const Rs=Vl.displaySize;fr.scale=fr.scale*Xo/Dr,lc={width:Rs[0],height:Rs[1],left:ba,top:-$a,advance:wl?Rs[1]:Rs[0]},Ca=js+(Xo-Rs[1]*fr.scale),Oc=lc.advance;const Pc=wl?Rs[0]*fr.scale-Xo*Us:Rs[1]*fr.scale-Xo*Us;Pc>0&&Pc>Da&&(Da=Pc)}else{const Vl=ei[fr.fontStack],Rs=Vl&&Vl[Xs];if(Rs&&Rs.rect)al=Rs.rect,lc=Rs.metrics;else{const Pc=Jn[fr.fontStack],ed=Pc&&Pc[Xs];if(!ed)continue;lc=ed.metrics}Ca=(Us-fr.scale)*Xo}wl?(Xt.verticalizable=!0,Hs.push({glyph:Xs,imageName:Ic,x:so,y:Fo+Ca,vertical:wl,scale:fr.scale,fontStack:fr.fontStack,sectionIndex:sl,metrics:lc,rect:al}),so+=Oc*fr.scale+xi):(Hs.push({glyph:Xs,imageName:Ic,x:so,y:Fo+Ca,vertical:wl,scale:fr.scale,fontStack:fr.fontStack,sectionIndex:sl,metrics:lc,rect:al}),so+=lc.advance*fr.scale+xi)}0!==Hs.length&&(ss=Math.max(so-xi,ss),Ku(Hs,0,Hs.length-1,Cs,Da)),so=0;const Wo=In*Us+Da;ol.lineOffset=Math.max(Da,js),Fo+=Wo,rl=Math.max(Wo,rl),++Qo}var Es;const Lo=Fo-oh,{horizontalAlign:Ns,verticalAlign:Ks}=Sd(Zn);(function(as,Us,js,ol,Hs,Da,Wo,ca,fr){const sl=(Us-js)*Hs;let Xs=0;Xs=Da!==Wo?-ca*ol-oh:(-ol*fr+.5)*Wo;for(const Ca of as)for(const lc of Ca.positionedGlyphs)lc.x+=sl,lc.y+=Xs})(Xt.positionedLines,Cs,Ns,Ks,ss,rl,In,Lo,kn.length),Xt.top+=-Ks*Lo,Xt.bottom=Xt.top+Lo,Xt.left+=-Ns*ss,Xt.right=Xt.left+ss}(At,t,c,g,it,P,B,$,fe,ee,ve,je),!function(Xt){for(const Jn of Xt)if(0!==Jn.positionedGlyphs.length)return!1;return!0}(Ct)&&At}const Ed={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Td={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function ah(o,t,c,g,D,M){if(t.imageName){const P=g[t.imageName];return P?P.displaySize[0]*t.scale*Xo/M+D:0}{const P=c[t.fontStack],B=P&&P[o];return B?B.metrics.advance*t.scale+D:0}}function wu(o,t,c,g){const D=Math.pow(o-t,2);return g?o<t?D/2:2*D:D+Math.abs(c)*c}function Tc(o,t,c){let g=0;return 10===o&&(g-=1e4),c&&(g+=150),40!==o&&65288!==o||(g+=50),41!==t&&65289!==t||(g+=50),g}function qu(o,t,c,g,D,M){let P=null,B=wu(t,c,D,M);for(const $ of g){const ee=wu(t-$.x,c,D,M)+$.badness;ee<=B&&(P=$,B=ee)}return{index:o,x:t,priorBreak:P,badness:B}}function Du(o){return o?Du(o.priorBreak).concat(o.index):[]}function lh(o,t,c,g,D,M,P){if("point"!==M)return[];if(!o)return[];const B=[],$=function(ve,xe,Te,je,Ue,it){let pt=0;for(let Je=0;Je<ve.length();Je++){const Ct=ve.getSection(Je);pt+=ah(ve.getCharCode(Je),Ct,je,Ue,xe,it)}return pt/Math.max(1,Math.ceil(pt/Te))}(o,t,c,g,D,P),ee=o.text.indexOf("\u200b")>=0;let se=0;for(let ve=0;ve<o.length();ve++){const xe=o.getSection(ve),Te=o.getCharCode(ve);if(Ed[Te]||(se+=ah(Te,xe,g,D,t,P)),ve<o.length()-1){const je=!((fe=Te)<11904||!(G["Bopomofo Extended"](fe)||G.Bopomofo(fe)||G["CJK Compatibility Forms"](fe)||G["CJK Compatibility Ideographs"](fe)||G["CJK Compatibility"](fe)||G["CJK Radicals Supplement"](fe)||G["CJK Strokes"](fe)||G["CJK Symbols and Punctuation"](fe)||G["CJK Unified Ideographs Extension A"](fe)||G["CJK Unified Ideographs"](fe)||G["Enclosed CJK Letters and Months"](fe)||G["Halfwidth and Fullwidth Forms"](fe)||G.Hiragana(fe)||G["Ideographic Description Characters"](fe)||G["Kangxi Radicals"](fe)||G["Katakana Phonetic Extensions"](fe)||G.Katakana(fe)||G["Vertical Forms"](fe)||G["Yi Radicals"](fe)||G["Yi Syllables"](fe)));(Td[Te]||je||xe.imageName)&&B.push(qu(ve+1,se,$,B,Tc(Te,o.getCharCode(ve+1),je&&ee),!1))}}var fe;return Du(qu(o.length(),se,$,B,0,!0))}function Sd(o){let t=.5,c=.5;switch(o){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":c=1;break;case"top":case"top-right":case"top-left":c=0}return{horizontalAlign:t,verticalAlign:c}}function Ku(o,t,c,g,D){if(!g&&!D)return;const M=o[c],P=(o[c].x+M.metrics.advance*M.scale)*g;for(let B=t;B<=c;B++)o[B].x-=P,o[B].y+=D}function Md(o,t,c){const{horizontalAlign:g,verticalAlign:D}=Sd(c),M=t[0]-o.displaySize[0]*g,P=t[1]-o.displaySize[1]*D;return{image:o,top:P,bottom:P+o.displaySize[1],left:M,right:M+o.displaySize[0]}}function tf(o,t,c,g,D,M){const P=o.image;let B;if(P.content){const Ue=P.content,it=P.pixelRatio||1;B=[Ue[0]/it,Ue[1]/it,P.displaySize[0]-Ue[2]/it,P.displaySize[1]-Ue[3]/it]}const $=t.left*M,ee=t.right*M;let se,fe,ve,xe;"width"===c||"both"===c?(xe=D[0]+$-g[3],fe=D[0]+ee+g[1]):(xe=D[0]+($+ee-P.displaySize[0])/2,fe=xe+P.displaySize[0]);const Te=t.top*M,je=t.bottom*M;return"height"===c||"both"===c?(se=D[1]+Te-g[0],ve=D[1]+je+g[2]):(se=D[1]+(Te+je-P.displaySize[1])/2,ve=se+P.displaySize[1]),{image:P,top:se,right:fe,bottom:ve,left:xe,collisionPadding:B}}const Sc=255,Mc=128,nu=Sc*Mc;function nf(o,t){const{expression:c}=t;if("constant"===c.kind)return{kind:"constant",layoutSize:c.evaluate(new Xi(o+1))};if("source"===c.kind)return{kind:"source"};{const{zoomStops:g,interpolationType:D}=c;let M=0;for(;M<g.length&&g[M]<=o;)M++;M=Math.max(0,M-1);let P=M;for(;P<g.length&&g[P]<o+1;)P++;P=Math.min(g.length-1,P);const B=g[M],$=g[P];return"composite"===c.kind?{kind:"composite",minZoom:B,maxZoom:$,interpolationType:D}:{kind:"camera",minZoom:B,maxZoom:$,minSize:c.evaluate(new Xi(B)),maxSize:c.evaluate(new Xi($)),interpolationType:D}}}function If(o,t,c){let g="never";const D=o.get(t);return D?g=D:o.get(c)&&(g="always"),g}const Up=ec.VectorTileFeature.types,gp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ch(o,t,c,g,D,M,P,B,$,ee,se,fe,ve){const xe=B?Math.min(nu,Math.round(B[0])):0,Te=B?Math.min(nu,Math.round(B[1])):0;o.emplaceBack(t,c,Math.round(32*g),Math.round(32*D),M,P,(xe<<1)+($?1:0),Te,16*ee,16*se,256*fe,256*ve)}function Xu(o,t,c){o.emplaceBack(t.x,t.y,c),o.emplaceBack(t.x,t.y,c),o.emplaceBack(t.x,t.y,c),o.emplaceBack(t.x,t.y,c)}function Of(o){for(const t of o.sections)if(sr(t.text))return!0;return!1}class Cu{constructor(t){this.layoutVertexArray=new ie,this.indexArray=new vt,this.programConfigurations=t,this.segments=new Dn,this.dynamicLayoutVertexArray=new ue,this.opacityVertexArray=new Ne,this.hasVisibleVertices=!1,this.placedSymbolArray=new V}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(t,c,g,D){this.isEmpty()||(g&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,nh.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,c),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,jh.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,gp,!0),this.opacityVertexBuffer.itemSize=1),(g||D)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Xn("SymbolBuffers",Cu);class rf{constructor(t,c,g){this.layoutVertexArray=new t,this.layoutAttributes=c,this.indexArray=new g,this.segments=new Dn,this.collisionVertexArray=new Mt}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Hh.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Xn("CollisionBuffers",rf);class Ad{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(P=>P.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=vf([]),this.placementViewportMatrix=vf([]);const c=this.layers[0]._unevaluatedLayout._values;this.textSizeData=nf(this.zoom,c["text-size"]),this.iconSizeData=nf(this.zoom,c["icon-size"]);const g=this.layers[0].layout,D=g.get("symbol-sort-key"),M=g.get("symbol-z-order");this.canOverlap="never"!==If(g,"text-overlap","text-allow-overlap")||"never"!==If(g,"icon-overlap","icon-allow-overlap")||g.get("text-ignore-placement")||g.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==M&&!D.isConstant(),this.sortFeaturesByY=("viewport-y"===M||"auto"===M&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===g.get("symbol-placement")&&(this.writingModes=g.get("text-writing-mode").map(P=>x.WritingMode[P])),this.stateDependentLayerIds=this.layers.filter(P=>P.isStateDependent()).map(P=>P.id),this.sourceID=t.sourceID}createArrays(){this.text=new Cu(new vl(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Cu(new vl(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new X,this.lineVertexArray=new le,this.symbolInstances=new Y}calculateGlyphDependencies(t,c,g,D,M){for(let P=0;P<t.length;P++)if(c[t.charCodeAt(P)]=!0,(g||D)&&M){const B=xu[t.charAt(P)];B&&(c[B.charCodeAt(0)]=!0)}}populate(t,c,g){const D=this.layers[0],M=D.layout,P=M.get("text-font"),B=M.get("text-field"),$=M.get("icon-image"),ee=("constant"!==B.value.kind||B.value.value instanceof Qn&&!B.value.value.isEmpty()||B.value.value.toString().length>0)&&("constant"!==P.value.kind||P.value.value.length>0),se="constant"!==$.value.kind||!!$.value.value||Object.keys($.parameters).length>0,fe=M.get("symbol-sort-key");if(this.features=[],!ee&&!se)return;const ve=c.iconDependencies,xe=c.glyphDependencies,Te=c.availableImages,je=new Xi(this.zoom);for(const{feature:Ue,id:it,index:pt,sourceLayerIndex:Je}of t){const Ct=D._featureFilter.needGeometry,At=Wc(Ue,Ct);if(!D._featureFilter.filter(je,At,g))continue;let Xt,Jn;if(Ct||(At.geometry=Rl(Ue)),ee){const $n=D.getValueAndResolveTokens("text-field",At,g,Te),kn=Qn.factory($n);Of(kn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Co()||this.hasRTLText&&Nn.isParsed())&&(Xt=Gh(kn,D,At))}if(se){const $n=D.getValueAndResolveTokens("icon-image",At,g,Te);Jn=$n instanceof ji?$n:ji.fromString($n)}if(!Xt&&!Jn)continue;const ei=this.sortFeaturesByKey?fe.evaluate(At,{},g):void 0;if(this.features.push({id:it,text:Xt,icon:Jn,index:pt,sourceLayerIndex:Je,geometry:At.geometry,properties:Ue.properties,type:Up[Ue.type],sortKey:ei}),Jn&&(ve[Jn.name]=!0),Xt){const $n=P.evaluate(At,{},g).join(","),kn="viewport"!==M.get("text-rotation-alignment")&&"point"!==M.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(x.WritingMode.vertical)>=0;for(const In of Xt.sections)if(In.image)ve[In.image.name]=!0;else{const Zn=de(Xt.toString()),Un=In.fontStack||$n,_n=xe[Un]=xe[Un]||{};this.calculateGlyphDependencies(In.text,_n,kn,this.allowVerticalPlacement,Zn)}}}"line"===M.get("symbol-placement")&&(this.features=function(Ue){const it={},pt={},Je=[];let Ct=0;function At($n){Je.push(Ue[$n]),Ct++}function Xt($n,kn,In){const Zn=pt[$n];return delete pt[$n],pt[kn]=Zn,Je[Zn].geometry[0].pop(),Je[Zn].geometry[0]=Je[Zn].geometry[0].concat(In[0]),Zn}function Jn($n,kn,In){const Zn=it[kn];return delete it[kn],it[$n]=Zn,Je[Zn].geometry[0].shift(),Je[Zn].geometry[0]=In[0].concat(Je[Zn].geometry[0]),Zn}function ei($n,kn,In){const Zn=In?kn[0][kn[0].length-1]:kn[0][0];return`${$n}:${Zn.x}:${Zn.y}`}for(let $n=0;$n<Ue.length;$n++){const kn=Ue[$n],In=kn.geometry,Zn=kn.text?kn.text.toString():null;if(!Zn){At($n);continue}const Un=ei(Zn,In),_n=ei(Zn,In,!0);if(Un in pt&&_n in it&&pt[Un]!==it[_n]){const xi=Jn(Un,_n,In),_i=Xt(Un,_n,Je[xi].geometry);delete it[Un],delete pt[_n],pt[ei(Zn,Je[_i].geometry,!0)]=_i,Je[xi].geometry=null}else Un in pt?Xt(Un,_n,In):_n in it?Jn(Un,_n,In):(At($n),it[Un]=Ct-1,pt[_n]=Ct-1)}return Je.filter($n=>$n.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Ue,it)=>Ue.sortKey-it.sortKey)}update(t,c,g){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,c,this.layers,g),this.icon.programConfigurations.updatePaintArrays(t,c,this.layers,g))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,c){const g=this.lineVertexArray.length;if(void 0!==t.segment){let D=t.dist(c[t.segment+1]),M=t.dist(c[t.segment]);const P={};for(let B=t.segment+1;B<c.length;B++)P[B]={x:c[B].x,y:c[B].y,tileUnitDistanceFromAnchor:D},B<c.length-1&&(D+=c[B+1].dist(c[B]));for(let B=t.segment||0;B>=0;B--)P[B]={x:c[B].x,y:c[B].y,tileUnitDistanceFromAnchor:M},B>0&&(M+=c[B-1].dist(c[B]));for(let B=0;B<c.length;B++){const $=P[B];this.lineVertexArray.emplaceBack($.x,$.y,$.tileUnitDistanceFromAnchor)}}return{lineStartIndex:g,lineLength:this.lineVertexArray.length-g}}addSymbols(t,c,g,D,M,P,B,$,ee,se,fe,ve){const xe=t.indexArray,Te=t.layoutVertexArray,je=t.segments.prepareSegment(4*c.length,Te,xe,this.canOverlap?P.sortKey:void 0),Ue=this.glyphOffsetArray.length,it=je.vertexLength,pt=this.allowVerticalPlacement&&B===x.WritingMode.vertical?Math.PI/2:0,Je=P.text&&P.text.sections;for(let Ct=0;Ct<c.length;Ct++){const{tl:At,tr:Xt,bl:Jn,br:ei,tex:$n,pixelOffsetTL:kn,pixelOffsetBR:In,minFontScaleX:Zn,minFontScaleY:Un,glyphOffset:_n,isSDF:xi,sectionIndex:_i}=c[Ct],Dr=je.vertexLength,so=_n[1];ch(Te,$.x,$.y,At.x,so+At.y,$n.x,$n.y,g,xi,kn.x,kn.y,Zn,Un),ch(Te,$.x,$.y,Xt.x,so+Xt.y,$n.x+$n.w,$n.y,g,xi,In.x,kn.y,Zn,Un),ch(Te,$.x,$.y,Jn.x,so+Jn.y,$n.x,$n.y+$n.h,g,xi,kn.x,In.y,Zn,Un),ch(Te,$.x,$.y,ei.x,so+ei.y,$n.x+$n.w,$n.y+$n.h,g,xi,In.x,In.y,Zn,Un),Xu(t.dynamicLayoutVertexArray,$,pt),xe.emplaceBack(Dr,Dr+1,Dr+2),xe.emplaceBack(Dr+1,Dr+2,Dr+3),je.vertexLength+=4,je.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(_n[0]),Ct!==c.length-1&&_i===c[Ct+1].sectionIndex||t.programConfigurations.populatePaintArrays(Te.length,P,P.index,{},ve,Je&&Je[_i])}t.placedSymbolArray.emplaceBack($.x,$.y,Ue,this.glyphOffsetArray.length-Ue,it,ee,se,$.segment,g?g[0]:0,g?g[1]:0,D[0],D[1],B,0,!1,0,fe)}_addCollisionDebugVertex(t,c,g,D,M,P){return c.emplaceBack(0,0),t.emplaceBack(g.x,g.y,D,M,Math.round(P.x),Math.round(P.y))}addCollisionDebugVertices(t,c,g,D,M,P,B){const $=M.segments.prepareSegment(4,M.layoutVertexArray,M.indexArray),ee=$.vertexLength,se=M.layoutVertexArray,fe=M.collisionVertexArray,ve=B.anchorX,xe=B.anchorY;this._addCollisionDebugVertex(se,fe,P,ve,xe,new yt(t,c)),this._addCollisionDebugVertex(se,fe,P,ve,xe,new yt(g,c)),this._addCollisionDebugVertex(se,fe,P,ve,xe,new yt(g,D)),this._addCollisionDebugVertex(se,fe,P,ve,xe,new yt(t,D)),$.vertexLength+=4;const Te=M.indexArray;Te.emplaceBack(ee,ee+1),Te.emplaceBack(ee+1,ee+2),Te.emplaceBack(ee+2,ee+3),Te.emplaceBack(ee+3,ee),$.primitiveLength+=4}addDebugCollisionBoxes(t,c,g,D){for(let M=t;M<c;M++){const P=this.collisionBoxArray.get(M);this.addCollisionDebugVertices(P.x1,P.y1,P.x2,P.y2,D?this.textCollisionBox:this.iconCollisionBox,P.anchorPoint,g)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new rf(et,ih.members,on),this.iconCollisionBox=new rf(et,ih.members,on);for(let t=0;t<this.symbolInstances.length;t++){const c=this.symbolInstances.get(t);this.addDebugCollisionBoxes(c.textBoxStartIndex,c.textBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c,!0),this.addDebugCollisionBoxes(c.iconBoxStartIndex,c.iconBoxEndIndex,c,!1),this.addDebugCollisionBoxes(c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c,!1)}}_deserializeCollisionBoxesForSymbol(t,c,g,D,M,P,B,$,ee){const se={};for(let fe=c;fe<g;fe++){const ve=t.get(fe);se.textBox={x1:ve.x1,y1:ve.y1,x2:ve.x2,y2:ve.y2,anchorPointX:ve.anchorPointX,anchorPointY:ve.anchorPointY},se.textFeatureIndex=ve.featureIndex;break}for(let fe=D;fe<M;fe++){const ve=t.get(fe);se.verticalTextBox={x1:ve.x1,y1:ve.y1,x2:ve.x2,y2:ve.y2,anchorPointX:ve.anchorPointX,anchorPointY:ve.anchorPointY},se.verticalTextFeatureIndex=ve.featureIndex;break}for(let fe=P;fe<B;fe++){const ve=t.get(fe);se.iconBox={x1:ve.x1,y1:ve.y1,x2:ve.x2,y2:ve.y2,anchorPointX:ve.anchorPointX,anchorPointY:ve.anchorPointY},se.iconFeatureIndex=ve.featureIndex;break}for(let fe=$;fe<ee;fe++){const ve=t.get(fe);se.verticalIconBox={x1:ve.x1,y1:ve.y1,x2:ve.x2,y2:ve.y2,anchorPointX:ve.anchorPointX,anchorPointY:ve.anchorPointY},se.verticalIconFeatureIndex=ve.featureIndex;break}return se}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let c=0;c<this.symbolInstances.length;c++){const g=this.symbolInstances.get(c);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,g.textBoxStartIndex,g.textBoxEndIndex,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g.iconBoxStartIndex,g.iconBoxEndIndex,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,c){const g=t.placedSymbolArray.get(c),D=g.vertexStartIndex+4*g.numGlyphs;for(let M=g.vertexStartIndex;M<D;M+=4)t.indexArray.emplaceBack(M,M+1,M+2),t.indexArray.emplaceBack(M+1,M+2,M+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const c=Math.sin(t),g=Math.cos(t),D=[],M=[],P=[];for(let B=0;B<this.symbolInstances.length;++B){P.push(B);const $=this.symbolInstances.get(B);D.push(0|Math.round(c*$.anchorX+g*$.anchorY)),M.push($.featureIndex)}return P.sort((B,$)=>D[B]-D[$]||M[$]-M[B]),P}addToSortKeyRanges(t,c){const g=this.sortKeyRanges[this.sortKeyRanges.length-1];g&&g.sortKey===c?g.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:c,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const c of this.symbolInstanceIndexes){const g=this.symbolInstances.get(c);this.featureSortOrder.push(g.featureIndex),[g.rightJustifiedTextSymbolIndex,g.centerJustifiedTextSymbolIndex,g.leftJustifiedTextSymbolIndex].forEach((D,M,P)=>{D>=0&&P.indexOf(D)===M&&this.addIndicesForPlacedSymbol(this.text,D)}),g.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,g.verticalPlacedTextSymbolIndex),g.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.placedIconSymbolIndex),g.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,g.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Pf,Id;Xn("SymbolBucket",Ad,{omit:["layers","collisionBoxArray","features","compareText"]}),Ad.MAX_GLYPHS=65535,Ad.addDynamicAttributes=Xu;var Eu={get paint(){return Id=Id||new Fr({"icon-opacity":new pi(st.paint_symbol["icon-opacity"]),"icon-color":new pi(st.paint_symbol["icon-color"]),"icon-halo-color":new pi(st.paint_symbol["icon-halo-color"]),"icon-halo-width":new pi(st.paint_symbol["icon-halo-width"]),"icon-halo-blur":new pi(st.paint_symbol["icon-halo-blur"]),"icon-translate":new li(st.paint_symbol["icon-translate"]),"icon-translate-anchor":new li(st.paint_symbol["icon-translate-anchor"]),"text-opacity":new pi(st.paint_symbol["text-opacity"]),"text-color":new pi(st.paint_symbol["text-color"],{runtimeType:mr,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new pi(st.paint_symbol["text-halo-color"]),"text-halo-width":new pi(st.paint_symbol["text-halo-width"]),"text-halo-blur":new pi(st.paint_symbol["text-halo-blur"]),"text-translate":new li(st.paint_symbol["text-translate"]),"text-translate-anchor":new li(st.paint_symbol["text-translate-anchor"])})},get layout(){return Pf=Pf||new Fr({"symbol-placement":new li(st.layout_symbol["symbol-placement"]),"symbol-spacing":new li(st.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new li(st.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new pi(st.layout_symbol["symbol-sort-key"]),"symbol-z-order":new li(st.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new li(st.layout_symbol["icon-allow-overlap"]),"icon-overlap":new li(st.layout_symbol["icon-overlap"]),"icon-ignore-placement":new li(st.layout_symbol["icon-ignore-placement"]),"icon-optional":new li(st.layout_symbol["icon-optional"]),"icon-rotation-alignment":new li(st.layout_symbol["icon-rotation-alignment"]),"icon-size":new pi(st.layout_symbol["icon-size"]),"icon-text-fit":new li(st.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new li(st.layout_symbol["icon-text-fit-padding"]),"icon-image":new pi(st.layout_symbol["icon-image"]),"icon-rotate":new pi(st.layout_symbol["icon-rotate"]),"icon-padding":new pi(st.layout_symbol["icon-padding"]),"icon-keep-upright":new li(st.layout_symbol["icon-keep-upright"]),"icon-offset":new pi(st.layout_symbol["icon-offset"]),"icon-anchor":new pi(st.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new li(st.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new li(st.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new li(st.layout_symbol["text-rotation-alignment"]),"text-field":new pi(st.layout_symbol["text-field"]),"text-font":new pi(st.layout_symbol["text-font"]),"text-size":new pi(st.layout_symbol["text-size"]),"text-max-width":new pi(st.layout_symbol["text-max-width"]),"text-line-height":new li(st.layout_symbol["text-line-height"]),"text-letter-spacing":new pi(st.layout_symbol["text-letter-spacing"]),"text-justify":new pi(st.layout_symbol["text-justify"]),"text-radial-offset":new pi(st.layout_symbol["text-radial-offset"]),"text-variable-anchor":new li(st.layout_symbol["text-variable-anchor"]),"text-anchor":new pi(st.layout_symbol["text-anchor"]),"text-max-angle":new li(st.layout_symbol["text-max-angle"]),"text-writing-mode":new li(st.layout_symbol["text-writing-mode"]),"text-rotate":new pi(st.layout_symbol["text-rotate"]),"text-padding":new li(st.layout_symbol["text-padding"]),"text-keep-upright":new li(st.layout_symbol["text-keep-upright"]),"text-transform":new pi(st.layout_symbol["text-transform"]),"text-offset":new pi(st.layout_symbol["text-offset"]),"text-allow-overlap":new li(st.layout_symbol["text-allow-overlap"]),"text-overlap":new li(st.layout_symbol["text-overlap"]),"text-ignore-placement":new li(st.layout_symbol["text-ignore-placement"]),"text-optional":new li(st.layout_symbol["text-optional"])})}};class Ga{constructor(t){if(void 0===t.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:qn,this.defaultValue=t}evaluate(t){if(t.formattedSection){const c=this.defaultValue.property.overrides;if(c&&c.hasOverride(t.formattedSection))return c.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Xn("FormatSectionOverride",Ga,{omit:["defaultValue"]});class Tu extends qr{constructor(t){super(t,Eu)}recalculate(t,c){if(super.recalculate(t,c),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const g=this.layout.get("text-writing-mode");if(g){const D=[];for(const M of g)D.indexOf(M)<0&&D.push(M);this.layout._values["text-writing-mode"]=D}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,c,g,D){const M=this.layout.get(t).evaluate(c,{},g,D),P=this._unevaluatedLayout._values[t];return P.isDataDriven()||Hl(P.value)||!M?M:(B=c.properties,M.replace(/{([^{}]+)}/g,(ee,se)=>se in B?String(B[se]):""));var B}createBucket(t){return new Ad(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of Eu.paint.overridableProperties){if(!Tu.hasPaintOverride(this.layout,t))continue;const c=this.paint.get(t),g=new Ga(c),D=new hc(g,c.property.specification);let M=null;M="constant"===c.value.kind||"source"===c.value.kind?new El("source",D):new Bi("composite",D,c.value.zoomStops),this.paint._values[t]=new Ba(c.property,M,c.parameters)}}_handleOverridablePaintPropertyUpdate(t,c,g){return!(!this.layout||c.isDataDriven()||g.isDataDriven())&&Tu.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,c){const g=t.get("text-field"),D=Eu.paint.properties[c];let M=!1;const P=B=>{for(const $ of B)if(D.overrides&&D.overrides.hasOverride($))return void(M=!0)};if("constant"===g.value.kind&&g.value.value instanceof Qn)P(g.value.value.sections);else if("source"===g.value.kind){const B=ee=>{M||(ee instanceof Hi&&tr(ee.value)===Lr?P(ee.value.sections):ee instanceof Ls?P(ee.sections):ee.eachChild(B))},$=g.value;$._styleExpression&&B($._styleExpression.expression)}return M}}let Od;var sf={get paint(){return Od=Od||new Fr({"background-color":new li(st.paint_background["background-color"]),"background-pattern":new dn(st.paint_background["background-pattern"]),"background-opacity":new li(st.paint_background["background-opacity"])})}};let Nf;var mp={get paint(){return Nf=Nf||new Fr({"raster-opacity":new li(st.paint_raster["raster-opacity"]),"raster-hue-rotate":new li(st.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new li(st.paint_raster["raster-brightness-min"]),"raster-brightness-max":new li(st.paint_raster["raster-brightness-max"]),"raster-saturation":new li(st.paint_raster["raster-saturation"]),"raster-contrast":new li(st.paint_raster["raster-contrast"]),"raster-resampling":new li(st.paint_raster["raster-resampling"]),"raster-fade-duration":new li(st.paint_raster["raster-fade-duration"])})}};class uh extends qr{constructor(t){super(t,{}),this.onAdd=c=>{this.implementation.onAdd&&this.implementation.onAdd(c,c.painter.context.gl)},this.onRemove=c=>{this.implementation.onRemove&&this.implementation.onRemove(c,c.painter.context.gl)},this.implementation=t}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const Rf={circle:class extends qr{constructor(o){super(o,Fp)}createBucket(o){return new Zc(o)}queryRadius(o){const t=o;return Ja("circle-radius",this,t)+Ja("circle-stroke-width",this,t)+Gd(this.paint.get("circle-translate"))}queryIntersectsFeature(o,t,c,g,D,M,P,B){const $=Wd(o,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),M.angle,P),ee=this.paint.get("circle-radius").evaluate(t,c)+this.paint.get("circle-stroke-width").evaluate(t,c),se="map"===this.paint.get("circle-pitch-alignment"),fe=se?$:(Te=B,$.map(je=>ip(je,Te))),ve=se?ee*P:ee;var Te;for(const xe of g)for(const Te of xe){const je=se?Te:ip(Te,B);let Ue=ve;const it=Ko([],[Te.x,Te.y,0,1],B);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?Ue*=it[3]/M.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(Ue*=M.cameraToCenterDistance/it[3]),yf(fe,je,Ue))return!0}return!1}},heatmap:class extends qr{createBucket(o){return new cd(o)}constructor(o){super(o,bl),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"heatmap-color"===o&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ah({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}},hillshade:class extends qr{constructor(o){super(o,mg)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}},fill:class extends qr{constructor(o){super(o,wf)}recalculate(o,t){super.recalculate(o,t);const c=this.paint._values["fill-outline-color"];"constant"===c.value.kind&&void 0===c.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(o){return new Nh(o)}queryRadius(){return Gd(this.paint.get("fill-translate"))}queryIntersectsFeature(o,t,c,g,D,M,P){return jd(Wd(o,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),M.angle,P),g)}isTileClipped(){return!0}},"fill-extrusion":class extends qr{constructor(o){super(o,up)}createBucket(o){return new _d(o)}queryRadius(){return Gd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(o,t,c,g,D,M,P,B){const $=Wd(o,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),M.angle,P),ee=this.paint.get("fill-extrusion-height").evaluate(t,c),se=this.paint.get("fill-extrusion-base").evaluate(t,c),fe=function(xe,Te,je,Ue){const it=[];for(const pt of xe){const Je=[pt.x,pt.y,0,1];Ko(Je,Je,Te),it.push(new yt(Je[0]/Je[3],Je[1]/Je[3]))}return it}($,B),ve=function(xe,Te,je,Ue){const it=[],pt=[],Je=Ue[8]*Te,Ct=Ue[9]*Te,At=Ue[10]*Te,Xt=Ue[11]*Te,Jn=Ue[8]*je,ei=Ue[9]*je,$n=Ue[10]*je,kn=Ue[11]*je;for(const In of xe){const Zn=[],Un=[];for(const _n of In){const xi=_n.x,_i=_n.y,Dr=Ue[0]*xi+Ue[4]*_i+Ue[12],so=Ue[1]*xi+Ue[5]*_i+Ue[13],Fo=Ue[2]*xi+Ue[6]*_i+Ue[14],ss=Ue[3]*xi+Ue[7]*_i+Ue[15],rl=Fo+At,Cs=ss+Xt,Qo=Dr+Jn,Es=so+ei,Lo=Fo+$n,Ns=ss+kn,Ks=new yt((Dr+Je)/Cs,(so+Ct)/Cs);Ks.z=rl/Cs,Zn.push(Ks);const as=new yt(Qo/Ns,Es/Ns);as.z=Lo/Ns,Un.push(as)}it.push(Zn),pt.push(Un)}return[it,pt]}(g,se,ee,B);return function(xe,Te,je){let Ue=1/0;jd(je,Te)&&(Ue=Cf(je,Te[0]));for(let it=0;it<Te.length;it++){const pt=Te[it],Je=xe[it];for(let Ct=0;Ct<pt.length-1;Ct++){const At=pt[Ct],Xt=[At,pt[Ct+1],Je[Ct+1],Je[Ct],At];kl(je,Xt)&&(Ue=Math.min(Ue,Cf(je,Xt)))}}return Ue!==1/0&&Ue}(ve[0],ve[1],fe)}},line:class extends qr{constructor(o){super(o,Tf),this.gradientVersion=0,Ds||(Ds=new th(Tf.paint.properties["line-width"].specification),Ds.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(o){"line-gradient"===o&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Fs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(o,t){super.recalculate(o,t),this.paint._values["line-floorwidth"]=Ds.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,o)}createBucket(o){return new Uh(o)}queryRadius(o){const t=o,c=bu(Ja("line-width",this,t),Ja("line-gap-width",this,t)),g=Ja("line-offset",this,t);return c/2+Math.abs(g)+Gd(this.paint.get("line-translate"))}queryIntersectsFeature(o,t,c,g,D,M,P){const B=Wd(o,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),M.angle,P),$=P/2*bu(this.paint.get("line-width").evaluate(t,c),this.paint.get("line-gap-width").evaluate(t,c)),ee=this.paint.get("line-offset").evaluate(t,c);return ee&&(g=function(se,fe){const ve=[];for(let xe=0;xe<se.length;xe++){const Te=se[xe],je=[];for(let Ue=0;Ue<Te.length;Ue++){const it=Te[Ue-1],pt=Te[Ue],Je=Te[Ue+1],Ct=0===Ue?new yt(0,0):pt.sub(it)._unit()._perp(),At=Ue===Te.length-1?new yt(0,0):Je.sub(pt)._unit()._perp(),Xt=Ct._add(At)._unit(),Jn=Xt.x*At.x+Xt.y*At.y;0!==Jn&&Xt._mult(1/Jn),je.push(Xt._mult(fe)._add(pt))}ve.push(je)}return ve}(g,ee*P)),function(se,fe,ve){for(let xe=0;xe<fe.length;xe++){const Te=fe[xe];if(se.length>=3)for(let je=0;je<Te.length;je++)if(vc(se,Te[je]))return!0;if(tp(se,Te,ve))return!0}return!1}(B,g,$)}isTileClipped(){return!0}},symbol:Tu,background:class extends qr{constructor(o){super(o,sf)}},raster:class extends qr{constructor(o){super(o,mp)}}};class kf{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const b=6371008.8;class A{constructor(t,c){if(isNaN(t)||isNaN(c))throw new Error(`Invalid LngLat object: (${t}, ${c})`);if(this.lng=+t,this.lat=+c,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new A(nn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const c=Math.PI/180,g=this.lat*c,D=t.lat*c,M=Math.sin(g)*Math.sin(D)+Math.cos(g)*Math.cos(D)*Math.cos((t.lng-this.lng)*c);return b*Math.acos(Math.min(M,1))}static convert(t){if(t instanceof A)return t;if(Array.isArray(t)&&(2===t.length||3===t.length))return new A(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&"object"==typeof t&&null!==t)return new A(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const f=2*Math.PI*b;function S(o){return f*Math.cos(o*Math.PI/180)}function U(o){return(180+o)/360}function te(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function Fe(o,t){return o/S(t)}function Ke(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}class ot{constructor(t,c,g=0){this.x=+t,this.y=+c,this.z=+g}static fromLngLat(t,c=0){const g=A.convert(t);return new ot(U(g.lng),te(g.lat),Fe(c,g.lat))}toLngLat(){return new A(360*this.x-180,Ke(this.y))}toAltitude(){return this.z*S(Ke(this.y))}meterInMercatorCoordinateUnits(){return 1/f*(t=Ke(this.y),1/Math.cos(t*Math.PI/180));var t}}function Dt(o,t,c){var g=2*Math.PI*6378137/256/Math.pow(2,c);return[o*g-2*Math.PI*6378137/2,t*g-2*Math.PI*6378137/2]}class Rt{constructor(t,c,g){if(t<0||t>25||g<0||g>=Math.pow(2,t)||c<0||c>=Math.pow(2,t))throw new Error(`x=${c}, y=${g}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=c,this.y=g,this.key=Wn(0,t,t,c,g)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,c,g){const D=(P=this.y,B=this.z,$=Dt(256*(M=this.x),256*(P=Math.pow(2,B)-P-1),B),ee=Dt(256*(M+1),256*(P+1),B),$[0]+","+$[1]+","+ee[0]+","+ee[1]);var M,P,B,$,ee;const se=function(fe,ve,xe){let Te,je="";for(let Ue=fe;Ue>0;Ue--)Te=1<<Ue-1,je+=(ve&Te?1:0)+(xe&Te?2:0);return je}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===g?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,c>1?"@2x":"").replace(/{quadkey}/g,se).replace(/{bbox-epsg-3857}/g,D)}isChildOf(t){const c=this.z-t.z;return c>0&&t.x===this.x>>c&&t.y===this.y>>c}getTilePoint(t){const c=Math.pow(2,this.z);return new yt((t.x*c-this.x)*oo,(t.y*c-this.y)*oo)}toString(){return`${this.z}/${this.x}/${this.y}`}}class zn{constructor(t,c){this.wrap=t,this.canonical=c,this.key=Wn(t,c.z,c.z,c.x,c.y)}}class pn{constructor(t,c,g,D,M){if(t<g)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${g}`);this.overscaledZ=t,this.wrap=c,this.canonical=new Rt(g,+D,+M),this.key=Wn(c,t,g,D,M)}clone(){return new pn(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const c=this.canonical.z-t;return t>this.canonical.z?new pn(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new pn(t,this.wrap,t,this.canonical.x>>c,this.canonical.y>>c)}calculateScaledKey(t,c){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const g=this.canonical.z-t;return t>this.canonical.z?Wn(this.wrap*+c,t,this.canonical.z,this.canonical.x,this.canonical.y):Wn(this.wrap*+c,t,t,this.canonical.x>>g,this.canonical.y>>g)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const c=this.canonical.z-t.canonical.z;return 0===t.overscaledZ||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>c&&t.canonical.y===this.canonical.y>>c}children(t){if(this.overscaledZ>=t)return[new pn(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const c=this.canonical.z+1,g=2*this.canonical.x,D=2*this.canonical.y;return[new pn(c,this.wrap,c,g,D),new pn(c,this.wrap,c,g+1,D),new pn(c,this.wrap,c,g,D+1),new pn(c,this.wrap,c,g+1,D+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new pn(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new pn(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new zn(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new ot(t.x-this.wrap,t.y))}}function Wn(o,t,c,g,D){(o*=2)<0&&(o=-1*o-1);const M=1<<c;return(M*M*o+M*D+g).toString(36)+c.toString(36)+t.toString(36)}Xn("CanonicalTileID",Rt),Xn("OverscaledTileID",pn,{omit:["posMatrix"]});class Tr{constructor(t,c,g){if(this.uid=t,c.height!==c.width)throw new RangeError("DEM tiles must be square");if(g&&"mapbox"!==g&&"terrarium"!==g)return void Et(`"${g}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=c.height;const D=this.dim=c.height-2;this.data=new Uint32Array(c.data.buffer),this.encoding=g||"mapbox";for(let M=0;M<D;M++)this.data[this._idx(-1,M)]=this.data[this._idx(0,M)],this.data[this._idx(D,M)]=this.data[this._idx(D-1,M)],this.data[this._idx(M,-1)]=this.data[this._idx(M,0)],this.data[this._idx(M,D)]=this.data[this._idx(M,D-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(D,-1)]=this.data[this._idx(D-1,0)],this.data[this._idx(-1,D)]=this.data[this._idx(0,D-1)],this.data[this._idx(D,D)]=this.data[this._idx(D-1,D-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let M=0;M<D;M++)for(let P=0;P<D;P++){const B=this.get(M,P);B>this.max&&(this.max=B),B<this.min&&(this.min=B)}}get(t,c){const g=new Uint8Array(this.data.buffer),D=4*this._idx(t,c);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(g[D],g[D+1],g[D+2])}getUnpackVector(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(t,c){if(t<-1||t>=this.dim+1||c<-1||c>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(c+1)*this.stride+(t+1)}_unpackMapbox(t,c,g){return(256*t*256+256*c+g)/10-1e4}_unpackTerrarium(t,c,g){return 256*t+c+g/256-32768}getPixels(){return new Qa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,c,g){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let D=c*this.dim,M=c*this.dim+this.dim,P=g*this.dim,B=g*this.dim+this.dim;switch(c){case-1:D=M-1;break;case 1:M=D+1}switch(g){case-1:P=B-1;break;case 1:B=P+1}const $=-c*this.dim,ee=-g*this.dim;for(let se=P;se<B;se++)for(let fe=D;fe<M;fe++)this.data[this._idx(fe,se)]=t.data[this._idx(fe+$,se+ee)]}}Xn("DEMData",Tr);class Oi{constructor(t){this._stringToNumber={},this._numberToString=[];for(let c=0;c<t.length;c++){const g=t[c];this._stringToNumber[g]=c,this._numberToString[c]=g}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class Ji{constructor(t,c,g,D,M){this.type="Feature",this._vectorTileFeature=t,t._z=c,t._x=g,t._y=D,this.properties=t.properties,this.id=M}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const c in this)"_geometry"!==c&&"_vectorTileFeature"!==c&&(t[c]=this[c]);return t}}class xr{constructor(t,c){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new _c(oo,16,0),this.grid3D=new _c(oo,16,0),this.featureIndexArray=new De,this.promoteId=c}insert(t,c,g,D,M,P){const B=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(g,D,M);const $=P?this.grid3D:this.grid;for(let ee=0;ee<c.length;ee++){const se=c[ee],fe=[1/0,1/0,-1/0,-1/0];for(let ve=0;ve<se.length;ve++){const xe=se[ve];fe[0]=Math.min(fe[0],xe.x),fe[1]=Math.min(fe[1],xe.y),fe[2]=Math.max(fe[2],xe.x),fe[3]=Math.max(fe[3],xe.y)}fe[0]<oo&&fe[1]<oo&&fe[2]>=0&&fe[3]>=0&&$.insert(B,fe[0],fe[1],fe[2],fe[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new ec.VectorTile(new Yu(this.rawTileData)).layers,this.sourceLayerCoder=new Oi(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,c,g,D){this.loadVTLayers();const M=t.params||{},P=oo/t.tileSize/t.scale,B=J(M.filter),$=t.queryGeometry,ee=t.queryPadding*P,se=no($),fe=this.grid.query(se.minX-ee,se.minY-ee,se.maxX+ee,se.maxY+ee),ve=no(t.cameraQueryGeometry),xe=this.grid3D.query(ve.minX-ee,ve.minY-ee,ve.maxX+ee,ve.maxY+ee,(Ue,it,pt,Je)=>function(Ct,At,Xt,Jn,ei){for(const kn of Ct)if(At<=kn.x&&Xt<=kn.y&&Jn>=kn.x&&ei>=kn.y)return!0;const $n=[new yt(At,Xt),new yt(At,ei),new yt(Jn,ei),new yt(Jn,Xt)];if(Ct.length>2)for(const kn of $n)if(vc(Ct,kn))return!0;for(let kn=0;kn<Ct.length-1;kn++)if(Sh(Ct[kn],Ct[kn+1],$n))return!0;return!1}(t.cameraQueryGeometry,Ue-ee,it-ee,pt+ee,Je+ee));for(const Ue of xe)fe.push(Ue);fe.sort(hr);const Te={};let je;for(let Ue=0;Ue<fe.length;Ue++){const it=fe[Ue];if(it===je)continue;je=it;const pt=this.featureIndexArray.get(it);let Je=null;this.loadMatchingFeature(Te,pt.bucketIndex,pt.sourceLayerIndex,pt.featureIndex,B,M.layers,M.availableImages,c,g,D,(Ct,At,Xt)=>(Je||(Je=Rl(Ct)),At.queryIntersectsFeature($,Ct,Xt,Je,this.z,t.transform,P,t.pixelPosMatrix)))}return Te}loadMatchingFeature(t,c,g,D,M,P,B,$,ee,se,fe){const ve=this.bucketLayerIDs[c];if(P&&!function(Ue,it){for(let pt=0;pt<Ue.length;pt++)if(it.indexOf(Ue[pt])>=0)return!0;return!1}(P,ve))return;const xe=this.sourceLayerCoder.decode(g),Te=this.vtLayers[xe].feature(D);if(M.needGeometry){const Ue=Wc(Te,!0);if(!M.filter(new Xi(this.tileID.overscaledZ),Ue,this.tileID.canonical))return}else if(!M.filter(new Xi(this.tileID.overscaledZ),Te))return;const je=this.getId(Te,xe);for(let Ue=0;Ue<ve.length;Ue++){const it=ve[Ue];if(P&&P.indexOf(it)<0)continue;const pt=$[it];if(!pt)continue;let Je={};je&&se&&(Je=se.getState(pt.sourceLayer||"_geojsonTileLayer",je));const Ct=Tn({},ee[it]);Ct.paint=Gi(Ct.paint,pt.paint,Te,Je,B),Ct.layout=Gi(Ct.layout,pt.layout,Te,Je,B);const At=!fe||fe(Te,pt,Je);if(!At)continue;const Xt=new Ji(Te,this.z,this.x,this.y,je);Xt.layer=Ct;let Jn=t[it];void 0===Jn&&(Jn=t[it]=[]),Jn.push({featureIndex:D,feature:Xt,intersectionZ:At})}}lookupSymbolFeatures(t,c,g,D,M,P,B,$){const ee={};this.loadVTLayers();const se=J(M);for(const fe of t)this.loadMatchingFeature(ee,g,D,fe,se,P,B,$,c);return ee}hasLayer(t){for(const c of this.bucketLayerIDs)for(const g of c)if(t===g)return!0;return!1}getId(t,c){let g=t.id;return this.promoteId&&(g=t.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[c]],"boolean"==typeof g&&(g=Number(g))),g}}function Gi(o,t,c,g,D){return vi(o,(M,P)=>{const B=t instanceof ys?t.get(P):null;return B&&B.evaluate?B.evaluate(c,g,D):B})}function no(o){let t=1/0,c=1/0,g=-1/0,D=-1/0;for(const M of o)t=Math.min(t,M.x),c=Math.min(c,M.y),g=Math.max(g,M.x),D=Math.max(D,M.y);return{minX:t,minY:c,maxX:g,maxY:D}}function hr(o,t){return t-o}function Or(o,t,c,g,D){const M=[];for(let P=0;P<o.length;P++){const B=o[P];let $;for(let ee=0;ee<B.length-1;ee++){let se=B[ee],fe=B[ee+1];se.x<t&&fe.x<t||(se.x<t?se=new yt(t,se.y+(t-se.x)/(fe.x-se.x)*(fe.y-se.y))._round():fe.x<t&&(fe=new yt(t,se.y+(t-se.x)/(fe.x-se.x)*(fe.y-se.y))._round()),se.y<c&&fe.y<c||(se.y<c?se=new yt(se.x+(c-se.y)/(fe.y-se.y)*(fe.x-se.x),c)._round():fe.y<c&&(fe=new yt(se.x+(c-se.y)/(fe.y-se.y)*(fe.x-se.x),c)._round()),se.x>=g&&fe.x>=g||(se.x>=g?se=new yt(g,se.y+(g-se.x)/(fe.x-se.x)*(fe.y-se.y))._round():fe.x>=g&&(fe=new yt(g,se.y+(g-se.x)/(fe.x-se.x)*(fe.y-se.y))._round()),se.y>=D&&fe.y>=D||(se.y>=D?se=new yt(se.x+(D-se.y)/(fe.y-se.y)*(fe.x-se.x),D)._round():fe.y>=D&&(fe=new yt(se.x+(D-se.y)/(fe.y-se.y)*(fe.x-se.x),D)._round()),$&&se.equals($[$.length-1])||($=[se],M.push($)),$.push(fe)))))}}return M}Xn("FeatureIndex",xr,{omit:["rawTileData","sourceLayerCoder"]});class Qi extends yt{constructor(t,c,g,D){super(t,c),this.angle=g,void 0!==D&&(this.segment=D)}clone(){return new Qi(this.x,this.y,this.angle,this.segment)}}function go(o,t,c,g,D){if(void 0===t.segment)return!0;let M=t,P=t.segment+1,B=0;for(;B>-c/2;){if(P--,P<0)return!1;B-=o[P].dist(M),M=o[P]}B+=o[P].dist(o[P+1]),P++;const $=[];let ee=0;for(;B<c/2;){const se=o[P],fe=o[P+1];if(!fe)return!1;let ve=o[P-1].angleTo(se)-se.angleTo(fe);for(ve=Math.abs((ve+3*Math.PI)%(2*Math.PI)-Math.PI),$.push({distance:B,angleDelta:ve}),ee+=ve;B-$[0].distance>g;)ee-=$.shift().angleDelta;if(ee>D)return!1;P++,B+=se.dist(fe)}return!0}function Ao(o){let t=0;for(let c=0;c<o.length-1;c++)t+=o[c].dist(o[c+1]);return t}function zs(o,t,c){return o?.6*t*c:0}function Jo(o,t){return Math.max(o?o.right-o.left:0,t?t.right-t.left:0)}function Vs(o,t,c,g,D,M){const P=zs(c,D,M),B=Jo(c,g)*M;let $=0;const ee=Ao(o)/2;for(let se=0;se<o.length-1;se++){const fe=o[se],ve=o[se+1],xe=fe.dist(ve);if($+xe>ee){const Te=(ee-$)/xe,je=ai.number(fe.x,ve.x,Te),Ue=ai.number(fe.y,ve.y,Te),it=new Qi(je,Ue,ve.angleTo(fe),se);return it._round(),!P||go(o,it,B,P,t)?it:void 0}$+=xe}}function rc(o,t,c,g,D,M,P,B,$){const ee=zs(g,M,P),se=Jo(g,D),fe=se*P,ve=0===o[0].x||o[0].x===$||0===o[0].y||o[0].y===$;return t-fe<t/4&&(t=fe+t/4),xa(o,ve?t/2*B%t:(se/2+2*M)*P*B%t,t,ee,c,fe,ve,!1,$)}function xa(o,t,c,g,D,M,P,B,$){const ee=M/2,se=Ao(o);let fe=0,ve=t-c,xe=[];for(let Te=0;Te<o.length-1;Te++){const je=o[Te],Ue=o[Te+1],it=je.dist(Ue),pt=Ue.angleTo(je);for(;ve+c<fe+it;){ve+=c;const Je=(ve-fe)/it,Ct=ai.number(je.x,Ue.x,Je),At=ai.number(je.y,Ue.y,Je);if(Ct>=0&&Ct<$&&At>=0&&At<$&&ve-ee>=0&&ve+ee<=se){const Xt=new Qi(Ct,At,pt,Te);Xt._round(),g&&!go(o,Xt,M,g,D)||xe.push(Xt)}}fe+=it}return B||xe.length||P||(xe=xa(o,fe/2,c,g,D,M,P,!0,$)),xe}Xn("Anchor",Qi);const tl=ba;function iu(o,t,c,g){const D=[],M=o.image,P=M.pixelRatio,B=M.paddedRect.w-2*tl,$=M.paddedRect.h-2*tl,ee=o.right-o.left,se=o.bottom-o.top,fe=M.stretchX||[[0,B]],ve=M.stretchY||[[0,$]],xe=(In,Zn)=>In+Zn[1]-Zn[0],Te=fe.reduce(xe,0),je=ve.reduce(xe,0),Ue=B-Te,it=$-je;let pt=0,Je=Te,Ct=0,At=je,Xt=0,Jn=Ue,ei=0,$n=it;if(M.content&&g){const In=M.content;pt=la(fe,0,In[0]),Ct=la(ve,0,In[1]),Je=la(fe,In[0],In[2]),At=la(ve,In[1],In[3]),Xt=In[0]-pt,ei=In[1]-Ct,Jn=In[2]-In[0]-Je,$n=In[3]-In[1]-At}const kn=(In,Zn,Un,_n)=>{const xi=Su(In.stretch-pt,Je,ee,o.left),_i=Bl(In.fixed-Xt,Jn,In.stretch,Te),Dr=Su(Zn.stretch-Ct,At,se,o.top),so=Bl(Zn.fixed-ei,$n,Zn.stretch,je),Fo=Su(Un.stretch-pt,Je,ee,o.left),ss=Bl(Un.fixed-Xt,Jn,Un.stretch,Te),rl=Su(_n.stretch-Ct,At,se,o.top),Cs=Bl(_n.fixed-ei,$n,_n.stretch,je),Qo=new yt(xi,Dr),Es=new yt(Fo,Dr),Lo=new yt(Fo,rl),Ns=new yt(xi,rl),Ks=new yt(_i/P,so/P),as=new yt(ss/P,Cs/P),Us=t*Math.PI/180;if(Us){const Hs=Math.sin(Us),Da=Math.cos(Us),Wo=[Da,-Hs,Hs,Da];Qo._matMult(Wo),Es._matMult(Wo),Ns._matMult(Wo),Lo._matMult(Wo)}const js=In.stretch+In.fixed,ol=Zn.stretch+Zn.fixed;return{tl:Qo,tr:Es,bl:Ns,br:Lo,tex:{x:M.paddedRect.x+tl+js,y:M.paddedRect.y+tl+ol,w:Un.stretch+Un.fixed-js,h:_n.stretch+_n.fixed-ol},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Ks,pixelOffsetBR:as,minFontScaleX:Jn/P/ee,minFontScaleY:$n/P/se,isSDF:c}};if(g&&(M.stretchX||M.stretchY)){const In=nl(fe,Ue,Te),Zn=nl(ve,it,je);for(let Un=0;Un<In.length-1;Un++){const _n=In[Un],xi=In[Un+1];for(let _i=0;_i<Zn.length-1;_i++)D.push(kn(_n,Zn[_i],xi,Zn[_i+1]))}}else D.push(kn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:B+1},{fixed:0,stretch:$+1}));return D}function la(o,t,c){let g=0;for(const D of o)g+=Math.max(t,Math.min(c,D[1]))-Math.max(t,Math.min(c,D[0]));return g}function nl(o,t,c){const g=[{fixed:-tl,stretch:0}];for(const[D,M]of o){const P=g[g.length-1];g.push({fixed:D-P.stretch,stretch:P.stretch}),g.push({fixed:D-P.stretch,stretch:P.stretch+(M-D)})}return g.push({fixed:t+tl,stretch:c}),g}function Su(o,t,c,g){return o/t*c+g}function Bl(o,t,c,g){return o-t*c/g}class wa{constructor(t,c,g,D,M,P,B,$,ee,se){if(this.boxStartIndex=t.length,ee){let fe=P.top,ve=P.bottom;const xe=P.collisionPadding;xe&&(fe-=xe[1],ve+=xe[3]);let Te=ve-fe;Te>0&&(Te=Math.max(10,Te),this.circleDiameter=Te)}else{let fe=P.top*B-$[0],ve=P.bottom*B+$[2],xe=P.left*B-$[3],Te=P.right*B+$[1];const je=P.collisionPadding;if(je&&(xe-=je[0]*B,fe-=je[1]*B,Te+=je[2]*B,ve+=je[3]*B),se){const Ue=new yt(xe,fe),it=new yt(Te,fe),pt=new yt(xe,ve),Je=new yt(Te,ve),Ct=se*Math.PI/180;Ue._rotate(Ct),it._rotate(Ct),pt._rotate(Ct),Je._rotate(Ct),xe=Math.min(Ue.x,it.x,pt.x,Je.x),Te=Math.max(Ue.x,it.x,pt.x,Je.x),fe=Math.min(Ue.y,it.y,pt.y,Je.y),ve=Math.max(Ue.y,it.y,pt.y,Je.y)}t.emplaceBack(c.x,c.y,xe,fe,Te,ve,g,D,M)}this.boxEndIndex=t.length}}class af{constructor(t=[],c=oc){if(this.data=t,this.length=this.data.length,this.compare=c,this.length>0)for(let g=(this.length>>1)-1;g>=0;g--)this._down(g)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],c=this.data.pop();return this.length--,this.length>0&&(this.data[0]=c,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:c,compare:g}=this,D=c[t];for(;t>0;){const M=t-1>>1,P=c[M];if(g(D,P)>=0)break;c[t]=P,t=M}c[t]=D}_down(t){const{data:c,compare:g}=this,D=this.length>>1,M=c[t];for(;t<D;){let P=1+(t<<1),B=c[P];const $=P+1;if($<this.length&&g(c[$],B)<0&&(P=$,B=c[$]),g(B,M)>=0)break;c[t]=B,t=P}c[t]=M}}function oc(o,t){return o<t?-1:o>t?1:0}function Pd(o,t=1,c=!1){let g=1/0,D=1/0,M=-1/0,P=-1/0;const B=o[0];for(let xe=0;xe<B.length;xe++){const Te=B[xe];(!xe||Te.x<g)&&(g=Te.x),(!xe||Te.y<D)&&(D=Te.y),(!xe||Te.x>M)&&(M=Te.x),(!xe||Te.y>P)&&(P=Te.y)}const $=Math.min(M-g,P-D);let ee=$/2;const se=new af([],ko);if(0===$)return new yt(g,D);for(let xe=g;xe<M;xe+=$)for(let Te=D;Te<P;Te+=$)se.push(new il(xe+ee,Te+ee,ee,o));let fe=function(xe){let Te=0,je=0,Ue=0;const it=xe[0];for(let pt=0,Je=it.length,Ct=Je-1;pt<Je;Ct=pt++){const At=it[pt],Xt=it[Ct],Jn=At.x*Xt.y-Xt.x*At.y;je+=(At.x+Xt.x)*Jn,Ue+=(At.y+Xt.y)*Jn,Te+=3*Jn}return new il(je/Te,Ue/Te,0,xe)}(o),ve=se.length;for(;se.length;){const xe=se.pop();(xe.d>fe.d||!fe.d)&&(fe=xe,c&&console.log("found best %d after %d probes",Math.round(1e4*xe.d)/1e4,ve)),xe.max-fe.d<=t||(ee=xe.h/2,se.push(new il(xe.p.x-ee,xe.p.y-ee,ee,o)),se.push(new il(xe.p.x+ee,xe.p.y-ee,ee,o)),se.push(new il(xe.p.x-ee,xe.p.y+ee,ee,o)),se.push(new il(xe.p.x+ee,xe.p.y+ee,ee,o)),ve+=4)}return c&&(console.log(`num probes: ${ve}`),console.log(`best distance: ${fe.d}`)),fe.p}function ko(o,t){return t.max-o.max}function il(o,t,c,g){this.p=new yt(o,t),this.h=c,this.d=function(D,M){let P=!1,B=1/0;for(let $=0;$<M.length;$++){const ee=M[$];for(let se=0,fe=ee.length,ve=fe-1;se<fe;ve=se++){const xe=ee[se],Te=ee[ve];xe.y>D.y!=Te.y>D.y&&D.x<(Te.x-xe.x)*(D.y-xe.y)/(Te.y-xe.y)+xe.x&&(P=!P),B=Math.min(B,Yc(D,xe,Te))}}return(P?1:-1)*Math.sqrt(B)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}const zl=Number.POSITIVE_INFINITY;function Ju(o,t){return t[1]!==zl?function(c,g,D){let M=0,P=0;switch(g=Math.abs(g),D=Math.abs(D),c){case"top-right":case"top-left":case"top":P=D-7;break;case"bottom-right":case"bottom-left":case"bottom":P=7-D}switch(c){case"top-right":case"bottom-right":case"right":M=-g;break;case"top-left":case"bottom-left":case"left":M=g}return[M,P]}(o,t[0],t[1]):function(c,g){let D=0,M=0;g<0&&(g=0);const P=g/Math.sqrt(2);switch(c){case"top-right":case"top-left":M=P-7;break;case"bottom-right":case"bottom-left":M=7-P;break;case"bottom":M=7-g;break;case"top":M=g-7}switch(c){case"top-right":case"bottom-right":D=-P;break;case"top-left":case"bottom-left":D=P;break;case"left":D=g;break;case"right":D=-g}return[D,M]}(o,t[0])}function sc(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function lf(o,t,c,g,D,M,P,B,$,ee,se){let fe=M.textMaxSize.evaluate(t,{});void 0===fe&&(fe=P);const ve=o.layers[0].layout,xe=ve.get("icon-offset").evaluate(t,{},se),Te=dh(c.horizontal),je=P/24,Ue=o.tilePixelRatio*je,it=o.tilePixelRatio*fe/24,pt=o.tilePixelRatio*B,Je=o.tilePixelRatio*ve.get("symbol-spacing"),Ct=ve.get("text-padding")*o.tilePixelRatio,At=function(_n,xi,_i,Dr=1){const so=_n.get("icon-padding").evaluate(xi,{},_i),Fo=so&&so.values;return[Fo[0]*Dr,Fo[1]*Dr,Fo[2]*Dr,Fo[3]*Dr]}(ve,t,se,o.tilePixelRatio),Xt=ve.get("text-max-angle")/180*Math.PI,Jn="viewport"!==ve.get("text-rotation-alignment")&&"point"!==ve.get("symbol-placement"),ei="map"===ve.get("icon-rotation-alignment")&&"point"!==ve.get("symbol-placement"),$n=ve.get("symbol-placement"),kn=Je/2,In=ve.get("icon-text-fit");let Zn;g&&"none"!==In&&(o.allowVerticalPlacement&&c.vertical&&(Zn=tf(g,c.vertical,In,ve.get("icon-text-fit-padding"),xe,je)),Te&&(g=tf(g,Te,In,ve.get("icon-text-fit-padding"),xe,je)));const Un=(_n,xi)=>{xi.x<0||xi.x>=oo||xi.y<0||xi.y>=oo||function(_i,Dr,so,Fo,ss,rl,Cs,Qo,Es,Lo,Ns,Ks,as,Us,js,ol,Hs,Da,Wo,ca,fr,sl,Xs,Ca,lc){const al=_i.addToLineVertexArray(Dr,so);let Ic,Oc,wl,Vl,Rs=0,Pc=0,ed=0,uf=0,Bf=-1,df=-1;const su={};let yp=No(""),vp=0,hf=0;if(void 0===Qo._unevaluatedLayout.getValue("text-radial-offset")?[vp,hf]=Qo.layout.get("text-offset").evaluate(fr,{},Ca).map(Wa=>Wa*Xo):(vp=Qo.layout.get("text-radial-offset").evaluate(fr,{},Ca)*Xo,hf=zl),_i.allowVerticalPlacement&&Fo.vertical){const Wa=Qo.layout.get("text-rotate").evaluate(fr,{},Ca)+90;wl=new wa(Es,Dr,Lo,Ns,Ks,Fo.vertical,as,Us,js,Wa),Cs&&(Vl=new wa(Es,Dr,Lo,Ns,Ks,Cs,Hs,Da,js,Wa))}if(ss){const Wa=Qo.layout.get("icon-rotate").evaluate(fr,{}),Ou="none"!==Qo.layout.get("icon-text-fit"),Rd=iu(ss,Wa,Xs,Ou),au=Cs?iu(Cs,Wa,Xs,Ou):void 0;Oc=new wa(Es,Dr,Lo,Ns,Ks,ss,Hs,Da,!1,Wa),Rs=4*Rd.length;const ff=_i.iconSizeData;let Pu=null;"source"===ff.kind?(Pu=[Mc*Qo.layout.get("icon-size").evaluate(fr,{})],Pu[0]>nu&&Et(`${_i.layerIds[0]}: Value for "icon-size" is >= ${Sc}. Reduce your "icon-size".`)):"composite"===ff.kind&&(Pu=[Mc*sl.compositeIconSizes[0].evaluate(fr,{},Ca),Mc*sl.compositeIconSizes[1].evaluate(fr,{},Ca)],(Pu[0]>nu||Pu[1]>nu)&&Et(`${_i.layerIds[0]}: Value for "icon-size" is >= ${Sc}. Reduce your "icon-size".`)),_i.addSymbols(_i.icon,Rd,Pu,ca,Wo,fr,x.WritingMode.none,Dr,al.lineStartIndex,al.lineLength,-1,Ca),Bf=_i.icon.placedSymbolArray.length-1,au&&(Pc=4*au.length,_i.addSymbols(_i.icon,au,Pu,ca,Wo,fr,x.WritingMode.vertical,Dr,al.lineStartIndex,al.lineLength,-1,Ca),df=_i.icon.placedSymbolArray.length-1)}const jp=Object.keys(Fo.horizontal);for(const Wa of jp){const Ou=Fo.horizontal[Wa];if(!Ic){yp=No(Ou.text);const au=Qo.layout.get("text-rotate").evaluate(fr,{},Ca);Ic=new wa(Es,Dr,Lo,Ns,Ks,Ou,as,Us,js,au)}const Rd=1===Ou.positionedLines.length;if(ed+=Ff(_i,Dr,Ou,rl,Qo,js,fr,ol,al,Fo.vertical?x.WritingMode.horizontal:x.WritingMode.horizontalOnly,Rd?jp:[Wa],su,Bf,sl,Ca),Rd)break}Fo.vertical&&(uf+=Ff(_i,Dr,Fo.vertical,rl,Qo,js,fr,ol,al,x.WritingMode.vertical,["vertical"],su,df,sl,Ca));const gh=Ic?Ic.boxStartIndex:_i.collisionBoxArray.length,mh=Ic?Ic.boxEndIndex:_i.collisionBoxArray.length,Hp=wl?wl.boxStartIndex:_i.collisionBoxArray.length,$p=wl?wl.boxEndIndex:_i.collisionBoxArray.length,Gp=Oc?Oc.boxStartIndex:_i.collisionBoxArray.length,Wp=Oc?Oc.boxEndIndex:_i.collisionBoxArray.length,yg=Vl?Vl.boxStartIndex:_i.collisionBoxArray.length,Zp=Vl?Vl.boxEndIndex:_i.collisionBoxArray.length;let Nc=-1;const Nd=(Wa,Ou)=>Wa&&Wa.circleDiameter?Math.max(Wa.circleDiameter,Ou):Ou;Nc=Nd(Ic,Nc),Nc=Nd(wl,Nc),Nc=Nd(Oc,Nc),Nc=Nd(Vl,Nc);const _h=Nc>-1?1:0;_h&&(Nc*=lc/Xo),_i.glyphOffsetArray.length>=Ad.MAX_GLYPHS&&Et("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==fr.sortKey&&_i.addToSortKeyRanges(_i.symbolInstances.length,fr.sortKey),_i.symbolInstances.emplaceBack(Dr.x,Dr.y,su.right>=0?su.right:-1,su.center>=0?su.center:-1,su.left>=0?su.left:-1,su.vertical||-1,Bf,df,yp,gh,mh,Hp,$p,Gp,Wp,yg,Zp,Lo,ed,uf,Rs,Pc,_h,0,as,vp,hf,Nc)}(o,xi,_n,c,g,D,Zn,o.layers[0],o.collisionBoxArray,t.index,t.sourceLayerIndex,o.index,Ue,[Ct,Ct,Ct,Ct],Jn,$,pt,At,ei,xe,t,M,ee,se,P)};if("line"===$n)for(const _n of Or(t.geometry,0,0,oo,oo)){const xi=rc(_n,Je,Xt,c.vertical||Te,g,24,it,o.overscaling,oo);for(const _i of xi)Te&&_p(o,Te.text,kn,_i)||Un(_n,_i)}else if("line-center"===$n){for(const _n of t.geometry)if(_n.length>1){const xi=Vs(_n,Xt,c.vertical||Te,g,24,it);xi&&Un(_n,xi)}}else if("Polygon"===t.type)for(const _n of md(t.geometry,0)){const xi=Pd(_n,16);Un(_n[0],new Qi(xi.x,xi.y,0))}else if("LineString"===t.type)for(const _n of t.geometry)Un(_n,new Qi(_n[0].x,_n[0].y,0));else if("Point"===t.type)for(const _n of t.geometry)for(const xi of _n)Un([xi],new Qi(xi.x,xi.y,0))}function Ff(o,t,c,g,D,M,P,B,$,ee,se,fe,ve,xe,Te){const je=function(pt,Je,Ct,At,Xt,Jn,ei,$n){const kn=At.layout.get("text-rotate").evaluate(Jn,{})*Math.PI/180,In=[];for(const Zn of Je.positionedLines)for(const Un of Zn.positionedGlyphs){if(!Un.rect)continue;const _n=Un.rect||{};let xi=$a+1,_i=!0,Dr=1,so=0;const Fo=(Xt||$n)&&Un.vertical,ss=Un.metrics.advance*Un.scale/2;if($n&&Je.verticalizable&&(so=Zn.lineOffset/2-(Un.imageName?-(Xo-Un.metrics.width*Un.scale)/2:(Un.scale-1)*Xo)),Un.imageName){const Wo=ei[Un.imageName];_i=Wo.sdf,Dr=Wo.pixelRatio,xi=ba/Dr}const rl=Xt?[Un.x+ss,Un.y]:[0,0];let Cs=Xt?[0,0]:[Un.x+ss+Ct[0],Un.y+Ct[1]-so],Qo=[0,0];Fo&&(Qo=Cs,Cs=[0,0]);const Es=(Un.metrics.left-xi)*Un.scale-ss+Cs[0],Lo=(-Un.metrics.top-xi)*Un.scale+Cs[1],Ns=Es+_n.w*Un.scale/Dr,Ks=Lo+_n.h*Un.scale/Dr,as=new yt(Es,Lo),Us=new yt(Ns,Lo),js=new yt(Es,Ks),ol=new yt(Ns,Ks);if(Fo){const Wo=new yt(-ss,ss-oh),ca=-Math.PI/2,fr=Xo/2-ss,sl=new yt(5-oh-fr,-(Un.imageName?fr:0)),Xs=new yt(...Qo);as._rotateAround(ca,Wo)._add(sl)._add(Xs),Us._rotateAround(ca,Wo)._add(sl)._add(Xs),js._rotateAround(ca,Wo)._add(sl)._add(Xs),ol._rotateAround(ca,Wo)._add(sl)._add(Xs)}if(kn){const Wo=Math.sin(kn),ca=Math.cos(kn),fr=[ca,-Wo,Wo,ca];as._matMult(fr),Us._matMult(fr),js._matMult(fr),ol._matMult(fr)}const Hs=new yt(0,0),Da=new yt(0,0);In.push({tl:as,tr:Us,bl:js,br:ol,tex:_n,writingMode:Je.writingMode,glyphOffset:rl,sectionIndex:Un.sectionIndex,isSDF:_i,pixelOffsetTL:Hs,pixelOffsetBR:Da,minFontScaleX:0,minFontScaleY:0})}return In}(0,c,B,D,M,P,g,o.allowVerticalPlacement),Ue=o.textSizeData;let it=null;"source"===Ue.kind?(it=[Mc*D.layout.get("text-size").evaluate(P,{})],it[0]>nu&&Et(`${o.layerIds[0]}: Value for "text-size" is >= ${Sc}. Reduce your "text-size".`)):"composite"===Ue.kind&&(it=[Mc*xe.compositeTextSizes[0].evaluate(P,{},Te),Mc*xe.compositeTextSizes[1].evaluate(P,{},Te)],(it[0]>nu||it[1]>nu)&&Et(`${o.layerIds[0]}: Value for "text-size" is >= ${Sc}. Reduce your "text-size".`)),o.addSymbols(o.text,je,it,B,M,P,ee,t,$.lineStartIndex,$.lineLength,ve,Te);for(const pt of se)fe[pt]=o.text.placedSymbolArray.length-1;return 4*je.length}function dh(o){for(const t in o)return o[t];return null}function _p(o,t,c,g){const D=o.compareText;if(t in D){const M=D[t];for(let P=M.length-1;P>=0;P--)if(g.dist(M[P])<c)return!0}else D[t]=[];return D[t].push(g),!1}const hh=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Lf{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[c,g]=new Uint8Array(t,0,2);if(219!==c)throw new Error("Data does not appear to be in a KDBush format.");const D=g>>4;if(1!==D)throw new Error(`Got v${D} data when expected v1.`);const M=hh[15&g];if(!M)throw new Error("Unrecognized array type.");const[P]=new Uint16Array(t,2,1),[B]=new Uint32Array(t,4,1);return new Lf(B,P,M,t)}constructor(t,c=64,g=Float64Array,D){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+c,2),65535),this.ArrayType=g,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const M=hh.indexOf(this.ArrayType),P=2*t*this.ArrayType.BYTES_PER_ELEMENT,B=t*this.IndexArrayType.BYTES_PER_ELEMENT,$=(8-B%8)%8;if(M<0)throw new Error(`Unexpected typed array class: ${g}.`);D&&D instanceof ArrayBuffer?(this.data=D,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+B+$,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+P+B+$),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+B+$,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+M]),new Uint16Array(this.data,2,1)[0]=c,new Uint32Array(this.data,4,1)[0]=t)}add(t,c){const g=this._pos>>1;return this.ids[g]=g,this.coords[this._pos++]=t,this.coords[this._pos++]=c,g}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return cf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,c,g,D){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:M,coords:P,nodeSize:B}=this,$=[0,M.length-1,0],ee=[];for(;$.length;){const se=$.pop()||0,fe=$.pop()||0,ve=$.pop()||0;if(fe-ve<=B){for(let Ue=ve;Ue<=fe;Ue++){const it=P[2*Ue],pt=P[2*Ue+1];it>=t&&it<=g&&pt>=c&&pt<=D&&ee.push(M[Ue])}continue}const xe=ve+fe>>1,Te=P[2*xe],je=P[2*xe+1];Te>=t&&Te<=g&&je>=c&&je<=D&&ee.push(M[xe]),(0===se?t<=Te:c<=je)&&($.push(ve),$.push(xe-1),$.push(1-se)),(0===se?g>=Te:D>=je)&&($.push(xe+1),$.push(fe),$.push(1-se))}return ee}within(t,c,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:D,coords:M,nodeSize:P}=this,B=[0,D.length-1,0],$=[],ee=g*g;for(;B.length;){const se=B.pop()||0,fe=B.pop()||0,ve=B.pop()||0;if(fe-ve<=P){for(let Ue=ve;Ue<=fe;Ue++)Ac(M[2*Ue],M[2*Ue+1],t,c)<=ee&&$.push(D[Ue]);continue}const xe=ve+fe>>1,Te=M[2*xe],je=M[2*xe+1];Ac(Te,je,t,c)<=ee&&$.push(D[xe]),(0===se?t-g<=Te:c-g<=je)&&(B.push(ve),B.push(xe-1),B.push(1-se)),(0===se?t+g>=Te:c+g>=je)&&(B.push(xe+1),B.push(fe),B.push(1-se))}return $}}function cf(o,t,c,g,D,M){if(D-g<=c)return;const P=g+D>>1;Mu(o,t,P,g,D,M),cf(o,t,c,g,P-1,1-M),cf(o,t,c,P+1,D,1-M)}function Mu(o,t,c,g,D,M){for(;D>g;){if(D-g>600){const ee=D-g+1,se=c-g+1,fe=Math.log(ee),ve=.5*Math.exp(2*fe/3),xe=.5*Math.sqrt(fe*ve*(ee-ve)/ee)*(se-ee/2<0?-1:1);Mu(o,t,c,Math.max(g,Math.floor(c-se*ve/ee+xe)),Math.min(D,Math.floor(c+(ee-se)*ve/ee+xe)),M)}const P=t[2*c+M];let B=g,$=D;for(wr(o,t,g,c),t[2*D+M]>P&&wr(o,t,g,D);B<$;){for(wr(o,t,B,$),B++,$--;t[2*B+M]<P;)B++;for(;t[2*$+M]>P;)$--}t[2*g+M]===P?wr(o,t,g,$):($++,wr(o,t,$,D)),$<=c&&(g=$+1),c<=$&&(D=$-1)}}function wr(o,t,c,g){Au(o,c,g),Au(t,2*c,2*g),Au(t,2*c+1,2*g+1)}function Au(o,t,c){const g=o[t];o[t]=o[c],o[c]=g}function Ac(o,t,c,g){const D=o-c,M=t-g;return D*D+M*M}var ac;x.PerformanceMarkers=void 0,(ac=x.PerformanceMarkers||(x.PerformanceMarkers={})).create="create",ac.load="load",ac.fullLoad="fullLoad";let ru=null,ou=[];const fh=1e3/60,Qu="loadTime",Iu="fullLoadTime",ph={mark(o){performance.mark(o)},frame(o){const t=o;null!=ru&&ou.push(t-ru),ru=t},clearMetrics(){ru=null,ou=[],performance.clearMeasures(Qu),performance.clearMeasures(Iu);for(const o in x.PerformanceMarkers)performance.clearMarks(x.PerformanceMarkers[o])},getPerformanceMetrics(){performance.measure(Qu,x.PerformanceMarkers.create,x.PerformanceMarkers.load),performance.measure(Iu,x.PerformanceMarkers.create,x.PerformanceMarkers.fullLoad);const o=performance.getEntriesByName(Qu)[0].duration,t=performance.getEntriesByName(Iu)[0].duration,c=ou.length,g=1/(ou.reduce((M,P)=>M+P,0)/c/1e3),D=ou.filter(M=>M>fh).reduce((M,P)=>M+(P-fh)/fh,0);return{loadTime:o,fullLoadTime:t,fps:g,percentDroppedFrames:D/(c+D)*100,totalFrames:c}}};x.AJAXError=bi,x.ARRAY_TYPE=ld,x.Actor=class{constructor(o,t,c){this.target=o,this.parent=t,this.mapId=c,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},yi(["receive","process"],this),this.invoker=new kf(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=zt()?o:window}send(o,t,c,g,D=!1){const M=Math.round(1e18*Math.random()).toString(36).substring(0,10);c&&(this.callbacks[M]=c);const P=xt(this.globalScope)?void 0:[];return this.target.postMessage({id:M,type:o,hasCallback:!!c,targetMapId:g,mustQueue:D,sourceMapId:this.mapId,data:_s(t,P)},P),{cancel:()=>{c&&delete this.callbacks[M],this.target.postMessage({id:M,type:"<cancel>",targetMapId:g,sourceMapId:this.mapId})}}}receive(o){const t=o.data,c=t.id;if(c&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){delete this.tasks[c];const g=this.cancelCallbacks[c];delete this.cancelCallbacks[c],g&&g()}else zt()||t.mustQueue?(this.tasks[c]=t,this.taskQueue.push(c),this.invoker.trigger()):this.processTask(c,t)}process(){if(!this.taskQueue.length)return;const o=this.taskQueue.shift(),t=this.tasks[o];delete this.tasks[o],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(o,t)}processTask(o,t){if("<response>"===t.type){const c=this.callbacks[o];delete this.callbacks[o],c&&(t.error?c(La(t.error)):c(null,La(t.data)))}else{let c=!1;const g=xt(this.globalScope)?void 0:[],D=t.hasCallback?(B,$)=>{c=!0,delete this.cancelCallbacks[o],this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:B?_s(B):null,data:_s($,g)},g)}:B=>{c=!0};let M=null;const P=La(t.data);if(this.parent[t.type])M=this.parent[t.type](t.sourceMapId,P,D);else if(this.parent.getWorkerSource){const B=t.type.split(".");M=this.parent.getWorkerSource(t.sourceMapId,B[0],P.source)[B[1]](P,D)}else D(new Error(`Could not find function ${t.type}`));!c&&M&&M.cancel&&(this.cancelCallbacks[o]=M.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},x.AlphaImage=Xc,x.CanonicalTileID=Rt,x.CollisionBoxArray=C,x.CollisionCircleLayoutArray=class extends ml{},x.Color=Wt,x.DEMData=Tr,x.DataConstantProperty=li,x.DictionaryCoder=Oi,x.EXTENT=oo,x.ErrorEvent=di,x.EvaluationParameters=Xi,x.Event=zi,x.Evented=Si,x.FeatureIndex=xr,x.FillBucket=Nh,x.FillExtrusionBucket=_d,x.GeoJSONFeature=Ji,x.ImageAtlas=Af,x.ImagePosition=ic,x.KDBush=Lf,x.LineBucket=Uh,x.LineStripIndexArray=class extends n{},x.LngLat=A,x.MercatorCoordinate=ot,x.ONE_EM=Xo,x.OverscaledTileID=pn,x.PerformanceUtils=ph,x.Point=yt,x.Pos3dArray=class extends jc{},x.PosArray=ze,x.Properties=Fr,x.Protobuf=Yu,x.QuadTriangleArray=class extends _a{},x.RGBAImage=Qa,x.RasterBoundsArray=class extends Hc{},x.RequestPerformance=class{constructor(o){this._marks={start:[o.url,"start"].join("#"),end:[o.url,"end"].join("#"),measure:o.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let o=performance.getEntriesByName(this._marks.measure);return 0===o.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),o=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),o}},x.SegmentVector=Dn,x.SymbolBucket=Ad,x.Transitionable=Ru,x.TriangleIndexArray=vt,x.Uniform1f=Xa,x.Uniform1i=class extends ci{constructor(o,t){super(o,t),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},x.Uniform2f=class extends ci{constructor(o,t){super(o,t),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},x.Uniform3f=class extends ci{constructor(o,t){super(o,t),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},x.Uniform4f=yl,x.UniformColor=vo,x.UniformMatrix4f=class extends ci{constructor(o,t){super(o,t),this.current=qo}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let t=1;t<16;t++)if(o[t]!==this.current[t]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},x.UnwrappedTileID=zn,x.ValidationError=at,x.ZoomHistory=rs,x.addDynamicAttributes=Xu,x.arrayBufferToImage=function(o,t){const c=new Image;c.onload=()=>{t(null,c),URL.revokeObjectURL(c.src),c.onload=null,window.requestAnimationFrame(()=>{c.src=en})},c.onerror=()=>t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const g=new Blob([new Uint8Array(o)],{type:"image/png"});c.src=o.byteLength?URL.createObjectURL(g):en},x.arrayBufferToImageBitmap=function(o,t){const c=new Blob([new Uint8Array(o)],{type:"image/png"});createImageBitmap(c).then(g=>{t(null,g)}).catch(g=>{t(new Error(`Could not load image because of ${g.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},x.asyncAll=function(o,t,c){if(!o.length)return c(null,[]);let g=o.length;const D=new Array(o.length);let M=null;o.forEach((P,B)=>{t(P,($,ee)=>{$&&(M=$),D[B]=ee,0==--g&&c(M,D)})})},x.bezier=bt,x.bindAll=yi,x.clamp=dt,x.clipLine=Or,x.clone=function(o){var t=new ld(16);return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],t},x.clone$1=Tt,x.collisionCircleLayout=$h,x.config=Mi,x.copy=function(o,t){return o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[4]=t[4],o[5]=t[5],o[6]=t[6],o[7]=t[7],o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},x.create=function(){var o=new ld(16);return ld!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},x.createExpression=Yr,x.createFilter=J,x.createLayout=yo,x.createStyleLayer=function(o){return"custom"===o.type?new uh(o):new Rf[o.type](o)},x.deepEqual=function o(t,c){if(Array.isArray(t)){if(!Array.isArray(c)||t.length!==c.length)return!1;for(let g=0;g<t.length;g++)if(!o(t[g],c[g]))return!1;return!0}if("object"==typeof t&&null!==t&&null!==c){if("object"!=typeof c||Object.keys(t).length!==Object.keys(c).length)return!1;for(const g in t)if(!o(t[g],c[g]))return!1;return!0}return t===c},x.derefLayers=function(o){o=o.slice();const t=Object.create(null);for(let c=0;c<o.length;c++)t[o[c].id]=o[c];for(let c=0;c<o.length;c++)"ref"in o[c]&&(o[c]=er(o[c],t[o[c].ref]));return o},x.diffStyles=function(o,t){if(!o)return[{command:An.setStyle,args:[t]}];let c=[];try{if(!Mn(o.version,t.version))return[{command:An.setStyle,args:[t]}];Mn(o.center,t.center)||c.push({command:An.setCenter,args:[t.center]}),Mn(o.zoom,t.zoom)||c.push({command:An.setZoom,args:[t.zoom]}),Mn(o.bearing,t.bearing)||c.push({command:An.setBearing,args:[t.bearing]}),Mn(o.pitch,t.pitch)||c.push({command:An.setPitch,args:[t.pitch]}),Mn(o.sprite,t.sprite)||c.push({command:An.setSprite,args:[t.sprite]}),Mn(o.glyphs,t.glyphs)||c.push({command:An.setGlyphs,args:[t.glyphs]}),Mn(o.transition,t.transition)||c.push({command:An.setTransition,args:[t.transition]}),Mn(o.light,t.light)||c.push({command:An.setLight,args:[t.light]});const g={},D=[];!function(P,B,$,ee){let se;for(se in B=B||{},P=P||{})Object.prototype.hasOwnProperty.call(P,se)&&(Object.prototype.hasOwnProperty.call(B,se)||We(se,$,ee));for(se in B)Object.prototype.hasOwnProperty.call(B,se)&&(Object.prototype.hasOwnProperty.call(P,se)?Mn(P[se],B[se])||("geojson"===P[se].type&&"geojson"===B[se].type&&kt(P,B,se)?$.push({command:An.setGeoJSONSourceData,args:[se,B[se].data]}):Ot(se,B,$,ee)):mt(se,B,$))}(o.sources,t.sources,D,g);const M=[];o.layers&&o.layers.forEach(P=>{g[P.source]?c.push({command:An.removeLayer,args:[P.id]}):M.push(P)}),c=c.concat(D),function(P,B,$){B=B||[];const ee=(P=P||[]).map(Yt),se=B.map(Yt),fe=P.reduce(jn,{}),ve=B.reduce(jn,{}),xe=ee.slice(),Te=Object.create(null);let je,Ue,it,pt,Je,Ct,At;for(je=0,Ue=0;je<ee.length;je++)it=ee[je],Object.prototype.hasOwnProperty.call(ve,it)?Ue++:($.push({command:An.removeLayer,args:[it]}),xe.splice(xe.indexOf(it,Ue),1));for(je=0,Ue=0;je<se.length;je++)it=se[se.length-1-je],xe[xe.length-1-je]!==it&&(Object.prototype.hasOwnProperty.call(fe,it)?($.push({command:An.removeLayer,args:[it]}),xe.splice(xe.lastIndexOf(it,xe.length-Ue),1)):Ue++,Ct=xe[xe.length-je],$.push({command:An.addLayer,args:[ve[it],Ct]}),xe.splice(xe.length-je,0,it),Te[it]=!0);for(je=0;je<se.length;je++)if(it=se[je],pt=fe[it],Je=ve[it],!Te[it]&&!Mn(pt,Je))if(Mn(pt.source,Je.source)&&Mn(pt["source-layer"],Je["source-layer"])&&Mn(pt.type,Je.type)){for(At in gn(pt.layout,Je.layout,$,it,null,An.setLayoutProperty),gn(pt.paint,Je.paint,$,it,null,An.setPaintProperty),Mn(pt.filter,Je.filter)||$.push({command:An.setFilter,args:[it,Je.filter]}),Mn(pt.minzoom,Je.minzoom)&&Mn(pt.maxzoom,Je.maxzoom)||$.push({command:An.setLayerZoomRange,args:[it,Je.minzoom,Je.maxzoom]}),pt)Object.prototype.hasOwnProperty.call(pt,At)&&"layout"!==At&&"paint"!==At&&"filter"!==At&&"metadata"!==At&&"minzoom"!==At&&"maxzoom"!==At&&(0===At.indexOf("paint.")?gn(pt[At],Je[At],$,it,At.slice(6),An.setPaintProperty):Mn(pt[At],Je[At])||$.push({command:An.setLayerProperty,args:[it,At,Je[At]]}));for(At in Je)Object.prototype.hasOwnProperty.call(Je,At)&&!Object.prototype.hasOwnProperty.call(pt,At)&&"layout"!==At&&"paint"!==At&&"filter"!==At&&"metadata"!==At&&"minzoom"!==At&&"maxzoom"!==At&&(0===At.indexOf("paint.")?gn(pt[At],Je[At],$,it,At.slice(6),An.setPaintProperty):Mn(pt[At],Je[At])||$.push({command:An.setLayerProperty,args:[it,At,Je[At]]}))}else $.push({command:An.removeLayer,args:[it]}),Ct=xe[xe.lastIndexOf(it)+1],$.push({command:An.addLayer,args:[Je,Ct]})}(M,t.layers,c)}catch(g){console.warn("Unable to compute style diff:",g),c=[{command:An.setStyle,args:[t]}]}return c},x.dot=function(o,t){return o[0]*t[0]+o[1]*t[1]+o[2]*t[2]+o[3]*t[3]},x.earthRadius=b,x.ease=Zt,x.emitValidationErrors=Il,x.emptyStyle=function(){const o={},t=st.$version;for(const c in st.$root){const g=st.$root[c];if(g.required){let D=null;D="version"===c?t:"array"===g.type?[]:{},null!=D&&(o[c]=D)}}return o},x.equals=function(o,t){var c=o[0],g=o[1],D=o[2],M=o[3],P=o[4],B=o[5],$=o[6],ee=o[7],se=o[8],fe=o[9],ve=o[10],xe=o[11],Te=o[12],je=o[13],Ue=o[14],it=o[15],pt=t[0],Je=t[1],Ct=t[2],At=t[3],Xt=t[4],Jn=t[5],ei=t[6],$n=t[7],kn=t[8],In=t[9],Zn=t[10],Un=t[11],_n=t[12],xi=t[13],_i=t[14],Dr=t[15];return Math.abs(c-pt)<=Ua*Math.max(1,Math.abs(c),Math.abs(pt))&&Math.abs(g-Je)<=Ua*Math.max(1,Math.abs(g),Math.abs(Je))&&Math.abs(D-Ct)<=Ua*Math.max(1,Math.abs(D),Math.abs(Ct))&&Math.abs(M-At)<=Ua*Math.max(1,Math.abs(M),Math.abs(At))&&Math.abs(P-Xt)<=Ua*Math.max(1,Math.abs(P),Math.abs(Xt))&&Math.abs(B-Jn)<=Ua*Math.max(1,Math.abs(B),Math.abs(Jn))&&Math.abs($-ei)<=Ua*Math.max(1,Math.abs($),Math.abs(ei))&&Math.abs(ee-$n)<=Ua*Math.max(1,Math.abs(ee),Math.abs($n))&&Math.abs(se-kn)<=Ua*Math.max(1,Math.abs(se),Math.abs(kn))&&Math.abs(fe-In)<=Ua*Math.max(1,Math.abs(fe),Math.abs(In))&&Math.abs(ve-Zn)<=Ua*Math.max(1,Math.abs(ve),Math.abs(Zn))&&Math.abs(xe-Un)<=Ua*Math.max(1,Math.abs(xe),Math.abs(Un))&&Math.abs(Te-_n)<=Ua*Math.max(1,Math.abs(Te),Math.abs(_n))&&Math.abs(je-xi)<=Ua*Math.max(1,Math.abs(je),Math.abs(xi))&&Math.abs(Ue-_i)<=Ua*Math.max(1,Math.abs(Ue),Math.abs(_i))&&Math.abs(it-Dr)<=Ua*Math.max(1,Math.abs(it),Math.abs(Dr))},x.evaluateSizeForFeature=function(o,{uSize:t,uSizeT:c},{lowerSize:g,upperSize:D}){return"source"===o.kind?g/Mc:"composite"===o.kind?ai.number(g/Mc,D/Mc,c):t},x.evaluateSizeForZoom=function(o,t){let c=0,g=0;if("constant"===o.kind)g=o.layoutSize;else if("source"!==o.kind){const{interpolationType:D,minZoom:M,maxZoom:P}=o,B=D?dt(Fi.interpolationFactor(D,t,M,P),0,1):0;"camera"===o.kind?g=ai.number(o.minSize,o.maxSize,B):c=B}return{uSizeT:c,uSize:g}},x.evaluateVariableOffset=Ju,x.evented=oa,x.exported=Pn,x.extend=Tn,x.filterObject=Vt,x.findLineIntersection=function(o,t,c,g){const D=t.y-o.y,M=t.x-o.x,P=g.y-c.y,B=g.x-c.x,$=P*M-B*D;if(0===$)return null;const ee=(B*(o.y-c.y)-P*(o.x-c.x))/$;return new yt(o.x+ee*M,o.y+ee*D)},x.fromScaling=function(o,t){return o[0]=t[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=t[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=t[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},x.getAnchorAlignment=Sd,x.getAnchorJustification=sc,x.getArrayBuffer=hn,x.getDefaultExportFromCjs=tt,x.getJSON=function(o,t){return Nt(Tn(o,{type:"json"}),t)},x.getOverlapMode=If,x.getProtocolAction=ht,x.getRTLTextPluginStatus=Co,x.getReferrer=ft,x.getVideo=function(o,t){const c=window.document.createElement("video");c.muted=!0,c.onloadstart=function(){t(null,c)};for(let g=0;g<o.length;g++){const D=window.document.createElement("source");ln(o[g])||(c.crossOrigin="Anonymous"),D.src=o[g],c.appendChild(D)}return{cancel:()=>{}}},x.groupByLayout=function(o,t){const c={};for(let D=0;D<o.length;D++){const M=t&&t[o[D].id]||Tl(o[D]);t&&(t[o[D].id]=M);let P=c[M];P||(P=c[M]=[]),P.push(o[D])}const g=[];for(const D in c)g.push(c[D]);return g},x.identity=vf,x.interpolate=ai,x.invert=function(o,t){var c=t[0],g=t[1],D=t[2],M=t[3],P=t[4],B=t[5],$=t[6],ee=t[7],se=t[8],fe=t[9],ve=t[10],xe=t[11],Te=t[12],je=t[13],Ue=t[14],it=t[15],pt=c*B-g*P,Je=c*$-D*P,Ct=c*ee-M*P,At=g*$-D*B,Xt=g*ee-M*B,Jn=D*ee-M*$,ei=se*je-fe*Te,$n=se*Ue-ve*Te,kn=se*it-xe*Te,In=fe*Ue-ve*je,Zn=fe*it-xe*je,Un=ve*it-xe*Ue,_n=pt*Un-Je*Zn+Ct*In+At*kn-Xt*$n+Jn*ei;return _n?(o[0]=(B*Un-$*Zn+ee*In)*(_n=1/_n),o[1]=(D*Zn-g*Un-M*In)*_n,o[2]=(je*Jn-Ue*Xt+it*At)*_n,o[3]=(ve*Xt-fe*Jn-xe*At)*_n,o[4]=($*kn-P*Un-ee*$n)*_n,o[5]=(c*Un-D*kn+M*$n)*_n,o[6]=(Ue*Ct-Te*Jn-it*Je)*_n,o[7]=(se*Jn-ve*Ct+xe*Je)*_n,o[8]=(P*Zn-B*kn+ee*ei)*_n,o[9]=(g*kn-c*Zn-M*ei)*_n,o[10]=(Te*Xt-je*Ct+it*pt)*_n,o[11]=(fe*Ct-se*Xt-xe*pt)*_n,o[12]=(B*$n-P*In-$*ei)*_n,o[13]=(c*In-g*$n+D*ei)*_n,o[14]=(je*Je-Te*At-Ue*pt)*_n,o[15]=(se*At-fe*Je+ve*pt)*_n,o):null},x.isImageBitmap=bn,x.isSafari=xt,x.isWorker=zt,x.keysDifference=function(o,t){const c=[];for(const g in o)g in t||c.push(g);return c},x.lazyLoadRTLTextPlugin=function(){Nn.isLoading()||Nn.isLoaded()||"deferred"!==Co()||kr()},x.makeRequest=Nt,x.mapObject=vi,x.mercatorXfromLng=U,x.mercatorYfromLat=te,x.mercatorZfromAltitude=Fe,x.mul=gg,x.mul$1=function(o,t,c){return o[0]=t[0]*c[0],o[1]=t[1]*c[1],o[2]=t[2]*c[2],o[3]=t[3]*c[3],o},x.multiply=Kc,x.nextPowerOfTwo=function(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))},x.operations=An,x.ortho=function(o,t,c,g,D,M,P){var B=1/(t-c),$=1/(g-D),ee=1/(M-P);return o[0]=-2*B,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*$,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*ee,o[11]=0,o[12]=(t+c)*B,o[13]=(D+g)*$,o[14]=(P+M)*ee,o[15]=1,o},x.parseCacheControl=function(o){const t={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(c,g,D,M)=>{const P=D||M;return t[g]=!P||P.toLowerCase(),""}),t["max-age"]){const c=parseInt(t["max-age"],10);isNaN(c)?delete t["max-age"]:t["max-age"]=c}return t},x.parseGlyphPbf=function(o){return new Yu(o).readFields(fp,[])},x.pbf=dp,x.performSymbolLayout=function(o){o.bucket.createArrays(),o.bucket.tilePixelRatio=oo/(512*o.bucket.overscaling),o.bucket.compareText={},o.bucket.iconsNeedLinear=!1;const t=o.bucket.layers[0].layout,c=o.bucket.layers[0]._unevaluatedLayout._values,g={layoutIconSize:c["icon-size"].possiblyEvaluate(new Xi(o.bucket.zoom+1),o.canonical),layoutTextSize:c["text-size"].possiblyEvaluate(new Xi(o.bucket.zoom+1),o.canonical),textMaxSize:c["text-size"].possiblyEvaluate(new Xi(18))};if("composite"===o.bucket.textSizeData.kind){const{minZoom:$,maxZoom:ee}=o.bucket.textSizeData;g.compositeTextSizes=[c["text-size"].possiblyEvaluate(new Xi($),o.canonical),c["text-size"].possiblyEvaluate(new Xi(ee),o.canonical)]}if("composite"===o.bucket.iconSizeData.kind){const{minZoom:$,maxZoom:ee}=o.bucket.iconSizeData;g.compositeIconSizes=[c["icon-size"].possiblyEvaluate(new Xi($),o.canonical),c["icon-size"].possiblyEvaluate(new Xi(ee),o.canonical)]}const D=t.get("text-line-height")*Xo,M="viewport"!==t.get("text-rotation-alignment")&&"point"!==t.get("symbol-placement"),P=t.get("text-keep-upright"),B=t.get("text-size");for(const $ of o.bucket.features){const ee=t.get("text-font").evaluate($,{},o.canonical).join(","),se=B.evaluate($,{},o.canonical),fe=g.layoutTextSize.evaluate($,{},o.canonical),ve=g.layoutIconSize.evaluate($,{},o.canonical),xe={horizontal:{},vertical:void 0},Te=$.text;let je,Ue=[0,0];if(Te){const Je=Te.toString(),Ct=t.get("text-letter-spacing").evaluate($,{},o.canonical)*Xo,At=K(Je)?Ct:0,Xt=t.get("text-anchor").evaluate($,{},o.canonical),Jn=t.get("text-variable-anchor");if(!Jn){const Zn=t.get("text-radial-offset").evaluate($,{},o.canonical);Ue=Zn?Ju(Xt,[Zn*Xo,zl]):t.get("text-offset").evaluate($,{},o.canonical).map(Un=>Un*Xo)}let ei=M?"center":t.get("text-justify").evaluate($,{},o.canonical);const $n=t.get("symbol-placement"),kn="point"===$n?t.get("text-max-width").evaluate($,{},o.canonical)*Xo:0,In=()=>{o.bucket.allowVerticalPlacement&&de(Je)&&(xe.vertical=ef(Te,o.glyphMap,o.glyphPositions,o.imagePositions,ee,kn,D,Xt,"left",At,Ue,x.WritingMode.vertical,!0,$n,fe,se))};if(!M&&Jn){const Zn="auto"===ei?Jn.map(_n=>sc(_n)):[ei];let Un=!1;for(let _n=0;_n<Zn.length;_n++){const xi=Zn[_n];if(!xe.horizontal[xi])if(Un)xe.horizontal[xi]=xe.horizontal[0];else{const _i=ef(Te,o.glyphMap,o.glyphPositions,o.imagePositions,ee,kn,D,"center",xi,At,Ue,x.WritingMode.horizontal,!1,$n,fe,se);_i&&(xe.horizontal[xi]=_i,Un=1===_i.positionedLines.length)}}In()}else{"auto"===ei&&(ei=sc(Xt));const Zn=ef(Te,o.glyphMap,o.glyphPositions,o.imagePositions,ee,kn,D,Xt,ei,At,Ue,x.WritingMode.horizontal,!1,$n,fe,se);Zn&&(xe.horizontal[ei]=Zn),In(),de(Je)&&M&&P&&(xe.vertical=ef(Te,o.glyphMap,o.glyphPositions,o.imagePositions,ee,kn,D,Xt,ei,At,Ue,x.WritingMode.vertical,!1,$n,fe,se))}}let it=!1;if($.icon&&$.icon.name){const Je=o.imageMap[$.icon.name];Je&&(je=Md(o.imagePositions[$.icon.name],t.get("icon-offset").evaluate($,{},o.canonical),t.get("icon-anchor").evaluate($,{},o.canonical)),it=!!Je.sdf,void 0===o.bucket.sdfIcons?o.bucket.sdfIcons=it:o.bucket.sdfIcons!==it&&Et("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Je.pixelRatio!==o.bucket.pixelRatio||0!==t.get("icon-rotate").constantOr(1))&&(o.bucket.iconsNeedLinear=!0))}const pt=dh(xe.horizontal)||xe.vertical;o.bucket.iconsInText=!!pt&&pt.iconsInText,(pt||je)&&lf(o.bucket,$,xe,je,o.imageMap,g,fe,ve,Ue,it,o.canonical)}o.showCollisionBoxes&&o.bucket.generateCollisionDebugBuffers()},x.perspective=function(o,t,c,g,D){var M,P=1/Math.tan(t/2);return o[0]=P/c,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=P,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,null!=D&&D!==1/0?(o[10]=(D+g)*(M=1/(g-D)),o[14]=2*D*g*M):(o[10]=-1,o[14]=-2*g),o},x.pick=function(o,t){const c={};for(let g=0;g<t.length;g++){const D=t[g];D in o&&(c[D]=o[D])}return c},x.plugin=Nn,x.pointGeometry=Pe,x.polygonIntersectsPolygon=kl,x.potpack=rh,x.register=Xn,x.registerForPluginStateChange=function(o){return o({pluginStatus:Ii,pluginURL:Vr}),oa.on("pluginStateChange",o),o},x.renderColorRamp=Ah,x.rotateX=function(o,t,c){var g=Math.sin(c),D=Math.cos(c),M=t[4],P=t[5],B=t[6],$=t[7],ee=t[8],se=t[9],fe=t[10],ve=t[11];return t!==o&&(o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=t[3],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[4]=M*D+ee*g,o[5]=P*D+se*g,o[6]=B*D+fe*g,o[7]=$*D+ve*g,o[8]=ee*D-M*g,o[9]=se*D-P*g,o[10]=fe*D-B*g,o[11]=ve*D-$*g,o},x.rotateZ=function(o,t,c){var g=Math.sin(c),D=Math.cos(c),M=t[0],P=t[1],B=t[2],$=t[3],ee=t[4],se=t[5],fe=t[6],ve=t[7];return t!==o&&(o[8]=t[8],o[9]=t[9],o[10]=t[10],o[11]=t[11],o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15]),o[0]=M*D+ee*g,o[1]=P*D+se*g,o[2]=B*D+fe*g,o[3]=$*D+ve*g,o[4]=ee*D-M*g,o[5]=se*D-P*g,o[6]=fe*D-B*g,o[7]=ve*D-$*g,o},x.sameOrigin=ln,x.scale=function(o,t,c){var g=c[0],D=c[1],M=c[2];return o[0]=t[0]*g,o[1]=t[1]*g,o[2]=t[2]*g,o[3]=t[3]*g,o[4]=t[4]*D,o[5]=t[5]*D,o[6]=t[6]*D,o[7]=t[7]*D,o[8]=t[8]*M,o[9]=t[9]*M,o[10]=t[10]*M,o[11]=t[11]*M,o[12]=t[12],o[13]=t[13],o[14]=t[14],o[15]=t[15],o},x.setRTLTextPlugin=function(o,t,c=!1){if(Ii===Ri||Ii===lr||Ii===Yi)throw new Error("setRTLTextPlugin cannot be called multiple times.");Vr=Pn.resolveURL(o),Ii=Ri,Wr=t,Ps(),c||kr()},x.sphericalToCartesian=function([o,t,c]){return t+=90,t*=Math.PI/180,c*=Math.PI/180,{x:o*Math.cos(t)*Math.sin(c),y:o*Math.sin(t)*Math.sin(c),z:o*Math.cos(c)}},x.toEvaluationFeature=Wc,x.transformMat4=Ko,x.translate=function(o,t,c){var g,D,M,P,B,$,ee,se,fe,ve,xe,Te,je=c[0],Ue=c[1],it=c[2];return t===o?(o[12]=t[0]*je+t[4]*Ue+t[8]*it+t[12],o[13]=t[1]*je+t[5]*Ue+t[9]*it+t[13],o[14]=t[2]*je+t[6]*Ue+t[10]*it+t[14],o[15]=t[3]*je+t[7]*Ue+t[11]*it+t[15]):(D=t[1],M=t[2],P=t[3],B=t[4],$=t[5],ee=t[6],se=t[7],fe=t[8],ve=t[9],xe=t[10],Te=t[11],o[0]=g=t[0],o[1]=D,o[2]=M,o[3]=P,o[4]=B,o[5]=$,o[6]=ee,o[7]=se,o[8]=fe,o[9]=ve,o[10]=xe,o[11]=Te,o[12]=g*je+B*Ue+fe*it+t[12],o[13]=D*je+$*Ue+ve*it+t[13],o[14]=M*je+ee*Ue+xe*it+t[14],o[15]=P*je+se*Ue+Te*it+t[15]),o},x.triggerPluginCompletionEvent=eo,x.unicodeBlockLookup=G,x.uniqueId=function(){return Gn++},x.v8Spec=st,x.validateCustomStyleLayer=function(o){const t=[],c=o.id;return void 0===c&&t.push({message:`layers.${c}: missing required property "id"`}),void 0===o.render&&t.push({message:`layers.${c}: missing required method "render"`}),o.renderingMode&&"2d"!==o.renderingMode&&"3d"!==o.renderingMode&&t.push({message:`layers.${c}: property "renderingMode" must be either "2d" or "3d"`}),t},x.validateLight=rd,x.validateStyle=Fa,x.vectorTile=ec,x.warnOnce=Et,x.wrap=nn}),be(0,function(x){class tt{constructor(he){this.keyCache={},he&&this.replace(he)}replace(he){this._layerConfigs={},this._layers={},this.update(he,[])}update(he,ye){for(const Ve of he){this._layerConfigs[Ve.id]=Ve;const $e=this._layers[Ve.id]=x.createStyleLayer(Ve);$e._featureFilter=x.createFilter($e.filter),this.keyCache[Ve.id]&&delete this.keyCache[Ve.id]}for(const Ve of ye)delete this.keyCache[Ve],delete this._layerConfigs[Ve],delete this._layers[Ve];this.familiesBySource={};const Ie=x.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const Ve of Ie){const $e=Ve.map(Xe=>this._layers[Xe.id]),we=$e[0];if("none"===we.visibility)continue;const me=we.source||"";let oe=this.familiesBySource[me];oe||(oe=this.familiesBySource[me]={});const Se=we.sourceLayer||"_geojsonTileLayer";let Ye=oe[Se];Ye||(Ye=oe[Se]=[]),Ye.push($e)}}}class Pe{constructor(he){const ye={},Ie=[];for(const me in he){const oe=he[me],Se=ye[me]={};for(const Ye in oe){const Xe=oe[+Ye];if(!Xe||0===Xe.bitmap.width||0===Xe.bitmap.height)continue;const gt={x:0,y:0,w:Xe.bitmap.width+2,h:Xe.bitmap.height+2};Ie.push(gt),Se[Ye]={rect:gt,metrics:Xe.metrics}}}const{w:Ve,h:$e}=x.potpack(Ie),we=new x.AlphaImage({width:Ve||1,height:$e||1});for(const me in he){const oe=he[me];for(const Se in oe){const Ye=oe[+Se];if(!Ye||0===Ye.bitmap.width||0===Ye.bitmap.height)continue;const Xe=ye[me][Se].rect;x.AlphaImage.copy(Ye.bitmap,we,{x:0,y:0},{x:Xe.x+1,y:Xe.y+1},Ye.bitmap)}}this.image=we,this.positions=ye}}x.register("GlyphAtlas",Pe);class Ze{constructor(he){this.tileID=new x.OverscaledTileID(he.tileID.overscaledZ,he.tileID.wrap,he.tileID.canonical.z,he.tileID.canonical.x,he.tileID.canonical.y),this.uid=he.uid,this.zoom=he.zoom,this.pixelRatio=he.pixelRatio,this.tileSize=he.tileSize,this.source=he.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=he.showCollisionBoxes,this.collectResourceTiming=!!he.collectResourceTiming,this.returnDependencies=!!he.returnDependencies,this.promoteId=he.promoteId}parse(he,ye,Ie,Ve,$e){this.status="parsing",this.data=he,this.collisionBoxArray=new x.CollisionBoxArray;const we=new x.DictionaryCoder(Object.keys(he.layers).sort()),me=new x.FeatureIndex(this.tileID,this.promoteId);me.bucketLayerIDs=[];const oe={},Se={featureIndex:me,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Ie},Ye=ye.familiesBySource[this.source];for(const Oe in Ye){const Ge=he.layers[Oe];if(!Ge)continue;1===Ge.version&&x.warnOnce(`Vector tile source "${this.source}" layer "${Oe}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Gt=we.encode(Oe),tn=[];for(let Wt=0;Wt<Ge.length;Wt++){const cn=Ge.feature(Wt),Zi=me.getId(cn,Oe);tn.push({feature:cn,id:Zi,index:Wt,sourceLayerIndex:Gt})}for(const Wt of Ye[Oe]){const cn=Wt[0];cn.source!==this.source&&x.warnOnce(`layer.source = ${cn.source} does not equal this.source = ${this.source}`),cn.minzoom&&this.zoom<Math.floor(cn.minzoom)||cn.maxzoom&&this.zoom>=cn.maxzoom||"none"!==cn.visibility&&(yt(Wt,this.zoom,Ie),(oe[cn.id]=cn.createBucket({index:me.bucketLayerIDs.length,layers:Wt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Gt,sourceID:this.source})).populate(tn,Se,this.tileID.canonical),me.bucketLayerIDs.push(Wt.map(Zi=>Zi.id)))}}let Xe,gt,mn,wn;const sn=x.mapObject(Se.glyphDependencies,Oe=>Object.keys(Oe).map(Number));Object.keys(sn).length?Ve.send("getGlyphs",{uid:this.uid,stacks:sn,source:this.source,tileID:this.tileID,type:"glyphs"},(Oe,Ge)=>{Xe||(Xe=Oe,gt=Ge,ut.call(this))}):gt={};const Cn=Object.keys(Se.iconDependencies);Cn.length?Ve.send("getImages",{icons:Cn,source:this.source,tileID:this.tileID,type:"icons"},(Oe,Ge)=>{Xe||(Xe=Oe,mn=Ge,ut.call(this))}):mn={};const Fn=Object.keys(Se.patternDependencies);function ut(){if(Xe)return $e(Xe);if(gt&&mn&&wn){const Oe=new Pe(gt),Ge=new x.ImageAtlas(mn,wn);for(const Gt in oe){const tn=oe[Gt];tn instanceof x.SymbolBucket?(yt(tn.layers,this.zoom,Ie),x.performSymbolLayout({bucket:tn,glyphMap:gt,glyphPositions:Oe.positions,imageMap:mn,imagePositions:Ge.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):tn.hasPattern&&(tn instanceof x.LineBucket||tn instanceof x.FillBucket||tn instanceof x.FillExtrusionBucket)&&(yt(tn.layers,this.zoom,Ie),tn.addFeatures(Se,this.tileID.canonical,Ge.patternPositions))}this.status="done",$e(null,{buckets:Object.values(oe).filter(Gt=>!Gt.isEmpty()),featureIndex:me,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Oe.image,imageAtlas:Ge,glyphMap:this.returnDependencies?gt:null,iconMap:this.returnDependencies?mn:null,glyphPositions:this.returnDependencies?Oe.positions:null})}}Fn.length?Ve.send("getImages",{icons:Fn,source:this.source,tileID:this.tileID,type:"patterns"},(Oe,Ge)=>{Xe||(Xe=Oe,wn=Ge,ut.call(this))}):wn={},ut.call(this)}}function yt(Le,he,ye){const Ie=new x.EvaluationParameters(he);for(const Ve of Le)Ve.recalculate(Ie,ye)}function Ht(Le,he){const ye=x.getArrayBuffer(Le.request,(Ie,Ve,$e,we)=>{Ie?he(Ie):Ve&&he(null,{vectorTile:new x.vectorTile.VectorTile(new x.Protobuf(Ve)),rawData:Ve,cacheControl:$e,expires:we})});return()=>{ye.cancel(),he()}}class $t{constructor(he,ye,Ie,Ve){this.actor=he,this.layerIndex=ye,this.availableImages=Ie,this.loadVectorData=Ve||Ht,this.loading={},this.loaded={}}loadTile(he,ye){const Ie=he.uid;this.loading||(this.loading={});const Ve=!!(he&&he.request&&he.request.collectResourceTiming)&&new x.RequestPerformance(he.request),$e=this.loading[Ie]=new Ze(he);$e.abort=this.loadVectorData(he,(we,me)=>{if(delete this.loading[Ie],we||!me)return $e.status="done",this.loaded[Ie]=$e,ye(we);const oe=me.rawData,Se={};me.expires&&(Se.expires=me.expires),me.cacheControl&&(Se.cacheControl=me.cacheControl);const Ye={};if(Ve){const Xe=Ve.finish();Xe&&(Ye.resourceTiming=JSON.parse(JSON.stringify(Xe)))}$e.vectorTile=me.vectorTile,$e.parse(me.vectorTile,this.layerIndex,this.availableImages,this.actor,(Xe,gt)=>{if(Xe||!gt)return ye(Xe);ye(null,x.extend({rawTileData:oe.slice(0)},gt,Se,Ye))}),this.loaded=this.loaded||{},this.loaded[Ie]=$e})}reloadTile(he,ye){const Ie=this.loaded,Ve=he.uid,$e=this;if(Ie&&Ie[Ve]){const we=Ie[Ve];we.showCollisionBoxes=he.showCollisionBoxes;const me=(oe,Se)=>{const Ye=we.reloadCallback;Ye&&(delete we.reloadCallback,we.parse(we.vectorTile,$e.layerIndex,this.availableImages,$e.actor,Ye)),ye(oe,Se)};"parsing"===we.status?we.reloadCallback=me:"done"===we.status&&(we.vectorTile?we.parse(we.vectorTile,this.layerIndex,this.availableImages,this.actor,me):me())}}abortTile(he,ye){const Ie=this.loading,Ve=he.uid;Ie&&Ie[Ve]&&Ie[Ve].abort&&(Ie[Ve].abort(),delete Ie[Ve]),ye()}removeTile(he,ye){const Ie=this.loaded,Ve=he.uid;Ie&&Ie[Ve]&&delete Ie[Ve],ye()}}class It{constructor(){this.loaded={}}loadTile(he,ye){const{uid:Ie,encoding:Ve,rawImageData:$e}=he,we=x.isImageBitmap($e)?this.getImageData($e):$e,me=new x.DEMData(Ie,we,Ve);this.loaded=this.loaded||{},this.loaded[Ie]=me,ye(null,me)}getImageData(he){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(he.width,he.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=he.width,this.offscreenCanvas.height=he.height,this.offscreenCanvasContext.drawImage(he,0,0,he.width,he.height);const ye=this.offscreenCanvasContext.getImageData(-1,-1,he.width+2,he.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new x.RGBAImage({width:ye.width,height:ye.height},ye.data)}removeTile(he){const ye=this.loaded,Ie=he.uid;ye&&ye[Ie]&&delete ye[Ie]}}function bt(Le,he){if(0!==Le.length){Zt(Le[0],he);for(var ye=1;ye<Le.length;ye++)Zt(Le[ye],!he)}}function Zt(Le,he){for(var ye=0,Ie=0,Ve=0,$e=Le.length,we=$e-1;Ve<$e;we=Ve++){var me=(Le[Ve][0]-Le[we][0])*(Le[we][1]+Le[Ve][1]),oe=ye+me;Ie+=Math.abs(ye)>=Math.abs(me)?ye-oe+me:me-oe+ye,ye=oe}ye+Ie>=0!=!!he&&Le.reverse()}var dt=x.getDefaultExportFromCjs(function Le(he,ye){var Ie,Ve=he&&he.type;if("FeatureCollection"===Ve)for(Ie=0;Ie<he.features.length;Ie++)Le(he.features[Ie],ye);else if("GeometryCollection"===Ve)for(Ie=0;Ie<he.geometries.length;Ie++)Le(he.geometries[Ie],ye);else if("Feature"===Ve)Le(he.geometry,ye);else if("Polygon"===Ve)bt(he.coordinates,ye);else if("MultiPolygon"===Ve)for(Ie=0;Ie<he.coordinates.length;Ie++)bt(he.coordinates[Ie],ye);return he});const nn=x.vectorTile.VectorTileFeature.prototype.toGeoJSON;var Tn={exports:{}},Gn=x.pointGeometry,yi=x.vectorTile.VectorTileFeature,vi=Vt;function Vt(Le,he){this.options=he||{},this.features=Le,this.length=Le.length}function Tt(Le,he){this.id="number"==typeof Le.id?Le.id:void 0,this.type=Le.type,this.rawGeometry=1===Le.type?[Le.geometry]:Le.geometry,this.properties=Le.tags,this.extent=he||4096}Vt.prototype.feature=function(Le){return new Tt(this.features[Le],this.options.extent)},Tt.prototype.loadGeometry=function(){var Le=this.rawGeometry;this.geometry=[];for(var he=0;he<Le.length;he++){for(var ye=Le[he],Ie=[],Ve=0;Ve<ye.length;Ve++)Ie.push(new Gn(ye[Ve][0],ye[Ve][1]));this.geometry.push(Ie)}return this.geometry},Tt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Le=this.geometry,he=1/0,ye=-1/0,Ie=1/0,Ve=-1/0,$e=0;$e<Le.length;$e++)for(var we=Le[$e],me=0;me<we.length;me++){var oe=we[me];he=Math.min(he,oe.x),ye=Math.max(ye,oe.x),Ie=Math.min(Ie,oe.y),Ve=Math.max(Ve,oe.y)}return[he,Ie,ye,Ve]},Tt.prototype.toGeoJSON=yi.prototype.toGeoJSON;var wt=x.pbf,Et=vi;function Bt(Le){var he=new wt;return function(ye,Ie){for(var Ve in ye.layers)Ie.writeMessage(3,lt,ye.layers[Ve])}(Le,he),he.finish()}function lt(Le,he){var ye;he.writeVarintField(15,Le.version||1),he.writeStringField(1,Le.name||""),he.writeVarintField(5,Le.extent||4096);var Ie={keys:[],values:[],keycache:{},valuecache:{}};for(ye=0;ye<Le.length;ye++)Ie.feature=Le.feature(ye),he.writeMessage(2,zt,Ie);var Ve=Ie.keys;for(ye=0;ye<Ve.length;ye++)he.writeStringField(3,Ve[ye]);var $e=Ie.values;for(ye=0;ye<$e.length;ye++)he.writeMessage(4,ui,$e[ye])}function zt(Le,he){var ye=Le.feature;void 0!==ye.id&&he.writeVarintField(1,ye.id),he.writeMessage(2,nt,Le),he.writeVarintField(3,ye.type),he.writeMessage(4,en,ye)}function nt(Le,he){var ye=Le.feature,Ie=Le.keys,Ve=Le.values,$e=Le.keycache,we=Le.valuecache;for(var me in ye.properties){var oe=ye.properties[me],Se=$e[me];if(null!==oe){void 0===Se&&(Ie.push(me),$e[me]=Se=Ie.length-1),he.writeVarint(Se);var Ye=typeof oe;"string"!==Ye&&"boolean"!==Ye&&"number"!==Ye&&(oe=JSON.stringify(oe));var Xe=Ye+":"+oe,gt=we[Xe];void 0===gt&&(Ve.push(oe),we[Xe]=gt=Ve.length-1),he.writeVarint(gt)}}}function xt(Le,he){return(he<<3)+(7&Le)}function bn(Le){return Le<<1^Le>>31}function en(Le,he){for(var ye=Le.loadGeometry(),Ie=Le.type,Ve=0,$e=0,we=ye.length,me=0;me<we;me++){var oe=ye[me],Se=1;1===Ie&&(Se=oe.length),he.writeVarint(xt(1,Se));for(var Ye=3===Ie?oe.length-1:oe.length,Xe=0;Xe<Ye;Xe++){1===Xe&&1!==Ie&&he.writeVarint(xt(2,Ye-1));var gt=oe[Xe].x-Ve,mn=oe[Xe].y-$e;he.writeVarint(bn(gt)),he.writeVarint(bn(mn)),Ve+=gt,$e+=mn}3===Ie&&he.writeVarint(xt(7,1))}}function ui(Le,he){var ye=typeof Le;"string"===ye?he.writeStringField(1,Le):"boolean"===ye?he.writeBooleanField(7,Le):"number"===ye&&(Le%1!=0?he.writeDoubleField(3,Le):Le<0?he.writeSVarintField(6,Le):he.writeVarintField(5,Le))}Tn.exports=Bt,Tn.exports.fromVectorTileJs=Bt,Tn.exports.fromGeojsonVt=function(Le,he){he=he||{};var ye={};for(var Ie in Le)ye[Ie]=new Et(Le[Ie].features,he),ye[Ie].name=Ie,ye[Ie].version=he.version,ye[Ie].extent=he.extent;return Bt({layers:ye})},Tn.exports.GeoJSONWrapper=Et;var Jt=x.getDefaultExportFromCjs(Tn.exports);const Pn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Le=>Le},Mi=Math.fround||(bi=new Float32Array(1),Le=>(bi[0]=+Le,bi[0]));var bi;const ft=3,ht=5,Pt=6;class Nt{constructor(he){this.options=Object.assign(Object.create(Pn),he),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(he){const{log:ye,minZoom:Ie,maxZoom:Ve}=this.options;ye&&console.time("total time");const $e=`prepare ${he.length} points`;ye&&console.time($e),this.points=he;const we=[];for(let oe=0;oe<he.length;oe++){const Se=he[oe];if(!Se.geometry)continue;const[Ye,Xe]=Se.geometry.coordinates,gt=Mi(oi(Ye)),mn=Mi(mi(Xe));we.push(gt,mn,1/0,oe,-1,1),this.options.reduce&&we.push(0)}let me=this.trees[Ve+1]=this._createTree(we);ye&&console.timeEnd($e);for(let oe=Ve;oe>=Ie;oe--){const Se=+Date.now();me=this.trees[oe]=this._createTree(this._cluster(me,oe)),ye&&console.log("z%d: %d clusters in %dms",oe,me.numItems,+Date.now()-Se)}return ye&&console.timeEnd("total time"),this}getClusters(he,ye){let Ie=((he[0]+180)%360+360)%360-180;const Ve=Math.max(-90,Math.min(90,he[1]));let $e=180===he[2]?180:((he[2]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,he[3]));if(he[2]-he[0]>=360)Ie=-180,$e=180;else if(Ie>$e){const Xe=this.getClusters([Ie,Ve,180,we],ye),gt=this.getClusters([-180,Ve,$e,we],ye);return Xe.concat(gt)}const me=this.trees[this._limitZoom(ye)],oe=me.range(oi(Ie),mi(we),oi($e),mi(Ve)),Se=me.data,Ye=[];for(const Xe of oe){const gt=this.stride*Xe;Ye.push(Se[gt+ht]>1?hn(Se,gt,this.clusterProps):this.points[Se[gt+ft]])}return Ye}getChildren(he){const ye=this._getOriginId(he),Ie=this._getOriginZoom(he),Ve="No cluster with the specified id.",$e=this.trees[Ie];if(!$e)throw new Error(Ve);const we=$e.data;if(ye*this.stride>=we.length)throw new Error(Ve);const me=this.options.radius/(this.options.extent*Math.pow(2,Ie-1)),oe=$e.within(we[ye*this.stride],we[ye*this.stride+1],me),Se=[];for(const Ye of oe){const Xe=Ye*this.stride;we[Xe+4]===he&&Se.push(we[Xe+ht]>1?hn(we,Xe,this.clusterProps):this.points[we[Xe+ft]])}if(0===Se.length)throw new Error(Ve);return Se}getLeaves(he,ye,Ie){const Ve=[];return this._appendLeaves(Ve,he,ye=ye||10,Ie=Ie||0,0),Ve}getTile(he,ye,Ie){const Ve=this.trees[this._limitZoom(he)],$e=Math.pow(2,he),{extent:we,radius:me}=this.options,oe=me/we,Se=(Ie-oe)/$e,Ye=(Ie+1+oe)/$e,Xe={features:[]};return this._addTileFeatures(Ve.range((ye-oe)/$e,Se,(ye+1+oe)/$e,Ye),Ve.data,ye,Ie,$e,Xe),0===ye&&this._addTileFeatures(Ve.range(1-oe/$e,Se,1,Ye),Ve.data,$e,Ie,$e,Xe),ye===$e-1&&this._addTileFeatures(Ve.range(0,Se,oe/$e,Ye),Ve.data,-1,Ie,$e,Xe),Xe.features.length?Xe:null}getClusterExpansionZoom(he){let ye=this._getOriginZoom(he)-1;for(;ye<=this.options.maxZoom;){const Ie=this.getChildren(he);if(ye++,1!==Ie.length)break;he=Ie[0].properties.cluster_id}return ye}_appendLeaves(he,ye,Ie,Ve,$e){const we=this.getChildren(ye);for(const me of we){const oe=me.properties;if(oe&&oe.cluster?$e+oe.point_count<=Ve?$e+=oe.point_count:$e=this._appendLeaves(he,oe.cluster_id,Ie,Ve,$e):$e<Ve?$e++:he.push(me),he.length===Ie)break}return $e}_createTree(he){const ye=new x.KDBush(he.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Ie=0;Ie<he.length;Ie+=this.stride)ye.add(he[Ie],he[Ie+1]);return ye.finish(),ye.data=he,ye}_addTileFeatures(he,ye,Ie,Ve,$e,we){for(const me of he){const oe=me*this.stride,Se=ye[oe+ht]>1;let Ye,Xe,gt;if(Se)Ye=ln(ye,oe,this.clusterProps),Xe=ye[oe],gt=ye[oe+1];else{const sn=this.points[ye[oe+ft]];Ye=sn.properties;const[Cn,Fn]=sn.geometry.coordinates;Xe=oi(Cn),gt=mi(Fn)}const mn={type:1,geometry:[[Math.round(this.options.extent*(Xe*$e-Ie)),Math.round(this.options.extent*(gt*$e-Ve))]],tags:Ye};let wn;wn=Se||this.options.generateId?ye[oe+ft]:this.points[ye[oe+ft]].id,void 0!==wn&&(mn.id=wn),we.features.push(mn)}}_limitZoom(he){return Math.max(this.options.minZoom,Math.min(Math.floor(+he),this.options.maxZoom+1))}_cluster(he,ye){const{radius:Ie,extent:Ve,reduce:$e,minPoints:we}=this.options,me=Ie/(Ve*Math.pow(2,ye)),oe=he.data,Se=[],Ye=this.stride;for(let Xe=0;Xe<oe.length;Xe+=Ye){if(oe[Xe+2]<=ye)continue;oe[Xe+2]=ye;const gt=oe[Xe],mn=oe[Xe+1],wn=he.within(oe[Xe],oe[Xe+1],me),sn=oe[Xe+ht];let Cn=sn;for(const Fn of wn){const ut=Fn*Ye;oe[ut+2]>ye&&(Cn+=oe[ut+ht])}if(Cn>sn&&Cn>=we){let Fn,ut=gt*sn,Oe=mn*sn,Ge=-1;const Gt=((Xe/Ye|0)<<5)+(ye+1)+this.points.length;for(const tn of wn){const Wt=tn*Ye;if(oe[Wt+2]<=ye)continue;oe[Wt+2]=ye;const cn=oe[Wt+ht];ut+=oe[Wt]*cn,Oe+=oe[Wt+1]*cn,oe[Wt+4]=Gt,$e&&(Fn||(Fn=this._map(oe,Xe,!0),Ge=this.clusterProps.length,this.clusterProps.push(Fn)),$e(Fn,this._map(oe,Wt)))}oe[Xe+4]=Gt,Se.push(ut/Cn,Oe/Cn,1/0,Gt,-1,Cn),$e&&Se.push(Ge)}else{for(let Fn=0;Fn<Ye;Fn++)Se.push(oe[Xe+Fn]);if(Cn>1)for(const Fn of wn){const ut=Fn*Ye;if(!(oe[ut+2]<=ye)){oe[ut+2]=ye;for(let Oe=0;Oe<Ye;Oe++)Se.push(oe[ut+Oe])}}}}return Se}_getOriginId(he){return he-this.points.length>>5}_getOriginZoom(he){return(he-this.points.length)%32}_map(he,ye,Ie){if(he[ye+ht]>1){const we=this.clusterProps[he[ye+Pt]];return Ie?Object.assign({},we):we}const Ve=this.points[he[ye+ft]].properties,$e=this.options.map(Ve);return Ie&&$e===Ve?Object.assign({},$e):$e}}function hn(Le,he,ye){return{type:"Feature",id:Le[he+ft],properties:ln(Le,he,ye),geometry:{type:"Point",coordinates:[(Ie=Le[he],360*(Ie-.5)),zi(Le[he+1])]}};var Ie}function ln(Le,he,ye){const Ie=Le[he+ht],Ve=Ie>=1e4?`${Math.round(Ie/1e3)}k`:Ie>=1e3?Math.round(Ie/100)/10+"k":Ie,$e=Le[he+Pt],we=-1===$e?{}:Object.assign({},ye[$e]);return Object.assign(we,{cluster:!0,cluster_id:Le[he+ft],point_count:Ie,point_count_abbreviated:Ve})}function oi(Le){return Le/360+.5}function mi(Le){const he=Math.sin(Le*Math.PI/180),ye=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return ye<0?0:ye>1?1:ye}function zi(Le){const he=(180-360*Le)*Math.PI/180;return 360*Math.atan(Math.exp(he))/Math.PI-90}function di(Le,he,ye,Ie){for(var Ve,$e=Ie,we=ye-he>>1,me=ye-he,oe=Le[he],Se=Le[he+1],Ye=Le[ye],Xe=Le[ye+1],gt=he+3;gt<ye;gt+=3){var mn=Si(Le[gt],Le[gt+1],oe,Se,Ye,Xe);if(mn>$e)Ve=gt,$e=mn;else if(mn===$e){var wn=Math.abs(gt-we);wn<me&&(Ve=gt,me=wn)}}$e>Ie&&(Ve-he>3&&di(Le,he,Ve,Ie),Le[Ve+2]=$e,ye-Ve>3&&di(Le,Ve,ye,Ie))}function Si(Le,he,ye,Ie,Ve,$e){var we=Ve-ye,me=$e-Ie;if(0!==we||0!==me){var oe=((Le-ye)*we+(he-Ie)*me)/(we*we+me*me);oe>1?(ye=Ve,Ie=$e):oe>0&&(ye+=we*oe,Ie+=me*oe)}return(we=Le-ye)*we+(me=he-Ie)*me}function st(Le,he,ye,Ie){var Ve={id:void 0===Le?null:Le,type:he,geometry:ye,tags:Ie,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function($e){var we=$e.geometry,me=$e.type;if("Point"===me||"MultiPoint"===me||"LineString"===me)Ci($e,we);else if("Polygon"===me||"MultiLineString"===me)for(var oe=0;oe<we.length;oe++)Ci($e,we[oe]);else if("MultiPolygon"===me)for(oe=0;oe<we.length;oe++)for(var Se=0;Se<we[oe].length;Se++)Ci($e,we[oe][Se])}(Ve),Ve}function Ci(Le,he){for(var ye=0;ye<he.length;ye+=3)Le.minX=Math.min(Le.minX,he[ye]),Le.minY=Math.min(Le.minY,he[ye+1]),Le.maxX=Math.max(Le.maxX,he[ye]),Le.maxY=Math.max(Le.maxY,he[ye+1])}function er(Le,he,ye,Ie){if(he.geometry){var Ve=he.geometry.coordinates,$e=he.geometry.type,we=Math.pow(ye.tolerance/((1<<ye.maxZoom)*ye.extent),2),me=[],oe=he.id;if(ye.promoteId?oe=he.properties[ye.promoteId]:ye.generateId&&(oe=Ie||0),"Point"===$e)Mn(Ve,me);else if("MultiPoint"===$e)for(var Se=0;Se<Ve.length;Se++)Mn(Ve[Se],me);else if("LineString"===$e)An(Ve,me,we,!1);else if("MultiLineString"===$e){if(ye.lineMetrics){for(Se=0;Se<Ve.length;Se++)An(Ve[Se],me=[],we,!1),Le.push(st(oe,"LineString",me,he.properties));return}mt(Ve,me,we,!1)}else if("Polygon"===$e)mt(Ve,me,we,!0);else{if("MultiPolygon"!==$e){if("GeometryCollection"===$e){for(Se=0;Se<he.geometry.geometries.length;Se++)er(Le,{id:oe,geometry:he.geometry.geometries[Se],properties:he.properties},ye,Ie);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Se=0;Se<Ve.length;Se++){var Ye=[];mt(Ve[Se],Ye,we,!0),me.push(Ye)}}Le.push(st(oe,$e,me,he.properties))}}function Mn(Le,he){he.push(We(Le[0])),he.push(Ot(Le[1])),he.push(0)}function An(Le,he,ye,Ie){for(var Ve,$e,we=0,me=0;me<Le.length;me++){var oe=We(Le[me][0]),Se=Ot(Le[me][1]);he.push(oe),he.push(Se),he.push(0),me>0&&(we+=Ie?(Ve*Se-oe*$e)/2:Math.sqrt(Math.pow(oe-Ve,2)+Math.pow(Se-$e,2))),Ve=oe,$e=Se}var Ye=he.length-3;he[2]=1,di(he,0,Ye,ye),he[Ye+2]=1,he.size=Math.abs(we),he.start=0,he.end=he.size}function mt(Le,he,ye,Ie){for(var Ve=0;Ve<Le.length;Ve++){var $e=[];An(Le[Ve],$e,ye,Ie),he.push($e)}}function We(Le){return Le/360+.5}function Ot(Le){var he=Math.sin(Le*Math.PI/180),ye=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return ye<0?0:ye>1?1:ye}function kt(Le,he,ye,Ie,Ve,$e,we,me){if(Ie/=he,$e>=(ye/=he)&&we<Ie)return Le;if(we<ye||$e>=Ie)return null;for(var oe=[],Se=0;Se<Le.length;Se++){var Ye=Le[Se],Xe=Ye.geometry,gt=Ye.type,mn=0===Ve?Ye.minX:Ye.minY,wn=0===Ve?Ye.maxX:Ye.maxY;if(mn>=ye&&wn<Ie)oe.push(Ye);else if(!(wn<ye||mn>=Ie)){var sn=[];if("Point"===gt||"MultiPoint"===gt)gn(Xe,sn,ye,Ie,Ve);else if("LineString"===gt)Yt(Xe,sn,ye,Ie,Ve,!1,me.lineMetrics);else if("MultiLineString"===gt)at(Xe,sn,ye,Ie,Ve,!1);else if("Polygon"===gt)at(Xe,sn,ye,Ie,Ve,!0);else if("MultiPolygon"===gt)for(var Cn=0;Cn<Xe.length;Cn++){var Fn=[];at(Xe[Cn],Fn,ye,Ie,Ve,!0),Fn.length&&sn.push(Fn)}if(sn.length){if(me.lineMetrics&&"LineString"===gt){for(Cn=0;Cn<sn.length;Cn++)oe.push(st(Ye.id,gt,sn[Cn],Ye.tags));continue}"LineString"!==gt&&"MultiLineString"!==gt||(1===sn.length?(gt="LineString",sn=sn[0]):gt="MultiLineString"),"Point"!==gt&&"MultiPoint"!==gt||(gt=3===sn.length?"Point":"MultiPoint"),oe.push(st(Ye.id,gt,sn,Ye.tags))}}}return oe.length?oe:null}function gn(Le,he,ye,Ie,Ve){for(var $e=0;$e<Le.length;$e+=3){var we=Le[$e+Ve];we>=ye&&we<=Ie&&(he.push(Le[$e]),he.push(Le[$e+1]),he.push(Le[$e+2]))}}function Yt(Le,he,ye,Ie,Ve,$e,we){for(var me,oe,Se=jn(Le),Ye=0===Ve?yn:Kn,Xe=Le.start,gt=0;gt<Le.length-3;gt+=3){var mn=Le[gt],wn=Le[gt+1],sn=Le[gt+2],Cn=Le[gt+3],Fn=Le[gt+4],ut=0===Ve?mn:wn,Oe=0===Ve?Cn:Fn,Ge=!1;we&&(me=Math.sqrt(Math.pow(mn-Cn,2)+Math.pow(wn-Fn,2))),ut<ye?Oe>ye&&(oe=Ye(Se,mn,wn,Cn,Fn,ye),we&&(Se.start=Xe+me*oe)):ut>Ie?Oe<Ie&&(oe=Ye(Se,mn,wn,Cn,Fn,Ie),we&&(Se.start=Xe+me*oe)):qt(Se,mn,wn,sn),Oe<ye&&ut>=ye&&(oe=Ye(Se,mn,wn,Cn,Fn,ye),Ge=!0),Oe>Ie&&ut<=Ie&&(oe=Ye(Se,mn,wn,Cn,Fn,Ie),Ge=!0),!$e&&Ge&&(we&&(Se.end=Xe+me*oe),he.push(Se),Se=jn(Le)),we&&(Xe+=me)}var Gt=Le.length-3;mn=Le[Gt],wn=Le[Gt+1],sn=Le[Gt+2],(ut=0===Ve?mn:wn)>=ye&&ut<=Ie&&qt(Se,mn,wn,sn),Gt=Se.length-3,$e&&Gt>=3&&(Se[Gt]!==Se[0]||Se[Gt+1]!==Se[1])&&qt(Se,Se[0],Se[1],Se[2]),Se.length&&he.push(Se)}function jn(Le){var he=[];return he.size=Le.size,he.start=Le.start,he.end=Le.end,he}function at(Le,he,ye,Ie,Ve,$e){for(var we=0;we<Le.length;we++)Yt(Le[we],he,ye,Ie,Ve,$e,!1)}function qt(Le,he,ye,Ie){Le.push(he),Le.push(ye),Le.push(Ie)}function yn(Le,he,ye,Ie,Ve,$e){var we=($e-he)/(Ie-he);return Le.push($e),Le.push(ye+(Ve-ye)*we),Le.push(1),we}function Kn(Le,he,ye,Ie,Ve,$e){var we=($e-ye)/(Ve-ye);return Le.push(he+(Ie-he)*we),Le.push($e),Le.push(1),we}function qn(Le,he){for(var ye=[],Ie=0;Ie<Le.length;Ie++){var Ve,$e=Le[Ie],we=$e.type;if("Point"===we||"MultiPoint"===we||"LineString"===we)Ve=rn($e.geometry,he);else if("MultiLineString"===we||"Polygon"===we){Ve=[];for(var me=0;me<$e.geometry.length;me++)Ve.push(rn($e.geometry[me],he))}else if("MultiPolygon"===we)for(Ve=[],me=0;me<$e.geometry.length;me++){for(var oe=[],Se=0;Se<$e.geometry[me].length;Se++)oe.push(rn($e.geometry[me][Se],he));Ve.push(oe)}ye.push(st($e.id,we,Ve,$e.tags))}return ye}function rn(Le,he){var ye=[];ye.size=Le.size,void 0!==Le.start&&(ye.start=Le.start,ye.end=Le.end);for(var Ie=0;Ie<Le.length;Ie+=3)ye.push(Le[Ie]+he,Le[Ie+1],Le[Ie+2]);return ye}function On(Le,he){if(Le.transformed)return Le;var ye,Ie,Ve,$e=1<<Le.z,we=Le.x,me=Le.y;for(ye=0;ye<Le.features.length;ye++){var oe=Le.features[ye],Se=oe.geometry,Ye=oe.type;if(oe.geometry=[],1===Ye)for(Ie=0;Ie<Se.length;Ie+=2)oe.geometry.push(Qt(Se[Ie],Se[Ie+1],he,$e,we,me));else for(Ie=0;Ie<Se.length;Ie++){var Xe=[];for(Ve=0;Ve<Se[Ie].length;Ve+=2)Xe.push(Qt(Se[Ie][Ve],Se[Ie][Ve+1],he,$e,we,me));oe.geometry.push(Xe)}}return Le.transformed=!0,Le}function Qt(Le,he,ye,Ie,Ve,$e){return[Math.round(ye*(Le*Ie-Ve)),Math.round(ye*(he*Ie-$e))]}function mr(Le,he,ye,Ie,Ve){for(var $e=he===Ve.maxZoom?0:Ve.tolerance/((1<<he)*Ve.extent),we={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ye,y:Ie,z:he,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},me=0;me<Le.length;me++){we.numFeatures++,ii(we,Le[me],$e,Ve);var oe=Le[me].minX,Se=Le[me].minY,Ye=Le[me].maxX,Xe=Le[me].maxY;oe<we.minX&&(we.minX=oe),Se<we.minY&&(we.minY=Se),Ye>we.maxX&&(we.maxX=Ye),Xe>we.maxY&&(we.maxY=Xe)}return we}function ii(Le,he,ye,Ie){var Ve=he.geometry,$e=he.type,we=[];if("Point"===$e||"MultiPoint"===$e)for(var me=0;me<Ve.length;me+=3)we.push(Ve[me]),we.push(Ve[me+1]),Le.numPoints++,Le.numSimplified++;else if("LineString"===$e)Rn(we,Ve,Le,ye,!1,!1);else if("MultiLineString"===$e||"Polygon"===$e)for(me=0;me<Ve.length;me++)Rn(we,Ve[me],Le,ye,"Polygon"===$e,0===me);else if("MultiPolygon"===$e)for(var oe=0;oe<Ve.length;oe++){var Se=Ve[oe];for(me=0;me<Se.length;me++)Rn(we,Se[me],Le,ye,!0,0===me)}if(we.length){var Ye=he.tags||null;if("LineString"===$e&&Ie.lineMetrics){for(var Xe in Ye={},he.tags)Ye[Xe]=he.tags[Xe];Ye.mapbox_clip_start=Ve.start/Ve.size,Ye.mapbox_clip_end=Ve.end/Ve.size}var gt={geometry:we,type:"Polygon"===$e||"MultiPolygon"===$e?3:"LineString"===$e||"MultiLineString"===$e?2:1,tags:Ye};null!==he.id&&(gt.id=he.id),Le.features.push(gt)}}function Rn(Le,he,ye,Ie,Ve,$e){var we=Ie*Ie;if(Ie>0&&he.size<(Ve?we:Ie))ye.numPoints+=he.length/3;else{for(var me=[],oe=0;oe<he.length;oe+=3)(0===Ie||he[oe+2]>we)&&(ye.numSimplified++,me.push(he[oe]),me.push(he[oe+1])),ye.numPoints++;Ve&&function(Se,Ye){for(var Xe=0,gt=0,mn=Se.length,wn=mn-2;gt<mn;wn=gt,gt+=2)Xe+=(Se[gt]-Se[wn])*(Se[gt+1]+Se[wn+1]);if(Xe>0===Ye)for(gt=0,mn=Se.length;gt<mn/2;gt+=2){var sn=Se[gt],Cn=Se[gt+1];Se[gt]=Se[mn-2-gt],Se[gt+1]=Se[mn-1-gt],Se[mn-2-gt]=sn,Se[mn-1-gt]=Cn}}(me,$e),Le.push(me)}}function Li(Le,he){var ye=(he=this.options=function(Ve,$e){for(var we in $e)Ve[we]=$e[we];return Ve}(Object.create(this.options),he)).debug;if(ye&&console.time("preprocess data"),he.maxZoom<0||he.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(he.promoteId&&he.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ve,$e,we,me,oe,Se,Ie=function(Ve,$e){var we=[];if("FeatureCollection"===Ve.type)for(var me=0;me<Ve.features.length;me++)er(we,Ve.features[me],$e,me);else er(we,"Feature"===Ve.type?Ve:{geometry:Ve},$e);return we}(Le,he);this.tiles={},this.tileCoords=[],ye&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",he.indexMaxZoom,he.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),me=Ve=Ie,oe=kt(Ve,1,-1-(we=($e=he).buffer/$e.extent),we,0,-1,2,$e),Se=kt(Ve,1,1-we,2+we,0,-1,2,$e),(oe||Se)&&(me=kt(Ve,1,-we,1+we,0,-1,2,$e)||[],oe&&(me=qn(oe,1).concat(me)),Se&&(me=me.concat(qn(Se,-1)))),(Ie=me).length&&this.splitTile(Ie,0,0,0),ye&&(Ie.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Lr(Le,he,ye){return 32*((1<<Le)*ye+he)+Le}function _r(Le,he){return he?Le.properties[he]:Le.id}function Ai(Le,he){if(null==Le)return!0;if("Feature"===Le.type)return null!=_r(Le,he);if("FeatureCollection"===Le.type){const ye=new Set;for(const Ie of Le.features){const Ve=_r(Ie,he);if(null==Ve||ye.has(Ve))return!1;ye.add(Ve)}return!0}return!1}function ur(Le,he){const ye=new Map;if(null!=Le)if("Feature"===Le.type)ye.set(_r(Le,he),Le);else for(const Ie of Le.features)ye.set(_r(Ie,he),Ie);return ye}function si(Le,he){const ye=Le.tileID.canonical;if(!this._geoJSONIndex)return he(null,null);const Ie=this._geoJSONIndex.getTile(ye.z,ye.x,ye.y);if(!Ie)return he(null,null);const Ve=new class{constructor(we){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=x.EXTENT,this.length=we.length,this._features=we}feature(we){return new class{constructor(me){this._feature=me,this.extent=x.EXTENT,this.type=me.type,this.properties=me.tags,"id"in me&&!isNaN(me.id)&&(this.id=parseInt(me.id,10))}loadGeometry(){if(1===this._feature.type){const me=[];for(const oe of this._feature.geometry)me.push([new x.Point(oe[0],oe[1])]);return me}{const me=[];for(const oe of this._feature.geometry){const Se=[];for(const Ye of oe)Se.push(new x.Point(Ye[0],Ye[1]));me.push(Se)}return me}}toGeoJSON(me,oe,Se){return nn.call(this,me,oe,Se)}}(this._features[we])}}(Ie.features);let $e=Jt(Ve);0===$e.byteOffset&&$e.byteLength===$e.buffer.byteLength||($e=new Uint8Array($e)),he(null,{vectorTile:Ve,rawData:$e.buffer})}Li.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Li.prototype.splitTile=function(Le,he,ye,Ie,Ve,$e,we){for(var me=[Le,he,ye,Ie],oe=this.options,Se=oe.debug;me.length;){Ie=me.pop(),ye=me.pop(),he=me.pop(),Le=me.pop();var Ye=1<<he,Xe=Lr(he,ye,Ie),gt=this.tiles[Xe];if(!gt&&(Se>1&&console.time("creation"),gt=this.tiles[Xe]=mr(Le,he,ye,Ie,oe),this.tileCoords.push({z:he,x:ye,y:Ie}),Se)){Se>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",he,ye,Ie,gt.numFeatures,gt.numPoints,gt.numSimplified),console.timeEnd("creation"));var mn="z"+he;this.stats[mn]=(this.stats[mn]||0)+1,this.total++}if(gt.source=Le,Ve){if(he===oe.maxZoom||he===Ve)continue;var wn=1<<Ve-he;if(ye!==Math.floor($e/wn)||Ie!==Math.floor(we/wn))continue}else if(he===oe.indexMaxZoom||gt.numPoints<=oe.indexMaxPoints)continue;if(gt.source=null,0!==Le.length){Se>1&&console.time("clipping");var sn,Cn,Fn,ut,Oe,Ge,Gt=.5*oe.buffer/oe.extent,tn=.5-Gt,Wt=.5+Gt,cn=1+Gt;sn=Cn=Fn=ut=null,Oe=kt(Le,Ye,ye-Gt,ye+Wt,0,gt.minX,gt.maxX,oe),Ge=kt(Le,Ye,ye+tn,ye+cn,0,gt.minX,gt.maxX,oe),Le=null,Oe&&(sn=kt(Oe,Ye,Ie-Gt,Ie+Wt,1,gt.minY,gt.maxY,oe),Cn=kt(Oe,Ye,Ie+tn,Ie+cn,1,gt.minY,gt.maxY,oe),Oe=null),Ge&&(Fn=kt(Ge,Ye,Ie-Gt,Ie+Wt,1,gt.minY,gt.maxY,oe),ut=kt(Ge,Ye,Ie+tn,Ie+cn,1,gt.minY,gt.maxY,oe),Ge=null),Se>1&&console.timeEnd("clipping"),me.push(sn||[],he+1,2*ye,2*Ie),me.push(Cn||[],he+1,2*ye,2*Ie+1),me.push(Fn||[],he+1,2*ye+1,2*Ie),me.push(ut||[],he+1,2*ye+1,2*Ie+1)}}},Li.prototype.getTile=function(Le,he,ye){var Ie=this.options,Ve=Ie.extent,$e=Ie.debug;if(Le<0||Le>24)return null;var we=1<<Le,me=Lr(Le,he=(he%we+we)%we,ye);if(this.tiles[me])return On(this.tiles[me],Ve);$e>1&&console.log("drilling down to z%d-%d-%d",Le,he,ye);for(var oe,Se=Le,Ye=he,Xe=ye;!oe&&Se>0;)Se--,Ye=Math.floor(Ye/2),Xe=Math.floor(Xe/2),oe=this.tiles[Lr(Se,Ye,Xe)];return oe&&oe.source?($e>1&&console.log("found parent tile z%d-%d-%d",Se,Ye,Xe),$e>1&&console.time("drilling down"),this.splitTile(oe.source,Se,Ye,Xe,Le,he,ye),$e>1&&console.timeEnd("drilling down"),this.tiles[me]?On(this.tiles[me],Ve):null):null};class Br extends $t{constructor(he,ye,Ie,Ve){super(he,ye,Ie,si),this._dataUpdateable=new Map,this.loadGeoJSON=($e,we)=>{const{promoteId:me}=$e;if($e.request)return x.getJSON($e.request,(oe,Se,Ye,Xe)=>{this._dataUpdateable=Ai(Se,me)?ur(Se,me):void 0,we(oe,Se,Ye,Xe)});if("string"==typeof $e.data)try{const oe=JSON.parse($e.data);this._dataUpdateable=Ai(oe,me)?ur(oe,me):void 0,we(null,oe)}catch{we(new Error(`Input data given to '${$e.source}' is not a valid GeoJSON object.`))}else $e.dataDiff?this._dataUpdateable?(function(oe,Se,Ye){var Xe,gt,mn,wn;if(Se.removeAll&&oe.clear(),Se.remove)for(const sn of Se.remove)oe.delete(sn);if(Se.add)for(const sn of Se.add){const Cn=_r(sn,Ye);null!=Cn&&oe.set(Cn,sn)}if(Se.update)for(const sn of Se.update){let Cn=oe.get(sn.id);if(null==Cn)continue;const Fn=!sn.removeAllProperties&&((null===(Xe=sn.removeProperties)||void 0===Xe?void 0:Xe.length)>0||(null===(gt=sn.addOrUpdateProperties)||void 0===gt?void 0:gt.length)>0);if((sn.newGeometry||sn.removeAllProperties||Fn)&&(Cn={...Cn},oe.set(sn.id,Cn),Fn&&(Cn.properties={...Cn.properties})),sn.newGeometry&&(Cn.geometry=sn.newGeometry),sn.removeAllProperties)Cn.properties={};else if((null===(mn=sn.removeProperties)||void 0===mn?void 0:mn.length)>0)for(const ut of sn.removeProperties)Object.prototype.hasOwnProperty.call(Cn.properties,ut)&&delete Cn.properties[ut];if((null===(wn=sn.addOrUpdateProperties)||void 0===wn?void 0:wn.length)>0)for(const{key:ut,value:Oe}of sn.addOrUpdateProperties)Cn.properties[ut]=Oe}}(this._dataUpdateable,$e.dataDiff,me),we(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):we(new Error(`Cannot update existing geojson data in ${$e.source}`)):we(new Error(`Input data given to '${$e.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},Ve&&(this.loadGeoJSON=Ve)}loadData(he,ye){var Ie;null===(Ie=this._pendingRequest)||void 0===Ie||Ie.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const Ve=!!(he&&he.request&&he.request.collectResourceTiming)&&new x.RequestPerformance(he.request);this._pendingCallback=ye,this._pendingRequest=this.loadGeoJSON(he,($e,we)=>{if(delete this._pendingCallback,delete this._pendingRequest,$e||!we)return ye($e);if("object"!=typeof we)return ye(new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`));{dt(we,!0);try{if(he.filter){const oe=x.createExpression(he.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===oe.result)throw new Error(oe.value.map(Ye=>`${Ye.key}: ${Ye.message}`).join(", "));we={type:"FeatureCollection",features:we.features.filter(Ye=>oe.value.evaluate({zoom:0},Ye))}}this._geoJSONIndex=he.cluster?new Nt(function({superclusterOptions:oe,clusterProperties:Se}){if(!Se||!oe)return oe;const Ye={},Xe={},gt={accumulated:null,zoom:0},mn={properties:null},wn=Object.keys(Se);for(const sn of wn){const[Cn,Fn]=Se[sn],ut=x.createExpression(Fn),Oe=x.createExpression("string"==typeof Cn?[Cn,["accumulated"],["get",sn]]:Cn);Ye[sn]=ut.value,Xe[sn]=Oe.value}return oe.map=sn=>{mn.properties=sn;const Cn={};for(const Fn of wn)Cn[Fn]=Ye[Fn].evaluate(gt,mn);return Cn},oe.reduce=(sn,Cn)=>{mn.properties=Cn;for(const Fn of wn)gt.accumulated=sn[Fn],sn[Fn]=Xe[Fn].evaluate(gt,mn)},oe}(he)).load(we.features):new Li(oe=we,he.geojsonVtOptions)}catch(oe){return ye(oe)}this.loaded={};const me={};if(Ve){const oe=Ve.finish();oe&&(me.resourceTiming={},me.resourceTiming[he.source]=JSON.parse(JSON.stringify(oe)))}ye(null,me)}var oe})}reloadTile(he,ye){const Ie=this.loaded;return Ie&&Ie[he.uid]?super.reloadTile(he,ye):this.loadTile(he,ye)}removeSource(he,ye){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ye()}getClusterExpansionZoom(he,ye){try{ye(null,this._geoJSONIndex.getClusterExpansionZoom(he.clusterId))}catch(Ie){ye(Ie)}}getClusterChildren(he,ye){try{ye(null,this._geoJSONIndex.getChildren(he.clusterId))}catch(Ie){ye(Ie)}}getClusterLeaves(he,ye){try{ye(null,this._geoJSONIndex.getLeaves(he.clusterId,he.limit,he.offset))}catch(Ie){ye(Ie)}}}class Vo{constructor(he){this.self=he,this.actor=new x.Actor(he,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:$t,geojson:Br},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ye,Ie)=>{if(this.workerSourceTypes[ye])throw new Error(`Worker source with name "${ye}" already registered.`);this.workerSourceTypes[ye]=Ie},this.self.registerRTLTextPlugin=ye=>{if(x.plugin.isParsed())throw new Error("RTL text plugin already registered.");x.plugin.applyArabicShaping=ye.applyArabicShaping,x.plugin.processBidirectionalText=ye.processBidirectionalText,x.plugin.processStyledBidirectionalText=ye.processStyledBidirectionalText}}setReferrer(he,ye){this.referrer=ye}setImages(he,ye,Ie){this.availableImages[he]=ye;for(const Ve in this.workerSources[he]){const $e=this.workerSources[he][Ve];for(const we in $e)$e[we].availableImages=ye}Ie()}setLayers(he,ye,Ie){this.getLayerIndex(he).replace(ye),Ie()}updateLayers(he,ye,Ie){this.getLayerIndex(he).update(ye.layers,ye.removedIds),Ie()}loadTile(he,ye,Ie){this.getWorkerSource(he,ye.type,ye.source).loadTile(ye,Ie)}loadDEMTile(he,ye,Ie){this.getDEMWorkerSource(he,ye.source).loadTile(ye,Ie)}reloadTile(he,ye,Ie){this.getWorkerSource(he,ye.type,ye.source).reloadTile(ye,Ie)}abortTile(he,ye,Ie){this.getWorkerSource(he,ye.type,ye.source).abortTile(ye,Ie)}removeTile(he,ye,Ie){this.getWorkerSource(he,ye.type,ye.source).removeTile(ye,Ie)}removeDEMTile(he,ye){this.getDEMWorkerSource(he,ye.source).removeTile(ye)}removeSource(he,ye,Ie){if(!this.workerSources[he]||!this.workerSources[he][ye.type]||!this.workerSources[he][ye.type][ye.source])return;const Ve=this.workerSources[he][ye.type][ye.source];delete this.workerSources[he][ye.type][ye.source],void 0!==Ve.removeSource?Ve.removeSource(ye,Ie):Ie()}loadWorkerSource(he,ye,Ie){try{this.self.importScripts(ye.url),Ie()}catch(Ve){Ie(Ve.toString())}}syncRTLPluginState(he,ye,Ie){try{x.plugin.setState(ye);const Ve=x.plugin.getPluginURL();if(x.plugin.isLoaded()&&!x.plugin.isParsed()&&null!=Ve){this.self.importScripts(Ve);const $e=x.plugin.isParsed();Ie($e?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ve}`),$e)}}catch(Ve){Ie(Ve.toString())}}getAvailableImages(he){let ye=this.availableImages[he];return ye||(ye=[]),ye}getLayerIndex(he){let ye=this.layerIndexes[he];return ye||(ye=this.layerIndexes[he]=new tt),ye}getWorkerSource(he,ye,Ie){return this.workerSources[he]||(this.workerSources[he]={}),this.workerSources[he][ye]||(this.workerSources[he][ye]={}),this.workerSources[he][ye][Ie]||(this.workerSources[he][ye][Ie]=new this.workerSourceTypes[ye]({send:($e,we,me)=>{this.actor.send($e,we,me,he)}},this.getLayerIndex(he),this.getAvailableImages(he))),this.workerSources[he][ye][Ie]}getDEMWorkerSource(he,ye){return this.demWorkerSources[he]||(this.demWorkerSources[he]={}),this.demWorkerSources[he][ye]||(this.demWorkerSources[he][ye]=new It),this.demWorkerSources[he][ye]}}return x.isWorker()&&(self.worker=new Vo(self)),Vo}),be(0,function(x){class Pe{static testProp(n){if(!Pe.docStyle)return n[0];for(let d=0;d<n.length;d++)if(n[d]in Pe.docStyle)return n[d];return n[0]}static create(n,d,y){const C=window.document.createElement(n);return void 0!==d&&(C.className=d),y&&y.appendChild(C),C}static createNS(n,d){return window.document.createElementNS(n,d)}static disableDrag(){Pe.docStyle&&Pe.selectProp&&(Pe.userSelect=Pe.docStyle[Pe.selectProp],Pe.docStyle[Pe.selectProp]="none")}static enableDrag(){Pe.docStyle&&Pe.selectProp&&(Pe.docStyle[Pe.selectProp]=Pe.userSelect)}static setTransform(n,d){n.style[Pe.transformProp]=d}static addEventListener(n,d,y,C={}){n.addEventListener(d,y,"passive"in C?C:C.capture)}static removeEventListener(n,d,y,C={}){n.removeEventListener(d,y,"passive"in C?C:C.capture)}static suppressClickInternal(n){n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",Pe.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",Pe.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",Pe.suppressClickInternal,!0)},0)}static mousePos(n,d){const y=n.getBoundingClientRect();return new x.Point(d.clientX-y.left-n.clientLeft,d.clientY-y.top-n.clientTop)}static touchPos(n,d){const y=n.getBoundingClientRect(),C=[];for(let N=0;N<d.length;N++)C.push(new x.Point(d[N].clientX-y.left-n.clientLeft,d[N].clientY-y.top-n.clientTop));return C}static mouseButton(n){return n.button}static remove(n){n.parentNode&&n.parentNode.removeChild(n)}}Pe.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,Pe.selectProp=Pe.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Pe.transformProp=Pe.testProp(["transform","WebkitTransform"]);const Ze={supported:!1,testSupport:function(w){!$t&&Ht&&(It?bt(w):yt=w)}};let yt,Ht,$t=!1,It=!1;function bt(w){const n=w.createTexture();w.bindTexture(w.TEXTURE_2D,n);try{if(w.texImage2D(w.TEXTURE_2D,0,w.RGBA,w.RGBA,w.UNSIGNED_BYTE,Ht),w.isContextLost())return;Ze.supported=!0}catch{}w.deleteTexture(n),$t=!0}var Zt;typeof document<"u"&&(Ht=document.createElement("img"),Ht.onload=function(){yt&&bt(yt),yt=null,It=!0},Ht.onerror=function(){$t=!0,yt=null},Ht.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(w){let n,d,y,C;w.resetRequestQueue=()=>{n=[],d=0,y=0,C={}},w.addThrottleControl=X=>{const le=y++;return C[le]=X,le},w.removeThrottleControl=X=>{delete C[X],Z()},w.getImage=(X,le,ae=!0)=>{Ze.supported&&(X.headers||(X.headers={}),X.headers.accept="image/webp,*/*");const De={requestParameters:X,supportImageRefresh:ae,callback:le,cancelled:!1,completed:!1,cancel:()=>{De.completed||De.cancelled||(De.cancelled=!0,De.innerRequest&&(De.innerRequest.cancel(),d--),Z())}};return n.push(De),Z(),De};const N=X=>{const{requestParameters:le,supportImageRefresh:ae,callback:De}=X;return x.extend(le,{type:"image"}),(!1!==ae||x.isWorker()||x.getProtocolAction(le.url)||le.headers&&!Object.keys(le.headers).reduce((ze,ke)=>ze&&"accept"===ke,!0)?x.makeRequest:Y)(le,(ze,ke,R,k)=>{V(X,De,ze,ke,R,k)})},V=(X,le,ae,De,ze,ke)=>{var R,k;ae?le(ae):De instanceof HTMLImageElement||De instanceof ImageBitmap?le(null,De):De&&(R=De,k=(R,k)=>{null!=R?le(R):null!=k&&le(null,k,{cacheControl:ze,expires:ke})},"function"==typeof createImageBitmap?x.arrayBufferToImageBitmap(R,k):x.arrayBufferToImage(R,k)),X.cancelled||(X.completed=!0,d--,Z())},Z=()=>{const X=(()=>{const le=Object.keys(C);let ae=!1;if(le.length>0)for(const De of le)if(ae=C[De](),ae)break;return ae})()?x.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:x.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let le=d;le<X&&n.length>0;le++){const ae=n.shift();if(ae.cancelled){le--;continue}const De=N(ae);d++,ae.innerRequest=De}},Y=(X,le)=>{const ae=new Image,De=X.url;let ze=!1;const ke=X.credentials;return ke&&"include"===ke?ae.crossOrigin="use-credentials":(ke&&"same-origin"===ke||!x.sameOrigin(De))&&(ae.crossOrigin="anonymous"),ae.fetchPriority="high",ae.onload=()=>{le(null,ae),ae.onerror=ae.onload=null},ae.onerror=()=>{ze||le(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),ae.onerror=ae.onload=null},ae.src=De,{cancel:()=>{ze=!0,ae.src=""}}}}(Zt||(Zt={})),Zt.resetRequestQueue();var dt,w,nn=Zt;(w=dt||(dt={})).Glyphs="Glyphs",w.Image="Image",w.Source="Source",w.SpriteImage="SpriteImage",w.SpriteJSON="SpriteJSON",w.Style="Style",w.Tile="Tile",w.Unknown="Unknown";class Tn{constructor(n){this._transformRequestFn=n}transformRequest(n,d){return this._transformRequestFn&&this._transformRequestFn(n,d)||{url:n}}normalizeSpriteURL(n,d,y){const C=function(N){const V=N.match(Gn);if(!V)throw new Error(`Unable to parse URL "${N}"`);return{protocol:V[1],authority:V[2],path:V[3]||"/",params:V[4]?V[4].split("&"):[]}}(n);return C.path+=`${d}${y}`,function(N){const V=N.params.length?`?${N.params.join("&")}`:"";return`${N.protocol}://${N.authority}${N.path}${V}`}(C)}setTransformRequest(n){this._transformRequestFn=n}}const Gn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function yi(w){var n=new x.ARRAY_TYPE(3);return n[0]=w[0],n[1]=w[1],n[2]=w[2],n}var vi,Vt=function(w,n,d){return w[0]=n[0]-d[0],w[1]=n[1]-d[1],w[2]=n[2]-d[2],w};vi=new x.ARRAY_TYPE(3),x.ARRAY_TYPE!=Float32Array&&(vi[0]=0,vi[1]=0,vi[2]=0);var Tt=function(w){var n=w[0],d=w[1];return n*n+d*d};function wt(w){const n=[];if("string"==typeof w)n.push({id:"default",url:w});else if(w&&w.length>0){const d=[];for(const{id:y,url:C}of w){const N=`${y}${C}`;-1===d.indexOf(N)&&(d.push(N),n.push({id:y,url:C}))}}return n}function Et(w,n,d,y,C){if(y)return void w(y);if(C!==Object.values(n).length||C!==Object.values(d).length)return;const N={};for(const V in n){N[V]={};const Z=x.exported.getImageCanvasContext(d[V]),Y=n[V];for(const X in Y){const{width:le,height:ae,x:De,y:ze,sdf:ke,pixelRatio:R,stretchX:k,stretchY:O,content:z}=Y[X];N[V][X]={data:null,pixelRatio:R,sdf:ke,stretchX:k,stretchY:O,content:z,spriteData:{width:le,height:ae,x:De,y:ze,context:Z}}}}w(null,N)}!function(){var w=new x.ARRAY_TYPE(2);x.ARRAY_TYPE!=Float32Array&&(w[0]=0,w[1]=0)}();class Bt{constructor(n,d,y,C){this.context=n,this.format=y,this.texture=n.gl.createTexture(),this.update(d,C)}update(n,d,y){const{width:C,height:N}=n,V=!(this.size&&this.size[0]===C&&this.size[1]===N||y),{context:Z}=this,{gl:Y}=Z;if(this.useMipmap=!(!d||!d.useMipmap),Y.bindTexture(Y.TEXTURE_2D,this.texture),Z.pixelStoreUnpackFlipY.set(!1),Z.pixelStoreUnpack.set(1),Z.pixelStoreUnpackPremultiplyAlpha.set(this.format===Y.RGBA&&(!d||!1!==d.premultiply)),V)this.size=[C,N],n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||x.isImageBitmap(n)?Y.texImage2D(Y.TEXTURE_2D,0,this.format,this.format,Y.UNSIGNED_BYTE,n):Y.texImage2D(Y.TEXTURE_2D,0,this.format,C,N,0,this.format,Y.UNSIGNED_BYTE,n.data);else{const{x:X,y:le}=y||{x:0,y:0};n instanceof HTMLImageElement||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement||n instanceof ImageData||x.isImageBitmap(n)?Y.texSubImage2D(Y.TEXTURE_2D,0,X,le,Y.RGBA,Y.UNSIGNED_BYTE,n):Y.texSubImage2D(Y.TEXTURE_2D,0,X,le,C,N,Y.RGBA,Y.UNSIGNED_BYTE,n.data)}this.useMipmap&&this.isSizePowerOfTwo()&&Y.generateMipmap(Y.TEXTURE_2D)}bind(n,d,y){const{context:C}=this,{gl:N}=C;N.bindTexture(N.TEXTURE_2D,this.texture),y!==N.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(y=N.LINEAR),n!==this.filter&&(N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MAG_FILTER,n),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_MIN_FILTER,y||n),this.filter=n),d!==this.wrap&&(N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_S,d),N.texParameteri(N.TEXTURE_2D,N.TEXTURE_WRAP_T,d),this.wrap=d)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}function lt(w){const{userImage:n}=w;return!!(n&&n.render&&n.render())&&(w.data.replace(new Uint8Array(n.data.buffer)),!0)}class zt extends x.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new x.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:d,callback:y}of this.requestors)this._notify(d,y);this.requestors=[]}}getImage(n){const d=this.images[n];if(d&&!d.data&&d.spriteData){const y=d.spriteData;d.data=new x.RGBAImage({width:y.width,height:y.height},y.context.getImageData(y.x,y.y,y.width,y.height).data),d.spriteData=null}return d}addImage(n,d){if(this.images[n])throw new Error(`Image id ${n} already exist, use updateImage instead`);this._validate(n,d)&&(this.images[n]=d)}_validate(n,d){let y=!0;const C=d.data||d.spriteData;return this._validateStretch(d.stretchX,C&&C.width)||(this.fire(new x.ErrorEvent(new Error(`Image "${n}" has invalid "stretchX" value`))),y=!1),this._validateStretch(d.stretchY,C&&C.height)||(this.fire(new x.ErrorEvent(new Error(`Image "${n}" has invalid "stretchY" value`))),y=!1),this._validateContent(d.content,d)||(this.fire(new x.ErrorEvent(new Error(`Image "${n}" has invalid "content" value`))),y=!1),y}_validateStretch(n,d){if(!n)return!0;let y=0;for(const C of n){if(C[0]<y||C[1]<C[0]||d<C[1])return!1;y=C[1]}return!0}_validateContent(n,d){if(!n)return!0;if(4!==n.length)return!1;const y=d.spriteData,C=y&&y.width||d.data.width,N=y&&y.height||d.data.height;return!(n[0]<0||C<n[0]||n[1]<0||N<n[1]||n[2]<0||C<n[2]||n[3]<0||N<n[3]||n[2]<n[0]||n[3]<n[1])}updateImage(n,d,y=!0){const C=this.getImage(n);if(y&&(C.data.width!==d.data.width||C.data.height!==d.data.height))throw new Error(`size mismatch between old image (${C.data.width}x${C.data.height}) and new image (${d.data.width}x${d.data.height}).`);d.version=C.version+1,this.images[n]=d,this.updatedImages[n]=!0}removeImage(n){const d=this.images[n];delete this.images[n],delete this.patterns[n],d.userImage&&d.userImage.onRemove&&d.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n,d){let y=!0;if(!this.isLoaded())for(const C of n)this.images[C]||(y=!1);this.isLoaded()||y?this._notify(n,d):this.requestors.push({ids:n,callback:d})}_notify(n,d){const y={};for(const C of n){let N=this.getImage(C);N||(this.fire(new x.Event("styleimagemissing",{id:C})),N=this.getImage(C)),N?y[C]={data:N.data.clone(),pixelRatio:N.pixelRatio,sdf:N.sdf,version:N.version,stretchX:N.stretchX,stretchY:N.stretchY,content:N.content,hasRenderCallback:!(!N.userImage||!N.userImage.render)}:x.warnOnce(`Image "${C}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}d(null,y)}getPixelSize(){const{width:n,height:d}=this.atlasImage;return{width:n,height:d}}getPattern(n){const d=this.patterns[n],y=this.getImage(n);if(!y)return null;if(d&&d.position.version===y.version)return d.position;if(d)d.position.version=y.version;else{const C={w:y.data.width+2,h:y.data.height+2,x:0,y:0},N=new x.ImagePosition(C,y);this.patterns[n]={bin:C,position:N}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const d=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Bt(n,this.atlasImage,d.RGBA),this.atlasTexture.bind(d.LINEAR,d.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const N in this.patterns)n.push(this.patterns[N].bin);const{w:d,h:y}=x.potpack(n),C=this.atlasImage;C.resize({width:d||1,height:y||1});for(const N in this.patterns){const{bin:V}=this.patterns[N],Z=V.x+1,Y=V.y+1,X=this.getImage(N).data,le=X.width,ae=X.height;x.RGBAImage.copy(X,C,{x:0,y:0},{x:Z,y:Y},{width:le,height:ae}),x.RGBAImage.copy(X,C,{x:0,y:ae-1},{x:Z,y:Y-1},{width:le,height:1}),x.RGBAImage.copy(X,C,{x:0,y:0},{x:Z,y:Y+ae},{width:le,height:1}),x.RGBAImage.copy(X,C,{x:le-1,y:0},{x:Z-1,y:Y},{width:1,height:ae}),x.RGBAImage.copy(X,C,{x:0,y:0},{x:Z+le,y:Y},{width:1,height:ae})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const d of n){if(this.callbackDispatchedThisFrame[d])continue;this.callbackDispatchedThisFrame[d]=!0;const y=this.getImage(d);y||x.warnOnce(`Image with ID: "${d}" was not found`),lt(y)&&this.updateImage(d,y)}}}const nt=1e20;function xt(w,n,d,y,C,N,V,Z,Y){for(let X=n;X<n+y;X++)bn(w,d*N+X,N,C,V,Z,Y);for(let X=d;X<d+C;X++)bn(w,X*N+n,1,y,V,Z,Y)}function bn(w,n,d,y,C,N,V){N[0]=0,V[0]=-nt,V[1]=nt,C[0]=w[n];for(let Z=1,Y=0,X=0;Z<y;Z++){C[Z]=w[n+Z*d];const le=Z*Z;do{const ae=N[Y];X=(C[Z]-C[ae]+le-ae*ae)/(Z-ae)/2}while(X<=V[Y]&&--Y>-1);Y++,N[Y]=Z,V[Y]=X,V[Y+1]=nt}for(let Z=0,Y=0;Z<y;Z++){for(;V[Y+1]<Z;)Y++;const X=N[Y],le=Z-X;w[n+Z*d]=C[X]+le*le}}class en{constructor(n,d){this.requestManager=n,this.localIdeographFontFamily=d,this.entries={}}setURL(n){this.url=n}getGlyphs(n,d){const y=[];for(const C in n)for(const N of n[C])y.push({stack:C,id:N});x.asyncAll(y,({stack:C,id:N},V)=>{let Z=this.entries[C];Z||(Z=this.entries[C]={glyphs:{},requests:{},ranges:{}});let Y=Z.glyphs[N];if(void 0!==Y)return void V(null,{stack:C,id:N,glyph:Y});if(Y=this._tinySDF(Z,C,N),Y)return Z.glyphs[N]=Y,void V(null,{stack:C,id:N,glyph:Y});const X=Math.floor(N/256);if(256*X>65535)return void V(new Error("glyphs > 65535 not supported"));if(Z.ranges[X])return void V(null,{stack:C,id:N,glyph:Y});if(!this.url)return void V(new Error("glyphsUrl is not set"));let le=Z.requests[X];le||(le=Z.requests[X]=[],en.loadGlyphRange(C,X,this.url,this.requestManager,(ae,De)=>{if(De){for(const ze in De)this._doesCharSupportLocalGlyph(+ze)||(Z.glyphs[+ze]=De[+ze]);Z.ranges[X]=!0}for(const ze of le)ze(ae,De);delete Z.requests[X]})),le.push((ae,De)=>{ae?V(ae):De&&V(null,{stack:C,id:N,glyph:De[N]||null})})},(C,N)=>{if(C)d(C);else if(N){const V={};for(const{stack:Z,id:Y,glyph:X}of N)(V[Z]||(V[Z]={}))[Y]=X&&{id:X.id,bitmap:X.bitmap.clone(),metrics:X.metrics};d(null,V)}})}_doesCharSupportLocalGlyph(n){return!!this.localIdeographFontFamily&&(x.unicodeBlockLookup["CJK Unified Ideographs"](n)||x.unicodeBlockLookup["Hangul Syllables"](n)||x.unicodeBlockLookup.Hiragana(n)||x.unicodeBlockLookup.Katakana(n))}_tinySDF(n,d,y){const C=this.localIdeographFontFamily;if(!C||!this._doesCharSupportLocalGlyph(y))return;let N=n.tinySDF;if(!N){let Z="400";/bold/i.test(d)?Z="900":/medium/i.test(d)?Z="500":/light/i.test(d)&&(Z="200"),N=n.tinySDF=new en.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:C,fontWeight:Z})}const V=N.draw(String.fromCharCode(y));return{id:y,bitmap:new x.AlphaImage({width:V.width||30,height:V.height||30},V.data),metrics:{width:V.glyphWidth||24,height:V.glyphHeight||24,left:V.glyphLeft||0,top:V.glyphTop-27||-8,advance:V.glyphAdvance||24}}}}en.loadGlyphRange=function(w,n,d,y,C){const N=256*n,V=N+255,Z=y.transformRequest(d.replace("{fontstack}",w).replace("{range}",`${N}-${V}`),dt.Glyphs);x.getArrayBuffer(Z,(Y,X)=>{if(Y)C(Y);else if(X){const le={};for(const ae of x.parseGlyphPbf(X))le[ae.id]=ae;C(null,le)}})},en.TinySDF=class{constructor({fontSize:w=24,buffer:n=3,radius:d=8,cutoff:y=.25,fontFamily:C="sans-serif",fontWeight:N="normal",fontStyle:V="normal"}={}){this.buffer=n,this.cutoff=y,this.radius=d;const Z=this.size=w+4*n,Y=this._createCanvas(Z),X=this.ctx=Y.getContext("2d",{willReadFrequently:!0});X.font=`${V} ${N} ${w}px ${C}`,X.textBaseline="alphabetic",X.textAlign="left",X.fillStyle="black",this.gridOuter=new Float64Array(Z*Z),this.gridInner=new Float64Array(Z*Z),this.f=new Float64Array(Z),this.z=new Float64Array(Z+1),this.v=new Uint16Array(Z)}_createCanvas(w){const n=document.createElement("canvas");return n.width=n.height=w,n}draw(w){const{width:n,actualBoundingBoxAscent:d,actualBoundingBoxDescent:y,actualBoundingBoxLeft:C,actualBoundingBoxRight:N}=this.ctx.measureText(w),V=Math.ceil(d),Z=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(N-C))),Y=Math.min(this.size-this.buffer,V+Math.ceil(y)),X=Z+2*this.buffer,le=Y+2*this.buffer,ae=Math.max(X*le,0),De=new Uint8ClampedArray(ae),ze={data:De,width:X,height:le,glyphWidth:Z,glyphHeight:Y,glyphTop:V,glyphLeft:0,glyphAdvance:n};if(0===Z||0===Y)return ze;const{ctx:ke,buffer:R,gridInner:k,gridOuter:O}=this;ke.clearRect(R,R,Z,Y),ke.fillText(w,R,R+V);const z=ke.getImageData(R,R,Z,Y);O.fill(nt,0,ae),k.fill(0,0,ae);for(let W=0;W<Y;W++)for(let ie=0;ie<Z;ie++){const ue=z.data[4*(W*Z+ie)+3]/255;if(0===ue)continue;const Ne=(W+R)*X+ie+R;if(1===ue)O[Ne]=0,k[Ne]=nt;else{const et=.5-ue;O[Ne]=et>0?et*et:0,k[Ne]=et<0?et*et:0}}xt(O,0,0,X,le,X,this.f,this.v,this.z),xt(k,R,R,Z,Y,X,this.f,this.v,this.z);for(let W=0;W<ae;W++){const ie=Math.sqrt(O[W])-Math.sqrt(k[W]);De[W]=Math.round(255-255*(ie/this.radius+this.cutoff))}return ze}};class ui{constructor(){this.specification=x.v8Spec.light.position}possiblyEvaluate(n,d){return x.sphericalToCartesian(n.expression.evaluate(d))}interpolate(n,d,y){return{x:x.interpolate.number(n.x,d.x,y),y:x.interpolate.number(n.y,d.y,y),z:x.interpolate.number(n.z,d.z,y)}}}let Jt,Pn;class Mi extends x.Evented{constructor(n){super(),Jt=Jt||new x.Properties({anchor:new x.DataConstantProperty(x.v8Spec.light.anchor),position:new ui,color:new x.DataConstantProperty(x.v8Spec.light.color),intensity:new x.DataConstantProperty(x.v8Spec.light.intensity)}),this._transitionable=new x.Transitionable(Jt),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,d={}){if(!this._validate(x.validateLight,n,d))for(const y in n){const C=n[y];y.endsWith("-transition")?this._transitionable.setTransition(y.slice(0,-11),C):this._transitionable.setValue(y,C)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,d,y){return(!y||!1!==y.validate)&&x.emitValidationErrors(this,n.call(x.validateStyle,x.extend({value:d,style:{glyphs:!0,sprite:!0},styleSpec:x.v8Spec})))}}class bi{constructor(n,d){this.width=n,this.height=d,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(n,d){const y=n.join(",")+String(d);return this.dashEntry[y]||(this.dashEntry[y]=this.addDash(n,d)),this.dashEntry[y]}getDashRanges(n,d,y){const C=[];let N=n.length%2==1?-n[n.length-1]*y:0,V=n[0]*y,Z=!0;C.push({left:N,right:V,isDash:Z,zeroLength:0===n[0]});let Y=n[0];for(let X=1;X<n.length;X++){Z=!Z;const le=n[X];N=Y*y,Y+=le,V=Y*y,C.push({left:N,right:V,isDash:Z,zeroLength:0===le})}return C}addRoundDash(n,d,y){const C=d/2;for(let N=-y;N<=y;N++){const V=this.width*(this.nextRow+y+N);let Z=0,Y=n[Z];for(let X=0;X<this.width;X++){X/Y.right>1&&(Y=n[++Z]);const le=Math.abs(X-Y.left),ae=Math.abs(X-Y.right),De=Math.min(le,ae);let ze;const ke=N/y*(C+1);if(Y.isDash){const R=C-Math.abs(ke);ze=Math.sqrt(De*De+R*R)}else ze=C-Math.sqrt(De*De+ke*ke);this.data[V+X]=Math.max(0,Math.min(255,ze+128))}}}addRegularDash(n){for(let Z=n.length-1;Z>=0;--Z){const Y=n[Z],X=n[Z+1];Y.zeroLength?n.splice(Z,1):X&&X.isDash===Y.isDash&&(X.left=Y.left,n.splice(Z,1))}const d=n[0],y=n[n.length-1];d.isDash===y.isDash&&(d.left=y.left-this.width,y.right=d.right+this.width);const C=this.width*this.nextRow;let N=0,V=n[N];for(let Z=0;Z<this.width;Z++){Z/V.right>1&&(V=n[++N]);const Y=Math.abs(Z-V.left),X=Math.abs(Z-V.right),le=Math.min(Y,X);this.data[C+Z]=Math.max(0,Math.min(255,(V.isDash?le:-le)+128))}}addDash(n,d){const y=d?7:0,C=2*y+1;if(this.nextRow+C>this.height)return x.warnOnce("LineAtlas out of space"),null;let N=0;for(let Z=0;Z<n.length;Z++)N+=n[Z];if(0!==N){const Z=this.width/N,Y=this.getDashRanges(n,this.width,Z);d?this.addRoundDash(Y,Z,y):this.addRegularDash(Y)}const V={y:(this.nextRow+y+.5)/this.height,height:2*y/this.height,width:N};return this.nextRow+=C,this.dirty=!0,V}bind(n){const d=n.gl;this.texture?(d.bindTexture(d.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,d.texSubImage2D(d.TEXTURE_2D,0,0,0,this.width,this.height,d.ALPHA,d.UNSIGNED_BYTE,this.data))):(this.texture=d.createTexture(),d.bindTexture(d.TEXTURE_2D,this.texture),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.REPEAT),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texImage2D(d.TEXTURE_2D,0,d.ALPHA,this.width,this.height,0,d.ALPHA,d.UNSIGNED_BYTE,this.data))}}class ft{constructor(n,d,y){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=y;const C=this.workerPool.acquire(y);for(let N=0;N<C.length;N++){const V=new ft.Actor(C[N],d,y);V.name=`Worker ${N}`,this.actors.push(V)}if(!this.actors.length)throw new Error("No actors found")}broadcast(n,d,y){x.asyncAll(this.actors,(C,N)=>{C.send(n,d,N)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(n=!0){this.actors.forEach(d=>{d.remove()}),this.actors=[],n&&this.workerPool.release(this.id)}}function ht(w,n,d){const y=function(C,N){if(C)return d(C);if(N){const V=x.pick(x.extend(N,w),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);N.vector_layers&&(V.vectorLayers=N.vector_layers,V.vectorLayerIds=V.vectorLayers.map(Z=>Z.id)),d(null,V)}};return w.url?x.getJSON(n.transformRequest(w.url,dt.Source),y):x.exported.frame(()=>y(null,w))}ft.Actor=x.Actor;class Pt{constructor(n,d){n&&(d?this.setSouthWest(n).setNorthEast(d):Array.isArray(n)&&(4===n.length?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1])))}setNorthEast(n){return this._ne=n instanceof x.LngLat?new x.LngLat(n.lng,n.lat):x.LngLat.convert(n),this}setSouthWest(n){return this._sw=n instanceof x.LngLat?new x.LngLat(n.lng,n.lat):x.LngLat.convert(n),this}extend(n){const d=this._sw,y=this._ne;let C,N;if(n instanceof x.LngLat)C=n,N=n;else{if(!(n instanceof Pt))return Array.isArray(n)?4===n.length||n.every(Array.isArray)?this.extend(Pt.convert(n)):this.extend(x.LngLat.convert(n)):n&&("lng"in n||"lon"in n)&&"lat"in n?this.extend(x.LngLat.convert(n)):this;if(C=n._sw,N=n._ne,!C||!N)return this}return d||y?(d.lng=Math.min(C.lng,d.lng),d.lat=Math.min(C.lat,d.lat),y.lng=Math.max(N.lng,y.lng),y.lat=Math.max(N.lat,y.lat)):(this._sw=new x.LngLat(C.lng,C.lat),this._ne=new x.LngLat(N.lng,N.lat)),this}getCenter(){return new x.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new x.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new x.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:d,lat:y}=x.LngLat.convert(n);let C=this._sw.lng<=d&&d<=this._ne.lng;return this._sw.lng>this._ne.lng&&(C=this._sw.lng>=d&&d>=this._ne.lng),this._sw.lat<=y&&y<=this._ne.lat&&C}static convert(n){return n instanceof Pt?n:n&&new Pt(n)}static fromLngLat(n,d=0){const y=360*d/40075017,C=y/Math.cos(Math.PI/180*n.lat);return new Pt(new x.LngLat(n.lng-C,n.lat-y),new x.LngLat(n.lng+C,n.lat+y))}}class Nt{constructor(n,d,y){this.bounds=Pt.convert(this.validateBounds(n)),this.minzoom=d||0,this.maxzoom=y||24}validateBounds(n){return Array.isArray(n)&&4===n.length?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const d=Math.pow(2,n.z),y=Math.floor(x.mercatorXfromLng(this.bounds.getWest())*d),C=Math.floor(x.mercatorYfromLat(this.bounds.getNorth())*d),N=Math.ceil(x.mercatorXfromLng(this.bounds.getEast())*d),V=Math.ceil(x.mercatorYfromLat(this.bounds.getSouth())*d);return n.x>=y&&n.x<N&&n.y>=C&&n.y<V}}class hn extends x.Evented{constructor(n,d,y,C){if(super(),this.id=n,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,x.extend(this,x.pick(d,["url","scheme","tileSize","promoteId"])),this._options=x.extend({type:"vector"},d),this._collectResourceTiming=d.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(C)}load(){this._loaded=!1,this.fire(new x.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ht(this._options,this.map._requestManager,(n,d)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),n?this.fire(new x.ErrorEvent(n)):d&&(x.extend(this,d),d.bounds&&(this.tileBounds=new Nt(d.bounds,this.minzoom,this.maxzoom)),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}setSourceProperty(n){this._tileJSONRequest&&this._tileJSONRequest.cancel(),n(),this.load()}setTiles(n){return this.setSourceProperty(()=>{this._options.tiles=n}),this}setUrl(n){return this.setSourceProperty(()=>{this.url=n,this._options.url=n}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return x.extend({},this._options)}loadTile(n,d){const y=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),C={request:this.map._requestManager.transformRequest(y,dt.Tile),uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function N(V,Z){return delete n.request,n.aborted?d(null):V&&404!==V.status?d(V):(Z&&Z.resourceTiming&&(n.resourceTiming=Z.resourceTiming),this.map._refreshExpiredTiles&&Z&&n.setExpiryData(Z),n.loadVectorData(Z,this.map.painter),d(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}C.request.collectResourceTiming=this._collectResourceTiming,n.actor&&"expired"!==n.state?"loading"===n.state?n.reloadCallback=d:n.request=n.actor.send("reloadTile",C,N.bind(this)):(n.actor=this.dispatcher.getActor(),n.request=n.actor.send("loadTile",C,N.bind(this)))}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id},void 0)}unloadTile(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class ln extends x.Evented{constructor(n,d,y,C){super(),this.id=n,this.dispatcher=y,this.setEventedParent(C),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=x.extend({type:"raster"},d),x.extend(this,x.pick(d,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new x.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ht(this._options,this.map._requestManager,(n,d)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new x.ErrorEvent(n)):d&&(x.extend(this,d),d.bounds&&(this.tileBounds=new Nt(d.bounds,this.minzoom,this.maxzoom)),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return x.extend({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,d){const y=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);n.request=nn.getImage(this.map._requestManager.transformRequest(y,dt.Tile),(C,N,V)=>{if(delete n.request,n.aborted)n.state="unloaded",d(null);else if(C)n.state="errored",d(C);else if(N){this.map._refreshExpiredTiles&&V&&n.setExpiryData(V);const Z=this.map.painter.context,Y=Z.gl;n.texture=this.map.painter.getTileTexture(N.width),n.texture?n.texture.update(N,{useMipmap:!0}):(n.texture=new Bt(Z,N,Y.RGBA,{useMipmap:!0}),n.texture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE,Y.LINEAR_MIPMAP_NEAREST),Z.extTextureFilterAnisotropic&&Y.texParameterf(Y.TEXTURE_2D,Z.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Z.extTextureFilterAnisotropicMax)),n.state="loaded",d(null)}},this.map._refreshExpiredTiles)}abortTile(n,d){n.request&&(n.request.cancel(),delete n.request),d()}unloadTile(n,d){n.texture&&this.map.painter.saveTileTexture(n.texture),d()}hasTransition(){return!1}}class oi extends ln{constructor(n,d,y,C){super(n,d,y,C),this.type="raster-dem",this.maxzoom=22,this._options=x.extend({type:"raster-dem"},d),this.encoding=d.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(n,d){const y=n.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function C(N,V){N&&(n.state="errored",d(N)),V&&(n.dem=V,n.needsHillshadePrepare=!0,n.needsTerrainPrepare=!0,n.state="loaded",d(null))}n.request=nn.getImage(this.map._requestManager.transformRequest(y,dt.Tile),function(N,V){if(delete n.request,n.aborted)n.state="unloaded",d(null);else if(N)n.state="errored",d(N);else if(V){this.map._refreshExpiredTiles&&n.setExpiryData(V),delete V.cacheControl,delete V.expires;const Z=x.isImageBitmap(V)&&(null==Pn&&(Pn=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),Pn)?V:x.exported.getImageData(V,1),Y={uid:n.uid,coord:n.tileID,source:this.id,rawImageData:Z,encoding:this.encoding};n.actor&&"expired"!==n.state||(n.actor=this.dispatcher.getActor(),n.actor.send("loadDEMTile",Y,C.bind(this)))}}.bind(this),this.map._refreshExpiredTiles),n.neighboringTiles=this._getNeighboringTiles(n.tileID)}_getNeighboringTiles(n){const d=n.canonical,y=Math.pow(2,d.z),C=(d.x-1+y)%y,N=0===d.x?n.wrap-1:n.wrap,V=(d.x+1+y)%y,Z=d.x+1===y?n.wrap+1:n.wrap,Y={};return Y[new x.OverscaledTileID(n.overscaledZ,N,d.z,C,d.y).key]={backfilled:!1},Y[new x.OverscaledTileID(n.overscaledZ,Z,d.z,V,d.y).key]={backfilled:!1},d.y>0&&(Y[new x.OverscaledTileID(n.overscaledZ,N,d.z,C,d.y-1).key]={backfilled:!1},Y[new x.OverscaledTileID(n.overscaledZ,n.wrap,d.z,d.x,d.y-1).key]={backfilled:!1},Y[new x.OverscaledTileID(n.overscaledZ,Z,d.z,V,d.y-1).key]={backfilled:!1}),d.y+1<y&&(Y[new x.OverscaledTileID(n.overscaledZ,N,d.z,C,d.y+1).key]={backfilled:!1},Y[new x.OverscaledTileID(n.overscaledZ,n.wrap,d.z,d.x,d.y+1).key]={backfilled:!1},Y[new x.OverscaledTileID(n.overscaledZ,Z,d.z,V,d.y+1).key]={backfilled:!1}),Y}unloadTile(n){n.demTexture&&this.map.painter.saveTileTexture(n.demTexture),n.fbo&&(n.fbo.destroy(),delete n.fbo),n.dem&&delete n.dem,delete n.neighboringTiles,n.state="unloaded",n.actor&&n.actor.send("removeDEMTile",{uid:n.uid,source:this.id})}}class mi extends x.Evented{constructor(n,d,y,C){super(),this.id=n,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=y.getActor(),this.setEventedParent(C),this._data=d.data,this._options=x.extend({},d),this._collectResourceTiming=d.collectResourceTiming,void 0!==d.maxzoom&&(this.maxzoom=d.maxzoom),d.type&&(this.type=d.type),d.attribution&&(this.attribution=d.attribution),this.promoteId=d.promoteId;const N=x.EXTENT/this.tileSize;this.workerOptions=x.extend({source:this.id,cluster:d.cluster||!1,geojsonVtOptions:{buffer:(void 0!==d.buffer?d.buffer:128)*N,tolerance:(void 0!==d.tolerance?d.tolerance:.375)*N,extent:x.EXTENT,maxZoom:this.maxzoom,lineMetrics:d.lineMetrics||!1,generateId:d.generateId||!1},superclusterOptions:{maxZoom:void 0!==d.clusterMaxZoom?d.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,d.clusterMinPoints||2),extent:x.EXTENT,radius:(d.clusterRadius||50)*N,log:!1,generateId:d.generateId||!1},clusterProperties:d.clusterProperties,filter:d.filter},d.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}load(){this._updateWorkerData()}onAdd(n){this.map=n,this.load()}setData(n){return this._data=n,this._updateWorkerData(),this}updateData(n){return this._updateWorkerData(n),this}setClusterOptions(n){return this.workerOptions.cluster=n.cluster,n&&(void 0!==n.clusterRadius&&(this.workerOptions.superclusterOptions.radius=n.clusterRadius),void 0!==n.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=n.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(n,d){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:n,source:this.id},d),this}getClusterChildren(n,d){return this.actor.send("geojson.getClusterChildren",{clusterId:n,source:this.id},d),this}getClusterLeaves(n,d,y,C){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:n,limit:d,offset:y},C),this}_updateWorkerData(n){const d=x.extend({},this.workerOptions);n?d.dataDiff=n:"string"==typeof this._data?(d.request=this.map._requestManager.transformRequest(x.exported.resolveURL(this._data),dt.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new x.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,d,(y,C)=>{if(this._pendingLoads--,this._removed||C&&C.abandoned)return void this.fire(new x.Event("dataabort",{dataType:"source"}));let N=null;if(C&&C.resourceTiming&&C.resourceTiming[this.id]&&(N=C.resourceTiming[this.id].slice(0)),y)return void this.fire(new x.ErrorEvent(y));const V={dataType:"source"};this._collectResourceTiming&&N&&N.length>0&&x.extend(V,{resourceTiming:N}),this.fire(new x.Event("data",{...V,sourceDataType:"metadata"})),this.fire(new x.Event("data",{...V,sourceDataType:"content"}))})}loaded(){return 0===this._pendingLoads}loadTile(n,d){const y=n.actor?"reloadTile":"loadTile";n.actor=this.actor;const C={type:this.type,uid:n.uid,tileID:n.tileID,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};n.request=this.actor.send(y,C,(N,V)=>(delete n.request,n.unloadVectorData(),n.aborted?d(null):N?d(N):(n.loadVectorData(V,this.map.painter,"reloadTile"===y),d(null))))}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.aborted=!0}unloadTile(n){n.unloadVectorData(),this.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return x.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var zi=x.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class di extends x.Evented{constructor(n,d,y,C){super(),this.id=n,this.dispatcher=y,this.coordinates=d.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(C),this.options=d}load(n,d){this._loaded=!1,this.fire(new x.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=nn.getImage(this.map._requestManager.transformRequest(this.url,dt.Image),(y,C)=>{this._request=null,this._loaded=!0,y?this.fire(new x.ErrorEvent(y)):C&&(this.image=C,n&&(this.coordinates=n),d&&d(),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return n.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=n.url,this.load(n.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(n){this.coordinates=n;const d=n.map(x.MercatorCoordinate.fromLngLat);this.tileID=function(C){let N=1/0,V=1/0,Z=-1/0,Y=-1/0;for(const De of C)N=Math.min(N,De.x),V=Math.min(V,De.y),Z=Math.max(Z,De.x),Y=Math.max(Y,De.y);const X=Math.max(Z-N,Y-V),le=Math.max(0,Math.floor(-Math.log(X)/Math.LN2)),ae=Math.pow(2,le);return new x.CanonicalTileID(le,Math.floor((N+Z)/2*ae),Math.floor((V+Y)/2*ae))}(d),this.minzoom=this.maxzoom=this.tileID.z;const y=d.map(C=>this.tileID.getTilePoint(C)._round());return this._boundsArray=new x.RasterBoundsArray,this._boundsArray.emplaceBack(y[0].x,y[0].y,0,0),this._boundsArray.emplaceBack(y[1].x,y[1].y,x.EXTENT,0),this._boundsArray.emplaceBack(y[3].x,y[3].y,0,x.EXTENT),this._boundsArray.emplaceBack(y[2].x,y[2].y,x.EXTENT,x.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new x.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const n=this.map.painter.context,d=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,zi.members)),this.boundsSegments||(this.boundsSegments=x.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Bt(n,this.image,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let y=!1;for(const C in this.tiles){const N=this.tiles[C];"loaded"!==N.state&&(N.state="loaded",N.texture=this.texture,y=!0)}y&&this.fire(new x.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(n,d){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},d(null)):(n.state="errored",d(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class Si extends di{constructor(n,d,y,C){super(n,d,y,C),this.roundZoom=!0,this.type="video",this.options=d}load(){this._loaded=!1;const n=this.options;this.urls=[];for(const d of n.urls)this.urls.push(this.map._requestManager.transformRequest(d,dt.Source).url);x.getVideo(this.urls,(d,y)=>{this._loaded=!0,d?this.fire(new x.ErrorEvent(d)):y&&(this.video=y,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(n){if(this.video){const d=this.video.seekable;n<d.start(0)||n>d.end(0)?this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${d.start(0)} and ${d.end(0)}-second mark.`))):this.video.currentTime=n}}getVideo(){return this.video}onAdd(n){this.map||(this.map=n,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const n=this.map.painter.context,d=n.gl;this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,zi.members)),this.boundsSegments||(this.boundsSegments=x.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE),d.texSubImage2D(d.TEXTURE_2D,0,0,0,d.RGBA,d.UNSIGNED_BYTE,this.video)):(this.texture=new Bt(n,this.video,d.RGBA),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE));let y=!1;for(const C in this.tiles){const N=this.tiles[C];"loaded"!==N.state&&(N.state="loaded",N.texture=this.texture,y=!0)}y&&this.fire(new x.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class st extends di{constructor(n,d,y,C){super(n,d,y,C),d.coordinates?Array.isArray(d.coordinates)&&4===d.coordinates.length&&!d.coordinates.some(N=>!Array.isArray(N)||2!==N.length||N.some(V=>"number"!=typeof V))||this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${n}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${n}`,null,'missing required property "coordinates"'))),d.animate&&"boolean"!=typeof d.animate&&this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${n}`,null,'optional "animate" property must be a boolean value'))),d.canvas?"string"==typeof d.canvas||d.canvas instanceof HTMLCanvasElement||this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${n}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new x.ErrorEvent(new x.ValidationError(`sources.${n}`,null,'missing required property "canvas"'))),this.options=d,this.animate=void 0===d.animate||d.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new x.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(n){this.map=n,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let n=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,n=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,n=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const d=this.map.painter.context,y=d.gl;this.boundsBuffer||(this.boundsBuffer=d.createVertexBuffer(this._boundsArray,zi.members)),this.boundsSegments||(this.boundsSegments=x.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(n||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Bt(d,this.canvas,y.RGBA,{premultiply:!0});let C=!1;for(const N in this.tiles){const V=this.tiles[N];"loaded"!==V.state&&(V.state="loaded",V.texture=this.texture,C=!0)}C&&this.fire(new x.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const n of[this.canvas.width,this.canvas.height])if(isNaN(n)||n<=0)return!0;return!1}}const Ci={vector:hn,raster:ln,"raster-dem":oi,geojson:mi,video:Si,image:di,canvas:st};function er(w,n){const d=x.create();return x.translate(d,d,[1,1,0]),x.scale(d,d,[.5*w.width,.5*w.height,1]),x.multiply(d,d,w.calculatePosMatrix(n.toUnwrapped()))}function Mn(w,n,d,y,C,N){const V=function(ae,De,ze){if(ae)for(const ke of ae){const R=De[ke];if(R&&R.source===ze&&"fill-extrusion"===R.type)return!0}else for(const ke in De){const R=De[ke];if(R.source===ze&&"fill-extrusion"===R.type)return!0}return!1}(C&&C.layers,n,w.id),Z=N.maxPitchScaleFactor(),Y=w.tilesIn(y,Z,V);Y.sort(An);const X=[];for(const ae of Y)X.push({wrappedTileID:ae.tileID.wrapped().key,queryResults:ae.tile.queryRenderedFeatures(n,d,w._state,ae.queryGeometry,ae.cameraQueryGeometry,ae.scale,C,N,Z,er(w.transform,ae.tileID))});const le=function(ae){const De={},ze={};for(const ke of ae){const R=ke.queryResults,k=ke.wrappedTileID,O=ze[k]=ze[k]||{};for(const z in R){const W=R[z],ie=O[z]=O[z]||{},ue=De[z]=De[z]||[];for(const Ne of W)ie[Ne.featureIndex]||(ie[Ne.featureIndex]=!0,ue.push(Ne))}}return De}(X);for(const ae in le)le[ae].forEach(De=>{const ze=De.feature,ke=w.getFeatureState(ze.layer["source-layer"],ze.id);ze.source=ze.layer.source,ze.layer["source-layer"]&&(ze.sourceLayer=ze.layer["source-layer"]),ze.state=ke});return le}function An(w,n){const d=w.tileID,y=n.tileID;return d.overscaledZ-y.overscaledZ||d.canonical.y-y.canonical.y||d.wrap-y.wrap||d.canonical.x-y.canonical.x}class mt{constructor(n,d){this.timeAdded=0,this.fadeEndTime=0,this.tileID=n,this.uid=x.uniqueId(),this.uses=0,this.tileSize=d,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(n){const d=n+this.timeAdded;d<this.fadeEndTime||(this.fadeEndTime=d)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(n){this.demTexture&&n.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(n,d,y){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=function(C,N){const V={};if(!N)return V;for(const Z of C){const Y=Z.layerIds.map(X=>N.getLayer(X)).filter(Boolean);if(0!==Y.length){Z.layers=Y,Z.stateDependentLayerIds&&(Z.stateDependentLayers=Z.stateDependentLayerIds.map(X=>Y.filter(le=>le.id===X)[0]));for(const X of Y)V[X.id]=Z}}return V}(n.buckets,d.style),this.hasSymbolBuckets=!1;for(const C in this.buckets){const N=this.buckets[C];if(N instanceof x.SymbolBucket){if(this.hasSymbolBuckets=!0,!y)break;N.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const C in this.buckets){const N=this.buckets[C];if(N instanceof x.SymbolBucket&&N.hasRTLText){this.hasRTLText=!0,x.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const C in this.buckets){const N=this.buckets[C];this.queryPadding=Math.max(this.queryPadding,d.style.getLayer(C).queryRadius(N))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage)}else this.collisionBoxArray=new x.CollisionBoxArray}unloadVectorData(){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(n){return this.buckets[n.id]}upload(n){for(const y in this.buckets){const C=this.buckets[y];C.uploadPending()&&C.upload(n)}const d=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Bt(n,this.imageAtlas.image,d.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Bt(n,this.glyphAtlasImage,d.ALPHA),this.glyphAtlasImage=null)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,d,y,C,N,V,Z,Y,X,le){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:C,cameraQueryGeometry:N,scale:V,tileSize:this.tileSize,pixelPosMatrix:le,transform:Y,params:Z,queryPadding:this.queryPadding*X},n,d,y):{}}querySourceFeatures(n,d){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const C=y.loadVTLayers(),N=d&&d.sourceLayer?d.sourceLayer:"",V=C._geojsonTileLayer||C[N];if(!V)return;const Z=x.createFilter(d&&d.filter),{z:Y,x:X,y:le}=this.tileID.canonical,ae={z:Y,x:X,y:le};for(let De=0;De<V.length;De++){const ze=V.feature(De);if(Z.needGeometry){const k=x.toEvaluationFeature(ze,!0);if(!Z.filter(new x.EvaluationParameters(this.tileID.overscaledZ),k,this.tileID.canonical))continue}else if(!Z.filter(new x.EvaluationParameters(this.tileID.overscaledZ),ze))continue;const ke=y.getId(ze,N),R=new x.GeoJSONFeature(ze,Y,X,le,ke);R.tile=ae,n.push(R)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const d=this.expirationTime;if(n.cacheControl){const y=x.parseCacheControl(n.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const y=Date.now();let C=!1;if(this.expirationTime>y)C=!1;else if(d)if(this.expirationTime<d)C=!0;else{const N=this.expirationTime-d;N?this.expirationTime=y+Math.max(N,3e4):C=!0}else C=!0;C?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(n,d){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(n).length)return;const y=this.latestFeatureIndex.loadVTLayers();for(const C in this.buckets){if(!d.style.hasLayer(C))continue;const N=this.buckets[C],V=N.layers[0].sourceLayer||"_geojsonTileLayer",Z=y[V],Y=n[V];if(!Z||!Y||0===Object.keys(Y).length)continue;N.update(Y,Z,this.imageAtlas&&this.imageAtlas.patternPositions||{});const X=d&&d.style&&d.style.getLayer(C);X&&(this.queryPadding=Math.max(this.queryPadding,X.queryRadius(N)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<x.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=x.exported.now()+n}setDependencies(n,d){const y={};for(const C of d)y[C]=!0;this.dependencies[n]=y}hasDependency(n,d){for(const y of n){const C=this.dependencies[y];if(C)for(const N of d)if(C[N])return!0}return!1}}class We{constructor(n,d){this.max=n,this.onRemove=d,this.reset()}reset(){for(const n in this.data)for(const d of this.data[n])d.timeout&&clearTimeout(d.timeout),this.onRemove(d.value);return this.data={},this.order=[],this}add(n,d,y){const C=n.wrapped().key;void 0===this.data[C]&&(this.data[C]=[]);const N={value:d,timeout:void 0};if(void 0!==y&&(N.timeout=setTimeout(()=>{this.remove(n,N)},y)),this.data[C].push(N),this.order.push(C),this.order.length>this.max){const V=this._getAndRemoveByKey(this.order[0]);V&&this.onRemove(V)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const d=this.data[n].shift();return d.timeout&&clearTimeout(d.timeout),0===this.data[n].length&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),d.value}getByKey(n){const d=this.data[n];return d?d[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,d){if(!this.has(n))return this;const y=n.wrapped().key,C=void 0===d?0:this.data[y].indexOf(d),N=this.data[y][C];return this.data[y].splice(C,1),N.timeout&&clearTimeout(N.timeout),0===this.data[y].length&&delete this.data[y],this.onRemove(N.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const d=this._getAndRemoveByKey(this.order[0]);d&&this.onRemove(d)}return this}filter(n){const d=[];for(const y in this.data)for(const C of this.data[y])n(C.value)||d.push(C);for(const y of d)this.remove(y.value.tileID,y)}}class Ot{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,d,y){const C=String(d);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][C]=this.stateChanges[n][C]||{},x.extend(this.stateChanges[n][C],y),null===this.deletedStates[n]){this.deletedStates[n]={};for(const N in this.state[n])N!==C&&(this.deletedStates[n][N]=null)}else if(this.deletedStates[n]&&null===this.deletedStates[n][C]){this.deletedStates[n][C]={};for(const N in this.state[n][C])y[N]||(this.deletedStates[n][C][N]=null)}else for(const N in y)this.deletedStates[n]&&this.deletedStates[n][C]&&null===this.deletedStates[n][C][N]&&delete this.deletedStates[n][C][N]}removeFeatureState(n,d,y){if(null===this.deletedStates[n])return;const C=String(d);if(this.deletedStates[n]=this.deletedStates[n]||{},y&&void 0!==d)null!==this.deletedStates[n][C]&&(this.deletedStates[n][C]=this.deletedStates[n][C]||{},this.deletedStates[n][C][y]=null);else if(void 0!==d)if(this.stateChanges[n]&&this.stateChanges[n][C])for(y in this.deletedStates[n][C]={},this.stateChanges[n][C])this.deletedStates[n][C][y]=null;else this.deletedStates[n][C]=null;else this.deletedStates[n]=null}getState(n,d){const y=String(d),C=x.extend({},(this.state[n]||{})[y],(this.stateChanges[n]||{})[y]);if(null===this.deletedStates[n])return{};if(this.deletedStates[n]){const N=this.deletedStates[n][d];if(null===N)return{};for(const V in N)delete C[V]}return C}initializeTileState(n,d){n.setFeatureState(this.state,d)}coalesceChanges(n,d){const y={};for(const C in this.stateChanges){this.state[C]=this.state[C]||{};const N={};for(const V in this.stateChanges[C])this.state[C][V]||(this.state[C][V]={}),x.extend(this.state[C][V],this.stateChanges[C][V]),N[V]=this.state[C][V];y[C]=N}for(const C in this.deletedStates){this.state[C]=this.state[C]||{};const N={};if(null===this.deletedStates[C])for(const V in this.state[C])N[V]={},this.state[C][V]={};else for(const V in this.deletedStates[C]){if(null===this.deletedStates[C][V])this.state[C][V]={};else for(const Z of Object.keys(this.deletedStates[C][V]))delete this.state[C][V][Z];N[V]=this.state[C][V]}y[C]=y[C]||{},x.extend(y[C],N)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(y).length)for(const C in n)n[C].setFeatureState(y,d)}}class kt extends x.Evented{constructor(n,d,y){super(),this.id=n,this.dispatcher=y,this.on("data",C=>{"source"===C.dataType&&"metadata"===C.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===C.dataType&&"content"===C.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(C,N,V,Z){const Y=new Ci[N.type](C,N,V,Z);if(Y.id!==C)throw new Error(`Expected Source id to be ${C} instead of ${Y.id}`);return x.bindAll(["load","abort","unload","serialize","prepare"],Y),Y}(n,d,y,this),this._tiles={},this._cache=new We(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ot,this._didEmitContent=!1,this._updated=!1}onAdd(n){this.map=n,this._maxTileCacheSize=n?n._maxTileCacheSize:null,this._maxTileCacheZoomLevels=n?n._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(n)}onRemove(n){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(n)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const n in this._tiles){const d=this._tiles[n];if("loaded"!==d.state&&"errored"!==d.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(n,d){return this._source.loadTile(n,d)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n,()=>{})}_abortTile(n){this._source.abortTile&&this._source.abortTile(n,()=>{}),this._source.fire(new x.Event("dataabort",{tile:n,coord:n.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const d in this._tiles){const y=this._tiles[d];y.upload(n),y.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(n=>n.tileID).sort(gn).map(n=>n.key)}getRenderableIds(n){const d=[];for(const y in this._tiles)this._isIdRenderable(y,n)&&d.push(this._tiles[y]);return n?d.sort((y,C)=>{const N=y.tileID,V=C.tileID,Z=new x.Point(N.canonical.x,N.canonical.y)._rotate(this.transform.angle),Y=new x.Point(V.canonical.x,V.canonical.y)._rotate(this.transform.angle);return N.overscaledZ-V.overscaledZ||Y.y-Z.y||Y.x-Z.x}).map(y=>y.tileID.key):d.map(y=>y.tileID).sort(gn).map(y=>y.key)}hasRenderableParent(n){const d=this.findLoadedParent(n,0);return!!d&&this._isIdRenderable(d.tileID.key)}_isIdRenderable(n,d){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(d||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)"errored"!==this._tiles[n].state&&this._reloadTile(n,"reloading")}}_reloadTile(n,d){const y=this._tiles[n];y&&("loading"!==y.state&&(y.state=d),this._loadTile(y,this._tileLoaded.bind(this,y,n,d)))}_tileLoaded(n,d,y,C){if(C)return n.state="errored",void(404!==C.status?this._source.fire(new x.ErrorEvent(C,{tile:n})):this.update(this.transform,this.terrain));n.timeAdded=x.exported.now(),"expired"===y&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(d,n),"raster-dem"===this.getSource().type&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),n.aborted||this._source.fire(new x.Event("data",{dataType:"source",tile:n,coord:n.tileID}))}_backfillDEM(n){const d=this.getRenderableIds();for(let C=0;C<d.length;C++){const N=d[C];if(n.neighboringTiles&&n.neighboringTiles[N]){const V=this.getTileByID(N);y(n,V),y(V,n)}}function y(C,N){C.needsHillshadePrepare=!0,C.needsTerrainPrepare=!0;let V=N.tileID.canonical.x-C.tileID.canonical.x;const Z=N.tileID.canonical.y-C.tileID.canonical.y,Y=Math.pow(2,C.tileID.canonical.z),X=N.tileID.key;0===V&&0===Z||Math.abs(Z)>1||(Math.abs(V)>1&&(1===Math.abs(V+Y)?V+=Y:1===Math.abs(V-Y)&&(V-=Y)),N.dem&&C.dem&&(C.dem.backfillBorder(N.dem,V,Z),C.neighboringTiles&&C.neighboringTiles[X]&&(C.neighboringTiles[X].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,d,y,C){for(const N in this._tiles){let V=this._tiles[N];if(C[N]||!V.hasData()||V.tileID.overscaledZ<=d||V.tileID.overscaledZ>y)continue;let Z=V.tileID;for(;V&&V.tileID.overscaledZ>d+1;){const X=V.tileID.scaledTo(V.tileID.overscaledZ-1);V=this._tiles[X.key],V&&V.hasData()&&(Z=X)}let Y=Z;for(;Y.overscaledZ>d;)if(Y=Y.scaledTo(Y.overscaledZ-1),n[Y.key]){C[Z.key]=Z;break}}}findLoadedParent(n,d){if(n.key in this._loadedParentTiles){const y=this._loadedParentTiles[n.key];return y&&y.tileID.overscaledZ>=d?y:null}for(let y=n.overscaledZ-1;y>=d;y--){const C=n.scaledTo(y),N=this._getLoadedTile(C);if(N)return N}}_getLoadedTile(n){const d=this._tiles[n.key];return d&&d.hasData()?d:this._cache.getByKey(n.wrapped().key)}updateCacheSize(n){const d=Math.ceil(n.width/this._source.tileSize)+1,y=Math.ceil(n.height/this._source.tileSize)+1,C=Math.floor(d*y*(null===this._maxTileCacheZoomLevels?x.config.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),N="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(N)}handleWrapJump(n){const d=Math.round((n-(void 0===this._prevLng?n:this._prevLng))/360);if(this._prevLng=n,d){const y={};for(const C in this._tiles){const N=this._tiles[C];N.tileID=N.tileID.unwrapTo(N.tileID.wrap+d),y[N.tileID.key]=N}this._tiles=y;for(const C in this._timers)clearTimeout(this._timers[C]),delete this._timers[C];for(const C in this._tiles)this._setTileReloadTimer(C,this._tiles[C])}}update(n,d){if(this.transform=n,this.terrain=d,!this._sourceLoaded||this._paused)return;let y;this.updateCacheSize(n),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?y=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(le=>new x.OverscaledTileID(le.canonical.z,le.wrap,le.canonical.z,le.canonical.x,le.canonical.y)):(y=n.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:d}),this._source.hasTile&&(y=y.filter(le=>this._source.hasTile(le)))):y=[];const C=n.coveringZoomLevel(this._source),N=Math.max(C-kt.maxOverzooming,this._source.minzoom),V=Math.max(C+kt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const le={};for(const ae of y)if(ae.canonical.z>this._source.minzoom){const De=ae.scaledTo(ae.canonical.z-1);le[De.key]=De;const ze=ae.scaledTo(Math.max(this._source.minzoom,Math.min(ae.canonical.z,5)));le[ze.key]=ze}y=y.concat(Object.values(le))}const Z=0===y.length&&!this._updated&&this._didEmitContent;this._updated=!0,Z&&this.fire(new x.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const Y=this._updateRetainedTiles(y,C);if(Yt(this._source.type)){const le={},ae={},De=Object.keys(Y),ze=x.exported.now();for(const ke of De){const R=Y[ke],k=this._tiles[ke];if(!k||0!==k.fadeEndTime&&k.fadeEndTime<=ze)continue;const O=this.findLoadedParent(R,N);O&&(this._addTile(O.tileID),le[O.tileID.key]=O.tileID),ae[ke]=R}this._retainLoadedChildren(ae,C,V,Y);for(const ke in le)Y[ke]||(this._coveredTiles[ke]=!0,Y[ke]=le[ke]);if(d){const ke={},R={};for(const k of y)this._tiles[k.key].hasData()?ke[k.key]=k:R[k.key]=k;for(const k in R){const O=R[k].children(this._source.maxzoom);this._tiles[O[0].key]&&this._tiles[O[1].key]&&this._tiles[O[2].key]&&this._tiles[O[3].key]&&(ke[O[0].key]=Y[O[0].key]=O[0],ke[O[1].key]=Y[O[1].key]=O[1],ke[O[2].key]=Y[O[2].key]=O[2],ke[O[3].key]=Y[O[3].key]=O[3],delete R[k])}for(const k in R){const O=this.findLoadedParent(R[k],this._source.minzoom);if(O){ke[O.tileID.key]=Y[O.tileID.key]=O.tileID;for(const z in ke)ke[z].isChildOf(O.tileID)&&delete ke[z]}}for(const k in this._tiles)ke[k]||(this._coveredTiles[k]=!0)}}for(const le in Y)this._tiles[le].clearFadeHold();const X=x.keysDifference(this._tiles,Y);for(const le of X){const ae=this._tiles[le];ae.hasSymbolBuckets&&!ae.holdingForFade()?ae.setHoldDuration(this.map._fadeDuration):ae.hasSymbolBuckets&&!ae.symbolFadeFinished()||this._removeTile(le)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(n)}_updateRetainedTiles(n,d){const y={},C={},N=Math.max(d-kt.maxOverzooming,this._source.minzoom),V=Math.max(d+kt.maxUnderzooming,this._source.minzoom),Z={};for(const Y of n){const X=this._addTile(Y);y[Y.key]=Y,X.hasData()||d<this._source.maxzoom&&(Z[Y.key]=Y)}this._retainLoadedChildren(Z,d,V,y);for(const Y of n){let X=this._tiles[Y.key];if(X.hasData())continue;if(d+1>this._source.maxzoom){const ae=Y.children(this._source.maxzoom)[0],De=this.getTile(ae);if(De&&De.hasData()){y[ae.key]=ae;continue}}else{const ae=Y.children(this._source.maxzoom);if(y[ae[0].key]&&y[ae[1].key]&&y[ae[2].key]&&y[ae[3].key])continue}let le=X.wasRequested();for(let ae=Y.overscaledZ-1;ae>=N;--ae){const De=Y.scaledTo(ae);if(C[De.key])break;if(C[De.key]=!0,X=this.getTile(De),!X&&le&&(X=this._addTile(De)),X){const ze=X.hasData();if((le||ze)&&(y[De.key]=De),le=X.wasRequested(),ze)break}}}return y}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const d=[];let y,C=this._tiles[n].tileID;for(;C.overscaledZ>0;){if(C.key in this._loadedParentTiles){y=this._loadedParentTiles[C.key];break}d.push(C.key);const N=C.scaledTo(C.overscaledZ-1);if(y=this._getLoadedTile(N),y)break;C=N}for(const N of d)this._loadedParentTiles[N]=y}}_addTile(n){let d=this._tiles[n.key];if(d)return d;d=this._cache.getAndRemove(n),d&&(this._setTileReloadTimer(n.key,d),d.tileID=n,this._state.initializeTileState(d,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,d)));const y=d;return d||(d=new mt(n,this._source.tileSize*n.overscaleFactor()),this._loadTile(d,this._tileLoaded.bind(this,d,n.key,d.state))),d.uses++,this._tiles[n.key]=d,y||this._source.fire(new x.Event("dataloading",{tile:d,coord:d.tileID,dataType:"source"})),d}_setTileReloadTimer(n,d){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const y=d.getExpiryTimeout();y&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},y))}_removeTile(n){const d=this._tiles[n];d&&(d.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),d.uses>0||(d.hasData()&&"reloading"!==d.state?this._cache.add(d.tileID,d,d.getExpiryTimeout()):(d.aborted=!0,this._abortTile(d),this._unloadTile(d))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(n);this._cache.reset()}tilesIn(n,d,y){const C=[],N=this.transform;if(!N)return C;const V=y?N.getCameraQueryGeometry(n):n,Z=n.map(ke=>N.pointCoordinate(ke,this.terrain)),Y=V.map(ke=>N.pointCoordinate(ke,this.terrain)),X=this.getIds();let le=1/0,ae=1/0,De=-1/0,ze=-1/0;for(const ke of Y)le=Math.min(le,ke.x),ae=Math.min(ae,ke.y),De=Math.max(De,ke.x),ze=Math.max(ze,ke.y);for(let ke=0;ke<X.length;ke++){const R=this._tiles[X[ke]];if(R.holdingForFade())continue;const k=R.tileID,O=Math.pow(2,N.zoom-R.tileID.overscaledZ),z=d*R.queryPadding*x.EXTENT/R.tileSize/O,W=[k.getTilePoint(new x.MercatorCoordinate(le,ae)),k.getTilePoint(new x.MercatorCoordinate(De,ze))];if(W[0].x-z<x.EXTENT&&W[0].y-z<x.EXTENT&&W[1].x+z>=0&&W[1].y+z>=0){const ie=Z.map(Ne=>k.getTilePoint(Ne)),ue=Y.map(Ne=>k.getTilePoint(Ne));C.push({tile:R,tileID:k,queryGeometry:ie,cameraQueryGeometry:ue,scale:O})}}return C}getVisibleCoordinates(n){const d=this.getRenderableIds(n).map(y=>this._tiles[y].tileID);for(const y of d)y.posMatrix=this.transform.calculatePosMatrix(y.toUnwrapped());return d}hasTransition(){if(this._source.hasTransition())return!0;if(Yt(this._source.type)){const n=x.exported.now();for(const d in this._tiles)if(this._tiles[d].fadeEndTime>=n)return!0}return!1}setFeatureState(n,d,y){this._state.updateState(n=n||"_geojsonTileLayer",d,y)}removeFeatureState(n,d,y){this._state.removeFeatureState(n=n||"_geojsonTileLayer",d,y)}getFeatureState(n,d){return this._state.getState(n=n||"_geojsonTileLayer",d)}setDependencies(n,d,y){const C=this._tiles[n];C&&C.setDependencies(d,y)}reloadTilesForDependencies(n,d){for(const y in this._tiles)this._tiles[y].hasDependency(n,d)&&this._reloadTile(y,"reloading");this._cache.filter(y=>!y.hasDependency(n,d))}}function gn(w,n){const d=Math.abs(2*w.wrap)-+(w.wrap<0),y=Math.abs(2*n.wrap)-+(n.wrap<0);return w.overscaledZ-n.overscaledZ||y-d||n.canonical.y-w.canonical.y||n.canonical.x-w.canonical.x}function Yt(w){return"raster"===w||"image"===w||"video"===w}kt.maxOverzooming=10,kt.maxUnderzooming=3;const jn="mapboxgl_preloaded_worker_pool";class at{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<at.workerCount;)this.workers.push(new Worker(x.config.WORKER_URL));return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],0===this.numActive()&&(this.workers.forEach(d=>{d.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[jn]}numActive(){return Object.keys(this.active).length}}const qt=Math.floor(x.exported.hardwareConcurrency/2);let yn;function Kn(){return yn||(yn=new at),yn}at.workerCount=x.isSafari(globalThis)?Math.max(Math.min(qt,3),1):1;class qn{constructor(n,d){this.reset(n,d)}reset(n,d){this.points=n||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(d||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(1===this.points.length)return this.points[0];n=x.clamp(n,0,1);let d=1,y=this._distances[d];const C=n*this.paddedLength+this.padding;for(;y<C&&d<this._distances.length;)y=this._distances[++d];const N=d-1,V=this._distances[N],Z=y-V,Y=Z>0?(C-V)/Z:0;return this.points[N].mult(1-Y).add(this.points[d].mult(Y))}}function rn(w,n){let d=!0;return"always"===w||"never"!==w&&"never"!==n||(d=!1),d}class On{constructor(n,d,y){const C=this.boxCells=[],N=this.circleCells=[];this.xCellCount=Math.ceil(n/y),this.yCellCount=Math.ceil(d/y);for(let V=0;V<this.xCellCount*this.yCellCount;V++)C.push([]),N.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=d,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/d,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,d,y,C,N){this._forEachCell(d,y,C,N,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(d),this.bboxes.push(y),this.bboxes.push(C),this.bboxes.push(N)}insertCircle(n,d,y,C){this._forEachCell(d-C,y-C,d+C,y+C,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(d),this.circles.push(y),this.circles.push(C)}_insertBoxCell(n,d,y,C,N,V){this.boxCells[N].push(V)}_insertCircleCell(n,d,y,C,N,V){this.circleCells[N].push(V)}_query(n,d,y,C,N,V,Z){if(y<0||n>this.width||C<0||d>this.height)return[];const Y=[];if(n<=0&&d<=0&&this.width<=y&&this.height<=C){if(N)return[{key:null,x1:n,y1:d,x2:y,y2:C}];for(let X=0;X<this.boxKeys.length;X++)Y.push({key:this.boxKeys[X],x1:this.bboxes[4*X],y1:this.bboxes[4*X+1],x2:this.bboxes[4*X+2],y2:this.bboxes[4*X+3]});for(let X=0;X<this.circleKeys.length;X++){const le=this.circles[3*X],ae=this.circles[3*X+1],De=this.circles[3*X+2];Y.push({key:this.circleKeys[X],x1:le-De,y1:ae-De,x2:le+De,y2:ae+De})}}else this._forEachCell(n,d,y,C,this._queryCell,Y,{hitTest:N,overlapMode:V,seenUids:{box:{},circle:{}}},Z);return Y}query(n,d,y,C){return this._query(n,d,y,C,!1,null)}hitTest(n,d,y,C,N,V){return this._query(n,d,y,C,!0,N,V).length>0}hitTestCircle(n,d,y,C,N){const V=n-y,Z=n+y,Y=d-y,X=d+y;if(Z<0||V>this.width||X<0||Y>this.height)return!1;const le=[];return this._forEachCell(V,Y,Z,X,this._queryCellCircle,le,{hitTest:!0,overlapMode:C,circle:{x:n,y:d,radius:y},seenUids:{box:{},circle:{}}},N),le.length>0}_queryCell(n,d,y,C,N,V,Z,Y){const{seenUids:X,hitTest:le,overlapMode:ae}=Z,De=this.boxCells[N];if(null!==De){const ke=this.bboxes;for(const R of De)if(!X.box[R]){X.box[R]=!0;const k=4*R,O=this.boxKeys[R];if(n<=ke[k+2]&&d<=ke[k+3]&&y>=ke[k+0]&&C>=ke[k+1]&&(!Y||Y(O))&&(!le||!rn(ae,O.overlapMode))&&(V.push({key:O,x1:ke[k],y1:ke[k+1],x2:ke[k+2],y2:ke[k+3]}),le))return!0}}const ze=this.circleCells[N];if(null!==ze){const ke=this.circles;for(const R of ze)if(!X.circle[R]){X.circle[R]=!0;const k=3*R,O=this.circleKeys[R];if(this._circleAndRectCollide(ke[k],ke[k+1],ke[k+2],n,d,y,C)&&(!Y||Y(O))&&(!le||!rn(ae,O.overlapMode))){const z=ke[k],W=ke[k+1],ie=ke[k+2];if(V.push({key:O,x1:z-ie,y1:W-ie,x2:z+ie,y2:W+ie}),le)return!0}}}return!1}_queryCellCircle(n,d,y,C,N,V,Z,Y){const{circle:X,seenUids:le,overlapMode:ae}=Z,De=this.boxCells[N];if(null!==De){const ke=this.bboxes;for(const R of De)if(!le.box[R]){le.box[R]=!0;const k=4*R,O=this.boxKeys[R];if(this._circleAndRectCollide(X.x,X.y,X.radius,ke[k+0],ke[k+1],ke[k+2],ke[k+3])&&(!Y||Y(O))&&!rn(ae,O.overlapMode))return V.push(!0),!0}}const ze=this.circleCells[N];if(null!==ze){const ke=this.circles;for(const R of ze)if(!le.circle[R]){le.circle[R]=!0;const k=3*R,O=this.circleKeys[R];if(this._circlesCollide(ke[k],ke[k+1],ke[k+2],X.x,X.y,X.radius)&&(!Y||Y(O))&&!rn(ae,O.overlapMode))return V.push(!0),!0}}}_forEachCell(n,d,y,C,N,V,Z,Y){const X=this._convertToXCellCoord(n),le=this._convertToYCellCoord(d),ae=this._convertToXCellCoord(y),De=this._convertToYCellCoord(C);for(let ze=X;ze<=ae;ze++)for(let ke=le;ke<=De;ke++)if(N.call(this,n,d,y,C,this.xCellCount*ke+ze,V,Z,Y))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,d,y,C,N,V){const Z=C-n,Y=N-d,X=y+V;return X*X>Z*Z+Y*Y}_circleAndRectCollide(n,d,y,C,N,V,Z){const Y=(V-C)/2,X=Math.abs(n-(C+Y));if(X>Y+y)return!1;const le=(Z-N)/2,ae=Math.abs(d-(N+le));if(ae>le+y)return!1;if(X<=Y||ae<=le)return!0;const De=X-Y,ze=ae-le;return De*De+ze*ze<=y*y}}function Qt(w,n,d,y,C){const N=x.create();return n?(x.scale(N,N,[1/C,1/C,1]),d||x.rotateZ(N,N,y.angle)):x.multiply(N,y.labelPlaneMatrix,w),N}function mr(w,n,d,y,C){if(n){const N=x.clone(w);return x.scale(N,N,[C,C,1]),d||x.rotateZ(N,N,-y.angle),N}return y.glCoordMatrix}function ii(w,n,d){let y;d?(y=[w.x,w.y,d(w.x,w.y),1],x.transformMat4(y,y,n)):(y=[w.x,w.y,0,1],Ve(y,y,n));const C=y[3];return{point:new x.Point(y[0]/C,y[1]/C),signedDistanceFromCamera:C}}function Rn(w,n){return.5+w/n*.5}function Li(w,n){const d=w[0]/w[3],y=w[1]/w[3];return d>=-n[0]&&d<=n[0]&&y>=-n[1]&&y<=n[1]}function Lr(w,n,d,y,C,N,V,Z,Y,X){const le=y?w.textSizeData:w.iconSizeData,ae=x.evaluateSizeForZoom(le,d.transform.zoom),De=[256/d.width*2+1,256/d.height*2+1],ze=y?w.text.dynamicLayoutVertexArray:w.icon.dynamicLayoutVertexArray;ze.clear();const ke=w.lineVertexArray,R=y?w.text.placedSymbolArray:w.icon.placedSymbolArray,k=d.transform.width/d.transform.height;let O=!1;for(let z=0;z<R.length;z++){const W=R.get(z);if(W.hidden||W.writingMode===x.WritingMode.vertical&&!O){Ie(W.numGlyphs,ze);continue}let ie;if(O=!1,X?(ie=[W.anchorX,W.anchorY,X(W.anchorX,W.anchorY),1],x.transformMat4(ie,ie,n)):(ie=[W.anchorX,W.anchorY,0,1],Ve(ie,ie,n)),!Li(ie,De)){Ie(W.numGlyphs,ze);continue}const ue=Rn(d.transform.cameraToCenterDistance,ie[3]),Ne=x.evaluateSizeForFeature(le,ae,W),et=V?Ne/ue:Ne*ue,Mt=new x.Point(W.anchorX,W.anchorY),vt=ii(Mt,C,X).point,on={projections:{},offsets:{}},Hn=ur(W,et,!1,Z,n,C,N,w.glyphOffsetArray,ke,ze,vt,Mt,on,k,Y,X);O=Hn.useVertical,(Hn.notEnoughRoom||O||Hn.needsFlipping&&ur(W,et,!0,Z,n,C,N,w.glyphOffsetArray,ke,ze,vt,Mt,on,k,Y,X).notEnoughRoom)&&Ie(W.numGlyphs,ze)}y?w.text.dynamicLayoutVertexBuffer.updateData(ze):w.icon.dynamicLayoutVertexBuffer.updateData(ze)}function _r(w,n,d,y,C,N,V,Z,Y,X,le,ae,De){const ze=Z.glyphStartIndex+Z.numGlyphs,ke=Z.lineStartIndex,R=Z.lineStartIndex+Z.lineLength,k=n.getoffsetX(Z.glyphStartIndex),O=n.getoffsetX(ze-1),z=he(w*k,d,y,C,N,V,Z.segment,ke,R,Y,X,le,ae,De);if(!z)return null;const W=he(w*O,d,y,C,N,V,Z.segment,ke,R,Y,X,le,ae,De);return W?{first:z,last:W}:null}function Ai(w,n,d,y){return w===x.WritingMode.horizontal&&Math.abs(d.y-n.y)>Math.abs(d.x-n.x)*y?{useVertical:!0}:(w===x.WritingMode.vertical?n.y<d.y:n.x>d.x)?{needsFlipping:!0}:null}function ur(w,n,d,y,C,N,V,Z,Y,X,le,ae,De,ze,ke,R){const k=n/24,O=w.lineOffsetX*k,z=w.lineOffsetY*k;let W;if(w.numGlyphs>1){const ie=w.glyphStartIndex+w.numGlyphs,ue=w.lineStartIndex,Ne=w.lineStartIndex+w.lineLength,et=_r(k,Z,O,z,d,le,ae,w,Y,N,De,ke,R);if(!et)return{notEnoughRoom:!0};const Mt=ii(et.first.point,V,R).point,vt=ii(et.last.point,V,R).point;if(y&&!d){const on=Ai(w.writingMode,Mt,vt,ze);if(on)return on}W=[et.first];for(let on=w.glyphStartIndex+1;on<ie-1;on++)W.push(he(k*Z.getoffsetX(on),O,z,d,le,ae,w.segment,ue,Ne,Y,N,De,ke,R));W.push(et.last)}else{if(y&&!d){const ue=ii(ae,C,R).point,Ne=w.lineStartIndex+w.segment+1,et=new x.Point(Y.getx(Ne),Y.gety(Ne)),Mt=ii(et,C,R),vt=Mt.signedDistanceFromCamera>0?Mt.point:si(ae,et,ue,1,C,R),on=Ai(w.writingMode,ue,vt,ze);if(on)return on}const ie=he(k*Z.getoffsetX(w.glyphStartIndex),O,z,d,le,ae,w.segment,w.lineStartIndex,w.lineStartIndex+w.lineLength,Y,N,De,ke,R);if(!ie)return{notEnoughRoom:!0};W=[ie]}for(const ie of W)x.addDynamicAttributes(X,ie.point,ie.angle);return{}}function si(w,n,d,y,C,N){const V=ii(w.add(w.sub(n)._unit()),C,N).point,Z=d.sub(V);return d.add(Z._mult(y/Z.mag()))}function Br(w,n){const{projectionCache:d,lineVertexArray:y,labelPlaneMatrix:C,tileAnchorPoint:N,distanceFromAnchor:V,getElevation:Z,previousVertex:Y,direction:X,absOffsetX:le}=n;if(d.projections[w])return d.projections[w];const ae=new x.Point(y.getx(w),y.gety(w)),De=ii(ae,C,Z);if(De.signedDistanceFromCamera>0)return d.projections[w]=De.point,De.point;const ze=w-X;return si(0===V?N:new x.Point(y.getx(ze),y.gety(ze)),ae,Y,le-V+1,C,Z)}function Vo(w,n,d){return w._unit()._perp()._mult(n*d)}function Le(w,n,d,y,C,N,V,Z){const{projectionCache:Y,direction:X}=Z;if(Y.offsets[w])return Y.offsets[w];const le=d.add(n);if(w+X<y||w+X>=C)return Y.offsets[w]=le,le;const ae=Br(w+X,Z),De=Vo(ae.sub(d),V,X),ze=d.add(De),ke=ae.add(De);return Y.offsets[w]=x.findLineIntersection(N,le,ze,ke)||le,Y.offsets[w]}function he(w,n,d,y,C,N,V,Z,Y,X,le,ae,De,ze){const ke=y?w-n:w+n;let R=ke>0?1:-1,k=0;y&&(R*=-1,k=Math.PI),R<0&&(k+=Math.PI);let O,z,W=R>0?Z+V:Z+V+1,ie=C,ue=C,Ne=0,et=0;const Mt=Math.abs(ke),vt=[];let on;for(;Ne+et<=Mt;){if(W+=R,W<Z||W>=Y)return null;Ne+=et,ue=ie,z=O;const Dn={projectionCache:ae,lineVertexArray:X,labelPlaneMatrix:le,tileAnchorPoint:N,distanceFromAnchor:Ne,getElevation:ze,previousVertex:ue,direction:R,absOffsetX:Mt};if(ie=Br(W,Dn),0===d)vt.push(ue),on=ie.sub(ue);else{let gi;const Bn=ie.sub(ue);gi=0===Bn.mag()?Vo(Br(W+R,Dn).sub(ie),d,R):Vo(Bn,d,R),z||(z=ue.add(gi)),O=Le(W,gi,ie,Z,Y,z,d,Dn),vt.push(z),on=O.sub(z)}et=on.mag()}const Hn=on._mult((Mt-Ne)/et)._add(z||ue),Pi=k+Math.atan2(ie.y-ue.y,ie.x-ue.x);return vt.push(Hn),{point:Hn,angle:De?Pi:0,path:vt}}const ye=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ie(w,n){for(let d=0;d<w;d++){const y=n.length;n.resize(y+4),n.float32.set(ye,3*y)}}function Ve(w,n,d){const y=n[0],C=n[1];return w[0]=d[0]*y+d[4]*C+d[12],w[1]=d[1]*y+d[5]*C+d[13],w[3]=d[3]*y+d[7]*C+d[15],w}const $e=100;class we{constructor(n,d=new On(n.width+200,n.height+200,25),y=new On(n.width+200,n.height+200,25)){this.transform=n,this.grid=d,this.ignoredGrid=y,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+$e,this.screenBottomBoundary=n.height+$e,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(n,d,y,C,N,V){const Z=this.projectAndGetPerspectiveRatio(C,n.anchorPointX,n.anchorPointY,V),Y=y*Z.perspectiveRatio,X=n.x1*Y+Z.point.x,le=n.y1*Y+Z.point.y,ae=n.x2*Y+Z.point.x,De=n.y2*Y+Z.point.y;return!this.isInsideGrid(X,le,ae,De)||"always"!==d&&this.grid.hitTest(X,le,ae,De,d,N)||Z.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[X,le,ae,De],offscreen:this.isOffscreen(X,le,ae,De)}}placeCollisionCircles(n,d,y,C,N,V,Z,Y,X,le,ae,De,ze,ke){const R=[],k=new x.Point(d.anchorX,d.anchorY),O=ii(k,V,ke),z=Rn(this.transform.cameraToCenterDistance,O.signedDistanceFromCamera),W=(le?N/z:N*z)/x.ONE_EM,ie=ii(k,Z,ke).point,ue=_r(W,C,d.lineOffsetX*W,d.lineOffsetY*W,!1,ie,k,d,y,Z,{projections:{},offsets:{}},!1,ke);let Ne=!1,et=!1,Mt=!0;if(ue){const vt=.5*De*z+ze,on=new x.Point(-100,-100),Hn=new x.Point(this.screenRightBoundary,this.screenBottomBoundary),Pi=new qn,Dn=ue.first,gi=ue.last;let Bn=[];for(let Ir=Dn.path.length-1;Ir>=1;Ir--)Bn.push(Dn.path[Ir]);for(let Ir=1;Ir<gi.path.length;Ir++)Bn.push(gi.path[Ir]);const cr=2.5*vt;if(Y){const Ir=Bn.map(ki=>ii(ki,Y,ke));Bn=Ir.some(ki=>ki.signedDistanceFromCamera<=0)?[]:Ir.map(ki=>ki.point)}let To=[];if(Bn.length>0){const Ir=Bn[0].clone(),ki=Bn[0].clone();for(let Kr=1;Kr<Bn.length;Kr++)Ir.x=Math.min(Ir.x,Bn[Kr].x),Ir.y=Math.min(Ir.y,Bn[Kr].y),ki.x=Math.max(ki.x,Bn[Kr].x),ki.y=Math.max(ki.y,Bn[Kr].y);To=Ir.x>=on.x&&ki.x<=Hn.x&&Ir.y>=on.y&&ki.y<=Hn.y?[Bn]:ki.x<on.x||Ir.x>Hn.x||ki.y<on.y||Ir.y>Hn.y?[]:x.clipLine([Bn],on.x,on.y,Hn.x,Hn.y)}for(const Ir of To){Pi.reset(Ir,.25*vt);let ki=0;ki=Pi.length<=.5*vt?1:Math.ceil(Pi.paddedLength/cr)+1;for(let Kr=0;Kr<ki;Kr++){const xs=Kr/Math.max(ki-1,1),No=Pi.lerp(xs),ar=No.x+$e,qs=No.y+$e;R.push(ar,qs,vt,0);const sa=ar-vt,_l=qs-vt,ci=ar+vt,Xa=qs+vt;if(Mt=Mt&&this.isOffscreen(sa,_l,ci,Xa),et=et||this.isInsideGrid(sa,_l,ci,Xa),"always"!==n&&this.grid.hitTestCircle(ar,qs,vt,n,ae)&&(Ne=!0,!X))return{circles:[],offscreen:!1,collisionDetected:Ne}}}}return{circles:!X&&Ne||!et||z<this.perspectiveRatioCutoff?[]:R,offscreen:Mt,collisionDetected:Ne}}queryRenderedSymbols(n){if(0===n.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const d=[];let y=1/0,C=1/0,N=-1/0,V=-1/0;for(const le of n){const ae=new x.Point(le.x+$e,le.y+$e);y=Math.min(y,ae.x),C=Math.min(C,ae.y),N=Math.max(N,ae.x),V=Math.max(V,ae.y),d.push(ae)}const Z=this.grid.query(y,C,N,V).concat(this.ignoredGrid.query(y,C,N,V)),Y={},X={};for(const le of Z){const ae=le.key;if(void 0===Y[ae.bucketInstanceId]&&(Y[ae.bucketInstanceId]={}),Y[ae.bucketInstanceId][ae.featureIndex])continue;const De=[new x.Point(le.x1,le.y1),new x.Point(le.x2,le.y1),new x.Point(le.x2,le.y2),new x.Point(le.x1,le.y2)];x.polygonIntersectsPolygon(d,De)&&(Y[ae.bucketInstanceId][ae.featureIndex]=!0,void 0===X[ae.bucketInstanceId]&&(X[ae.bucketInstanceId]=[]),X[ae.bucketInstanceId].push(ae.featureIndex))}return X}insertCollisionBox(n,d,y,C,N,V){(y?this.ignoredGrid:this.grid).insert({bucketInstanceId:C,featureIndex:N,collisionGroupID:V,overlapMode:d},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,d,y,C,N,V){const Z=y?this.ignoredGrid:this.grid,Y={bucketInstanceId:C,featureIndex:N,collisionGroupID:V,overlapMode:d};for(let X=0;X<n.length;X+=4)Z.insertCircle(Y,n[X],n[X+1],n[X+2])}projectAndGetPerspectiveRatio(n,d,y,C){let N;return C?(N=[d,y,C(d,y),1],x.transformMat4(N,N,n)):(N=[d,y,0,1],Ve(N,N,n)),{point:new x.Point((N[0]/N[3]+1)/2*this.transform.width+$e,(-N[1]/N[3]+1)/2*this.transform.height+$e),perspectiveRatio:.5+this.transform.cameraToCenterDistance/N[3]*.5}}isOffscreen(n,d,y,C){return y<$e||n>=this.screenRightBoundary||C<$e||d>this.screenBottomBoundary}isInsideGrid(n,d,y,C){return y>=0&&n<this.gridRightBoundary&&C>=0&&d<this.gridBottomBoundary}getViewportMatrix(){const n=x.identity([]);return x.translate(n,n,[-100,-100,0]),n}}function me(w,n,d){return n*(x.EXTENT/(w.tileSize*Math.pow(2,d-w.tileID.overscaledZ)))}class oe{constructor(n,d,y,C){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?d:-d))):C&&y?1:0,this.placed=y}isHidden(){return 0===this.opacity&&!this.placed}}class Se{constructor(n,d,y,C,N){this.text=new oe(n?n.text:null,d,y,N),this.icon=new oe(n?n.icon:null,d,C,N)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ye{constructor(n,d,y){this.text=n,this.icon=d,this.skipFade=y}}class Xe{constructor(){this.invProjMatrix=x.create(),this.viewportMatrix=x.create(),this.circles=[]}}class gt{constructor(n,d,y,C,N){this.bucketInstanceId=n,this.featureIndex=d,this.sourceLayerIndex=y,this.bucketIndex=C,this.tileID=N}}class mn{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const d=++this.maxGroupID;this.collisionGroups[n]={ID:d,predicate:y=>y.collisionGroupID===d}}return this.collisionGroups[n]}}function wn(w,n,d,y,C){const{horizontalAlign:N,verticalAlign:V}=x.getAnchorAlignment(w),Z=-(N-.5)*n,Y=-(V-.5)*d,X=x.evaluateVariableOffset(w,y);return new x.Point(Z+X[0]*C,Y+X[1]*C)}function sn(w,n,d,y,C,N){const{x1:V,x2:Z,y1:Y,y2:X,anchorPointX:le,anchorPointY:ae}=w,De=new x.Point(n,d);return y&&De._rotate(C?N:-N),{x1:V+De.x,y1:Y+De.y,x2:Z+De.x,y2:X+De.y,anchorPointX:le,anchorPointY:ae}}class Cn{constructor(n,d,y,C,N){this.transform=n.clone(),this.terrain=d,this.collisionIndex=new we(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=y,this.retainedQueryData={},this.collisionGroups=new mn(C),this.collisionCircleArrays={},this.prevPlacement=N,N&&(N.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,d,y,C){const N=y.getBucket(d),V=y.latestFeatureIndex;if(!N||!V||d.id!==N.layerIds[0])return;const Z=y.collisionBoxArray,Y=N.layers[0].layout,X=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),le=y.tileSize/x.EXTENT,ae=this.transform.calculatePosMatrix(y.tileID.toUnwrapped()),De="map"===Y.get("text-pitch-alignment"),ze="map"===Y.get("text-rotation-alignment"),ke=me(y,1,this.transform.zoom),R=Qt(ae,De,ze,this.transform,ke);let k=null;if(De){const z=mr(ae,De,ze,this.transform,ke);k=x.multiply([],this.transform.labelPlaneMatrix,z)}this.retainedQueryData[N.bucketInstanceId]=new gt(N.bucketInstanceId,V,N.sourceLayerIndex,N.index,y.tileID);const O={bucket:N,layout:Y,posMatrix:ae,textLabelPlaneMatrix:R,labelToScreenMatrix:k,scale:X,textPixelRatio:le,holdingForFade:y.holdingForFade(),collisionBoxArray:Z,partiallyEvaluatedTextSize:x.evaluateSizeForZoom(N.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(N.sourceID)};if(C)for(const z of N.sortKeyRanges){const{sortKey:W,symbolInstanceStart:ie,symbolInstanceEnd:ue}=z;n.push({sortKey:W,symbolInstanceStart:ie,symbolInstanceEnd:ue,parameters:O})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:N.symbolInstances.length,parameters:O})}attemptAnchorPlacement(n,d,y,C,N,V,Z,Y,X,le,ae,De,ze,ke,R,k){const O=[De.textOffset0,De.textOffset1],z=wn(n,y,C,O,N),W=this.collisionIndex.placeCollisionBox(sn(d,z.x,z.y,V,Z,this.transform.angle),ae,Y,X,le.predicate,k);if((!R||0!==this.collisionIndex.placeCollisionBox(sn(R,z.x,z.y,V,Z,this.transform.angle),ae,Y,X,le.predicate,k).box.length)&&W.box.length>0){let ie;if(this.prevPlacement&&this.prevPlacement.variableOffsets[De.crossTileID]&&this.prevPlacement.placements[De.crossTileID]&&this.prevPlacement.placements[De.crossTileID].text&&(ie=this.prevPlacement.variableOffsets[De.crossTileID].anchor),0===De.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[De.crossTileID]={textOffset:O,width:y,height:C,anchor:n,textBoxScale:N,prevAnchor:ie},this.markUsedJustification(ze,n,De,ke),ze.allowVerticalPlacement&&(this.markUsedOrientation(ze,ke,De),this.placedOrientations[De.crossTileID]=ke),{shift:z,placedGlyphBoxes:W}}}placeLayerBucketPart(n,d,y){const{bucket:C,layout:N,posMatrix:V,textLabelPlaneMatrix:Z,labelToScreenMatrix:Y,textPixelRatio:X,holdingForFade:le,collisionBoxArray:ae,partiallyEvaluatedTextSize:De,collisionGroup:ze}=n.parameters,ke=N.get("text-optional"),R=N.get("icon-optional"),k=x.getOverlapMode(N,"text-overlap","text-allow-overlap"),O="always"===k,z=x.getOverlapMode(N,"icon-overlap","icon-allow-overlap"),W="always"===z,ie="map"===N.get("text-rotation-alignment"),ue="map"===N.get("text-pitch-alignment"),Ne="none"!==N.get("icon-text-fit"),et="viewport-y"===N.get("symbol-z-order"),Mt=O&&(W||!C.hasIconData()||R),vt=W&&(O||!C.hasTextData()||ke);!C.collisionArrays&&ae&&C.deserializeCollisionBoxes(ae);const on=this.retainedQueryData[C.bucketInstanceId].tileID,Hn=this.terrain?(Dn,gi)=>this.terrain.getElevation(on,Dn,gi):null,Pi=(Dn,gi)=>{if(d[Dn.crossTileID])return;if(le)return void(this.placements[Dn.crossTileID]=new Ye(!1,!1,!1));let Bn=!1,cr=!1,To=!0,Ir=null,ki={box:null,offscreen:null},Kr={box:null,offscreen:null},xs=null,No=null,ar=null,qs=0,sa=0,_l=0;gi.textFeatureIndex?qs=gi.textFeatureIndex:Dn.useRuntimeCollisionCircles&&(qs=Dn.featureIndex),gi.verticalTextFeatureIndex&&(sa=gi.verticalTextFeatureIndex);const ci=gi.textBox;if(ci){const vo=br=>{let Ro=x.WritingMode.horizontal;if(C.allowVerticalPlacement&&!br&&this.prevPlacement){const $o=this.prevPlacement.placedOrientations[Dn.crossTileID];$o&&(this.placedOrientations[Dn.crossTileID]=$o,Ro=$o,this.markUsedOrientation(C,Ro,Dn))}return Ro},qo=(br,Ro)=>{if(C.allowVerticalPlacement&&Dn.numVerticalGlyphVertices>0&&gi.verticalTextBox){for(const $o of C.writingModes)if($o===x.WritingMode.vertical?(ki=Ro(),Kr=ki):ki=br(),ki&&ki.box&&ki.box.length)break}else ki=br()};if(N.get("text-variable-anchor")){let br=N.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Dn.crossTileID]){const Cr=this.prevPlacement.variableOffsets[Dn.crossTileID];br.indexOf(Cr.anchor)>0&&(br=br.filter(So=>So!==Cr.anchor),br.unshift(Cr.anchor))}const Ro=(Cr,So,ws)=>{const Gc=Cr.x2-Cr.x1,vl=Cr.y2-Cr.y1,sd=Dn.textBoxScale,ku=Ne&&"never"===z?So:null;let oo={box:[],offscreen:!1};const ya="never"!==k?2*br.length:br.length;for(let aa=0;aa<ya;++aa){const Rl=this.attemptAnchorPlacement(br[aa%br.length],Cr,Gc,vl,sd,ie,ue,X,V,ze,aa>=br.length?k:"never",Dn,C,ws,ku,Hn);if(Rl&&(oo=Rl.placedGlyphBoxes,oo&&oo.box&&oo.box.length)){Bn=!0,Ir=Rl.shift;break}}return oo};qo(()=>Ro(ci,gi.iconBox,x.WritingMode.horizontal),()=>{const Cr=gi.verticalTextBox;return C.allowVerticalPlacement&&!(ki&&ki.box&&ki.box.length)&&Dn.numVerticalGlyphVertices>0&&Cr?Ro(Cr,gi.verticalIconBox,x.WritingMode.vertical):{box:null,offscreen:null}}),ki&&(Bn=ki.box,To=ki.offscreen);const $o=vo(ki&&ki.box);if(!Bn&&this.prevPlacement){const Cr=this.prevPlacement.variableOffsets[Dn.crossTileID];Cr&&(this.variableOffsets[Dn.crossTileID]=Cr,this.markUsedJustification(C,Cr.anchor,Dn,$o))}}else{const br=(Ro,$o)=>{const Cr=this.collisionIndex.placeCollisionBox(Ro,k,X,V,ze.predicate,Hn);return Cr&&Cr.box&&Cr.box.length&&(this.markUsedOrientation(C,$o,Dn),this.placedOrientations[Dn.crossTileID]=$o),Cr};qo(()=>br(ci,x.WritingMode.horizontal),()=>{const Ro=gi.verticalTextBox;return C.allowVerticalPlacement&&Dn.numVerticalGlyphVertices>0&&Ro?br(Ro,x.WritingMode.vertical):{box:null,offscreen:null}}),vo(ki&&ki.box&&ki.box.length)}}if(xs=ki,Bn=xs&&xs.box&&xs.box.length>0,To=xs&&xs.offscreen,Dn.useRuntimeCollisionCircles){const vo=C.text.placedSymbolArray.get(Dn.centerJustifiedTextSymbolIndex),qo=x.evaluateSizeForFeature(C.textSizeData,De,vo),br=N.get("text-padding");No=this.collisionIndex.placeCollisionCircles(k,vo,C.lineVertexArray,C.glyphOffsetArray,qo,V,Z,Y,y,ue,ze.predicate,Dn.collisionCircleDiameter,br,Hn),No.circles.length&&No.collisionDetected&&!y&&x.warnOnce("Collisions detected, but collision boxes are not shown"),Bn=O||No.circles.length>0&&!No.collisionDetected,To=To&&No.offscreen}if(gi.iconFeatureIndex&&(_l=gi.iconFeatureIndex),gi.iconBox){const vo=qo=>{const br=Ne&&Ir?sn(qo,Ir.x,Ir.y,ie,ue,this.transform.angle):qo;return this.collisionIndex.placeCollisionBox(br,z,X,V,ze.predicate,Hn)};Kr&&Kr.box&&Kr.box.length&&gi.verticalIconBox?(ar=vo(gi.verticalIconBox),cr=ar.box.length>0):(ar=vo(gi.iconBox),cr=ar.box.length>0),To=To&&ar.offscreen}const Xa=ke||0===Dn.numHorizontalGlyphVertices&&0===Dn.numVerticalGlyphVertices,yl=R||0===Dn.numIconVertices;if(Xa||yl?yl?Xa||(cr=cr&&Bn):Bn=cr&&Bn:cr=Bn=cr&&Bn,Bn&&xs&&xs.box&&this.collisionIndex.insertCollisionBox(xs.box,k,N.get("text-ignore-placement"),C.bucketInstanceId,Kr&&Kr.box&&sa?sa:qs,ze.ID),cr&&ar&&this.collisionIndex.insertCollisionBox(ar.box,z,N.get("icon-ignore-placement"),C.bucketInstanceId,_l,ze.ID),No&&(Bn&&this.collisionIndex.insertCollisionCircles(No.circles,k,N.get("text-ignore-placement"),C.bucketInstanceId,qs,ze.ID),y)){const vo=C.bucketInstanceId;let qo=this.collisionCircleArrays[vo];void 0===qo&&(qo=this.collisionCircleArrays[vo]=new Xe);for(let br=0;br<No.circles.length;br+=4)qo.circles.push(No.circles[br+0]),qo.circles.push(No.circles[br+1]),qo.circles.push(No.circles[br+2]),qo.circles.push(No.collisionDetected?1:0)}if(0===Dn.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===C.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Dn.crossTileID]=new Ye(Bn||Mt,cr||vt,To||C.justReloaded),d[Dn.crossTileID]=!0};if(et){if(0!==n.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const Dn=C.getSortedSymbolIndexes(this.transform.angle);for(let gi=Dn.length-1;gi>=0;--gi){const Bn=Dn[gi];Pi(C.symbolInstances.get(Bn),C.collisionArrays[Bn])}}else for(let Dn=n.symbolInstanceStart;Dn<n.symbolInstanceEnd;Dn++)Pi(C.symbolInstances.get(Dn),C.collisionArrays[Dn]);if(y&&C.bucketInstanceId in this.collisionCircleArrays){const Dn=this.collisionCircleArrays[C.bucketInstanceId];x.invert(Dn.invProjMatrix,V),Dn.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(n,d,y,C){let N;N=C===x.WritingMode.vertical?y.verticalPlacedTextSymbolIndex:{left:y.leftJustifiedTextSymbolIndex,center:y.centerJustifiedTextSymbolIndex,right:y.rightJustifiedTextSymbolIndex}[x.getAnchorJustification(d)];const V=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex,y.verticalPlacedTextSymbolIndex];for(const Z of V)Z>=0&&(n.text.placedSymbolArray.get(Z).crossTileID=N>=0&&Z!==N?0:y.crossTileID)}markUsedOrientation(n,d,y){const C=d===x.WritingMode.horizontal||d===x.WritingMode.horizontalOnly?d:0,N=d===x.WritingMode.vertical?d:0,V=[y.leftJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.rightJustifiedTextSymbolIndex];for(const Z of V)n.text.placedSymbolArray.get(Z).placedOrientation=C;y.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(y.verticalPlacedTextSymbolIndex).placedOrientation=N)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const d=this.prevPlacement;let y=!1;this.prevZoomAdjustment=d?d.zoomAdjustment(this.transform.zoom):0;const C=d?d.symbolFadeChange(n):1,N=d?d.opacities:{},V=d?d.variableOffsets:{},Z=d?d.placedOrientations:{};for(const Y in this.placements){const X=this.placements[Y],le=N[Y];le?(this.opacities[Y]=new Se(le,C,X.text,X.icon),y=y||X.text!==le.text.placed||X.icon!==le.icon.placed):(this.opacities[Y]=new Se(null,C,X.text,X.icon,X.skipFade),y=y||X.text||X.icon)}for(const Y in N){const X=N[Y];if(!this.opacities[Y]){const le=new Se(X,C,!1,!1);le.isHidden()||(this.opacities[Y]=le,y=y||X.text.placed||X.icon.placed)}}for(const Y in V)this.variableOffsets[Y]||!this.opacities[Y]||this.opacities[Y].isHidden()||(this.variableOffsets[Y]=V[Y]);for(const Y in Z)this.placedOrientations[Y]||!this.opacities[Y]||this.opacities[Y].isHidden()||(this.placedOrientations[Y]=Z[Y]);if(d&&void 0===d.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");y?this.lastPlacementChangeTime=n:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=d?d.lastPlacementChangeTime:n)}updateLayerOpacities(n,d){const y={};for(const C of d){const N=C.getBucket(n);N&&C.latestFeatureIndex&&n.id===N.layerIds[0]&&this.updateBucketOpacities(N,y,C.collisionBoxArray)}}updateBucketOpacities(n,d,y){n.hasTextData()&&(n.text.opacityVertexArray.clear(),n.text.hasVisibleVertices=!1),n.hasIconData()&&(n.icon.opacityVertexArray.clear(),n.icon.hasVisibleVertices=!1),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const C=n.layers[0].layout,N=new Se(null,0,!1,!1,!0),V=C.get("text-allow-overlap"),Z=C.get("icon-allow-overlap"),Y=C.get("text-variable-anchor"),X="map"===C.get("text-rotation-alignment"),le="map"===C.get("text-pitch-alignment"),ae="none"!==C.get("icon-text-fit"),De=new Se(null,0,V&&(Z||!n.hasIconData()||C.get("icon-optional")),Z&&(V||!n.hasTextData()||C.get("text-optional")),!0);!n.collisionArrays&&y&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(y);const ze=(ke,R,k)=>{for(let O=0;O<R/4;O++)ke.opacityVertexArray.emplaceBack(k);ke.hasVisibleVertices=ke.hasVisibleVertices||k!==Qn};for(let ke=0;ke<n.symbolInstances.length;ke++){const R=n.symbolInstances.get(ke),{numHorizontalGlyphVertices:k,numVerticalGlyphVertices:O,crossTileID:z}=R;let W=this.opacities[z];d[z]?W=N:W||(W=De,this.opacities[z]=W),d[z]=!0;const ie=R.numIconVertices>0,ue=this.placedOrientations[R.crossTileID],Ne=ue===x.WritingMode.vertical,et=ue===x.WritingMode.horizontal||ue===x.WritingMode.horizontalOnly;if(k>0||O>0){const Mt=Zi(W.text);ze(n.text,k,Ne?Qn:Mt),ze(n.text,O,et?Qn:Mt);const vt=W.text.isHidden();[R.rightJustifiedTextSymbolIndex,R.centerJustifiedTextSymbolIndex,R.leftJustifiedTextSymbolIndex].forEach(Pi=>{Pi>=0&&(n.text.placedSymbolArray.get(Pi).hidden=vt||Ne?1:0)}),R.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(R.verticalPlacedTextSymbolIndex).hidden=vt||et?1:0);const on=this.variableOffsets[R.crossTileID];on&&this.markUsedJustification(n,on.anchor,R,ue);const Hn=this.placedOrientations[R.crossTileID];Hn&&(this.markUsedJustification(n,"left",R,Hn),this.markUsedOrientation(n,Hn,R))}if(ie){const Mt=Zi(W.icon),vt=!(ae&&R.verticalPlacedIconSymbolIndex&&Ne);R.placedIconSymbolIndex>=0&&(ze(n.icon,R.numIconVertices,vt?Mt:Qn),n.icon.placedSymbolArray.get(R.placedIconSymbolIndex).hidden=W.icon.isHidden()),R.verticalPlacedIconSymbolIndex>=0&&(ze(n.icon,R.numVerticalIconVertices,vt?Qn:Mt),n.icon.placedSymbolArray.get(R.verticalPlacedIconSymbolIndex).hidden=W.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Mt=n.collisionArrays[ke];if(Mt){let vt=new x.Point(0,0);if(Mt.textBox||Mt.verticalTextBox){let Hn=!0;if(Y){const Pi=this.variableOffsets[z];Pi?(vt=wn(Pi.anchor,Pi.width,Pi.height,Pi.textOffset,Pi.textBoxScale),X&&vt._rotate(le?this.transform.angle:-this.transform.angle)):Hn=!1}Mt.textBox&&Fn(n.textCollisionBox.collisionVertexArray,W.text.placed,!Hn||Ne,vt.x,vt.y),Mt.verticalTextBox&&Fn(n.textCollisionBox.collisionVertexArray,W.text.placed,!Hn||et,vt.x,vt.y)}const on=!(et||!Mt.verticalIconBox);Mt.iconBox&&Fn(n.iconCollisionBox.collisionVertexArray,W.icon.placed,on,ae?vt.x:0,ae?vt.y:0),Mt.verticalIconBox&&Fn(n.iconCollisionBox.collisionVertexArray,W.icon.placed,!on,ae?vt.x:0,ae?vt.y:0)}}}if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.text.opacityVertexArray.length!==n.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${n.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${n.text.layoutVertexArray.length}) / 4`);if(n.icon.opacityVertexArray.length!==n.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${n.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${n.icon.layoutVertexArray.length}) / 4`);if(n.bucketInstanceId in this.collisionCircleArrays){const ke=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=ke.invProjMatrix,n.placementViewportMatrix=ke.viewportMatrix,n.collisionCircleArray=ke.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return 0===this.fadeDuration?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,d){const y=this.zoomAtLastRecencyCheck===d?1-this.zoomAdjustment(d):1;return this.zoomAtLastRecencyCheck=d,this.commitTime+this.fadeDuration*y>n}setStale(){this.stale=!0}}function Fn(w,n,d,y,C){w.emplaceBack(n?1:0,d?1:0,y||0,C||0),w.emplaceBack(n?1:0,d?1:0,y||0,C||0),w.emplaceBack(n?1:0,d?1:0,y||0,C||0),w.emplaceBack(n?1:0,d?1:0,y||0,C||0)}const ut=Math.pow(2,25),Oe=Math.pow(2,24),Ge=Math.pow(2,17),Gt=Math.pow(2,16),tn=Math.pow(2,9),Wt=Math.pow(2,8),cn=Math.pow(2,1);function Zi(w){if(0===w.opacity&&!w.placed)return 0;if(1===w.opacity&&w.placed)return 4294967295;const n=w.placed?1:0,d=Math.floor(127*w.opacity);return d*ut+n*Oe+d*Ge+n*Gt+d*tn+n*Wt+d*cn+n}const Qn=0;class nr{constructor(n){this._sortAcrossTiles="viewport-y"!==n.layout.get("symbol-z-order")&&!n.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,d,y,C,N){const V=this._bucketParts;for(;this._currentTileIndex<n.length;)if(d.getBucketParts(V,C,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,N())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,V.sort((Z,Y)=>Z.sortKey-Y.sortKey));this._currentPartIndex<V.length;)if(d.placeLayerBucketPart(V[this._currentPartIndex],this._seenCrossTileIDs,y),this._currentPartIndex++,N())return!0;return!1}}class ji{constructor(n,d,y,C,N,V,Z,Y){this.placement=new Cn(n,d,V,Z,Y),this._currentPlacementIndex=y.length-1,this._forceFullPlacement=C,this._showCollisionBoxes=N,this._done=!1}isDone(){return this._done}continuePlacement(n,d,y){const C=x.exported.now(),N=()=>!this._forceFullPlacement&&x.exported.now()-C>2;for(;this._currentPlacementIndex>=0;){const V=d[n[this._currentPlacementIndex]],Z=this.placement.collisionIndex.transform.zoom;if("symbol"===V.type&&(!V.minzoom||V.minzoom<=Z)&&(!V.maxzoom||V.maxzoom>Z)){if(this._inProgressLayer||(this._inProgressLayer=new nr(V)),this._inProgressLayer.continuePlacement(y[V.source],this.placement,this._showCollisionBoxes,V,N))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Pr=512/x.EXTENT/2;class Ki{constructor(n,d,y){this.tileID=n,this.bucketInstanceId=y,this._symbolsByKey={};const C=new Map;for(let N=0;N<d.length;N++){const V=d.get(N),Z=V.key,Y=C.get(Z);Y?Y.push(V):C.set(Z,[V])}for(const[N,V]of C){const Z={positions:V.map(Y=>({x:Math.floor(Y.anchorX*Pr),y:Math.floor(Y.anchorY*Pr)})),crossTileIDs:V.map(Y=>Y.crossTileID)};if(Z.positions.length>128){const Y=new x.KDBush(Z.positions.length,16,Uint16Array);for(const{x:X,y:le}of Z.positions)Y.add(X,le);Y.finish(),delete Z.positions,Z.index=Y}this._symbolsByKey[N]=Z}}getScaledCoordinates(n,d){const{x:y,y:C,z:N}=this.tileID.canonical,{x:V,y:Z,z:Y}=d.canonical,X=Pr/Math.pow(2,Y-N),le=(Z*x.EXTENT+n.anchorY)*X,ae=C*x.EXTENT*Pr;return{x:Math.floor((V*x.EXTENT+n.anchorX)*X-y*x.EXTENT*Pr),y:Math.floor(le-ae)}}findMatches(n,d,y){const C=this.tileID.canonical.z<d.canonical.z?1:Math.pow(2,this.tileID.canonical.z-d.canonical.z);for(let N=0;N<n.length;N++){const V=n.get(N);if(V.crossTileID)continue;const Z=this._symbolsByKey[V.key];if(!Z)continue;const Y=this.getScaledCoordinates(V,d);if(Z.index){const X=Z.index.range(Y.x-C,Y.y-C,Y.x+C,Y.y+C).sort();for(const le of X){const ae=Z.crossTileIDs[le];if(!y[ae]){y[ae]=!0,V.crossTileID=ae;break}}}else if(Z.positions)for(let X=0;X<Z.positions.length;X++){const le=Z.positions[X],ae=Z.crossTileIDs[X];if(Math.abs(le.x-Y.x)<=C&&Math.abs(le.y-Y.y)<=C&&!y[ae]){y[ae]=!0,V.crossTileID=ae;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:n})=>n)}}class tr{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Hr{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const d=Math.round((n-this.lng)/360);if(0!==d)for(const y in this.indexes){const C=this.indexes[y],N={};for(const V in C){const Z=C[V];Z.tileID=Z.tileID.unwrapTo(Z.tileID.wrap+d),N[Z.tileID.key]=Z}this.indexes[y]=N}this.lng=n}addBucket(n,d,y){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===d.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let N=0;N<d.symbolInstances.length;N++)d.symbolInstances.get(N).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const C=this.usedCrossTileIDs[n.overscaledZ];for(const N in this.indexes){const V=this.indexes[N];if(Number(N)>n.overscaledZ)for(const Z in V){const Y=V[Z];Y.tileID.isChildOf(n)&&Y.findMatches(d.symbolInstances,n,C)}else{const Z=V[n.scaledTo(Number(N)).key];Z&&Z.findMatches(d.symbolInstances,n,C)}}for(let N=0;N<d.symbolInstances.length;N++){const V=d.symbolInstances.get(N);V.crossTileID||(V.crossTileID=y.generate(),C[V.crossTileID]=!0)}return void 0===this.indexes[n.overscaledZ]&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Ki(n,d.symbolInstances,d.bucketInstanceId),!0}removeBucketCrossTileIDs(n,d){for(const y of d.getCrossTileIDsLists())for(const C of y)delete this.usedCrossTileIDs[n][C]}removeStaleBuckets(n){let d=!1;for(const y in this.indexes){const C=this.indexes[y];for(const N in C)n[C[N].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,C[N]),delete C[N],d=!0)}return d}}class Hi{constructor(){this.layerIndexes={},this.crossTileIDs=new tr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,d,y){let C=this.layerIndexes[n.id];void 0===C&&(C=this.layerIndexes[n.id]=new Hr);let N=!1;const V={};C.handleWrapJump(y);for(const Z of d){const Y=Z.getBucket(n);Y&&n.id===Y.layerIds[0]&&(Y.bucketInstanceId||(Y.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(Z.tileID,Y,this.crossTileIDs)&&(N=!0),V[Y.bucketInstanceId]=!0)}return C.removeStaleBuckets(V)&&(N=!0),N}pruneUnusedLayers(n){const d={};n.forEach(y=>{d[y]=!0});for(const y in this.layerIndexes)d[y]||delete this.layerIndexes[y]}}const hi=(w,n)=>x.emitValidationErrors(w,n&&n.filter(d=>"source.canvas"!==d.identifier)),Uo=x.pick(x.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),mo=x.pick(x.operations,["setCenter","setZoom","setBearing","setPitch"]),lo=x.emptyStyle();class Vi extends x.Evented{constructor(n,d={}){super(),this.map=n,this.dispatcher=new ft(Kn(),this,n._getMapId()),this.imageManager=new zt,this.imageManager.setEventedParent(this),this.glyphManager=new en(n._requestManager,d.localIdeographFontFamily),this.lineAtlas=new bi(256,512),this.crossTileSymbolIndex=new Hi,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new x.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",x.getReferrer());const y=this;this._rtlTextPluginCallback=Vi.registerForPluginStateChange(C=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:C.pluginStatus,pluginURL:C.pluginURL},(N,V)=>{if(x.triggerPluginCompletionEvent(N),V&&V.every(Z=>Z))for(const Z in y.sourceCaches){const Y=y.sourceCaches[Z].getSource().type;"vector"!==Y&&"geojson"!==Y||y.sourceCaches[Z].reload()}})}),this.on("data",C=>{if("source"!==C.dataType||"metadata"!==C.sourceDataType)return;const N=this.sourceCaches[C.sourceId];if(!N)return;const V=N.getSource();if(V&&V.vectorLayerIds)for(const Z in this._layers){const Y=this._layers[Z];Y.source===V.id&&this._validateLayer(Y)}})}loadURL(n,d={},y){this.fire(new x.Event("dataloading",{dataType:"style"})),d.validate="boolean"!=typeof d.validate||d.validate;const C=this.map._requestManager.transformRequest(n,dt.Style);this._request=x.getJSON(C,(N,V)=>{this._request=null,N?this.fire(new x.ErrorEvent(N)):V&&this._load(V,d,y)})}loadJSON(n,d={},y){this.fire(new x.Event("dataloading",{dataType:"style"})),this._request=x.exported.frame(()=>{this._request=null,d.validate=!1!==d.validate,this._load(n,d,y)})}loadEmpty(){this.fire(new x.Event("dataloading",{dataType:"style"})),this._load(lo,{validate:!1})}_load(n,d,y){const C=d.transformStyle?d.transformStyle(y,n):n;if(!d.validate||!hi(this,x.validateStyle(C))){this._loaded=!0,this.stylesheet=C;for(const N in C.sources)this.addSource(N,C.sources[N],{validate:!1});C.sprite?this._loadSprite(C.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(C.glyphs),this._createLayers(),this.light=new Mi(this.stylesheet.light),this.map.setTerrain(this.stylesheet.terrain),this.fire(new x.Event("data",{dataType:"style"})),this.fire(new x.Event("style.load"))}}_createLayers(){const n=x.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",n),this._order=n.map(d=>d.id),this._layers={},this._serializedLayers=null;for(const d of n){const y=x.createStyleLayer(d);y.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=y}}_loadSprite(n,d=!1,y=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(C,N,V,Z){const Y=wt(C),X=Y.length,le=V>1?"@2x":"",ae={},De={},ze={};for(const{id:ke,url:R}of Y){const k=N.transformRequest(N.normalizeSpriteURL(R,le,".json"),dt.SpriteJSON),O=`${ke}_${k.url}`;ae[O]=x.getJSON(k,(ie,ue)=>{delete ae[O],De[ke]=ue,Et(Z,De,ze,ie,X)});const z=N.transformRequest(N.normalizeSpriteURL(R,le,".png"),dt.SpriteImage),W=`${ke}_${z.url}`;ae[W]=nn.getImage(z,(ie,ue)=>{delete ae[W],ze[ke]=ue,Et(Z,De,ze,ie,X)})}return{cancel(){for(const ke of Object.values(ae))ke.cancel()}}}(n,this.map._requestManager,this.map.getPixelRatio(),(C,N)=>{if(this._spriteRequest=null,C)this.fire(new x.ErrorEvent(C));else if(N)for(const V in N){this._spritesImagesIds[V]=[];const Z=this._spritesImagesIds[V]?this._spritesImagesIds[V].filter(Y=>!(Y in N)):[];for(const Y of Z)this.imageManager.removeImage(Y),this._changedImages[Y]=!0;for(const Y in N[V]){const X="default"===V?Y:`${V}:${Y}`;this._spritesImagesIds[V].push(X),X in this.imageManager.images?this.imageManager.updateImage(X,N[V][Y],!1):this.imageManager.addImage(X,N[V][Y]),d&&(this._changedImages[X]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),d&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new x.Event("data",{dataType:"style"})),y&&y(C)})}_unloadSprite(){for(const n of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(n),this._changedImages[n]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new x.Event("data",{dataType:"style"}))}_validateLayer(n){const d=this.sourceCaches[n.source];if(!d)return;const y=n.sourceLayer;if(!y)return;const C=d.getSource();("geojson"===C.type||C.vectorLayerIds&&-1===C.vectorLayerIds.indexOf(y))&&this.fire(new x.ErrorEvent(new Error(`Source layer "${y}" does not exist on source "${C.id}" as specified by style layer "${n.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this.sourceCaches)if(!this.sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(n){const d=this._serializedAllLayers();if(!n||0===n.length)return Object.values(d);const y=[];for(const C of n)d[C]&&y.push(d[C]);return y}_serializedAllLayers(){let n=this._serializedLayers;if(n)return n;n=this._serializedLayers={};const d=Object.keys(this._layers);for(const y of d){const C=this._layers[y];"custom"!==C.type&&(n[y]=C.serialize())}return n}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const n in this.sourceCaches)if(this.sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(n){if(!this._loaded)return;const d=this._changed;if(this._changed){const C=Object.keys(this._updatedLayers),N=Object.keys(this._removedLayers);(C.length||N.length)&&this._updateWorkerLayers(C,N);for(const V in this._updatedSources){const Z=this._updatedSources[V];if("reload"===Z)this._reloadSource(V);else{if("clear"!==Z)throw new Error(`Invalid action ${Z}`);this._clearSource(V)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const V in this._updatedPaintProps)this._layers[V].updateTransitions(n);this.light.updateTransitions(n),this._resetUpdates()}const y={};for(const C in this.sourceCaches){const N=this.sourceCaches[C];y[C]=N.used,N.used=!1}for(const C of this._order){const N=this._layers[C];N.recalculate(n,this._availableImages),!N.isHidden(n.zoom)&&N.source&&(this.sourceCaches[N.source].used=!0)}for(const C in y){const N=this.sourceCaches[C];y[C]!==N.used&&N.fire(new x.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:C}))}this.light.recalculate(n),this.z=n.zoom,d&&this.fire(new x.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const d in this.sourceCaches)this.sourceCaches[d].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const n in this.sourceCaches)this.sourceCaches[n].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(n,d){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(n),removedIds:d})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(n,d={}){this._checkLoaded();const y=this.serialize();if(n=d.transformStyle?d.transformStyle(y,n):n,hi(this,x.validateStyle(n)))return!1;(n=x.clone$1(n)).layers=x.derefLayers(n.layers);const C=x.diffStyles(y,n).filter(V=>!(V.command in mo));if(0===C.length)return!1;const N=C.filter(V=>!(V.command in Uo));if(N.length>0)throw new Error(`Unimplemented: ${N.map(V=>V.command).join(", ")}.`);for(const V of C)"setTransition"!==V.command&&this[V.command].apply(this,V.args);return this.stylesheet=n,!0}addImage(n,d){if(this.getImage(n))return this.fire(new x.ErrorEvent(new Error(`An image named "${n}" already exists.`)));this.imageManager.addImage(n,d),this._afterImageUpdated(n)}updateImage(n,d){this.imageManager.updateImage(n,d)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new x.ErrorEvent(new Error(`An image named "${n}" does not exist.`)));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new x.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(n,d,y={}){if(this._checkLoaded(),void 0!==this.sourceCaches[n])throw new Error(`Source "${n}" already exists.`);if(!d.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(d).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(d.type)>=0&&this._validate(x.validateStyle.source,`sources.${n}`,d,null,y))return;this.map&&this.map._collectResourceTiming&&(d.collectResourceTiming=!0);const C=this.sourceCaches[n]=new kt(n,d,this.dispatcher);C.style=this,C.setEventedParent(this,()=>({isSourceLoaded:C.loaded(),source:C.serialize(),sourceId:n})),C.onAdd(this.map),this._changed=!0}removeSource(n){if(this._checkLoaded(),void 0===this.sourceCaches[n])throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===n)return this.fire(new x.ErrorEvent(new Error(`Source "${n}" cannot be removed while layer "${y}" is using it.`)));const d=this.sourceCaches[n];delete this.sourceCaches[n],delete this._updatedSources[n],d.fire(new x.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:n})),d.setEventedParent(null),d.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,d){if(this._checkLoaded(),void 0===this.sourceCaches[n])throw new Error(`There is no source with this ID=${n}`);const y=this.sourceCaches[n].getSource();if("geojson"!==y.type)throw new Error(`geojsonSource.type is ${y.type}, which is !== 'geojson`);y.setData(d),this._changed=!0}getSource(n){return this.sourceCaches[n]&&this.sourceCaches[n].getSource()}addLayer(n,d,y={}){this._checkLoaded();const C=n.id;if(this.getLayer(C))return void this.fire(new x.ErrorEvent(new Error(`Layer "${C}" already exists on this map.`)));let N;if("custom"===n.type){if(hi(this,x.validateCustomStyleLayer(n)))return;N=x.createStyleLayer(n)}else{if("object"==typeof n.source&&(this.addSource(C,n.source),n=x.clone$1(n),n=x.extend(n,{source:C})),this._validate(x.validateStyle.layer,`layers.${C}`,n,{arrayIndex:-1},y))return;N=x.createStyleLayer(n),this._validateLayer(N),N.setEventedParent(this,{layer:{id:C}})}const V=d?this._order.indexOf(d):this._order.length;if(d&&-1===V)this.fire(new x.ErrorEvent(new Error(`Cannot add layer "${C}" before non-existing layer "${d}".`)));else{if(this._order.splice(V,0,C),this._layerOrderChanged=!0,this._layers[C]=N,this._removedLayers[C]&&N.source&&"custom"!==N.type){const Z=this._removedLayers[C];delete this._removedLayers[C],Z.type!==N.type?this._updatedSources[N.source]="clear":(this._updatedSources[N.source]="reload",this.sourceCaches[N.source].pause())}this._updateLayer(N),N.onAdd&&N.onAdd(this.map)}}moveLayer(n,d){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new x.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===d)return;const y=this._order.indexOf(n);this._order.splice(y,1);const C=d?this._order.indexOf(d):this._order.length;d&&-1===C?this.fire(new x.ErrorEvent(new Error(`Cannot move layer "${n}" before non-existing layer "${d}".`))):(this._order.splice(C,0,n),this._layerOrderChanged=!0)}removeLayer(n){this._checkLoaded();const d=this._layers[n];if(!d)return void this.fire(new x.ErrorEvent(new Error(`Cannot remove non-existing layer "${n}".`)));d.setEventedParent(null);const y=this._order.indexOf(n);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=d,delete this._layers[n],this._serializedLayers&&delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],d.onRemove&&d.onRemove(this.map)}getLayer(n){return this._layers[n]}hasLayer(n){return n in this._layers}setLayerZoomRange(n,d,y){this._checkLoaded();const C=this.getLayer(n);C?C.minzoom===d&&C.maxzoom===y||(null!=d&&(C.minzoom=d),null!=y&&(C.maxzoom=y),this._updateLayer(C)):this.fire(new x.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${n}".`)))}setFilter(n,d,y={}){this._checkLoaded();const C=this.getLayer(n);if(C){if(!x.deepEqual(C.filter,d))return null==d?(C.filter=void 0,void this._updateLayer(C)):void(this._validate(x.validateStyle.filter,`layers.${C.id}.filter`,d,null,y)||(C.filter=x.clone$1(d),this._updateLayer(C)))}else this.fire(new x.ErrorEvent(new Error(`Cannot filter non-existing layer "${n}".`)))}getFilter(n){return x.clone$1(this.getLayer(n).filter)}setLayoutProperty(n,d,y,C={}){this._checkLoaded();const N=this.getLayer(n);N?x.deepEqual(N.getLayoutProperty(d),y)||(N.setLayoutProperty(d,y,C),this._updateLayer(N)):this.fire(new x.ErrorEvent(new Error(`Cannot style non-existing layer "${n}".`)))}getLayoutProperty(n,d){const y=this.getLayer(n);if(y)return y.getLayoutProperty(d);this.fire(new x.ErrorEvent(new Error(`Cannot get style of non-existing layer "${n}".`)))}setPaintProperty(n,d,y,C={}){this._checkLoaded();const N=this.getLayer(n);N?x.deepEqual(N.getPaintProperty(d),y)||(N.setPaintProperty(d,y,C)&&this._updateLayer(N),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new x.ErrorEvent(new Error(`Cannot style non-existing layer "${n}".`)))}getPaintProperty(n,d){return this.getLayer(n).getPaintProperty(d)}setFeatureState(n,d){this._checkLoaded();const y=n.source,C=n.sourceLayer,N=this.sourceCaches[y];if(void 0===N)return void this.fire(new x.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const V=N.getSource().type;"geojson"===V&&C?this.fire(new x.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==V||C?(void 0===n.id&&this.fire(new x.ErrorEvent(new Error("The feature id parameter must be provided."))),N.setFeatureState(C,n.id,d)):this.fire(new x.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(n,d){this._checkLoaded();const y=n.source,C=this.sourceCaches[y];if(void 0===C)return void this.fire(new x.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const N=C.getSource().type,V="vector"===N?n.sourceLayer:void 0;"vector"!==N||V?d&&"string"!=typeof n.id&&"number"!=typeof n.id?this.fire(new x.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):C.removeFeatureState(V,n.id,d):this.fire(new x.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(n){this._checkLoaded();const d=n.source,y=n.sourceLayer,C=this.sourceCaches[d];if(void 0!==C)return"vector"!==C.getSource().type||y?(void 0===n.id&&this.fire(new x.ErrorEvent(new Error("The feature id parameter must be provided."))),C.getFeatureState(y,n.id)):void this.fire(new x.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new x.ErrorEvent(new Error(`The source '${d}' does not exist in the map's style.`)))}getTransition(){return x.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const n=x.mapObject(this.sourceCaches,C=>C.serialize()),d=this._serializeByIds(this._order),y=this.stylesheet;return x.filterObject({version:y.version,name:y.name,metadata:y.metadata,light:y.light,center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch,sprite:y.sprite,glyphs:y.glyphs,transition:y.transition,sources:n,layers:d},C=>void 0!==C)}_updateLayer(n){this._updatedLayers[n.id]=!0,n.source&&!this._updatedSources[n.source]&&"raster"!==this.sourceCaches[n.source].getSource().type&&(this._updatedSources[n.source]="reload",this.sourceCaches[n.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(n){const d=V=>"fill-extrusion"===this._layers[V].type,y={},C=[];for(let V=this._order.length-1;V>=0;V--){const Z=this._order[V];if(d(Z)){y[Z]=V;for(const Y of n){const X=Y[Z];if(X)for(const le of X)C.push(le)}}}C.sort((V,Z)=>Z.intersectionZ-V.intersectionZ);const N=[];for(let V=this._order.length-1;V>=0;V--){const Z=this._order[V];if(d(Z))for(let Y=C.length-1;Y>=0;Y--){const X=C[Y].feature;if(y[X.layer.id]<V)break;N.push(X),C.pop()}else for(const Y of n){const X=Y[Z];if(X)for(const le of X)N.push(le.feature)}}return N}queryRenderedFeatures(n,d,y){d&&d.filter&&this._validate(x.validateStyle.filter,"queryRenderedFeatures.filter",d.filter,null,d);const C={};if(d&&d.layers){if(!Array.isArray(d.layers))return this.fire(new x.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const Z of d.layers){const Y=this._layers[Z];if(!Y)return this.fire(new x.ErrorEvent(new Error(`The layer '${Z}' does not exist in the map's style and cannot be queried for features.`))),[];C[Y.source]=!0}}const N=[];d.availableImages=this._availableImages;const V=this._serializedAllLayers();for(const Z in this.sourceCaches)d.layers&&!C[Z]||N.push(Mn(this.sourceCaches[Z],this._layers,V,n,d,y));return this.placement&&N.push(function(Z,Y,X,le,ae,De,ze){const ke={},R=De.queryRenderedSymbols(le),k=[];for(const O of Object.keys(R).map(Number))k.push(ze[O]);k.sort(An);for(const O of k){const z=O.featureIndex.lookupSymbolFeatures(R[O.bucketInstanceId],Y,O.bucketIndex,O.sourceLayerIndex,ae.filter,ae.layers,ae.availableImages,Z);for(const W in z){const ie=ke[W]=ke[W]||[],ue=z[W];ue.sort((Ne,et)=>{const Mt=O.featureSortOrder;if(Mt){const vt=Mt.indexOf(Ne.featureIndex);return Mt.indexOf(et.featureIndex)-vt}return et.featureIndex-Ne.featureIndex});for(const Ne of ue)ie.push(Ne)}}for(const O in ke)ke[O].forEach(z=>{const W=z.feature,ie=X[Z[O].source].getFeatureState(W.layer["source-layer"],W.id);W.source=W.layer.source,W.layer["source-layer"]&&(W.sourceLayer=W.layer["source-layer"]),W.state=ie});return ke}(this._layers,V,this.sourceCaches,n,d,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(N)}querySourceFeatures(n,d){d&&d.filter&&this._validate(x.validateStyle.filter,"querySourceFeatures.filter",d.filter,null,d);const y=this.sourceCaches[n];return y?function(C,N){const V=C.getRenderableIds().map(X=>C.getTileByID(X)),Z=[],Y={};for(let X=0;X<V.length;X++){const le=V[X],ae=le.tileID.canonical.key;Y[ae]||(Y[ae]=!0,le.querySourceFeatures(Z,N))}return Z}(y,d):[]}addSourceType(n,d,y){return Vi.getSourceType(n)?y(new Error(`A source type called "${n}" already exists.`)):(Vi.setSourceType(n,d),d.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:d.workerSourceURL},y):y(null,null))}getLight(){return this.light.getLight()}setLight(n,d={}){this._checkLoaded();const y=this.light.getLight();let C=!1;for(const V in n)if(!x.deepEqual(n[V],y[V])){C=!0;break}if(!C)return;const N={now:x.exported.now(),transition:x.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,d),this.light.updateTransitions(N)}_validate(n,d,y,C,N={}){return(!N||!1!==N.validate)&&hi(this,n.call(x.validateStyle,x.extend({key:d,style:this.serialize(),value:y,styleSpec:x.v8Spec},C)))}_remove(n=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),x.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const d in this._layers)this._layers[d].setEventedParent(null);for(const d in this.sourceCaches){const y=this.sourceCaches[d];y.setEventedParent(null),y.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(n)}_clearSource(n){this.sourceCaches[n].clearTiles()}_reloadSource(n){this.sourceCaches[n].resume(),this.sourceCaches[n].reload()}_updateSources(n){for(const d in this.sourceCaches)this.sourceCaches[d].update(n,this.map.terrain)}_generateCollisionBoxes(){for(const n in this.sourceCaches)this._reloadSource(n)}_updatePlacement(n,d,y,C,N=!1){let V=!1,Z=!1;const Y={};for(const X of this._order){const le=this._layers[X];if("symbol"!==le.type)continue;if(!Y[le.source]){const De=this.sourceCaches[le.source];Y[le.source]=De.getRenderableIds(!0).map(ze=>De.getTileByID(ze)).sort((ze,ke)=>ke.tileID.overscaledZ-ze.tileID.overscaledZ||(ze.tileID.isLessThan(ke.tileID)?-1:1))}const ae=this.crossTileSymbolIndex.addLayer(le,Y[le.source],n.center.lng);V=V||ae}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((N=N||this._layerOrderChanged||0===y)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(x.exported.now(),n.zoom))&&(this.pauseablePlacement=new ji(n,this.map.terrain,this._order,N,d,y,C,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Y),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(x.exported.now()),Z=!0),V&&this.pauseablePlacement.placement.setStale()),Z||V)for(const X of this._order){const le=this._layers[X];"symbol"===le.type&&this.placement.updateLayerOpacities(le,Y[le.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(x.exported.now())}_releaseSymbolFadeTiles(){for(const n in this.sourceCaches)this.sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,d,y){this.imageManager.getImages(d.icons,y),this._updateTilesForChangedImages();const C=this.sourceCaches[d.source];C&&C.setDependencies(d.tileID.key,d.type,d.icons)}getGlyphs(n,d,y){this.glyphManager.getGlyphs(d.stacks,y);const C=this.sourceCaches[d.source];C&&C.setDependencies(d.tileID.key,d.type,[""])}getResource(n,d,y){return x.makeRequest(d,y)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(n,d={}){this._checkLoaded(),n&&this._validate(x.validateStyle.glyphs,"glyphs",n,null,d)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=n,this.glyphManager.entries={},this.glyphManager.setURL(n))}addSprite(n,d,y={},C){this._checkLoaded();const N=[{id:n,url:d}],V=[...wt(this.stylesheet.sprite),...N];this._validate(x.validateStyle.sprite,"sprite",V,null,y)||(this.stylesheet.sprite=V,this._loadSprite(N,!0,C))}removeSprite(n){this._checkLoaded();const d=wt(this.stylesheet.sprite);if(d.find(y=>y.id===n)){if(this._spritesImagesIds[n])for(const y of this._spritesImagesIds[n])this.imageManager.removeImage(y),this._changedImages[y]=!0;d.splice(d.findIndex(y=>y.id===n),1),this.stylesheet.sprite=d.length>0?d:void 0,delete this._spritesImagesIds[n],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new x.Event("data",{dataType:"style"}))}else this.fire(new x.ErrorEvent(new Error(`Sprite "${n}" doesn't exists on this map.`)))}getSprite(){return wt(this.stylesheet.sprite)}setSprite(n,d={},y){this._checkLoaded(),n&&this._validate(x.validateStyle.sprite,"sprite",n,null,d)||(this.stylesheet.sprite=n,n?this._loadSprite(n,!0,y):(this._unloadSprite(),y&&y(null)))}}Vi.getSourceType=function(w){return Ci[w]},Vi.setSourceType=function(w,n){Ci[w]=n},Vi.registerForPluginStateChange=x.registerForPluginStateChange;var us=x.createLayout([{name:"a_pos",type:"Int16",components:2}]),ds="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const es={prelude:ir("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\n","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}"),background:ir("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:ir("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:ir("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:ir("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ir("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),heatmapTexture:ir("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:ir("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ir("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ir("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:ir("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),fillOutline:ir("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillOutlinePattern:ir("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),fillPattern:ir("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:ir("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:ir("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;\n#ifdef TERRAIN3D\nattribute vec2 a_centroid;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:ir("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ir("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:ir("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:ir("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:ir("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:ir("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:ir("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:ir("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:ir("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:ir("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:ir("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",ds),terrainDepth:ir("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",ds),terrainCoords:ir("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",ds)};function ir(w,n){const d=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=n.match(/attribute ([\w]+) ([\w]+)/g),C=w.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),N=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),V=N?N.concat(C):C,Z={};return{fragmentSource:w=w.replace(d,(Y,X,le,ae,De)=>(Z[De]=!0,"define"===X?`\n#ifndef HAS_UNIFORM_u_${De}\nvarying ${le} ${ae} ${De};\n#else\nuniform ${le} ${ae} u_${De};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${De}\n    ${le} ${ae} ${De} = u_${De};\n#endif\n`)),vertexSource:n=n.replace(d,(Y,X,le,ae,De)=>{const ze="float"===ae?"vec2":"vec4",ke=De.match(/color/)?"color":ze;return Z[De]?"define"===X?`\n#ifndef HAS_UNIFORM_u_${De}\nuniform lowp float u_${De}_t;\nattribute ${le} ${ze} a_${De};\nvarying ${le} ${ae} ${De};\n#else\nuniform ${le} ${ae} u_${De};\n#endif\n`:"vec4"===ke?`\n#ifndef HAS_UNIFORM_u_${De}\n    ${De} = a_${De};\n#else\n    ${le} ${ae} ${De} = u_${De};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${De}\n    ${De} = unpack_mix_${ke}(a_${De}, u_${De}_t);\n#else\n    ${le} ${ae} ${De} = u_${De};\n#endif\n`:"define"===X?`\n#ifndef HAS_UNIFORM_u_${De}\nuniform lowp float u_${De}_t;\nattribute ${le} ${ze} a_${De};\n#else\nuniform ${le} ${ae} u_${De};\n#endif\n`:"vec4"===ke?`\n#ifndef HAS_UNIFORM_u_${De}\n    ${le} ${ae} ${De} = a_${De};\n#else\n    ${le} ${ae} ${De} = u_${De};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${De}\n    ${le} ${ae} ${De} = unpack_mix_${ke}(a_${De}, u_${De}_t);\n#else\n    ${le} ${ae} ${De} = u_${De};\n#endif\n`}),staticAttributes:y,staticUniforms:V}}class Ts{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,d,y,C,N,V,Z,Y,X){this.context=n;let le=this.boundPaintVertexBuffers.length!==C.length;for(let ae=0;!le&&ae<C.length;ae++)this.boundPaintVertexBuffers[ae]!==C[ae]&&(le=!0);!this.vao||this.boundProgram!==d||this.boundLayoutVertexBuffer!==y||le||this.boundIndexBuffer!==N||this.boundVertexOffset!==V||this.boundDynamicVertexBuffer!==Z||this.boundDynamicVertexBuffer2!==Y||this.boundDynamicVertexBuffer3!==X?this.freshBind(d,y,C,N,V,Z,Y,X):(n.bindVertexArray.set(this.vao),Z&&Z.bind(),N&&N.dynamicDraw&&N.bind(),Y&&Y.bind(),X&&X.bind())}freshBind(n,d,y,C,N,V,Z,Y){const X=n.numAttributes,le=this.context,ae=le.gl;this.vao&&this.destroy(),this.vao=le.createVertexArray(),le.bindVertexArray.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=d,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=C,this.boundVertexOffset=N,this.boundDynamicVertexBuffer=V,this.boundDynamicVertexBuffer2=Z,this.boundDynamicVertexBuffer3=Y,d.enableAttributes(ae,n);for(const De of y)De.enableAttributes(ae,n);V&&V.enableAttributes(ae,n),Z&&Z.enableAttributes(ae,n),Y&&Y.enableAttributes(ae,n),d.bind(),d.setVertexAttribPointers(ae,n,N);for(const De of y)De.bind(),De.setVertexAttribPointers(ae,n,N);V&&(V.bind(),V.setVertexAttribPointers(ae,n,N)),C&&C.bind(),Z&&(Z.bind(),Z.setVertexAttribPointers(ae,n,N)),Y&&(Y.bind(),Y.setVertexAttribPointers(ae,n,N)),le.currentNumAttributes=X}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function da(w){const n=[];for(let d=0;d<w.length;d++){if(null===w[d])continue;const y=w[d].split(" ");n.push(y.pop())}return n}class Ss{constructor(n,d,y,C,N,V,Z){const Y=n.gl;this.program=Y.createProgram();const X=da(y.staticAttributes),le=C?C.getBinderAttributes():[],ae=X.concat(le),De=es.prelude.staticUniforms?da(es.prelude.staticUniforms):[],ze=y.staticUniforms?da(y.staticUniforms):[],ke=C?C.getBinderUniforms():[],R=De.concat(ze).concat(ke),k=[];for(const et of R)k.indexOf(et)<0&&k.push(et);const O=C?C.defines():[];V&&O.push("#define OVERDRAW_INSPECTOR;"),Z&&O.push("#define TERRAIN3D;");const z=O.concat(es.prelude.fragmentSource,y.fragmentSource).join("\n"),W=O.concat(es.prelude.vertexSource,y.vertexSource).join("\n"),ie=Y.createShader(Y.FRAGMENT_SHADER);if(Y.isContextLost())return void(this.failedToCreate=!0);Y.shaderSource(ie,z),Y.compileShader(ie),Y.attachShader(this.program,ie);const ue=Y.createShader(Y.VERTEX_SHADER);if(Y.isContextLost())return void(this.failedToCreate=!0);Y.shaderSource(ue,W),Y.compileShader(ue),Y.attachShader(this.program,ue),this.attributes={};const Ne={};this.numAttributes=ae.length;for(let et=0;et<this.numAttributes;et++)ae[et]&&(Y.bindAttribLocation(this.program,et,ae[et]),this.attributes[ae[et]]=et);Y.linkProgram(this.program),Y.deleteShader(ue),Y.deleteShader(ie);for(let et=0;et<k.length;et++){const Mt=k[et];if(Mt&&!Ne[Mt]){const vt=Y.getUniformLocation(this.program,Mt);vt&&(Ne[Mt]=vt)}}var et,Mt;this.fixedUniforms=N(n,Ne),this.terrainUniforms={u_depth:new x.Uniform1i(et=n,(Mt=Ne).u_depth),u_terrain:new x.Uniform1i(et,Mt.u_terrain),u_terrain_dim:new x.Uniform1f(et,Mt.u_terrain_dim),u_terrain_matrix:new x.UniformMatrix4f(et,Mt.u_terrain_matrix),u_terrain_unpack:new x.Uniform4f(et,Mt.u_terrain_unpack),u_terrain_exaggeration:new x.Uniform1f(et,Mt.u_terrain_exaggeration)},this.binderUniforms=C?C.getUniforms(n,Ne):[]}draw(n,d,y,C,N,V,Z,Y,X,le,ae,De,ze,ke,R,k,O,z){const W=n.gl;if(this.failedToCreate)return;if(n.program.set(this.program),n.setDepthMode(y),n.setStencilMode(C),n.setColorMode(N),n.setCullFace(V),Y){n.activeTexture.set(W.TEXTURE2),W.bindTexture(W.TEXTURE_2D,Y.depthTexture),n.activeTexture.set(W.TEXTURE3),W.bindTexture(W.TEXTURE_2D,Y.texture);for(const ue in this.terrainUniforms)this.terrainUniforms[ue].set(Y[ue])}for(const ue in this.fixedUniforms)this.fixedUniforms[ue].set(Z[ue]);R&&R.setUniforms(n,this.binderUniforms,ze,{zoom:ke});let ie=0;switch(d){case W.LINES:ie=2;break;case W.TRIANGLES:ie=3;break;case W.LINE_STRIP:ie=1}for(const ue of De.get()){const Ne=ue.vaos||(ue.vaos={});(Ne[X]||(Ne[X]=new Ts)).bind(n,this,le,R?R.getPaintVertexBuffers():[],ae,ue.vertexOffset,k,O,z),W.drawElements(d,ue.primitiveLength*ie,W.UNSIGNED_SHORT,ue.primitiveOffset*ie*2)}}}function io(w,n,d){const y=1/me(d,1,n.transform.tileZoom),C=Math.pow(2,d.tileID.overscaledZ),N=d.tileSize*Math.pow(2,n.transform.tileZoom)/C,V=N*(d.tileID.canonical.x+d.tileID.wrap*C),Z=N*d.tileID.canonical.y;return{u_image:0,u_texsize:d.imageAtlasTexture.size,u_scale:[y,w.fromScale,w.toScale],u_fade:w.t,u_pixel_coord_upper:[V>>16,Z>>16],u_pixel_coord_lower:[65535&V,65535&Z]}}const Za=(w,n,d,y)=>{const C=n.style.light,N=C.properties.get("position"),V=[N.x,N.y,N.z],Z=(X=new x.ARRAY_TYPE(9),x.ARRAY_TYPE!=Float32Array&&(X[1]=0,X[2]=0,X[3]=0,X[5]=0,X[6]=0,X[7]=0),X[0]=1,X[4]=1,X[8]=1,X);var X;"viewport"===C.properties.get("anchor")&&function(X,le){var ae=Math.sin(le),De=Math.cos(le);X[0]=De,X[1]=ae,X[2]=0,X[3]=-ae,X[4]=De,X[5]=0,X[6]=0,X[7]=0,X[8]=1}(Z,-n.transform.angle),function(X,le,ae){var De=le[0],ze=le[1],ke=le[2];X[0]=De*ae[0]+ze*ae[3]+ke*ae[6],X[1]=De*ae[1]+ze*ae[4]+ke*ae[7],X[2]=De*ae[2]+ze*ae[5]+ke*ae[8]}(V,V,Z);const Y=C.properties.get("color");return{u_matrix:w,u_lightpos:V,u_lightintensity:C.properties.get("intensity"),u_lightcolor:[Y.r,Y.g,Y.b],u_vertical_gradient:+d,u_opacity:y}},ts=(w,n,d,y,C,N,V)=>x.extend(Za(w,n,d,y),io(N,n,V),{u_height_factor:-Math.pow(2,C.overscaledZ)/V.tileSize/8}),Ta=w=>({u_matrix:w}),hs=(w,n,d,y)=>x.extend(Ta(w),io(d,n,y)),Sa=(w,n)=>({u_matrix:w,u_world:n}),Qs=(w,n,d,y,C)=>x.extend(hs(w,n,d,y),{u_world:C}),$s=(w,n,d,y)=>{const C=w.transform;let N,V;if("map"===y.paint.get("circle-pitch-alignment")){const Z=me(d,1,C.zoom);N=!0,V=[Z,Z]}else N=!1,V=C.pixelsToGLUnits;return{u_camera_to_center_distance:C.cameraToCenterDistance,u_scale_with_map:+("map"===y.paint.get("circle-pitch-scale")),u_matrix:w.translatePosMatrix(n.posMatrix,d,y.paint.get("circle-translate"),y.paint.get("circle-translate-anchor")),u_pitch_with_map:+N,u_device_pixel_ratio:w.pixelRatio,u_extrude_scale:V}},Oo=(w,n,d)=>{const y=me(d,1,n.zoom),C=Math.pow(2,n.zoom-d.tileID.overscaledZ),N=d.tileID.overscaleFactor();return{u_matrix:w,u_camera_to_center_distance:n.cameraToCenterDistance,u_pixels_to_tile_units:y,u_extrude_scale:[n.pixelsToGLUnits[0]/(y*C),n.pixelsToGLUnits[1]/(y*C)],u_overscale_factor:N}},Ya=(w,n,d=1)=>({u_matrix:w,u_color:n,u_overlay:0,u_overlay_scale:d}),Ma=w=>({u_matrix:w}),dl=(w,n,d,y)=>({u_matrix:w,u_extrude_scale:me(n,1,d),u_intensity:y});function dr(w,n){const d=Math.pow(2,n.canonical.z),y=n.canonical.y;return[new x.MercatorCoordinate(0,y/d).toLngLat().lat,new x.MercatorCoordinate(0,(y+1)/d).toLngLat().lat]}const $r=(w,n,d,y)=>{const C=w.transform;return{u_matrix:ks(w,n,d,y),u_ratio:1/me(n,1,C.zoom),u_device_pixel_ratio:w.pixelRatio,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},bo=(w,n,d,y,C)=>x.extend($r(w,n,d,C),{u_image:0,u_image_height:y}),xo=(w,n,d,y,C)=>{const N=w.transform,V=Ms(n,N);return{u_matrix:ks(w,n,d,C),u_texsize:n.imageAtlasTexture.size,u_ratio:1/me(n,1,N.zoom),u_device_pixel_ratio:w.pixelRatio,u_image:0,u_scale:[V,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/N.pixelsToGLUnits[0],1/N.pixelsToGLUnits[1]]}},Po=(w,n,d,y,C,N)=>{const V=w.lineAtlas,Z=Ms(n,w.transform),Y="round"===d.layout.get("line-cap"),X=V.getDash(y.from,Y),le=V.getDash(y.to,Y),ae=X.width*C.fromScale,De=le.width*C.toScale;return x.extend($r(w,n,d,N),{u_patternscale_a:[Z/ae,-X.height/2],u_patternscale_b:[Z/De,-le.height/2],u_sdfgamma:V.width/(256*Math.min(ae,De)*w.pixelRatio)/2,u_image:0,u_tex_y_a:X.y,u_tex_y_b:le.y,u_mix:C.t})};function Ms(w,n){return 1/me(w,1,n.tileZoom)}function ks(w,n,d,y){return w.translatePosMatrix(y?y.posMatrix:n.tileID.posMatrix,n,d.paint.get("line-translate"),d.paint.get("line-translate-anchor"))}const Gs=(w,n,d,y,C)=>{return{u_matrix:w,u_tl_parent:n,u_scale_parent:d,u_buffer_scale:1,u_fade_t:y.mix,u_opacity:y.opacity*C.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:C.paint.get("raster-brightness-min"),u_brightness_high:C.paint.get("raster-brightness-max"),u_saturation_factor:(V=C.paint.get("raster-saturation"),V>0?1-1/(1.001-V):-V),u_contrast_factor:(N=C.paint.get("raster-contrast"),N>0?1/(1-N):1+N),u_spin_weights:qa(C.paint.get("raster-hue-rotate"))};var N,V};function qa(w){w*=Math.PI/180;const n=Math.sin(w),d=Math.cos(w);return[(2*d+1)/3,(-Math.sqrt(3)*n-d+1)/3,(Math.sqrt(3)*n-d+1)/3]}const Fs=(w,n,d,y,C,N,V,Z,Y,X)=>{const le=C.transform;return{u_is_size_zoom_constant:+("constant"===w||"source"===w),u_is_size_feature_constant:+("constant"===w||"camera"===w),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:le.cameraToCenterDistance,u_pitch:le.pitch/360*2*Math.PI,u_rotate_symbol:+d,u_aspect_ratio:le.width/le.height,u_fade_change:C.options.fadeDuration?C.symbolFadeChange:1,u_matrix:N,u_label_plane_matrix:V,u_coord_matrix:Z,u_is_text:+Y,u_pitch_with_map:+y,u_texsize:X,u_texture:0}},rr=(w,n,d,y,C,N,V,Z,Y,X,le)=>{const ae=C.transform;return x.extend(Fs(w,n,d,y,C,N,V,Z,Y,X),{u_gamma_scale:y?Math.cos(ae._pitch)*ae.cameraToCenterDistance:1,u_device_pixel_ratio:C.pixelRatio,u_is_halo:+le})},Ln=(w,n,d,y,C,N,V,Z,Y,X)=>x.extend(rr(w,n,d,y,C,N,V,Z,!0,Y,!0),{u_texsize_icon:X,u_texture_icon:1}),ai=(w,n,d)=>({u_matrix:w,u_opacity:n,u_color:d}),Fi=(w,n,d,y,C,N)=>x.extend(function(V,Z,Y,X){const le=Y.imageManager.getPattern(V.from.toString()),ae=Y.imageManager.getPattern(V.to.toString()),{width:De,height:ze}=Y.imageManager.getPixelSize(),ke=Math.pow(2,X.tileID.overscaledZ),R=X.tileSize*Math.pow(2,Y.transform.tileZoom)/ke,k=R*(X.tileID.canonical.x+X.tileID.wrap*ke),O=R*X.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:le.tl,u_pattern_br_a:le.br,u_pattern_tl_b:ae.tl,u_pattern_br_b:ae.br,u_texsize:[De,ze],u_mix:Z.t,u_pattern_size_a:le.displaySize,u_pattern_size_b:ae.displaySize,u_scale_a:Z.fromScale,u_scale_b:Z.toScale,u_tile_units_to_pixels:1/me(X,1,Y.transform.tileZoom),u_pixel_coord_upper:[k>>16,O>>16],u_pixel_coord_lower:[65535&k,65535&O]}}(y,N,d,C),{u_matrix:w,u_opacity:n}),ro={fillExtrusion:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_lightpos:new x.Uniform3f(w,n.u_lightpos),u_lightintensity:new x.Uniform1f(w,n.u_lightintensity),u_lightcolor:new x.Uniform3f(w,n.u_lightcolor),u_vertical_gradient:new x.Uniform1f(w,n.u_vertical_gradient),u_opacity:new x.Uniform1f(w,n.u_opacity)}),fillExtrusionPattern:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_lightpos:new x.Uniform3f(w,n.u_lightpos),u_lightintensity:new x.Uniform1f(w,n.u_lightintensity),u_lightcolor:new x.Uniform3f(w,n.u_lightcolor),u_vertical_gradient:new x.Uniform1f(w,n.u_vertical_gradient),u_height_factor:new x.Uniform1f(w,n.u_height_factor),u_image:new x.Uniform1i(w,n.u_image),u_texsize:new x.Uniform2f(w,n.u_texsize),u_pixel_coord_upper:new x.Uniform2f(w,n.u_pixel_coord_upper),u_pixel_coord_lower:new x.Uniform2f(w,n.u_pixel_coord_lower),u_scale:new x.Uniform3f(w,n.u_scale),u_fade:new x.Uniform1f(w,n.u_fade),u_opacity:new x.Uniform1f(w,n.u_opacity)}),fill:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix)}),fillPattern:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_image:new x.Uniform1i(w,n.u_image),u_texsize:new x.Uniform2f(w,n.u_texsize),u_pixel_coord_upper:new x.Uniform2f(w,n.u_pixel_coord_upper),u_pixel_coord_lower:new x.Uniform2f(w,n.u_pixel_coord_lower),u_scale:new x.Uniform3f(w,n.u_scale),u_fade:new x.Uniform1f(w,n.u_fade)}),fillOutline:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_world:new x.Uniform2f(w,n.u_world)}),fillOutlinePattern:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_world:new x.Uniform2f(w,n.u_world),u_image:new x.Uniform1i(w,n.u_image),u_texsize:new x.Uniform2f(w,n.u_texsize),u_pixel_coord_upper:new x.Uniform2f(w,n.u_pixel_coord_upper),u_pixel_coord_lower:new x.Uniform2f(w,n.u_pixel_coord_lower),u_scale:new x.Uniform3f(w,n.u_scale),u_fade:new x.Uniform1f(w,n.u_fade)}),circle:(w,n)=>({u_camera_to_center_distance:new x.Uniform1f(w,n.u_camera_to_center_distance),u_scale_with_map:new x.Uniform1i(w,n.u_scale_with_map),u_pitch_with_map:new x.Uniform1i(w,n.u_pitch_with_map),u_extrude_scale:new x.Uniform2f(w,n.u_extrude_scale),u_device_pixel_ratio:new x.Uniform1f(w,n.u_device_pixel_ratio),u_matrix:new x.UniformMatrix4f(w,n.u_matrix)}),collisionBox:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_camera_to_center_distance:new x.Uniform1f(w,n.u_camera_to_center_distance),u_pixels_to_tile_units:new x.Uniform1f(w,n.u_pixels_to_tile_units),u_extrude_scale:new x.Uniform2f(w,n.u_extrude_scale),u_overscale_factor:new x.Uniform1f(w,n.u_overscale_factor)}),collisionCircle:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_inv_matrix:new x.UniformMatrix4f(w,n.u_inv_matrix),u_camera_to_center_distance:new x.Uniform1f(w,n.u_camera_to_center_distance),u_viewport_size:new x.Uniform2f(w,n.u_viewport_size)}),debug:(w,n)=>({u_color:new x.UniformColor(w,n.u_color),u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_overlay:new x.Uniform1i(w,n.u_overlay),u_overlay_scale:new x.Uniform1f(w,n.u_overlay_scale)}),clippingMask:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix)}),heatmap:(w,n)=>({u_extrude_scale:new x.Uniform1f(w,n.u_extrude_scale),u_intensity:new x.Uniform1f(w,n.u_intensity),u_matrix:new x.UniformMatrix4f(w,n.u_matrix)}),heatmapTexture:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_world:new x.Uniform2f(w,n.u_world),u_image:new x.Uniform1i(w,n.u_image),u_color_ramp:new x.Uniform1i(w,n.u_color_ramp),u_opacity:new x.Uniform1f(w,n.u_opacity)}),hillshade:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_image:new x.Uniform1i(w,n.u_image),u_latrange:new x.Uniform2f(w,n.u_latrange),u_light:new x.Uniform2f(w,n.u_light),u_shadow:new x.UniformColor(w,n.u_shadow),u_highlight:new x.UniformColor(w,n.u_highlight),u_accent:new x.UniformColor(w,n.u_accent)}),hillshadePrepare:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_image:new x.Uniform1i(w,n.u_image),u_dimension:new x.Uniform2f(w,n.u_dimension),u_zoom:new x.Uniform1f(w,n.u_zoom),u_unpack:new x.Uniform4f(w,n.u_unpack)}),line:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_ratio:new x.Uniform1f(w,n.u_ratio),u_device_pixel_ratio:new x.Uniform1f(w,n.u_device_pixel_ratio),u_units_to_pixels:new x.Uniform2f(w,n.u_units_to_pixels)}),lineGradient:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_ratio:new x.Uniform1f(w,n.u_ratio),u_device_pixel_ratio:new x.Uniform1f(w,n.u_device_pixel_ratio),u_units_to_pixels:new x.Uniform2f(w,n.u_units_to_pixels),u_image:new x.Uniform1i(w,n.u_image),u_image_height:new x.Uniform1f(w,n.u_image_height)}),linePattern:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_texsize:new x.Uniform2f(w,n.u_texsize),u_ratio:new x.Uniform1f(w,n.u_ratio),u_device_pixel_ratio:new x.Uniform1f(w,n.u_device_pixel_ratio),u_image:new x.Uniform1i(w,n.u_image),u_units_to_pixels:new x.Uniform2f(w,n.u_units_to_pixels),u_scale:new x.Uniform3f(w,n.u_scale),u_fade:new x.Uniform1f(w,n.u_fade)}),lineSDF:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_ratio:new x.Uniform1f(w,n.u_ratio),u_device_pixel_ratio:new x.Uniform1f(w,n.u_device_pixel_ratio),u_units_to_pixels:new x.Uniform2f(w,n.u_units_to_pixels),u_patternscale_a:new x.Uniform2f(w,n.u_patternscale_a),u_patternscale_b:new x.Uniform2f(w,n.u_patternscale_b),u_sdfgamma:new x.Uniform1f(w,n.u_sdfgamma),u_image:new x.Uniform1i(w,n.u_image),u_tex_y_a:new x.Uniform1f(w,n.u_tex_y_a),u_tex_y_b:new x.Uniform1f(w,n.u_tex_y_b),u_mix:new x.Uniform1f(w,n.u_mix)}),raster:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_tl_parent:new x.Uniform2f(w,n.u_tl_parent),u_scale_parent:new x.Uniform1f(w,n.u_scale_parent),u_buffer_scale:new x.Uniform1f(w,n.u_buffer_scale),u_fade_t:new x.Uniform1f(w,n.u_fade_t),u_opacity:new x.Uniform1f(w,n.u_opacity),u_image0:new x.Uniform1i(w,n.u_image0),u_image1:new x.Uniform1i(w,n.u_image1),u_brightness_low:new x.Uniform1f(w,n.u_brightness_low),u_brightness_high:new x.Uniform1f(w,n.u_brightness_high),u_saturation_factor:new x.Uniform1f(w,n.u_saturation_factor),u_contrast_factor:new x.Uniform1f(w,n.u_contrast_factor),u_spin_weights:new x.Uniform3f(w,n.u_spin_weights)}),symbolIcon:(w,n)=>({u_is_size_zoom_constant:new x.Uniform1i(w,n.u_is_size_zoom_constant),u_is_size_feature_constant:new x.Uniform1i(w,n.u_is_size_feature_constant),u_size_t:new x.Uniform1f(w,n.u_size_t),u_size:new x.Uniform1f(w,n.u_size),u_camera_to_center_distance:new x.Uniform1f(w,n.u_camera_to_center_distance),u_pitch:new x.Uniform1f(w,n.u_pitch),u_rotate_symbol:new x.Uniform1i(w,n.u_rotate_symbol),u_aspect_ratio:new x.Uniform1f(w,n.u_aspect_ratio),u_fade_change:new x.Uniform1f(w,n.u_fade_change),u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_label_plane_matrix:new x.UniformMatrix4f(w,n.u_label_plane_matrix),u_coord_matrix:new x.UniformMatrix4f(w,n.u_coord_matrix),u_is_text:new x.Uniform1i(w,n.u_is_text),u_pitch_with_map:new x.Uniform1i(w,n.u_pitch_with_map),u_texsize:new x.Uniform2f(w,n.u_texsize),u_texture:new x.Uniform1i(w,n.u_texture)}),symbolSDF:(w,n)=>({u_is_size_zoom_constant:new x.Uniform1i(w,n.u_is_size_zoom_constant),u_is_size_feature_constant:new x.Uniform1i(w,n.u_is_size_feature_constant),u_size_t:new x.Uniform1f(w,n.u_size_t),u_size:new x.Uniform1f(w,n.u_size),u_camera_to_center_distance:new x.Uniform1f(w,n.u_camera_to_center_distance),u_pitch:new x.Uniform1f(w,n.u_pitch),u_rotate_symbol:new x.Uniform1i(w,n.u_rotate_symbol),u_aspect_ratio:new x.Uniform1f(w,n.u_aspect_ratio),u_fade_change:new x.Uniform1f(w,n.u_fade_change),u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_label_plane_matrix:new x.UniformMatrix4f(w,n.u_label_plane_matrix),u_coord_matrix:new x.UniformMatrix4f(w,n.u_coord_matrix),u_is_text:new x.Uniform1i(w,n.u_is_text),u_pitch_with_map:new x.Uniform1i(w,n.u_pitch_with_map),u_texsize:new x.Uniform2f(w,n.u_texsize),u_texture:new x.Uniform1i(w,n.u_texture),u_gamma_scale:new x.Uniform1f(w,n.u_gamma_scale),u_device_pixel_ratio:new x.Uniform1f(w,n.u_device_pixel_ratio),u_is_halo:new x.Uniform1i(w,n.u_is_halo)}),symbolTextAndIcon:(w,n)=>({u_is_size_zoom_constant:new x.Uniform1i(w,n.u_is_size_zoom_constant),u_is_size_feature_constant:new x.Uniform1i(w,n.u_is_size_feature_constant),u_size_t:new x.Uniform1f(w,n.u_size_t),u_size:new x.Uniform1f(w,n.u_size),u_camera_to_center_distance:new x.Uniform1f(w,n.u_camera_to_center_distance),u_pitch:new x.Uniform1f(w,n.u_pitch),u_rotate_symbol:new x.Uniform1i(w,n.u_rotate_symbol),u_aspect_ratio:new x.Uniform1f(w,n.u_aspect_ratio),u_fade_change:new x.Uniform1f(w,n.u_fade_change),u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_label_plane_matrix:new x.UniformMatrix4f(w,n.u_label_plane_matrix),u_coord_matrix:new x.UniformMatrix4f(w,n.u_coord_matrix),u_is_text:new x.Uniform1i(w,n.u_is_text),u_pitch_with_map:new x.Uniform1i(w,n.u_pitch_with_map),u_texsize:new x.Uniform2f(w,n.u_texsize),u_texsize_icon:new x.Uniform2f(w,n.u_texsize_icon),u_texture:new x.Uniform1i(w,n.u_texture),u_texture_icon:new x.Uniform1i(w,n.u_texture_icon),u_gamma_scale:new x.Uniform1f(w,n.u_gamma_scale),u_device_pixel_ratio:new x.Uniform1f(w,n.u_device_pixel_ratio),u_is_halo:new x.Uniform1i(w,n.u_is_halo)}),background:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_opacity:new x.Uniform1f(w,n.u_opacity),u_color:new x.UniformColor(w,n.u_color)}),backgroundPattern:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_opacity:new x.Uniform1f(w,n.u_opacity),u_image:new x.Uniform1i(w,n.u_image),u_pattern_tl_a:new x.Uniform2f(w,n.u_pattern_tl_a),u_pattern_br_a:new x.Uniform2f(w,n.u_pattern_br_a),u_pattern_tl_b:new x.Uniform2f(w,n.u_pattern_tl_b),u_pattern_br_b:new x.Uniform2f(w,n.u_pattern_br_b),u_texsize:new x.Uniform2f(w,n.u_texsize),u_mix:new x.Uniform1f(w,n.u_mix),u_pattern_size_a:new x.Uniform2f(w,n.u_pattern_size_a),u_pattern_size_b:new x.Uniform2f(w,n.u_pattern_size_b),u_scale_a:new x.Uniform1f(w,n.u_scale_a),u_scale_b:new x.Uniform1f(w,n.u_scale_b),u_pixel_coord_upper:new x.Uniform2f(w,n.u_pixel_coord_upper),u_pixel_coord_lower:new x.Uniform2f(w,n.u_pixel_coord_lower),u_tile_units_to_pixels:new x.Uniform1f(w,n.u_tile_units_to_pixels)}),terrain:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_texture:new x.Uniform1i(w,n.u_texture),u_ele_delta:new x.Uniform1f(w,n.u_ele_delta)}),terrainDepth:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_ele_delta:new x.Uniform1f(w,n.u_ele_delta)}),terrainCoords:(w,n)=>({u_matrix:new x.UniformMatrix4f(w,n.u_matrix),u_texture:new x.Uniform1i(w,n.u_texture),u_terrain_coords_id:new x.Uniform1f(w,n.u_terrain_coords_id),u_ele_delta:new x.Uniform1f(w,n.u_ele_delta)})};class $i{constructor(n,d,y){this.context=n;const C=n.gl;this.buffer=C.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),C.bufferData(C.ELEMENT_ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const d=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),d.bufferSubData(d.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Zr={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class fs{constructor(n,d,y,C){this.length=d.length,this.attributes=y,this.itemSize=d.bytesPerElement,this.dynamicDraw=C,this.context=n;const N=n.gl;this.buffer=N.createBuffer(),n.bindVertexBuffer.set(this.buffer),N.bufferData(N.ARRAY_BUFFER,d.arrayBuffer,this.dynamicDraw?N.DYNAMIC_DRAW:N.STATIC_DRAW),this.dynamicDraw||delete d.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){if(n.length!==this.length)throw new Error(`Length of new data is ${n.length}, which doesn't match current length of ${this.length}`);const d=this.context.gl;this.bind(),d.bufferSubData(d.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,d){for(let y=0;y<this.attributes.length;y++){const C=d.attributes[this.attributes[y].name];void 0!==C&&n.enableVertexAttribArray(C)}}setVertexAttribPointers(n,d,y){for(let C=0;C<this.attributes.length;C++){const N=this.attributes[C],V=d.attributes[N.name];void 0!==V&&n.vertexAttribPointer(V,N.components,n[Zr[N.type]],!1,this.itemSize,N.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const zr=new WeakMap;function Gr(w){if(zr.has(w))return zr.get(w);{const n=w.getParameter(w.VERSION).startsWith("WebGL 2.0");return zr.set(w,n),n}}class Ni{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Ei extends Ni{getDefault(){return x.Color.transparent}set(n){const d=this.current;(n.r!==d.r||n.g!==d.g||n.b!==d.b||n.a!==d.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class ns extends Ni{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class As extends Ni{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class ps extends Ni{getDefault(){return[!0,!0,!0,!0]}set(n){const d=this.current;(n[0]!==d[0]||n[1]!==d[1]||n[2]!==d[2]||n[3]!==d[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class yr extends Ni{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class ha extends Ni{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class fa extends Ni{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const d=this.current;(n.func!==d.func||n.ref!==d.ref||n.mask!==d.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Zo extends Ni{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const d=this.current;(n[0]!==d[0]||n[1]!==d[1]||n[2]!==d[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class hl extends Ni{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const d=this.gl;n?d.enable(d.STENCIL_TEST):d.disable(d.STENCIL_TEST),this.current=n,this.dirty=!1}}class Aa extends Ni{getDefault(){return[0,1]}set(n){const d=this.current;(n[0]!==d[0]||n[1]!==d[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class jo extends Ni{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const d=this.gl;n?d.enable(d.DEPTH_TEST):d.disable(d.DEPTH_TEST),this.current=n,this.dirty=!1}}class co extends Ni{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Ls extends Ni{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const d=this.gl;n?d.enable(d.BLEND):d.disable(d.BLEND),this.current=n,this.dirty=!1}}class Ia extends Ni{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const d=this.current;(n[0]!==d[0]||n[1]!==d[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class Ui extends Ni{getDefault(){return x.Color.transparent}set(n){const d=this.current;(n.r!==d.r||n.g!==d.g||n.b!==d.b||n.a!==d.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class ea extends Ni{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class pa extends Ni{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const d=this.gl;n?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE),this.current=n,this.dirty=!1}}class Dl extends Ni{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class uo extends Ni{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class Nr extends Ni{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class Er extends Ni{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class or extends Ni{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const d=this.current;(n[0]!==d[0]||n[1]!==d[1]||n[2]!==d[2]||n[3]!==d[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class ho extends Ni{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class ta extends Ni{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const d=this.gl;d.bindRenderbuffer(d.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Bo extends Ni{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const d=this.gl;d.bindTexture(d.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class wi extends Ni{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const d=this.gl;d.bindBuffer(d.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ga extends Ni{getDefault(){return null}set(n){const d=this.gl;d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Oa extends Ni{getDefault(){return null}set(n){var d;if(n===this.current&&!this.dirty)return;const y=this.gl;Gr(y)?y.bindVertexArray(n):null===(d=y.getExtension("OES_vertex_array_object"))||void 0===d||d.bindVertexArrayOES(n),this.current=n,this.dirty=!1}}class Pa extends Ni{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class Ho extends Ni{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Cl extends Ni{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const d=this.gl;d.pixelStorei(d.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class gs extends Ni{constructor(n,d){super(n),this.context=n,this.parent=d}getDefault(){return null}}class jl extends gs{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class fl extends gs{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_ATTACHMENT,d.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class hc extends gs{set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const d=this.gl;d.framebufferRenderbuffer(d.FRAMEBUFFER,d.DEPTH_STENCIL_ATTACHMENT,d.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Hl{constructor(n,d,y,C,N){this.context=n,this.width=d,this.height=y;const V=n.gl,Z=this.framebuffer=V.createFramebuffer();if(this.colorAttachment=new jl(n,Z),C)this.depthAttachment=N?new hc(n,Z):new fl(n,Z);else if(N)throw new Error("Stencil cannot be setted without depth");if(V.checkFramebufferStatus(V.FRAMEBUFFER)!==V.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const n=this.context.gl,d=this.colorAttachment.get();if(d&&n.deleteTexture(d),this.depthAttachment){const y=this.depthAttachment.get();y&&n.deleteRenderbuffer(y)}n.deleteFramebuffer(this.framebuffer)}}class Yr{constructor(n,d,y){this.blendFunction=n,this.blendColor=d,this.mask=y}}Yr.Replace=[1,0],Yr.disabled=new Yr(Yr.Replace,x.Color.transparent,[!1,!1,!1,!1]),Yr.unblended=new Yr(Yr.Replace,x.Color.transparent,[!0,!0,!0,!0]),Yr.alphaBlended=new Yr([1,771],x.Color.transparent,[!0,!0,!0,!0]);class El{constructor(n){var d,y;if(this.gl=n,this.clearColor=new Ei(this),this.clearDepth=new ns(this),this.clearStencil=new As(this),this.colorMask=new ps(this),this.depthMask=new yr(this),this.stencilMask=new ha(this),this.stencilFunc=new fa(this),this.stencilOp=new Zo(this),this.stencilTest=new hl(this),this.depthRange=new Aa(this),this.depthTest=new jo(this),this.depthFunc=new co(this),this.blend=new Ls(this),this.blendFunc=new Ia(this),this.blendColor=new Ui(this),this.blendEquation=new ea(this),this.cullFace=new pa(this),this.cullFaceSide=new Dl(this),this.frontFace=new uo(this),this.program=new Nr(this),this.activeTexture=new Er(this),this.viewport=new or(this),this.bindFramebuffer=new ho(this),this.bindRenderbuffer=new ta(this),this.bindTexture=new Bo(this),this.bindVertexBuffer=new wi(this),this.bindElementBuffer=new ga(this),this.bindVertexArray=new Oa(this),this.pixelStoreUnpack=new Pa(this),this.pixelStoreUnpackPremultiplyAlpha=new Ho(this),this.pixelStoreUnpackFlipY=new Cl(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),Gr(n)){this.HALF_FLOAT=n.HALF_FLOAT;const C=n.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(d=n.RGBA16F)&&void 0!==d?d:C?.RGBA16F_EXT,this.RGB16F=null!==(y=n.RGB16F)&&void 0!==y?y:C?.RGB16F_EXT,n.getExtension("EXT_color_buffer_float")}else{n.getExtension("EXT_color_buffer_half_float"),n.getExtension("OES_texture_half_float_linear");const C=n.getExtension("OES_texture_half_float");this.HALF_FLOAT=C?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,d){return new $i(this,n,d)}createVertexBuffer(n,d,y){return new fs(this,n,d,y)}createRenderbuffer(n,d,y){const C=this.gl,N=C.createRenderbuffer();return this.bindRenderbuffer.set(N),C.renderbufferStorage(C.RENDERBUFFER,n,d,y),this.bindRenderbuffer.set(null),N}createFramebuffer(n,d,y,C){return new Hl(this,n,d,y,C)}clear({color:n,depth:d,stencil:y}){const C=this.gl;let N=0;n&&(N|=C.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),void 0!==d&&(N|=C.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(d),this.depthMask.set(!0)),void 0!==y&&(N|=C.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),C.clear(N)}setCullFace(n){!1===n.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){x.deepEqual(n.blendFunction,Yr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}createVertexArray(){var n;return Gr(this.gl)?this.gl.createVertexArray():null===(n=this.gl.getExtension("OES_vertex_array_object"))||void 0===n?void 0:n.createVertexArrayOES()}deleteVertexArray(n){var d;return Gr(this.gl)?this.gl.deleteVertexArray(n):null===(d=this.gl.getExtension("OES_vertex_array_object"))||void 0===d?void 0:d.deleteVertexArrayOES(n)}unbindVAO(){this.bindVertexArray.set(null)}}class Bi{constructor(n,d,y){this.func=n,this.mask=d,this.range=y}}Bi.ReadOnly=!1,Bi.ReadWrite=!0,Bi.disabled=new Bi(519,Bi.ReadOnly,[0,1]);class Rr{constructor(n,d,y,C,N,V){this.test=n,this.ref=d,this.mask=y,this.fail=C,this.depthFail=N,this.pass=V}}Rr.disabled=new Rr({func:519,mask:0},0,0,7680,7680,7680);class vr{constructor(n,d,y){this.enable=n,this.mode=d,this.frontFace=y}}let re;function ne(w,n,d,y,C,N,V){const Z=w.context,Y=Z.gl,X=w.useProgram("collisionBox"),le=[];let ae=0,De=0;for(let W=0;W<y.length;W++){const ie=y[W],ue=n.getTile(ie),Ne=ue.getBucket(d);if(!Ne)continue;let et=ie.posMatrix;0===C[0]&&0===C[1]||(et=w.translatePosMatrix(ie.posMatrix,ue,C,N));const Mt=V?Ne.textCollisionBox:Ne.iconCollisionBox,vt=Ne.collisionCircleArray;if(vt.length>0){const on=x.create(),Hn=et;x.mul(on,Ne.placementInvProjMatrix,w.transform.glCoordMatrix),x.mul(on,on,Ne.placementViewportMatrix),le.push({circleArray:vt,circleOffset:De,transform:Hn,invTransform:on,coord:ie}),ae+=vt.length/4,De=ae}Mt&&X.draw(Z,Y.LINES,Bi.disabled,Rr.disabled,w.colorModeForRenderPass(),vr.disabled,Oo(et,w.transform,ue),w.style.map.terrain&&w.style.map.terrain.getTerrainData(ie),d.id,Mt.layoutVertexBuffer,Mt.indexBuffer,Mt.segments,null,w.transform.zoom,null,null,Mt.collisionVertexBuffer)}if(!V||!le.length)return;const ze=w.useProgram("collisionCircle"),ke=new x.CollisionCircleLayoutArray;ke.resize(4*ae),ke._trim();let R=0;for(const W of le)for(let ie=0;ie<W.circleArray.length/4;ie++){const ue=4*ie,Ne=W.circleArray[ue+0],et=W.circleArray[ue+1],Mt=W.circleArray[ue+2],vt=W.circleArray[ue+3];ke.emplace(R++,Ne,et,Mt,vt,0),ke.emplace(R++,Ne,et,Mt,vt,1),ke.emplace(R++,Ne,et,Mt,vt,2),ke.emplace(R++,Ne,et,Mt,vt,3)}(!re||re.length<2*ae)&&(re=function(W){const ie=2*W,ue=new x.QuadTriangleArray;ue.resize(ie),ue._trim();for(let Ne=0;Ne<ie;Ne++){const et=6*Ne;ue.uint16[et+0]=4*Ne+0,ue.uint16[et+1]=4*Ne+1,ue.uint16[et+2]=4*Ne+2,ue.uint16[et+3]=4*Ne+2,ue.uint16[et+4]=4*Ne+3,ue.uint16[et+5]=4*Ne+0}return ue}(ae));const k=Z.createIndexBuffer(re,!0),O=Z.createVertexBuffer(ke,x.collisionCircleLayout.members,!0);for(const W of le){const ie={u_matrix:W.transform,u_inv_matrix:W.invTransform,u_camera_to_center_distance:(z=w.transform).cameraToCenterDistance,u_viewport_size:[z.width,z.height]};ze.draw(Z,Y.TRIANGLES,Bi.disabled,Rr.disabled,w.colorModeForRenderPass(),vr.disabled,ie,w.style.map.terrain&&w.style.map.terrain.getTerrainData(W.coord),d.id,O,k,x.SegmentVector.simpleSegment(0,2*W.circleOffset,W.circleArray.length,W.circleArray.length/2),null,w.transform.zoom,null,null,null)}var z;O.destroy(),k.destroy()}vr.disabled=new vr(!1,1029,2305),vr.backCCW=new vr(!0,1029,2305);const J=x.identity(new Float32Array(16));function Ae(w,n,d,y,C,N){const{horizontalAlign:V,verticalAlign:Z}=x.getAnchorAlignment(w),Y=-(V-.5)*n,X=-(Z-.5)*d,le=x.evaluateVariableOffset(w,y);return new x.Point((Y/C+le[0])*N,(X/C+le[1])*N)}function Ft(w,n,d,y,C,N,V,Z,Y,X,le){const ae=w.text.placedSymbolArray,De=w.text.dynamicLayoutVertexArray,ze=w.icon.dynamicLayoutVertexArray,ke={};De.clear();for(let R=0;R<ae.length;R++){const k=ae.get(R),O=k.hidden||!k.crossTileID||w.allowVerticalPlacement&&!k.placedOrientation?null:y[k.crossTileID];if(O){const z=new x.Point(k.anchorX,k.anchorY),W=ii(z,d?V:N,le),ie=Rn(C.cameraToCenterDistance,W.signedDistanceFromCamera);let ue=x.evaluateSizeForFeature(w.textSizeData,Y,k)*ie/x.ONE_EM;d&&(ue*=w.tilePixelRatio/Z);const{width:Ne,height:et,anchor:Mt,textOffset:vt,textBoxScale:on}=O,Hn=Ae(Mt,Ne,et,vt,on,ue),Pi=d?ii(z.add(Hn),N,le).point:W.point.add(n?Hn.rotate(-C.angle):Hn),Dn=w.allowVerticalPlacement&&k.placedOrientation===x.WritingMode.vertical?Math.PI/2:0;for(let gi=0;gi<k.numGlyphs;gi++)x.addDynamicAttributes(De,Pi,Dn);X&&k.associatedIconIndex>=0&&(ke[k.associatedIconIndex]={shiftedAnchor:Pi,angle:Dn})}else Ie(k.numGlyphs,De)}if(X){ze.clear();const R=w.icon.placedSymbolArray;for(let k=0;k<R.length;k++){const O=R.get(k);if(O.hidden)Ie(O.numGlyphs,ze);else{const z=ke[k];if(z)for(let W=0;W<O.numGlyphs;W++)x.addDynamicAttributes(ze,z.shiftedAnchor,z.angle);else Ie(O.numGlyphs,ze)}}w.icon.dynamicLayoutVertexBuffer.updateData(ze)}w.text.dynamicLayoutVertexBuffer.updateData(De)}function Vn(w,n,d){return d.iconsInText&&n?"symbolTextAndIcon":w?"symbolSDF":"symbolIcon"}function Jr(w,n,d,y,C,N,V,Z,Y,X,le,ae){const De=w.context,ze=De.gl,ke=w.transform,R="map"===Z,k="map"===Y,O="viewport"!==Z&&"point"!==d.layout.get("symbol-placement"),z=R&&!k&&!O,W=!d.layout.get("symbol-sort-key").isConstant();let ie=!1;const ue=w.depthModeForSublayer(0,Bi.ReadOnly),Ne=d.layout.get("text-variable-anchor"),et=[];for(const Mt of y){const vt=n.getTile(Mt),on=vt.getBucket(d);if(!on)continue;const Hn=C?on.text:on.icon;if(!Hn||!Hn.segments.get().length||!Hn.hasVisibleVertices)continue;const Pi=Hn.programConfigurations.get(d.id),Dn=C||on.sdfIcons,gi=C?on.textSizeData:on.iconSizeData,Bn=k||0!==ke.pitch,cr=w.useProgram(Vn(Dn,C,on),Pi),To=x.evaluateSizeForZoom(gi,ke.zoom),Ir=w.style.map.terrain&&w.style.map.terrain.getTerrainData(Mt);let ki,Kr,xs,No,ar=[0,0],qs=null;if(C)Kr=vt.glyphAtlasTexture,xs=ze.LINEAR,ki=vt.glyphAtlasTexture.size,on.iconsInText&&(ar=vt.imageAtlasTexture.size,qs=vt.imageAtlasTexture,No=Bn||w.options.rotating||w.options.zooming||"composite"===gi.kind||"camera"===gi.kind?ze.LINEAR:ze.NEAREST);else{const So=1!==d.layout.get("icon-size").constantOr(0)||on.iconsNeedLinear;Kr=vt.imageAtlasTexture,xs=Dn||w.options.rotating||w.options.zooming||So||Bn?ze.LINEAR:ze.NEAREST,ki=vt.imageAtlasTexture.size}const sa=me(vt,1,w.transform.zoom),_l=Qt(Mt.posMatrix,k,R,w.transform,sa),ci=mr(Mt.posMatrix,k,R,w.transform,sa),Xa=Ne&&on.hasTextData(),yl="none"!==d.layout.get("icon-text-fit")&&Xa&&on.hasIconData();if(O){const So=w.style.map.terrain?(Gc,vl)=>w.style.map.terrain.getElevation(Mt,Gc,vl):null,ws="map"===d.layout.get("text-rotation-alignment");Lr(on,Mt.posMatrix,w,C,_l,ci,k,X,ws,So)}const vo=w.translatePosMatrix(Mt.posMatrix,vt,N,V),qo=O||C&&Ne||yl?J:_l,br=w.translatePosMatrix(ci,vt,N,V,!0),Ro=Dn&&0!==d.paint.get(C?"text-halo-width":"icon-halo-width").constantOr(1);let $o;$o=Dn?on.iconsInText?Ln(gi.kind,To,z,k,w,vo,qo,br,ki,ar):rr(gi.kind,To,z,k,w,vo,qo,br,C,ki,!0):Fs(gi.kind,To,z,k,w,vo,qo,br,C,ki);const Cr={program:cr,buffers:Hn,uniformValues:$o,atlasTexture:Kr,atlasTextureIcon:qs,atlasInterpolation:xs,atlasInterpolationIcon:No,isSDF:Dn,hasHalo:Ro};if(W&&on.canOverlap){ie=!0;const So=Hn.segments.get();for(const ws of So)et.push({segments:new x.SegmentVector([ws]),sortKey:ws.sortKey,state:Cr,terrainData:Ir})}else et.push({segments:Hn.segments,sortKey:0,state:Cr,terrainData:Ir})}ie&&et.sort((Mt,vt)=>Mt.sortKey-vt.sortKey);for(const Mt of et){const vt=Mt.state;if(De.activeTexture.set(ze.TEXTURE0),vt.atlasTexture.bind(vt.atlasInterpolation,ze.CLAMP_TO_EDGE),vt.atlasTextureIcon&&(De.activeTexture.set(ze.TEXTURE1),vt.atlasTextureIcon&&vt.atlasTextureIcon.bind(vt.atlasInterpolationIcon,ze.CLAMP_TO_EDGE)),vt.isSDF){const on=vt.uniformValues;vt.hasHalo&&(on.u_is_halo=1,Is(vt.buffers,Mt.segments,d,w,vt.program,ue,le,ae,on,Mt.terrainData)),on.u_is_halo=0}Is(vt.buffers,Mt.segments,d,w,vt.program,ue,le,ae,vt.uniformValues,Mt.terrainData)}}function Is(w,n,d,y,C,N,V,Z,Y,X){const le=y.context;C.draw(le,le.gl.TRIANGLES,N,V,Z,vr.disabled,Y,X,d.id,w.layoutVertexBuffer,w.indexBuffer,n,d.paint,y.transform.zoom,w.programConfigurations.get(d.id),w.dynamicLayoutVertexBuffer,w.opacityVertexBuffer)}function pl(w,n,d,y,C){if(!d||!y||!y.imageAtlas)return;const N=y.imageAtlas.patternPositions;let V=N[d.to.toString()],Z=N[d.from.toString()];if(!V||!Z){const Y=C.getPaintProperty(n);V=N[Y],Z=N[Y]}V&&Z&&w.setConstantPatternPositions(V,Z)}function na(w,n,d,y,C,N,V){const Z=w.context.gl,Y="fill-pattern",X=d.paint.get(Y),le=X&&X.constantOr(1),ae=d.getCrossfadeParameters();let De,ze,ke,R,k;V?(ze=le&&!d.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",De=Z.LINES):(ze=le?"fillPattern":"fill",De=Z.TRIANGLES);const O=X.constantOr(null);for(const z of y){const W=n.getTile(z);if(le&&!W.patternsLoaded())continue;const ie=W.getBucket(d);if(!ie)continue;const ue=ie.programConfigurations.get(d.id),Ne=w.useProgram(ze,ue),et=w.style.map.terrain&&w.style.map.terrain.getTerrainData(z);le&&(w.context.activeTexture.set(Z.TEXTURE0),W.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),ue.updatePaintBuffers(ae)),pl(ue,Y,O,W,d);const Mt=et?z:null,vt=w.translatePosMatrix(Mt?Mt.posMatrix:z.posMatrix,W,d.paint.get("fill-translate"),d.paint.get("fill-translate-anchor"));if(V){R=ie.indexBuffer2,k=ie.segments2;const on=[Z.drawingBufferWidth,Z.drawingBufferHeight];ke="fillOutlinePattern"===ze&&le?Qs(vt,w,ae,W,on):Sa(vt,on)}else R=ie.indexBuffer,k=ie.segments,ke=le?hs(vt,w,ae,W):Ta(vt);Ne.draw(w.context,De,C,w.stencilModeForClipping(z),N,vr.disabled,ke,et,d.id,ie.layoutVertexBuffer,R,k,d.paint,w.transform.zoom,ue)}}function fc(w,n,d,y,C,N,V){const Z=w.context,Y=Z.gl,X="fill-extrusion-pattern",le=d.paint.get(X),ae=le.constantOr(1),De=d.getCrossfadeParameters(),ze=d.paint.get("fill-extrusion-opacity"),ke=le.constantOr(null);for(const R of y){const k=n.getTile(R),O=k.getBucket(d);if(!O)continue;const z=w.style.map.terrain&&w.style.map.terrain.getTerrainData(R),W=O.programConfigurations.get(d.id),ie=w.useProgram(ae?"fillExtrusionPattern":"fillExtrusion",W);ae&&(w.context.activeTexture.set(Y.TEXTURE0),k.imageAtlasTexture.bind(Y.LINEAR,Y.CLAMP_TO_EDGE),W.updatePaintBuffers(De)),pl(W,X,ke,k,d);const ue=w.translatePosMatrix(R.posMatrix,k,d.paint.get("fill-extrusion-translate"),d.paint.get("fill-extrusion-translate-anchor")),Ne=d.paint.get("fill-extrusion-vertical-gradient"),et=ae?ts(ue,w,Ne,ze,R,De,k):Za(ue,w,Ne,ze);ie.draw(Z,Z.gl.TRIANGLES,C,N,V,vr.backCCW,et,z,d.id,O.layoutVertexBuffer,O.indexBuffer,O.segments,d.paint,w.transform.zoom,W,w.style.map.terrain&&O.centroidVertexBuffer)}}function Tl(w,n,d,y,C,N,V){const Z=w.context,Y=Z.gl,X=d.fbo;if(!X)return;const le=w.useProgram("hillshade"),ae=w.style.map.terrain&&w.style.map.terrain.getTerrainData(n);Z.activeTexture.set(Y.TEXTURE0),Y.bindTexture(Y.TEXTURE_2D,X.colorAttachment.get()),le.draw(Z,Y.TRIANGLES,C,N,V,vr.disabled,((De,ze,ke,R)=>{const k=ke.paint.get("hillshade-shadow-color"),O=ke.paint.get("hillshade-highlight-color"),z=ke.paint.get("hillshade-accent-color");let W=ke.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ke.paint.get("hillshade-illumination-anchor")&&(W-=De.transform.angle);const ie=!De.options.moving;return{u_matrix:R?R.posMatrix:De.transform.calculatePosMatrix(ze.tileID.toUnwrapped(),ie),u_image:0,u_latrange:dr(0,ze.tileID),u_light:[ke.paint.get("hillshade-exaggeration"),W],u_shadow:k,u_highlight:O,u_accent:z}})(w,d,y,ae?n:null),ae,y.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments)}function Gl(w,n,d,y,C,N){const V=w.context,Z=V.gl,Y=n.dem;if(Y&&Y.data){const X=Y.dim,le=Y.stride,ae=Y.getPixels();if(V.activeTexture.set(Z.TEXTURE1),V.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||w.getTileTexture(le),n.demTexture){const ze=n.demTexture;ze.update(ae,{premultiply:!1}),ze.bind(Z.NEAREST,Z.CLAMP_TO_EDGE)}else n.demTexture=new Bt(V,ae,Z.RGBA,{premultiply:!1}),n.demTexture.bind(Z.NEAREST,Z.CLAMP_TO_EDGE);V.activeTexture.set(Z.TEXTURE0);let De=n.fbo;if(!De){const ze=new Bt(V,{width:X,height:X,data:null},Z.RGBA);ze.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),De=n.fbo=V.createFramebuffer(X,X,!0,!1),De.colorAttachment.set(ze.texture)}V.bindFramebuffer.set(De.framebuffer),V.viewport.set([0,0,X,X]),w.useProgram("hillshadePrepare").draw(V,Z.TRIANGLES,y,C,N,vr.disabled,((ze,ke)=>{const R=ke.stride,k=x.create();return x.ortho(k,0,x.EXTENT,-x.EXTENT,0,0,1),x.translate(k,k,[0,-x.EXTENT,0]),{u_matrix:k,u_image:1,u_dimension:[R,R],u_zoom:ze.overscaledZ,u_unpack:ke.getUnpackVector()}})(n.tileID,Y),null,d.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments),n.needsHillshadePrepare=!1}}function fo(w,n,d,y,C,N){const V=y.paint.get("raster-fade-duration");if(!N&&V>0){const Z=x.exported.now(),Y=(Z-w.timeAdded)/V,X=n?(Z-n.timeAdded)/V:-1,le=d.getSource(),ae=C.coveringZoomLevel({tileSize:le.tileSize,roundZoom:le.roundZoom}),De=!n||Math.abs(n.tileID.overscaledZ-ae)>Math.abs(w.tileID.overscaledZ-ae),ze=De&&w.refreshedUponExpiration?1:x.clamp(De?Y:1-X,0,1);return w.refreshedUponExpiration&&Y>=1&&(w.refreshedUponExpiration=!1),n?{opacity:1,mix:1-ze}:{opacity:ze,mix:0}}return{opacity:1,mix:0}}const ms=new x.Color(1,0,0,1),wo=new x.Color(0,1,0,1),pc=new x.Color(0,0,1,1),gc=new x.Color(1,0,1,1),Na=new x.Color(0,1,1,1);function Ra(w,n,d,y){Do(w,0,n+d/2,w.transform.width,d,y)}function ma(w,n,d,y){Do(w,n-d/2,0,d,w.transform.height,y)}function Do(w,n,d,y,C,N){const V=w.context,Z=V.gl;Z.enable(Z.SCISSOR_TEST),Z.scissor(n*w.pixelRatio,d*w.pixelRatio,y*w.pixelRatio,C*w.pixelRatio),V.clear({color:N}),Z.disable(Z.SCISSOR_TEST)}function Wl(w,n,d){const y=w.context,C=y.gl,N=d.posMatrix,V=w.useProgram("debug"),Z=Bi.disabled,Y=Rr.disabled,X=w.colorModeForRenderPass(),ae=w.style.map.terrain&&w.style.map.terrain.getTerrainData(d);y.activeTexture.set(C.TEXTURE0);const De=n.getTileByID(d.key).latestRawTileData,ze=Math.floor((De&&De.byteLength||0)/1024),ke=n.getTile(d).tileSize,R=512/Math.min(ke,512)*(d.overscaledZ/w.transform.zoom)*.5;let k=d.canonical.toString();d.overscaledZ!==d.canonical.z&&(k+=` => ${d.overscaledZ}`),function(O,z){O.initDebugOverlayCanvas();const W=O.debugOverlayCanvas,ie=O.context.gl,ue=O.debugOverlayCanvas.getContext("2d");ue.clearRect(0,0,W.width,W.height),ue.shadowColor="white",ue.shadowBlur=2,ue.lineWidth=1.5,ue.strokeStyle="white",ue.textBaseline="top",ue.font="bold 36px Open Sans, sans-serif",ue.fillText(z,5,5),ue.strokeText(z,5,5),O.debugOverlayTexture.update(W),O.debugOverlayTexture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE)}(w,`${k} ${ze}kB`),V.draw(y,C.TRIANGLES,Z,Y,Yr.alphaBlended,vr.disabled,Ya(N,x.Color.transparent,R),null,"$debug",w.debugBuffer,w.quadTriangleIndexBuffer,w.debugSegments),V.draw(y,C.LINE_STRIP,Z,Y,X,vr.disabled,Ya(N,x.Color.red),ae,"$debug",w.debugBuffer,w.tileBorderIndexBuffer,w.debugSegments)}function Qr(w,n,d){const y=w.context,C=y.gl,N=w.colorModeForRenderPass(),V=new Bi(C.LEQUAL,Bi.ReadWrite,w.depthRangeFor3D),Z=w.useProgram("terrain"),Y=n.getTerrainMesh();y.bindFramebuffer.set(null),y.viewport.set([0,0,w.width,w.height]);for(const X of d){const le=w.renderToTexture.getTexture(X),ae=n.getTerrainData(X.tileID);y.activeTexture.set(C.TEXTURE0),C.bindTexture(C.TEXTURE_2D,le.texture);const De={u_matrix:w.transform.calculatePosMatrix(X.tileID.toUnwrapped()),u_texture:0,u_ele_delta:n.getMeshFrameDelta(w.transform.zoom)};Z.draw(y,C.TRIANGLES,V,Rr.disabled,N,vr.backCCW,De,ae,"terrain",Y.vertexBuffer,Y.indexBuffer,Y.segments)}}const Sl={symbol:function(w,n,d,y,C){if("translucent"!==w.renderPass)return;const N=Rr.disabled,V=w.colorModeForRenderPass();d.layout.get("text-variable-anchor")&&function(Z,Y,X,le,ae,De,ze){const ke=Y.transform,R="map"===ae,k="map"===De;for(const O of Z){const z=le.getTile(O),W=z.getBucket(X);if(!W||!W.text||!W.text.segments.get().length)continue;const ie=x.evaluateSizeForZoom(W.textSizeData,ke.zoom),ue=me(z,1,Y.transform.zoom),Ne=Qt(O.posMatrix,k,R,Y.transform,ue),et="none"!==X.layout.get("icon-text-fit")&&W.hasIconData();if(ie){const Mt=Math.pow(2,ke.zoom-z.tileID.overscaledZ);Ft(W,R,k,ze,ke,Ne,O.posMatrix,Mt,ie,et,Y.style.map.terrain?(vt,on)=>Y.style.map.terrain.getElevation(O,vt,on):null)}}}(y,w,d,n,d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),C),0!==d.paint.get("icon-opacity").constantOr(1)&&Jr(w,n,d,y,!1,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),d.layout.get("icon-rotation-alignment"),d.layout.get("icon-pitch-alignment"),d.layout.get("icon-keep-upright"),N,V),0!==d.paint.get("text-opacity").constantOr(1)&&Jr(w,n,d,y,!0,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),d.layout.get("text-rotation-alignment"),d.layout.get("text-pitch-alignment"),d.layout.get("text-keep-upright"),N,V),n.map.showCollisionBoxes&&(ne(w,n,d,y,d.paint.get("text-translate"),d.paint.get("text-translate-anchor"),!0),ne(w,n,d,y,d.paint.get("icon-translate"),d.paint.get("icon-translate-anchor"),!1))},circle:function(w,n,d,y){if("translucent"!==w.renderPass)return;const C=d.paint.get("circle-opacity"),N=d.paint.get("circle-stroke-width"),V=d.paint.get("circle-stroke-opacity"),Z=!d.layout.get("circle-sort-key").isConstant();if(0===C.constantOr(1)&&(0===N.constantOr(1)||0===V.constantOr(1)))return;const Y=w.context,X=Y.gl,le=w.depthModeForSublayer(0,Bi.ReadOnly),ae=Rr.disabled,De=w.colorModeForRenderPass(),ze=[];for(let ke=0;ke<y.length;ke++){const R=y[ke],k=n.getTile(R),O=k.getBucket(d);if(!O)continue;const z=O.programConfigurations.get(d.id),W=w.useProgram("circle",z),ie=O.layoutVertexBuffer,ue=O.indexBuffer,Ne=w.style.map.terrain&&w.style.map.terrain.getTerrainData(R),et={programConfiguration:z,program:W,layoutVertexBuffer:ie,indexBuffer:ue,uniformValues:$s(w,R,k,d),terrainData:Ne};if(Z){const Mt=O.segments.get();for(const vt of Mt)ze.push({segments:new x.SegmentVector([vt]),sortKey:vt.sortKey,state:et})}else ze.push({segments:O.segments,sortKey:0,state:et})}Z&&ze.sort((ke,R)=>ke.sortKey-R.sortKey);for(const ke of ze){const{programConfiguration:R,program:k,layoutVertexBuffer:O,indexBuffer:z,uniformValues:W,terrainData:ie}=ke.state;k.draw(Y,X.TRIANGLES,le,ae,De,vr.disabled,W,ie,d.id,O,z,ke.segments,d.paint,w.transform.zoom,R)}},heatmap:function(w,n,d,y){if(0!==d.paint.get("heatmap-opacity"))if("offscreen"===w.renderPass){const C=w.context,N=C.gl,V=Rr.disabled,Z=new Yr([N.ONE,N.ONE],x.Color.transparent,[!0,!0,!0,!0]);(function(Y,X,le){const ae=Y.gl;Y.activeTexture.set(ae.TEXTURE1),Y.viewport.set([0,0,X.width/4,X.height/4]);let De=le.heatmapFbo;if(De)ae.bindTexture(ae.TEXTURE_2D,De.colorAttachment.get()),Y.bindFramebuffer.set(De.framebuffer);else{const ze=ae.createTexture();ae.bindTexture(ae.TEXTURE_2D,ze),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_S,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_WRAP_T,ae.CLAMP_TO_EDGE),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MIN_FILTER,ae.LINEAR),ae.texParameteri(ae.TEXTURE_2D,ae.TEXTURE_MAG_FILTER,ae.LINEAR),De=le.heatmapFbo=Y.createFramebuffer(X.width/4,X.height/4,!1,!1),function(ke,R,k,O){var z,W;const ie=ke.gl,ue=null!==(z=ke.HALF_FLOAT)&&void 0!==z?z:ie.UNSIGNED_BYTE,Ne=null!==(W=ke.RGBA16F)&&void 0!==W?W:ie.RGBA;ie.texImage2D(ie.TEXTURE_2D,0,Ne,R.width/4,R.height/4,0,ie.RGBA,ue,null),O.colorAttachment.set(k)}(Y,X,ze,De)}})(C,w,d),C.clear({color:x.Color.transparent});for(let Y=0;Y<y.length;Y++){const X=y[Y];if(n.hasRenderableParent(X))continue;const le=n.getTile(X),ae=le.getBucket(d);if(!ae)continue;const De=ae.programConfigurations.get(d.id),ze=w.useProgram("heatmap",De),{zoom:ke}=w.transform;ze.draw(C,N.TRIANGLES,Bi.disabled,V,Z,vr.disabled,dl(X.posMatrix,le,ke,d.paint.get("heatmap-intensity")),null,d.id,ae.layoutVertexBuffer,ae.indexBuffer,ae.segments,d.paint,w.transform.zoom,De)}C.viewport.set([0,0,w.width,w.height])}else"translucent"===w.renderPass&&(w.context.setColorMode(w.colorModeForRenderPass()),function(C,N){const V=C.context,Z=V.gl,Y=N.heatmapFbo;if(!Y)return;V.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,Y.colorAttachment.get()),V.activeTexture.set(Z.TEXTURE1);let X=N.colorRampTexture;X||(X=N.colorRampTexture=new Bt(V,N.colorRamp,Z.RGBA)),X.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),C.useProgram("heatmapTexture").draw(V,Z.TRIANGLES,Bi.disabled,Rr.disabled,C.colorModeForRenderPass(),vr.disabled,((le,ae,De,ze)=>{const ke=x.create();x.ortho(ke,0,le.width,le.height,0,0,1);const R=le.context.gl;return{u_matrix:ke,u_world:[R.drawingBufferWidth,R.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:ae.paint.get("heatmap-opacity")}})(C,N),null,N.id,C.viewportBuffer,C.quadTriangleIndexBuffer,C.viewportSegments,N.paint,C.transform.zoom)}(w,d))},line:function(w,n,d,y){if("translucent"!==w.renderPass)return;const C=d.paint.get("line-opacity"),N=d.paint.get("line-width");if(0===C.constantOr(1)||0===N.constantOr(1))return;const V=w.depthModeForSublayer(0,Bi.ReadOnly),Z=w.colorModeForRenderPass(),Y=d.paint.get("line-dasharray"),X=d.paint.get("line-pattern"),le=X.constantOr(1),ae=d.paint.get("line-gradient"),De=d.getCrossfadeParameters(),ze=le?"linePattern":Y?"lineSDF":ae?"lineGradient":"line",ke=w.context,R=ke.gl;let k=!0;for(const O of y){const z=n.getTile(O);if(le&&!z.patternsLoaded())continue;const W=z.getBucket(d);if(!W)continue;const ie=W.programConfigurations.get(d.id),ue=w.context.program.get(),Ne=w.useProgram(ze,ie),et=k||Ne.program!==ue,Mt=w.style.map.terrain&&w.style.map.terrain.getTerrainData(O),vt=X.constantOr(null);if(vt&&z.imageAtlas){const Pi=z.imageAtlas,Dn=Pi.patternPositions[vt.to.toString()],gi=Pi.patternPositions[vt.from.toString()];Dn&&gi&&ie.setConstantPatternPositions(Dn,gi)}const on=Mt?O:null,Hn=le?xo(w,z,d,De,on):Y?Po(w,z,d,Y,De,on):ae?bo(w,z,d,W.lineClipsArray.length,on):$r(w,z,d,on);if(le)ke.activeTexture.set(R.TEXTURE0),z.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),ie.updatePaintBuffers(De);else if(Y&&(et||w.lineAtlas.dirty))ke.activeTexture.set(R.TEXTURE0),w.lineAtlas.bind(ke);else if(ae){const Pi=W.gradients[d.id];let Dn=Pi.texture;if(d.gradientVersion!==Pi.version){let gi=256;if(d.stepInterpolant){const Bn=n.getSource().maxzoom,cr=O.canonical.z===Bn?Math.ceil(1<<w.transform.maxZoom-O.canonical.z):1;gi=x.clamp(x.nextPowerOfTwo(W.maxLineLength/x.EXTENT*1024*cr),256,ke.maxTextureSize)}Pi.gradient=x.renderColorRamp({expression:d.gradientExpression(),evaluationKey:"lineProgress",resolution:gi,image:Pi.gradient||void 0,clips:W.lineClipsArray}),Pi.texture?Pi.texture.update(Pi.gradient):Pi.texture=new Bt(ke,Pi.gradient,R.RGBA),Pi.version=d.gradientVersion,Dn=Pi.texture}ke.activeTexture.set(R.TEXTURE0),Dn.bind(d.stepInterpolant?R.NEAREST:R.LINEAR,R.CLAMP_TO_EDGE)}Ne.draw(ke,R.TRIANGLES,V,w.stencilModeForClipping(O),Z,vr.disabled,Hn,Mt,d.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,d.paint,w.transform.zoom,ie,W.layoutVertexBuffer2),k=!1}},fill:function(w,n,d,y){const C=d.paint.get("fill-color"),N=d.paint.get("fill-opacity");if(0===N.constantOr(1))return;const V=w.colorModeForRenderPass(),Z=d.paint.get("fill-pattern"),Y=w.opaquePassEnabledForLayer()&&!Z.constantOr(1)&&1===C.constantOr(x.Color.transparent).a&&1===N.constantOr(0)?"opaque":"translucent";if(w.renderPass===Y){const X=w.depthModeForSublayer(1,"opaque"===w.renderPass?Bi.ReadWrite:Bi.ReadOnly);na(w,n,d,y,X,V,!1)}if("translucent"===w.renderPass&&d.paint.get("fill-antialias")){const X=w.depthModeForSublayer(d.getPaintProperty("fill-outline-color")?2:0,Bi.ReadOnly);na(w,n,d,y,X,V,!0)}},"fill-extrusion":function(w,n,d,y){const C=d.paint.get("fill-extrusion-opacity");if(0!==C&&"translucent"===w.renderPass){const N=new Bi(w.context.gl.LEQUAL,Bi.ReadWrite,w.depthRangeFor3D);if(1!==C||d.paint.get("fill-extrusion-pattern").constantOr(1))fc(w,n,d,y,N,Rr.disabled,Yr.disabled),fc(w,n,d,y,N,w.stencilModeFor3D(),w.colorModeForRenderPass());else{const V=w.colorModeForRenderPass();fc(w,n,d,y,N,Rr.disabled,V)}}},hillshade:function(w,n,d,y){if("offscreen"!==w.renderPass&&"translucent"!==w.renderPass)return;const C=w.context,N=w.depthModeForSublayer(0,Bi.ReadOnly),V=w.colorModeForRenderPass(),[Z,Y]="translucent"===w.renderPass?w.stencilConfigForOverlap(y):[{},y];for(const X of Y){const le=n.getTile(X);void 0!==le.needsHillshadePrepare&&le.needsHillshadePrepare&&"offscreen"===w.renderPass?Gl(w,le,d,N,Rr.disabled,V):"translucent"===w.renderPass&&Tl(w,X,le,d,N,Z[X.overscaledZ],V)}C.viewport.set([0,0,w.width,w.height])},raster:function(w,n,d,y){if("translucent"!==w.renderPass||0===d.paint.get("raster-opacity")||!y.length)return;const C=w.context,N=C.gl,V=n.getSource(),Z=w.useProgram("raster"),Y=w.colorModeForRenderPass(),[X,le]=V instanceof di?[{},y]:w.stencilConfigForOverlap(y),ae=le[le.length-1].overscaledZ,De=!w.options.moving;for(const ze of le){const ke=w.depthModeForSublayer(ze.overscaledZ-ae,1===d.paint.get("raster-opacity")?Bi.ReadWrite:Bi.ReadOnly,N.LESS),R=n.getTile(ze);R.registerFadeDuration(d.paint.get("raster-fade-duration"));const k=n.findLoadedParent(ze,0),O=fo(R,k,n,d,w.transform,w.style.map.terrain);let z,W;const ie="nearest"===d.paint.get("raster-resampling")?N.NEAREST:N.LINEAR;C.activeTexture.set(N.TEXTURE0),R.texture.bind(ie,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST),C.activeTexture.set(N.TEXTURE1),k?(k.texture.bind(ie,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST),z=Math.pow(2,k.tileID.overscaledZ-R.tileID.overscaledZ),W=[R.tileID.canonical.x*z%1,R.tileID.canonical.y*z%1]):R.texture.bind(ie,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST);const ue=w.style.map.terrain&&w.style.map.terrain.getTerrainData(ze),Ne=ue?ze:null,et=Ne?Ne.posMatrix:w.transform.calculatePosMatrix(ze.toUnwrapped(),De),Mt=Gs(et,W||[0,0],z||1,O,d);V instanceof di?Z.draw(C,N.TRIANGLES,ke,Rr.disabled,Y,vr.disabled,Mt,ue,d.id,V.boundsBuffer,w.quadTriangleIndexBuffer,V.boundsSegments):Z.draw(C,N.TRIANGLES,ke,X[ze.overscaledZ],Y,vr.disabled,Mt,ue,d.id,w.rasterBoundsBuffer,w.quadTriangleIndexBuffer,w.rasterBoundsSegments)}},background:function(w,n,d,y){const C=d.paint.get("background-color"),N=d.paint.get("background-opacity");if(0===N)return;const V=w.context,Z=V.gl,Y=w.transform,X=Y.tileSize,le=d.paint.get("background-pattern");if(w.isPatternMissing(le))return;const ae=!le&&1===C.a&&1===N&&w.opaquePassEnabledForLayer()?"opaque":"translucent";if(w.renderPass!==ae)return;const De=Rr.disabled,ze=w.depthModeForSublayer(0,"opaque"===ae?Bi.ReadWrite:Bi.ReadOnly),ke=w.colorModeForRenderPass(),R=w.useProgram(le?"backgroundPattern":"background"),k=y||Y.coveringTiles({tileSize:X,terrain:w.style.map.terrain});le&&(V.activeTexture.set(Z.TEXTURE0),w.imageManager.bind(w.context));const O=d.getCrossfadeParameters();for(const z of k){const W=y?z.posMatrix:w.transform.calculatePosMatrix(z.toUnwrapped()),ie=le?Fi(W,N,w,le,{tileID:z,tileSize:X},O):ai(W,N,C),ue=w.style.map.terrain&&w.style.map.terrain.getTerrainData(z);R.draw(V,Z.TRIANGLES,ze,De,ke,vr.disabled,ie,ue,d.id,w.tileExtentBuffer,w.quadTriangleIndexBuffer,w.tileExtentSegments)}},debug:function(w,n,d){for(let y=0;y<d.length;y++)Wl(w,n,d[y])},custom:function(w,n,d){const y=w.context,C=d.implementation;if("offscreen"===w.renderPass){const N=C.prerender;N&&(w.setCustomLayerDefaults(),y.setColorMode(w.colorModeForRenderPass()),N.call(C,y.gl,w.transform.customLayerMatrix()),y.setDirty(),w.setBaseState())}else if("translucent"===w.renderPass){w.setCustomLayerDefaults(),y.setColorMode(w.colorModeForRenderPass()),y.setStencilMode(Rr.disabled);const N="3d"===C.renderingMode?new Bi(w.context.gl.LEQUAL,Bi.ReadWrite,w.depthRangeFor3D):w.depthModeForSublayer(0,Bi.ReadOnly);y.setDepthMode(N),C.render(y.gl,w.transform.customLayerMatrix()),y.setDirty(),w.setBaseState(),y.bindFramebuffer.set(null)}}};class Bc{constructor(n,d){this.context=new El(n),this.transform=d,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:x.create(),renderTime:0},this.setup(),this.numSublayers=kt.maxUnderzooming+kt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Hi}resize(n,d,y){if(this.width=n*y,this.height=d*y,this.pixelRatio=y,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const C of this.style._order)this.style._layers[C].resize()}setup(){const n=this.context,d=new x.PosArray;d.emplaceBack(0,0),d.emplaceBack(x.EXTENT,0),d.emplaceBack(0,x.EXTENT),d.emplaceBack(x.EXTENT,x.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(d,us.members),this.tileExtentSegments=x.SegmentVector.simpleSegment(0,0,4,2);const y=new x.PosArray;y.emplaceBack(0,0),y.emplaceBack(x.EXTENT,0),y.emplaceBack(0,x.EXTENT),y.emplaceBack(x.EXTENT,x.EXTENT),this.debugBuffer=n.createVertexBuffer(y,us.members),this.debugSegments=x.SegmentVector.simpleSegment(0,0,4,5);const C=new x.RasterBoundsArray;C.emplaceBack(0,0,0,0),C.emplaceBack(x.EXTENT,0,x.EXTENT,0),C.emplaceBack(0,x.EXTENT,0,x.EXTENT),C.emplaceBack(x.EXTENT,x.EXTENT,x.EXTENT,x.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(C,zi.members),this.rasterBoundsSegments=x.SegmentVector.simpleSegment(0,0,4,2);const N=new x.PosArray;N.emplaceBack(0,0),N.emplaceBack(1,0),N.emplaceBack(0,1),N.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(N,us.members),this.viewportSegments=x.SegmentVector.simpleSegment(0,0,4,2);const V=new x.LineStripIndexArray;V.emplaceBack(0),V.emplaceBack(1),V.emplaceBack(3),V.emplaceBack(2),V.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(V);const Z=new x.TriangleIndexArray;Z.emplaceBack(0,1,2),Z.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(Z);const Y=this.context.gl;this.stencilClearMode=new Rr({func:Y.ALWAYS,mask:0},0,255,Y.ZERO,Y.ZERO,Y.ZERO)}clearStencil(){const n=this.context,d=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const y=x.create();x.ortho(y,0,this.width,this.height,0,0,1),x.scale(y,y,[d.drawingBufferWidth,d.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,d.TRIANGLES,Bi.disabled,this.stencilClearMode,Yr.disabled,vr.disabled,Ma(y),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(n,d){if(this.currentStencilSource===n.source||!n.isTileClipped()||!d||!d.length)return;this.currentStencilSource=n.source;const y=this.context,C=y.gl;this.nextStencilID+d.length>256&&this.clearStencil(),y.setColorMode(Yr.disabled),y.setDepthMode(Bi.disabled);const N=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const V of d){const Z=this._tileClippingMaskIDs[V.key]=this.nextStencilID++,Y=this.style.map.terrain&&this.style.map.terrain.getTerrainData(V);N.draw(y,C.TRIANGLES,Bi.disabled,new Rr({func:C.ALWAYS,mask:0},Z,255,C.KEEP,C.KEEP,C.REPLACE),Yr.disabled,vr.disabled,Ma(V.posMatrix),Y,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,d=this.context.gl;return new Rr({func:d.NOTEQUAL,mask:255},n,255,d.KEEP,d.KEEP,d.REPLACE)}stencilModeForClipping(n){const d=this.context.gl;return new Rr({func:d.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,d.KEEP,d.KEEP,d.REPLACE)}stencilConfigForOverlap(n){const d=this.context.gl,y=n.sort((V,Z)=>Z.overscaledZ-V.overscaledZ),C=y[y.length-1].overscaledZ,N=y[0].overscaledZ-C+1;if(N>1){this.currentStencilSource=void 0,this.nextStencilID+N>256&&this.clearStencil();const V={};for(let Z=0;Z<N;Z++)V[Z+C]=new Rr({func:d.GEQUAL,mask:255},Z+this.nextStencilID,255,d.KEEP,d.KEEP,d.REPLACE);return this.nextStencilID+=N,[V,y]}return[{[C]:Rr.disabled},y]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new Yr([n.CONSTANT_COLOR,n.ONE],new x.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Yr.unblended:Yr.alphaBlended}depthModeForSublayer(n,d,y){if(!this.opaquePassEnabledForLayer())return Bi.disabled;const C=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new Bi(y||this.context.gl.LEQUAL,d,[C,C])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,d){this.style=n,this.options=d,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(x.exported.now()),this.imageManager.beginFrame();const y=this.style._order,C=this.style.sourceCaches,N={},V={},Z={};for(const Y in C){const X=C[Y];X.used&&X.prepare(this.context),N[Y]=X.getVisibleCoordinates(),V[Y]=N[Y].slice().reverse(),Z[Y]=X.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let Y=0;Y<y.length;Y++)if(this.style._layers[y[Y]].is3D()){this.opaquePassCutoff=Y;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const Y=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!x.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||Y.length)&&(x.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(X,le){const ae=X.context,De=ae.gl,ze=Yr.unblended,ke=new Bi(De.LEQUAL,Bi.ReadWrite,[0,1]),R=le.getTerrainMesh(),k=le.sourceCache.getRenderableTiles(),O=X.useProgram("terrainDepth");ae.bindFramebuffer.set(le.getFramebuffer("depth").framebuffer),ae.viewport.set([0,0,X.width/devicePixelRatio,X.height/devicePixelRatio]),ae.clear({color:x.Color.transparent,depth:1});for(const z of k){const W=le.getTerrainData(z.tileID),ie={u_matrix:X.transform.calculatePosMatrix(z.tileID.toUnwrapped()),u_ele_delta:le.getMeshFrameDelta(X.transform.zoom)};O.draw(ae,De.TRIANGLES,ke,Rr.disabled,ze,vr.backCCW,ie,W,"terrain",R.vertexBuffer,R.indexBuffer,R.segments)}ae.bindFramebuffer.set(null),ae.viewport.set([0,0,X.width,X.height])}(this,this.style.map.terrain),function(X,le){const ae=X.context,De=ae.gl,ze=Yr.unblended,ke=new Bi(De.LEQUAL,Bi.ReadWrite,[0,1]),R=le.getTerrainMesh(),k=le.getCoordsTexture(),O=le.sourceCache.getRenderableTiles(),z=X.useProgram("terrainCoords");ae.bindFramebuffer.set(le.getFramebuffer("coords").framebuffer),ae.viewport.set([0,0,X.width/devicePixelRatio,X.height/devicePixelRatio]),ae.clear({color:x.Color.transparent,depth:1}),le.coordsIndex=[];for(const W of O){const ie=le.getTerrainData(W.tileID);ae.activeTexture.set(De.TEXTURE0),De.bindTexture(De.TEXTURE_2D,k.texture);const ue={u_matrix:X.transform.calculatePosMatrix(W.tileID.toUnwrapped()),u_terrain_coords_id:(255-le.coordsIndex.length)/255,u_texture:0,u_ele_delta:le.getMeshFrameDelta(X.transform.zoom)};z.draw(ae,De.TRIANGLES,ke,Rr.disabled,ze,vr.backCCW,ue,ie,"terrain",R.vertexBuffer,R.indexBuffer,R.segments),le.coordsIndex.push(W.tileID.key)}ae.bindFramebuffer.set(null),ae.viewport.set([0,0,X.width,X.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const Y of y){const X=this.style._layers[Y];if(!X.hasOffscreenPass()||X.isHidden(this.transform.zoom))continue;const le=V[X.source];("custom"===X.type||le.length)&&this.renderLayer(this,C[X.source],X,le)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:d.showOverdrawInspector?x.Color.black:x.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=d.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const Y=this.style._layers[y[this.currentLayer]],X=C[Y.source],le=N[Y.source];this._renderTileClippingMasks(Y,le),this.renderLayer(this,X,Y,le)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const Y=this.style._layers[y[this.currentLayer]],X=C[Y.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(Y))continue;const le=("symbol"===Y.type?Z:V)[Y.source];this._renderTileClippingMasks(Y,N[Y.source]),this.renderLayer(this,X,Y,le)}if(this.options.showTileBoundaries){const Y=function(X,le){let ae=null;const De=Object.values(X._layers).flatMap(k=>k.source&&!k.isHidden(le)?[X.sourceCaches[k.source]]:[]),ze=De.filter(k=>"vector"===k.getSource().type),ke=De.filter(k=>"vector"!==k.getSource().type),R=k=>{(!ae||ae.getSource().maxzoom<k.getSource().maxzoom)&&(ae=k)};return ze.forEach(k=>R(k)),ae||ke.forEach(k=>R(k)),ae}(this.style,this.transform.zoom);Y&&Sl.debug(this,Y,Y.getVisibleCoordinates())}this.options.showPadding&&function(Y){const X=Y.transform.padding;Ra(Y,Y.transform.height-(X.top||0),3,ms),Ra(Y,X.bottom||0,3,wo),ma(Y,X.left||0,3,pc),ma(Y,Y.transform.width-(X.right||0),3,gc);const le=Y.transform.centerPoint;var ae,De,ze,ke;Do(ae=Y,(De=le.x)-1,(ze=Y.transform.height-le.y)-10,2,20,ke=Na),Do(ae,De-10,ze-1,20,2,ke)}(this),this.context.setDefault()}renderLayer(n,d,y,C){y.isHidden(this.transform.zoom)||("background"===y.type||"custom"===y.type||(C||[]).length)&&(this.id=y.id,Sl[y.type](n,d,y,C,this.style.placement.variableOffsets))}translatePosMatrix(n,d,y,C,N){if(!y[0]&&!y[1])return n;const V=N?"map"===C?this.transform.angle:0:"viewport"===C?-this.transform.angle:0;if(V){const X=Math.sin(V),le=Math.cos(V);y=[y[0]*le-y[1]*X,y[0]*X+y[1]*le]}const Z=[N?y[0]:me(d,y[0],this.transform.zoom),N?y[1]:me(d,y[1],this.transform.zoom),0],Y=new Float32Array(16);return x.translate(Y,n,Z),Y}saveTileTexture(n){const d=this._tileTextures[n.size[0]];d?d.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const d=this._tileTextures[n];return d&&d.length>0?d.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const d=this.imageManager.getPattern(n.from.toString()),y=this.imageManager.getPattern(n.to.toString());return!d||!y}useProgram(n,d){this.cache=this.cache||{};const y=n+(d?d.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[y]||(this.cache[y]=new Ss(this.context,n,es[n],d,ro[n],this._showOverdrawInspector,this.style.map.terrain)),this.cache[y]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Bt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Ml{constructor(n,d){this.points=n,this.planes=d}static fromInvProjectionMatrix(n,d,y){const C=Math.pow(2,y),N=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(Z=>{const Y=1/(Z=x.transformMat4([],Z,n))[3]/d*C;return x.mul$1(Z,Z,[Y,Y,1/Z[3],Y])}),V=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(Z=>{const Y=function(De,ze){var ke=ze[0],R=ze[1],k=ze[2],O=ke*ke+R*R+k*k;return O>0&&(O=1/Math.sqrt(O)),De[0]=ze[0]*O,De[1]=ze[1]*O,De[2]=ze[2]*O,De}([],(De=[],ze=Vt([],N[Z[0]],N[Z[1]]),ke=Vt([],N[Z[2]],N[Z[1]]),R=ze[0],z=ke[0],De[0]=(k=ze[1])*(ie=ke[2])-(O=ze[2])*(W=ke[1]),De[1]=O*z-R*ie,De[2]=R*W-k*z,De)),X=-((le=Y)[0]*(ae=N[Z[1]])[0]+le[1]*ae[1]+le[2]*ae[2]);var De,ze,ke,R,k,O,z,W,ie,le,ae;return Y.concat(X)});return new Ml(N,V)}}class zo{constructor(n,d){var y,C,N;this.min=n,this.max=d,this.center=function(y,C,N){return y[0]=.5*C[0],y[1]=.5*C[1],y[2]=.5*C[2],y}([],((y=[])[0]=(C=this.min)[0]+(N=this.max)[0],y[1]=C[1]+N[1],y[2]=C[2]+N[2],y))}quadrant(n){const d=[n%2==0,n<2],y=yi(this.min),C=yi(this.max);for(let N=0;N<d.length;N++)y[N]=d[N]?this.min[N]:this.center[N],C[N]=d[N]?this.center[N]:this.max[N];return C[2]=this.max[2],new zo(y,C)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}intersects(n){const d=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let y=!0;for(let C=0;C<n.planes.length;C++){const N=n.planes[C];let V=0;for(let Z=0;Z<d.length;Z++)x.dot(N,d[Z])>=0&&V++;if(0===V)return 0;V!==d.length&&(y=!1)}if(y)return 2;for(let C=0;C<3;C++){let N=Number.MAX_VALUE,V=-Number.MAX_VALUE;for(let Z=0;Z<n.points.length;Z++){const Y=n.points[Z][C]-this.min[C];N=Math.min(N,Y),V=Math.max(V,Y)}if(V<0||N>this.max[C]-this.min[C])return 0}return 1}}class is{constructor(n=0,d=0,y=0,C=0){if(isNaN(n)||n<0||isNaN(d)||d<0||isNaN(y)||y<0||isNaN(C)||C<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=d,this.left=y,this.right=C}interpolate(n,d,y){return null!=d.top&&null!=n.top&&(this.top=x.interpolate.number(n.top,d.top,y)),null!=d.bottom&&null!=n.bottom&&(this.bottom=x.interpolate.number(n.bottom,d.bottom,y)),null!=d.left&&null!=n.left&&(this.left=x.interpolate.number(n.left,d.left,y)),null!=d.right&&null!=n.right&&(this.right=x.interpolate.number(n.right,d.right,y)),this}getCenter(n,d){const y=x.clamp((this.left+n-this.right)/2,0,n),C=x.clamp((this.top+d-this.bottom)/2,0,d);return new x.Point(y,C)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new is(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class ka{constructor(n,d,y,C,N){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=void 0===N||!!N,this._minZoom=n||0,this._maxZoom=d||22,this._minPitch=y??0,this._maxPitch=C??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new x.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new is,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const n=new ka(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.apply(this),n}apply(n){this.tileSize=n.tileSize,this.latRange=n.latRange,this.width=n.width,this.height=n.height,this._center=n._center,this._elevation=n._elevation,this.zoom=n.zoom,this.angle=n.angle,this._fov=n._fov,this._pitch=n._pitch,this._unmodified=n._unmodified,this._edgeInsets=n._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(n){void 0===n?n=!0:null===n&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new x.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(n){const d=-x.wrap(n,-180,180)*Math.PI/180;var y;this.angle!==d&&(this._unmodified=!1,this.angle=d,this._calcMatrices(),this.rotationMatrix=(y=new x.ARRAY_TYPE(4),x.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y),function(y,C,N){var V=C[0],Z=C[1],Y=C[2],X=C[3],le=Math.sin(N),ae=Math.cos(N);y[0]=V*ae+Y*le,y[1]=Z*ae+X*le,y[2]=V*-le+Y*ae,y[3]=Z*-le+X*ae}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const d=x.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==d&&(this._unmodified=!1,this._pitch=d,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(n){const d=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==d&&(this._unmodified=!1,this._zoom=d,this.tileZoom=Math.max(0,Math.floor(d)),this.scale=this.zoomScale(d),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(n){n!==this._elevation&&(this._elevation=n,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,d,y){this._unmodified=!1,this._edgeInsets.interpolate(n,d,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const d=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,d)}getVisibleUnwrappedCoordinates(n){const d=[new x.UnwrappedTileID(0,n)];if(this._renderWorldCopies){const y=this.pointCoordinate(new x.Point(0,0)),C=this.pointCoordinate(new x.Point(this.width,0)),N=this.pointCoordinate(new x.Point(this.width,this.height)),V=this.pointCoordinate(new x.Point(0,this.height)),Z=Math.floor(Math.min(y.x,C.x,N.x,V.x)),Y=Math.floor(Math.max(y.x,C.x,N.x,V.x)),X=1;for(let le=Z-X;le<=Y+X;le++)0!==le&&d.push(new x.UnwrappedTileID(le,n))}return d}coveringTiles(n){var d,y;let C=this.coveringZoomLevel(n);const N=C;if(void 0!==n.minzoom&&C<n.minzoom)return[];void 0!==n.maxzoom&&C>n.maxzoom&&(C=n.maxzoom);const V=this.pointCoordinate(this.getCameraPoint()),Z=x.MercatorCoordinate.fromLngLat(this.center),Y=Math.pow(2,C),X=[Y*V.x,Y*V.y,0],le=[Y*Z.x,Y*Z.y,0],ae=Ml.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,C);let De=n.minzoom||0;!n.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(De=C);const ze=n.terrain?2/Math.min(this.tileSize,n.tileSize)*this.tileSize:3,ke=W=>({aabb:new zo([W*Y,0,0],[(W+1)*Y,Y,0]),zoom:0,x:0,y:0,wrap:W,fullyVisible:!1}),R=[],k=[],O=C,z=n.reparseOverscaled?N:C;if(this._renderWorldCopies)for(let W=1;W<=3;W++)R.push(ke(-W)),R.push(ke(W));for(R.push(ke(0));R.length>0;){const W=R.pop(),ie=W.x,ue=W.y;let Ne=W.fullyVisible;if(!Ne){const Hn=W.aabb.intersects(ae);if(0===Hn)continue;Ne=2===Hn}const et=n.terrain?X:le,Mt=W.aabb.distanceX(et),vt=W.aabb.distanceY(et),on=Math.max(Math.abs(Mt),Math.abs(vt));if(W.zoom===O||on>ze+(1<<O-W.zoom)-2&&W.zoom>=De){const Hn=O-W.zoom,Pi=X[0]-.5-(ie<<Hn),Dn=X[1]-.5-(ue<<Hn);k.push({tileID:new x.OverscaledTileID(W.zoom===O?z:W.zoom,W.wrap,W.zoom,ie,ue),distanceSq:Tt([le[0]-.5-ie,le[1]-.5-ue]),tileDistanceToCamera:Math.sqrt(Pi*Pi+Dn*Dn)})}else for(let Hn=0;Hn<4;Hn++){const Pi=(ie<<1)+Hn%2,Dn=(ue<<1)+(Hn>>1),gi=W.zoom+1;let Bn=W.aabb.quadrant(Hn);if(n.terrain){const cr=new x.OverscaledTileID(gi,W.wrap,gi,Pi,Dn),To=n.terrain.getMinMaxElevation(cr),Ir=null!==(d=To.minElevation)&&void 0!==d?d:this.elevation,ki=null!==(y=To.maxElevation)&&void 0!==y?y:this.elevation;Bn=new zo([Bn.min[0],Bn.min[1],Ir],[Bn.max[0],Bn.max[1],ki])}R.push({aabb:Bn,zoom:gi,x:Pi,y:Dn,wrap:W.wrap,fullyVisible:Ne})}}return k.sort((W,ie)=>W.distanceSq-ie.distanceSq).map(W=>W.tileID)}resize(n,d){this.width=n,this.height=d,this.pixelsToGLUnits=[2/n,-2/d],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const d=x.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new x.Point(x.mercatorXfromLng(n.lng)*this.worldSize,x.mercatorYfromLat(d)*this.worldSize)}unproject(n){return new x.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(n){this.freezeElevation||(this.elevation=n?this.getElevation(this._center,n):0)}getElevation(n,d){const y=x.MercatorCoordinate.fromLngLat(n.wrap()),C=(1<<this.tileZoom)*x.EXTENT,N=y.x*C,V=y.y*C,Z=Math.floor(N/x.EXTENT),Y=Math.floor(V/x.EXTENT),X=new x.OverscaledTileID(this.tileZoom,0,this.tileZoom,Z,Y);return d.getElevation(X,N%x.EXTENT,V%x.EXTENT,x.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(n){const d=this.pointLocation(this.centerPoint,n),y=this.getElevation(d,n);if(!(this.elevation-y))return;const C=this.getCameraPosition(),N=x.MercatorCoordinate.fromLngLat(C.lngLat,C.altitude),V=x.MercatorCoordinate.fromLngLat(d,y),Z=N.x-V.x,Y=N.y-V.y,X=N.z-V.z,le=Math.sqrt(Z*Z+Y*Y+X*X),ae=this.scaleZoom(this.cameraToCenterDistance/le/this.tileSize);this._elevation=y,this._center=d,this.zoom=ae}setLocationAtPoint(n,d){const y=this.pointCoordinate(d),C=this.pointCoordinate(this.centerPoint),N=this.locationCoordinate(n),V=new x.MercatorCoordinate(N.x-(y.x-C.x),N.y-(y.y-C.y));this.center=this.coordinateLocation(V),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(n,d){return d?this.coordinatePoint(this.locationCoordinate(n),this.getElevation(n,d),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(n))}pointLocation(n,d){return this.coordinateLocation(this.pointCoordinate(n,d))}locationCoordinate(n){return x.MercatorCoordinate.fromLngLat(n)}coordinateLocation(n){return n&&n.toLngLat()}pointCoordinate(n,d){if(d){const De=d.pointCoordinate(n);if(null!=De)return De}const y=[n.x,n.y,0,1],C=[n.x,n.y,1,1];x.transformMat4(y,y,this.pixelMatrixInverse),x.transformMat4(C,C,this.pixelMatrixInverse);const N=y[3],V=C[3],Z=y[1]/N,Y=C[1]/V,X=y[2]/N,le=C[2]/V,ae=X===le?0:(0-X)/(le-X);return new x.MercatorCoordinate(x.interpolate.number(y[0]/N,C[0]/V,ae)/this.worldSize,x.interpolate.number(Z,Y,ae)/this.worldSize)}coordinatePoint(n,d=0,y=this.pixelMatrix){const C=[n.x*this.worldSize,n.y*this.worldSize,d,1];return x.transformMat4(C,C,y),new x.Point(C[0]/C[3],C[1]/C[3])}getBounds(){const n=Math.max(0,this.height/2-this.getHorizon());return(new Pt).extend(this.pointLocation(new x.Point(0,n))).extend(this.pointLocation(new x.Point(this.width,n))).extend(this.pointLocation(new x.Point(this.width,this.height))).extend(this.pointLocation(new x.Point(0,this.height)))}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new Pt([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(n,d=!1){const y=n.key,C=d?this._alignedPosMatrixCache:this._posMatrixCache;if(C[y])return C[y];const N=n.canonical,V=this.worldSize/this.zoomScale(N.z),Z=N.x+Math.pow(2,N.z)*n.wrap,Y=x.identity(new Float64Array(16));return x.translate(Y,Y,[Z*V,N.y*V,0]),x.scale(Y,Y,[V/x.EXTENT,V/x.EXTENT,1]),x.multiply(Y,d?this.alignedProjMatrix:this.projMatrix,Y),C[y]=new Float32Array(Y),C[y]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let n,d,y,C,N=-90,V=90,Z=-180,Y=180;const X=this.size,le=this._unmodified;if(this.latRange){const ze=this.latRange;N=x.mercatorYfromLat(ze[1])*this.worldSize,V=x.mercatorYfromLat(ze[0])*this.worldSize,n=V-N<X.y?X.y/(V-N):0}if(this.lngRange){const ze=this.lngRange;Z=x.wrap(x.mercatorXfromLng(ze[0])*this.worldSize,0,this.worldSize),Y=x.wrap(x.mercatorXfromLng(ze[1])*this.worldSize,0,this.worldSize),Y<Z&&(Y+=this.worldSize),d=Y-Z<X.x?X.x/(Y-Z):0}const ae=this.point,De=Math.max(d||0,n||0);if(De)return this.center=this.unproject(new x.Point(d?(Y+Z)/2:ae.x,n?(V+N)/2:ae.y)),this.zoom+=this.scaleZoom(De),this._unmodified=le,void(this._constraining=!1);if(this.latRange){const ze=ae.y,ke=X.y/2;ze-ke<N&&(C=N+ke),ze+ke>V&&(C=V-ke)}if(this.lngRange){const ze=(Z+Y)/2,ke=x.wrap(ae.x,ze-this.worldSize/2,ze+this.worldSize/2),R=X.x/2;ke-R<Z&&(y=Z+R),ke+R>Y&&(y=Y-R)}void 0===y&&void 0===C||(this.center=this.unproject(new x.Point(void 0!==y?y:ae.x,void 0!==C?C:ae.y)).wrap()),this._unmodified=le,this._constraining=!1}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,d=this.point.x,y=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=x.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let C=x.identity(new Float64Array(16));x.scale(C,C,[this.width/2,-this.height/2,1]),x.translate(C,C,[1,-1,0]),this.labelPlaneMatrix=C,C=x.identity(new Float64Array(16)),x.scale(C,C,[1,-1,1]),x.translate(C,C,[-1,-1,0]),x.scale(C,C,[2/this.width,2/this.height,1]),this.glCoordMatrix=C,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const N=this._elevation<0?this.cameraToCenterDistance:this.cameraToSeaLevelDistance,V=Math.PI/2+this._pitch,Z=this._fov*(.5+n.y/this.height),Y=Math.sin(Z)*N/Math.sin(x.clamp(Math.PI-V-Z,.01,Math.PI-.01)),X=this.getHorizon(),le=2*Math.atan(X/this.cameraToCenterDistance)*(.5+n.y/(2*X)),ae=Math.sin(le)*N/Math.sin(x.clamp(Math.PI-V-le,.01,Math.PI-.01)),De=Math.min(Y,ae),ze=1.01*(Math.cos(Math.PI/2-this._pitch)*De+N),ke=this.height/50;C=new Float64Array(16),x.perspective(C,this._fov,this.width/this.height,ke,ze),C[8]=2*-n.x/this.width,C[9]=2*n.y/this.height,x.scale(C,C,[1,-1,1]),x.translate(C,C,[0,0,-this.cameraToCenterDistance]),x.rotateX(C,C,this._pitch),x.rotateZ(C,C,this.angle),x.translate(C,C,[-d,-y,0]),this.mercatorMatrix=x.scale([],C,[this.worldSize,this.worldSize,this.worldSize]),x.scale(C,C,[1,1,this._pixelPerMeter]),this.pixelMatrix=x.multiply(new Float64Array(16),this.labelPlaneMatrix,C),x.translate(C,C,[0,0,-this.elevation]),this.projMatrix=C,this.invProjMatrix=x.invert([],C),this.pixelMatrix3D=x.multiply(new Float64Array(16),this.labelPlaneMatrix,C);const R=this.width%2/2,k=this.height%2/2,O=Math.cos(this.angle),z=Math.sin(this.angle),W=d-Math.round(d)+O*R+z*k,ie=y-Math.round(y)+O*k+z*R,ue=new Float64Array(C);if(x.translate(ue,ue,[W>.5?W-1:W,ie>.5?ie-1:ie,0]),this.alignedProjMatrix=ue,C=x.invert(new Float64Array(16),this.pixelMatrix),!C)throw new Error("failed to invert matrix");this.pixelMatrixInverse=C,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const n=this.pointCoordinate(new x.Point(0,0)),d=[n.x*this.worldSize,n.y*this.worldSize,0,1];return x.transformMat4(d,d,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new x.Point(0,n))}getCameraQueryGeometry(n){const d=this.getCameraPoint();if(1===n.length)return[n[0],d];{let y=d.x,C=d.y,N=d.x,V=d.y;for(const Z of n)y=Math.min(y,Z.x),C=Math.min(C,Z.y),N=Math.max(N,Z.x),V=Math.max(V,Z.y);return[new x.Point(y,C),new x.Point(N,C),new x.Point(N,V),new x.Point(y,V),new x.Point(y,C)]}}}class cu{constructor(n){this._hashName=n&&encodeURIComponent(n),x.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(d,y){let C=!1,N=null;const V=()=>{N=null,C&&(d(),N=setTimeout(V,300),C=!1)};return()=>(C=!0,N||V(),N)}(this._updateHashUnthrottled.bind(this))}addTo(n){return this._map=n,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(n){const d=this._map.getCenter(),y=Math.round(100*this._map.getZoom())/100,C=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),N=Math.pow(10,C),V=Math.round(d.lng*N)/N,Z=Math.round(d.lat*N)/N,Y=this._map.getBearing(),X=this._map.getPitch();let le="";if(le+=n?`/${V}/${Z}/${y}`:`${y}/${Z}/${V}`,(Y||X)&&(le+="/"+Math.round(10*Y)/10),X&&(le+=`/${Math.round(X)}`),this._hashName){const ae=this._hashName;let De=!1;const ze=window.location.hash.slice(1).split("&").map(ke=>{const R=ke.split("=")[0];return R===ae?(De=!0,`${R}=${le}`):ke}).filter(ke=>ke);return De||ze.push(`${ae}=${le}`),`#${ze.join("&")}`}return`#${le}`}_getCurrentHash(){const n=window.location.hash.replace("#","");if(this._hashName){let d;return n.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(d=y)}),(d&&d[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._getCurrentHash();if(n.length>=3&&!n.some(d=>isNaN(d))){const d=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:d,pitch:+(n[4]||0)}),!0}return!1}_updateHashUnthrottled(){const n=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,n)}catch{}}}const Al={linearity:.3,easing:x.bezier(0,0,.3,1)},mc=x.extend({deceleration:2500,maxSpeed:1400},Al),gl=x.extend({deceleration:20,maxSpeed:1400},Al),ia=x.extend({deceleration:1e3,maxSpeed:360},Al),zc=x.extend({deceleration:1e3,maxSpeed:90},Al);class Ws{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:x.exported.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,d=x.exported.now();for(;n.length>0&&d-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const d={zoom:0,bearing:0,pitch:0,pan:new x.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:N}of this._inertiaBuffer)d.zoom+=N.zoomDelta||0,d.bearing+=N.bearingDelta||0,d.pitch+=N.pitchDelta||0,N.panDelta&&d.pan._add(N.panDelta),N.around&&(d.around=N.around),N.pinchAround&&(d.pinchAround=N.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,C={};if(d.pan.mag()){const N=Zl(d.pan.mag(),y,x.extend({},mc,n||{}));C.offset=d.pan.mult(N.amount/d.pan.mag()),C.center=this._map.transform.center,Os(C,N)}if(d.zoom){const N=Zl(d.zoom,y,gl);C.zoom=this._map.transform.zoom+N.amount,Os(C,N)}if(d.bearing){const N=Zl(d.bearing,y,ia);C.bearing=this._map.transform.bearing+x.clamp(N.amount,-179,179),Os(C,N)}if(d.pitch){const N=Zl(d.pitch,y,zc);C.pitch=this._map.transform.pitch+N.amount,Os(C,N)}if(C.zoom||C.bearing){const N=void 0===d.pinchAround?d.around:d.pinchAround;C.around=N?this._map.unproject(N):this._map.getCenter()}return this.clear(),x.extend(C,{noMoveStart:!0})}}function Os(w,n){(!w.duration||w.duration<n.duration)&&(w.duration=n.duration,w.easing=n.easing)}function Zl(w,n,d){const{maxSpeed:y,linearity:C,deceleration:N}=d,V=x.clamp(w*C/(n/1e3),-y,y),Z=Math.abs(V)/(N*C);return{easing:d.easing,duration:1e3*Z,amount:V*(Z/2)}}class po extends x.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,d,y,C={}){const N=Pe.mousePos(d.getCanvasContainer(),y),V=d.unproject(N);super(n,x.extend({point:N,lngLat:V,originalEvent:y},C)),this._defaultPrevented=!1,this.target=d}}class Fa extends x.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,d,y){const C="touchend"===n?y.changedTouches:y.touches,N=Pe.touchPos(d.getCanvasContainer(),C),V=N.map(Y=>d.unproject(Y)),Z=N.reduce((Y,X,le,ae)=>Y.add(X.div(ae.length)),new x.Point(0,0));super(n,{points:N,point:Z,lngLats:V,lngLat:d.unproject(Z),originalEvent:y}),this._defaultPrevented=!1}}class rd extends x.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,d,y){super(n,{originalEvent:y}),this._defaultPrevented=!1}}class Yl{constructor(n,d){this._map=n,this._clickTolerance=d.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new rd(n.type,this._map,n))}mousedown(n,d){return this._mousedownPos=d,this._firePreventable(new po(n.type,this._map,n))}mouseup(n){this._map.fire(new po(n.type,this._map,n))}click(n,d){this._mousedownPos&&this._mousedownPos.dist(d)>=this._clickTolerance||this._map.fire(new po(n.type,this._map,n))}dblclick(n){return this._firePreventable(new po(n.type,this._map,n))}mouseover(n){this._map.fire(new po(n.type,this._map,n))}mouseout(n){this._map.fire(new po(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Fa(n.type,this._map,n))}touchmove(n){this._map.fire(new Fa(n.type,this._map,n))}touchend(n){this._map.fire(new Fa(n.type,this._map,n))}touchcancel(n){this._map.fire(new Fa(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class uu{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(n){this._map.fire(new po(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new po("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._ignoreContextMenu||this._map.fire(new po(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Il{constructor(n){this._map=n}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(n){return this.transform.pointLocation(x.Point.convert(n),this._map.terrain)}}class _c{constructor(n,d){this._map=n,this._tr=new Il(n),this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=d.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,d){this.isEnabled()&&n.shiftKey&&0===n.button&&(Pe.disableDrag(),this._startPos=this._lastPos=d,this._active=!0)}mousemoveWindow(n,d){if(!this._active)return;const y=d;if(this._lastPos.equals(y)||!this._box&&y.dist(this._startPos)<this._clickTolerance)return;const C=this._startPos;this._lastPos=y,this._box||(this._box=Pe.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",n));const N=Math.min(C.x,y.x),V=Math.max(C.x,y.x),Z=Math.min(C.y,y.y),Y=Math.max(C.y,y.y);Pe.setTransform(this._box,`translate(${N}px,${Z}px)`),this._box.style.width=V-N+"px",this._box.style.height=Y-Z+"px"}mouseupWindow(n,d){if(!this._active||0!==n.button)return;const y=this._startPos,C=d;if(this.reset(),Pe.suppressClick(),y.x!==C.x||y.y!==C.y)return this._map.fire(new x.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:N=>N.fitScreenCoordinates(y,C,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&27===n.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",n))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(Pe.remove(this._box),this._box=null),Pe.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,d){return this._map.fire(new x.Event(n,{originalEvent:d}))}}function ra(w,n){if(w.length!==n.length)throw new Error(`The number of touches and points are not equal - touches ${w.length}, points ${n.length}`);const d={};for(let y=0;y<w.length;y++)d[w[y].identifier]=n[y];return d}class Xn{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,d,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=n.timeStamp),y.length===this.numTouches&&(this.centroid=function(C){const N=new x.Point(0,0);for(const V of C)N._add(V);return N.div(C.length)}(d),this.touches=ra(y,d)))}touchmove(n,d,y){if(this.aborted||!this.centroid)return;const C=ra(y,d);for(const N in this.touches){const V=C[N];(!V||V.dist(this.touches[N])>30)&&(this.aborted=!0)}}touchend(n,d,y){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),0===y.length){const C=!this.aborted&&this.centroid;if(this.reset(),C)return C}}}class Vc{constructor(n){this.singleTap=new Xn(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,d,y){this.singleTap.touchstart(n,d,y)}touchmove(n,d,y){this.singleTap.touchmove(n,d,y)}touchend(n,d,y){const C=this.singleTap.touchend(n,d,y);if(C){const N=n.timeStamp-this.lastTime<500,V=!this.lastTap||this.lastTap.dist(C)<30;if(N&&V||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=C,this.count===this.numTaps)return this.reset(),C}}}class _s{constructor(n){this._tr=new Il(n),this._zoomIn=new Vc({numTouches:1,numTaps:2}),this._zoomOut=new Vc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,d,y){this._zoomIn.touchstart(n,d,y),this._zoomOut.touchstart(n,d,y)}touchmove(n,d,y){this._zoomIn.touchmove(n,d,y),this._zoomOut.touchmove(n,d,y)}touchend(n,d,y){const C=this._zoomIn.touchend(n,d,y),N=this._zoomOut.touchend(n,d,y),V=this._tr;return C?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:Z=>Z.easeTo({duration:300,zoom:V.zoom+1,around:V.unproject(C)},{originalEvent:n})}):N?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:Z=>Z.easeTo({duration:300,zoom:V.zoom-1,around:V.unproject(N)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class La{constructor(n){this._enabled=!!n.enable,this._moveStateManager=n.moveStateManager,this._clickTolerance=n.clickTolerance||1,this._moveFunction=n.move,this._activateOnStart=!!n.activateOnStart,n.assignEvents(this),this.reset()}reset(n){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(n)}_move(...n){const d=this._moveFunction(...n);if(d.bearingDelta||d.pitchDelta||d.around||d.panDelta)return this._active=!0,d}dragStart(n,d){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(n)&&(this._moveStateManager.startMove(n),this._lastPoint=d.length?d[0]:d,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(n,d){if(!this.isEnabled())return;const y=this._lastPoint;if(!y)return;if(n.preventDefault(),!this._moveStateManager.isValidMoveEvent(n))return void this.reset(n);const C=d.length?d[0]:d;return!this._moved&&C.dist(y)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=C,this._move(y,C))}dragEnd(n){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(n)&&(this._moved&&Pe.suppressClick(),this.reset(n))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const rs={0:1,2:2};class G{constructor(n){this._correctEvent=n.checkCorrectEvent}startMove(n){const d=Pe.mouseButton(n);this._eventButton=d}endMove(n){delete this._eventButton}isValidStartEvent(n){return this._correctEvent(n)}isValidMoveEvent(n){return!function(d,y){const C=rs[y];return void 0===d.buttons||(d.buttons&C)!==C}(n,this._eventButton)}isValidEndEvent(n){return Pe.mouseButton(n)===this._eventButton}}class de{constructor(){this._firstTouch=void 0}_isOneFingerTouch(n){return 1===n.targetTouches.length}_isSameTouchEvent(n){return n.targetTouches[0].identifier===this._firstTouch}startMove(n){this._firstTouch=n.targetTouches[0].identifier}endMove(n){delete this._firstTouch}isValidStartEvent(n){return this._isOneFingerTouch(n)}isValidMoveEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}isValidEndEvent(n){return this._isOneFingerTouch(n)&&this._isSameTouchEvent(n)}}const K=w=>{w.mousedown=w.dragStart,w.mousemoveWindow=w.dragMove,w.mouseup=w.dragEnd,w.contextmenu=function(n){n.preventDefault()}},Ee=({enable:w,clickTolerance:n,bearingDegreesPerPixelMoved:d=.8})=>{const y=new G({checkCorrectEvent:C=>0===Pe.mouseButton(C)&&C.ctrlKey||2===Pe.mouseButton(C)});return new La({clickTolerance:n,move:(C,N)=>({bearingDelta:(N.x-C.x)*d}),moveStateManager:y,enable:w,assignEvents:K})},He=({enable:w,clickTolerance:n,pitchDegreesPerPixelMoved:d=-.5})=>{const y=new G({checkCorrectEvent:C=>0===Pe.mouseButton(C)&&C.ctrlKey||2===Pe.mouseButton(C)});return new La({clickTolerance:n,move:(C,N)=>({pitchDelta:(N.y-C.y)*d}),moveStateManager:y,enable:w,assignEvents:K})};class St{constructor(n,d){this._minTouches=n.cooperativeGestures?2:1,this._clickTolerance=n.clickTolerance||1,this._map=d,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new x.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(n,d,y){return this._calculateTransform(n,d,y)}touchmove(n,d,y){if(this._map._cooperativeGestures&&(2===this._minTouches&&y.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(n,!1,y.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(y.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,d,y)}touchend(n,d,y){this._calculateTransform(n,d,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,d,y){y.length>0&&(this._active=!0);const C=ra(y,d),N=new x.Point(0,0),V=new x.Point(0,0);let Z=0;for(const X in C){const le=C[X],ae=this._touches[X];ae&&(N._add(le),V._add(le.sub(ae)),Z++,C[X]=le)}if(this._touches=C,Z<this._minTouches||!V.mag())return;const Y=V.div(Z);return this._sum._add(Y),this._sum.mag()<this._clickTolerance?void 0:{around:N.div(Z),panDelta:Y}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Kt{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(n){}_move(n,d,y){return{}}touchstart(n,d,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([d[0],d[1]]))}touchmove(n,d,y){if(!this._firstTwoTouches)return;n.preventDefault();const[C,N]=this._firstTwoTouches,V=ni(y,d,C),Z=ni(y,d,N);if(!V||!Z)return;const Y=this._aroundCenter?null:V.add(Z).div(2);return this._move([V,Z],Y,n)}touchend(n,d,y){if(!this._firstTwoTouches)return;const[C,N]=this._firstTwoTouches,V=ni(y,d,C),Z=ni(y,d,N);V&&Z||(this._active&&Pe.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&"center"===n.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ni(w,n,d){for(let y=0;y<w.length;y++)if(w[y].identifier===d)return n[y]}function sr(w,n){return Math.log(w/n)/Math.LN2}class Ri extends Kt{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,d){const y=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(sr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:sr(this._distance,y),pinchAround:d}}}function lr(w,n){return 180*w.angleWith(n)/Math.PI}class Yi extends Kt{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,d){const y=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:lr(this._vector,y),pinchAround:d}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const d=25/(Math.PI*this._minDiameter)*360,y=lr(n,this._startVector);return Math.abs(y)<d}}function Wr(w){return Math.abs(w.y)>Math.abs(w.x)}class Ii extends Kt{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(n,d,y){super.touchstart(n,d,y),this._currentTouchCount=y.length}_start(n){this._lastPoints=n,Wr(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,d,y){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const C=n[0].sub(this._lastPoints[0]),N=n[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(C,N,y.timeStamp),this._valid?(this._lastPoints=n,this._active=!0,{pitchDelta:(C.y+N.y)/2*-.5}):void 0}gestureBeginsVertically(n,d,y){if(void 0!==this._valid)return this._valid;const C=n.mag()>=2,N=d.mag()>=2;if(!C&&!N)return;if(!C||!N)return void 0===this._firstMove&&(this._firstMove=y),y-this._firstMove<100&&void 0;const V=n.y>0==d.y>0;return Wr(n)&&Wr(d)&&V}}const Vr={panStep:100,bearingStep:15,pitchStep:10};class eo{constructor(n){this._tr=new Il(n);const d=Vr;this._panStep=d.panStep,this._bearingStep=d.bearingStep,this._pitchStep=d.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let d=0,y=0,C=0,N=0,V=0;switch(n.keyCode){case 61:case 107:case 171:case 187:d=1;break;case 189:case 109:case 173:d=-1;break;case 37:n.shiftKey?y=-1:(n.preventDefault(),N=-1);break;case 39:n.shiftKey?y=1:(n.preventDefault(),N=1);break;case 38:n.shiftKey?C=1:(n.preventDefault(),V=-1);break;case 40:n.shiftKey?C=-1:(n.preventDefault(),V=1);break;default:return}return this._rotationDisabled&&(y=0,C=0),{cameraAnimation:Z=>{const Y=this._tr;Z.easeTo({duration:300,easeId:"keyboardHandler",easing:Ps,zoom:d?Math.round(Y.zoom)+d*(n.shiftKey?2:1):Y.zoom,bearing:Y.bearing+y*this._bearingStep,pitch:Y.pitch+C*this._pitchStep,offset:[-N*this._panStep,-V*this._panStep],center:Y.center},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ps(w){return w*(2-w)}const oa=4.000244140625;class Co{constructor(n,d){this._map=n,this._tr=new Il(n),this._el=n.getCanvasContainer(),this._handler=d,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,x.bindAll(["_onTimeout"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&"center"===n.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!n[this._map._metaKey])return;n.preventDefault()}let d=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const y=x.exported.now(),C=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,0!==d&&d%oa==0?this._type="wheel":0!==d&&Math.abs(d)<4?this._type="trackpad":C>400?(this._type=null,this._lastValue=d,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(C*d)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,d+=this._lastValue)),n.shiftKey&&d&&(d/=4),this._type&&(this._lastWheelEvent=n,this._delta-=d,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const d=Pe.mousePos(this._el,n),y=this._tr;this._around=x.LngLat.convert(this._aroundCenter?y.center:y.unproject(d)),this._aroundPoint=y.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._tr.transform;if(0!==this._delta){const Z="wheel"===this._type&&Math.abs(this._delta)>oa?this._wheelZoomRate:this._defaultZoomRate;let Y=2/(1+Math.exp(-Math.abs(this._delta*Z)));this._delta<0&&0!==Y&&(Y=1/Y);const X="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):n.scale;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(X*Y))),"wheel"===this._type&&(this._startZoom=n.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const d="number"==typeof this._targetZoom?this._targetZoom:n.zoom,y=this._startZoom,C=this._easing;let N,V=!1;if("wheel"===this._type&&y&&C){const Z=Math.min((x.exported.now()-this._lastWheelEventTime)/200,1),Y=C(Z);N=x.interpolate.number(y,d,Y),Z<1?this._frameId||(this._frameId=!0):V=!0}else N=d,V=!0;return this._active=!0,V&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!V,zoomDelta:N-n.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let d=x.ease;if(this._prevEase){const y=this._prevEase,C=(x.exported.now()-y.start)/y.duration,N=y.easing(C+.01)-y.easing(C),V=.27/Math.sqrt(N*N+1e-4)*.01,Z=Math.sqrt(.0729-V*V);d=x.bezier(V,Z,.25,1)}return this._prevEase={start:x.exported.now(),duration:n,easing:d},d}reset(){this._active=!1}}class kr{constructor(n,d){this._clickZoom=n,this._tapZoom=d}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Nn{constructor(n){this._tr=new Il(n),this.reset()}reset(){this._active=!1}dblclick(n,d){return n.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:this._tr.zoom+(n.shiftKey?-1:1),around:this._tr.unproject(d)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xi{constructor(){this._tap=new Vc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(n,d,y){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=d[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(n,d,y))}touchmove(n,d,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const C=d[0],N=C.y-this._swipePoint.y;return this._swipePoint=C,n.preventDefault(),this._active=!0,{zoomDelta:N/128}}}else this._tap.touchmove(n,d,y)}touchend(n,d,y){this._tapTime?this._swipePoint&&0===y.length&&this.reset():this._tap.touchend(n,d,y)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Uc{constructor(n,d,y){this._el=n,this._mousePan=d,this._touchPan=y}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class _o{constructor(n,d,y){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=d,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ru{constructor(n,d,y,C){this._el=n,this._touchZoom=d,this._touchRotate=y,this._tapDragZoom=C,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const ql=w=>w.zoom||w.drag||w.pitch||w.rotate;class du extends x.Event{}function Zs(w){return w.panDelta&&w.panDelta.mag()||w.zoomDelta||w.bearingDelta||w.pitchDelta}class Ba{constructor(n,d){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Ws(n),this._bearingSnap=d.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(d),x.bindAll(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[C,N,V]of this._listeners)Pe.addEventListener(C,N,C===document?this.handleWindowEvent:this.handleEvent,V)}destroy(){for(const[n,d,y]of this._listeners)Pe.removeEventListener(n,d,n===document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(n){const d=this._map,y=d.getCanvasContainer();this._add("mapEvent",new Yl(d,n));const C=d.boxZoom=new _c(d,n);this._add("boxZoom",C);const N=new _s(d),V=new Nn(d);d.doubleClickZoom=new kr(V,N),this._add("tapZoom",N),this._add("clickZoom",V);const Z=new Xi;this._add("tapDragZoom",Z);const Y=d.touchPitch=new Ii(d);this._add("touchPitch",Y);const X=Ee(n),le=He(n);d.dragRotate=new _o(n,X,le),this._add("mouseRotate",X,["mousePitch"]),this._add("mousePitch",le,["mouseRotate"]);const ae=(({enable:O,clickTolerance:z})=>{const W=new G({checkCorrectEvent:ie=>0===Pe.mouseButton(ie)&&!ie.ctrlKey});return new La({clickTolerance:z,move:(ie,ue)=>({around:ue,panDelta:ue.sub(ie)}),activateOnStart:!0,moveStateManager:W,enable:O,assignEvents:K})})(n),De=new St(n,d);d.dragPan=new Uc(y,ae,De),this._add("mousePan",ae),this._add("touchPan",De,["touchZoom","touchRotate"]);const ze=new Yi,ke=new Ri;d.touchZoomRotate=new Ru(y,ke,ze,Z),this._add("touchRotate",ze,["touchPan","touchZoom"]),this._add("touchZoom",ke,["touchPan","touchRotate"]);const R=d.scrollZoom=new Co(d,this);this._add("scrollZoom",R,["mousePan"]);const k=d.keyboard=new eo(d);this._add("keyboard",k),this._add("blockableMapEvent",new uu(d));for(const O of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[O]&&d[O].enable(n[O])}_add(n,d,y){this._handlers.push({handlerName:n,handler:d,allowed:y}),this._handlersById[n]=d}stop(n){if(!this._updatingCamera){for(const{handler:d}of this._handlers)d.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!ql(this._eventsInProgress)||this.isZooming()}_blockedByActive(n,d,y){for(const C in n)if(C!==y&&(!d||d.indexOf(C)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const d=[];for(const y of n)this._el.contains(y.target)&&d.push(y);return d}handleEvent(n,d){if("blur"===n.type)return void this.stop(!0);this._updatingCamera=!0;const y="renderFrame"===n.type?void 0:n,C={needsRenderFrame:!1},N={},V={},Z=n.touches,Y=Z?this._getMapTouches(Z):void 0,X=Y?Pe.touchPos(this._el,Y):Pe.mousePos(this._el,n);for(const{handlerName:De,handler:ze,allowed:ke}of this._handlers){if(!ze.isEnabled())continue;let R;this._blockedByActive(V,ke,De)?ze.reset():ze[d||n.type]&&(R=ze[d||n.type](n,X,Y),this.mergeHandlerResult(C,N,R,De,y),R&&R.needsRenderFrame&&this._triggerRenderFrame()),(R||ze.isActive())&&(V[De]=ze)}const le={};for(const De in this._previousActiveHandlers)V[De]||(le[De]=y);this._previousActiveHandlers=V,(Object.keys(le).length||Zs(C))&&(this._changes.push([C,N,le]),this._triggerRenderFrame()),(Object.keys(V).length||Zs(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ae}=C;ae&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ae(this._map))}mergeHandlerResult(n,d,y,C,N){if(!y)return;x.extend(n,y);const V={handlerName:C,originalEvent:y.originalEvent||N};void 0!==y.zoomDelta&&(d.zoom=V),void 0!==y.panDelta&&(d.drag=V),void 0!==y.pitchDelta&&(d.pitch=V),void 0!==y.bearingDelta&&(d.rotate=V)}_applyChanges(){const n={},d={},y={};for(const[C,N,V]of this._changes)C.panDelta&&(n.panDelta=(n.panDelta||new x.Point(0,0))._add(C.panDelta)),C.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+C.zoomDelta),C.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+C.bearingDelta),C.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+C.pitchDelta),void 0!==C.around&&(n.around=C.around),void 0!==C.pinchAround&&(n.pinchAround=C.pinchAround),C.noInertia&&(n.noInertia=C.noInertia),x.extend(d,N),x.extend(y,V);this._updateMapTransform(n,d,y),this._changes=[]}_updateMapTransform(n,d,y){const C=this._map,N=C._getTransformForUpdate(),V=C.terrain;if(!(Zs(n)||V&&this._terrainMovement))return this._fireEvents(d,y,!0);let{panDelta:Z,zoomDelta:Y,bearingDelta:X,pitchDelta:le,around:ae,pinchAround:De}=n;void 0!==De&&(ae=De),C._stop(!0),ae=ae||C.transform.centerPoint;const ze=N.pointLocation(Z?ae.sub(Z):ae);X&&(N.bearing+=X),le&&(N.pitch+=le),Y&&(N.zoom+=Y),V?this._terrainMovement||!d.drag&&!d.zoom?d.drag&&this._terrainMovement?N.center=N.pointLocation(N.centerPoint.sub(Z)):N.setLocationAtPoint(ze,ae):(this._terrainMovement=!0,N.freezeElevation=!0,N.setLocationAtPoint(ze,ae),this._map.once("moveend",()=>{N.freezeElevation=!1,this._terrainMovement=!1,N.recalculateZoom(C.terrain)})):N.setLocationAtPoint(ze,ae),C._applyUpdatedTransform(N),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(d,y,!0)}_fireEvents(n,d,y){const C=ql(this._eventsInProgress),N=ql(n),V={};for(const le in n){const{originalEvent:ae}=n[le];this._eventsInProgress[le]||(V[`${le}start`]=ae),this._eventsInProgress[le]=n[le]}!C&&N&&this._fireEvent("movestart",N.originalEvent);for(const le in V)this._fireEvent(le,V[le]);N&&this._fireEvent("move",N.originalEvent);for(const le in n){const{originalEvent:ae}=n[le];this._fireEvent(le,ae)}const Z={};let Y;for(const le in this._eventsInProgress){const{handlerName:ae,originalEvent:De}=this._eventsInProgress[le];this._handlersById[ae].isActive()||(delete this._eventsInProgress[le],Y=d[ae]||De,Z[`${le}end`]=Y)}for(const le in Z)this._fireEvent(le,Z[le]);const X=ql(this._eventsInProgress);if(y&&(C||N)&&!X){this._updatingCamera=!0;const le=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ae=De=>0!==De&&-this._bearingSnap<De&&De<this._bearingSnap;le?(ae(le.bearing||this._map.getBearing())&&(le.bearing=0),le.freezeElevation=!0,this._map.easeTo(le,{originalEvent:Y})):(this._map.fire(new x.Event("moveend",{originalEvent:Y})),ae(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,d){this._map.fire(new x.Event(n,d?{originalEvent:d}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new du("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const ys={extend:(w,...n)=>x.extend(w,...n),run(w){w()},logToElement(w,n=!1,d="log"){const y=window.document.getElementById(d);y&&(n&&(y.innerHTML=""),y.innerHTML+=`<br>${w}`)}};class li extends x.Evented{constructor(n,d){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=d.bearingSnap,x.bindAll(["_renderFrameCallback"],this),this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new x.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(n,d){return this.jumpTo({center:n},d)}panBy(n,d,y){return n=x.Point.convert(n).mult(-1),this.panTo(this.transform.center,x.extend({offset:n},d),y)}panTo(n,d,y){return this.easeTo(x.extend({center:n},d),y)}getZoom(){return this.transform.zoom}setZoom(n,d){return this.jumpTo({zoom:n},d),this}zoomTo(n,d,y){return this.easeTo(x.extend({zoom:n},d),y)}zoomIn(n,d){return this.zoomTo(this.getZoom()+1,n,d),this}zoomOut(n,d){return this.zoomTo(this.getZoom()-1,n,d),this}getBearing(){return this.transform.bearing}setBearing(n,d){return this.jumpTo({bearing:n},d),this}getPadding(){return this.transform.padding}setPadding(n,d){return this.jumpTo({padding:n},d),this}rotateTo(n,d,y){return this.easeTo(x.extend({bearing:n},d),y)}resetNorth(n,d){return this.rotateTo(0,x.extend({duration:1e3},n),d),this}resetNorthPitch(n,d){return this.easeTo(x.extend({bearing:0,pitch:0,duration:1e3},n),d),this}snapToNorth(n,d){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,d):this}getPitch(){return this.transform.pitch}setPitch(n,d){return this.jumpTo({pitch:n},d),this}cameraForBounds(n,d){n=Pt.convert(n);const y=d&&d.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),y,d)}_cameraForBoxAndBearing(n,d,y,C){const N={top:0,bottom:0,right:0,left:0};if("number"==typeof(C=x.extend({padding:N,offset:[0,0],maxZoom:this.transform.maxZoom},C)).padding){const ue=C.padding;C.padding={top:ue,bottom:ue,right:ue,left:ue}}C.padding=x.extend(N,C.padding);const V=this.transform,Z=V.padding,Y=V.project(x.LngLat.convert(n)),X=V.project(x.LngLat.convert(d)),le=Y.rotate(-y*Math.PI/180),ae=X.rotate(-y*Math.PI/180),De=new x.Point(Math.max(le.x,ae.x),Math.max(le.y,ae.y)),ze=new x.Point(Math.min(le.x,ae.x),Math.min(le.y,ae.y)),ke=De.sub(ze),R=(V.width-(Z.left+Z.right+C.padding.left+C.padding.right))/ke.x,k=(V.height-(Z.top+Z.bottom+C.padding.top+C.padding.bottom))/ke.y;if(k<0||R<0)return void x.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const O=Math.min(V.scaleZoom(V.scale*Math.min(R,k)),C.maxZoom),z=x.Point.convert(C.offset),W=new x.Point((C.padding.left-C.padding.right)/2,(C.padding.top-C.padding.bottom)/2).rotate(y*Math.PI/180),ie=z.add(W).mult(V.scale/V.zoomScale(O));return{center:V.unproject(Y.add(X).div(2).sub(ie)),zoom:O,bearing:y}}fitBounds(n,d,y){return this._fitInternal(this.cameraForBounds(n,d),d,y)}fitScreenCoordinates(n,d,y,C,N){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(x.Point.convert(n)),this.transform.pointLocation(x.Point.convert(d)),y,C),C,N)}_fitInternal(n,d,y){return n?(delete(d=x.extend(n,d)).padding,d.linear?this.easeTo(d,y):this.flyTo(d,y)):this}jumpTo(n,d){this.stop();const y=this._getTransformForUpdate();let C=!1,N=!1,V=!1;return"zoom"in n&&y.zoom!==+n.zoom&&(C=!0,y.zoom=+n.zoom),void 0!==n.center&&(y.center=x.LngLat.convert(n.center)),"bearing"in n&&y.bearing!==+n.bearing&&(N=!0,y.bearing=+n.bearing),"pitch"in n&&y.pitch!==+n.pitch&&(V=!0,y.pitch=+n.pitch),null==n.padding||y.isPaddingEqual(n.padding)||(y.padding=n.padding),this._applyUpdatedTransform(y),this.fire(new x.Event("movestart",d)).fire(new x.Event("move",d)),C&&this.fire(new x.Event("zoomstart",d)).fire(new x.Event("zoom",d)).fire(new x.Event("zoomend",d)),N&&this.fire(new x.Event("rotatestart",d)).fire(new x.Event("rotate",d)).fire(new x.Event("rotateend",d)),V&&this.fire(new x.Event("pitchstart",d)).fire(new x.Event("pitch",d)).fire(new x.Event("pitchend",d)),this.fire(new x.Event("moveend",d))}calculateCameraOptionsFromTo(n,d,y,C=0){const N=x.MercatorCoordinate.fromLngLat(n,d),V=x.MercatorCoordinate.fromLngLat(y,C),Z=V.x-N.x,Y=V.y-N.y,X=V.z-N.z,le=Math.hypot(Z,Y,X);if(0===le)throw new Error("Can't calculate camera options with same From and To");const ae=Math.hypot(Z,Y),De=this.transform.scaleZoom(this.transform.cameraToCenterDistance/le/this.transform.tileSize),ze=180*Math.atan2(Z,-Y)/Math.PI;let ke=180*Math.acos(ae/le)/Math.PI;return ke=X<0?90-ke:90+ke,{center:V.toLngLat(),zoom:De,pitch:ke,bearing:ze}}easeTo(n,d){this._stop(!1,n.easeId),(!1===(n=x.extend({offset:[0,0],duration:500,easing:x.ease},n)).animate||!n.essential&&x.exported.prefersReducedMotion)&&(n.duration=0);const y=this._getTransformForUpdate(),C=this.getZoom(),N=this.getBearing(),V=this.getPitch(),Z=this.getPadding(),Y="zoom"in n?+n.zoom:C,X="bearing"in n?this._normalizeBearing(n.bearing,N):N,le="pitch"in n?+n.pitch:V,ae="padding"in n?n.padding:y.padding,De=x.Point.convert(n.offset);let ze=y.centerPoint.add(De);const ke=y.pointLocation(ze),R=x.LngLat.convert(n.center||ke);this._normalizeCenter(R);const k=y.project(ke),O=y.project(R).sub(k),z=y.zoomScale(Y-C);let W,ie;n.around&&(W=x.LngLat.convert(n.around),ie=y.locationPoint(W));const ue={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||Y!==C,this._rotating=this._rotating||N!==X,this._pitching=this._pitching||le!==V,this._padding=!y.isPaddingEqual(ae),this._easeId=n.easeId,this._prepareEase(d,n.noMoveStart,ue),this.terrain&&this._prepareElevation(R),this._ease(Ne=>{if(this._zooming&&(y.zoom=x.interpolate.number(C,Y,Ne)),this._rotating&&(y.bearing=x.interpolate.number(N,X,Ne)),this._pitching&&(y.pitch=x.interpolate.number(V,le,Ne)),this._padding&&(y.interpolatePadding(Z,ae,Ne),ze=y.centerPoint.add(De)),this.terrain&&!n.freezeElevation&&this._updateElevation(Ne),W)y.setLocationAtPoint(W,ie);else{const et=y.zoomScale(y.zoom-C),Mt=Y>C?Math.min(2,z):Math.max(.5,z),vt=Math.pow(Mt,1-Ne),on=y.unproject(k.add(O.mult(Ne*vt)).mult(et));y.setLocationAtPoint(y.renderWorldCopies?on.wrap():on,ze)}this._applyUpdatedTransform(y),this._fireMoveEvents(d)},Ne=>{this.terrain&&this._finalizeElevation(),this._afterEase(d,Ne)},n),this}_prepareEase(n,d,y={}){this._moving=!0,d||y.moving||this.fire(new x.Event("movestart",n)),this._zooming&&!y.zooming&&this.fire(new x.Event("zoomstart",n)),this._rotating&&!y.rotating&&this.fire(new x.Event("rotatestart",n)),this._pitching&&!y.pitching&&this.fire(new x.Event("pitchstart",n))}_prepareElevation(n){this._elevationCenter=n,this._elevationStart=this.transform.elevation,this._elevationTarget=this.transform.getElevation(n,this.terrain),this.transform.freezeElevation=!0}_updateElevation(n){const d=this.transform.getElevation(this._elevationCenter,this.terrain);if(n<1&&d!==this._elevationTarget){const y=this._elevationTarget-this._elevationStart;this._elevationStart+=n*(y-(d-(y*n+this._elevationStart))/(1-n)),this._elevationTarget=d}this.transform.elevation=x.interpolate.number(this._elevationStart,this._elevationTarget,n)}_finalizeElevation(){this.transform.freezeElevation=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(n){if(!this.transformCameraUpdate)return;const d=n.clone(),{center:y,zoom:C,pitch:N,bearing:V,elevation:Z}=this.transformCameraUpdate(d);y&&(d.center=y),void 0!==C&&(d.zoom=C),void 0!==N&&(d.pitch=N),void 0!==V&&(d.bearing=V),void 0!==Z&&(d.elevation=Z),this.transform.apply(d)}_fireMoveEvents(n){this.fire(new x.Event("move",n)),this._zooming&&this.fire(new x.Event("zoom",n)),this._rotating&&this.fire(new x.Event("rotate",n)),this._pitching&&this.fire(new x.Event("pitch",n))}_afterEase(n,d){if(this._easeId&&d&&this._easeId===d)return;delete this._easeId;const y=this._zooming,C=this._rotating,N=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new x.Event("zoomend",n)),C&&this.fire(new x.Event("rotateend",n)),N&&this.fire(new x.Event("pitchend",n)),this.fire(new x.Event("moveend",n))}flyTo(n,d){if(!n.essential&&x.exported.prefersReducedMotion){const Bn=x.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Bn,d)}this.stop(),n=x.extend({offset:[0,0],speed:1.2,curve:1.42,easing:x.ease},n);const y=this._getTransformForUpdate(),C=this.getZoom(),N=this.getBearing(),V=this.getPitch(),Z=this.getPadding(),Y="zoom"in n?x.clamp(+n.zoom,y.minZoom,y.maxZoom):C,X="bearing"in n?this._normalizeBearing(n.bearing,N):N,le="pitch"in n?+n.pitch:V,ae="padding"in n?n.padding:y.padding,De=y.zoomScale(Y-C),ze=x.Point.convert(n.offset);let ke=y.centerPoint.add(ze);const R=y.pointLocation(ke),k=x.LngLat.convert(n.center||R);this._normalizeCenter(k);const O=y.project(R),z=y.project(k).sub(O);let W=n.curve;const ie=Math.max(y.width,y.height),ue=ie/De,Ne=z.mag();if("minZoom"in n){const Bn=x.clamp(Math.min(n.minZoom,C,Y),y.minZoom,y.maxZoom),cr=ie/y.zoomScale(Bn-C);W=Math.sqrt(cr/Ne*2)}const et=W*W;function Mt(Bn){const cr=(ue*ue-ie*ie+(Bn?-1:1)*et*et*Ne*Ne)/(2*(Bn?ue:ie)*et*Ne);return Math.log(Math.sqrt(cr*cr+1)-cr)}function vt(Bn){return(Math.exp(Bn)-Math.exp(-Bn))/2}function on(Bn){return(Math.exp(Bn)+Math.exp(-Bn))/2}const Hn=Mt(0);let Pi=function(Bn){return on(Hn)/on(Hn+W*Bn)},Dn=function(Bn){return ie*((on(Hn)*(vt(cr=Hn+W*Bn)/on(cr))-vt(Hn))/et)/Ne;var cr},gi=(Mt(1)-Hn)/W;if(Math.abs(Ne)<1e-6||!isFinite(gi)){if(Math.abs(ie-ue)<1e-6)return this.easeTo(n,d);const Bn=ue<ie?-1:1;gi=Math.abs(Math.log(ue/ie))/W,Dn=function(){return 0},Pi=function(cr){return Math.exp(Bn*W*cr)}}return n.duration="duration"in n?+n.duration:1e3*gi/("screenSpeed"in n?+n.screenSpeed/W:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0),this._zooming=!0,this._rotating=N!==X,this._pitching=le!==V,this._padding=!y.isPaddingEqual(ae),this._prepareEase(d,!1),this.terrain&&this._prepareElevation(k),this._ease(Bn=>{const cr=Bn*gi,To=1/Pi(cr);y.zoom=1===Bn?Y:C+y.scaleZoom(To),this._rotating&&(y.bearing=x.interpolate.number(N,X,Bn)),this._pitching&&(y.pitch=x.interpolate.number(V,le,Bn)),this._padding&&(y.interpolatePadding(Z,ae,Bn),ke=y.centerPoint.add(ze)),this.terrain&&!n.freezeElevation&&this._updateElevation(Bn);const Ir=1===Bn?k:y.unproject(O.add(z.mult(Dn(cr))).mult(To));y.setLocationAtPoint(y.renderWorldCopies?Ir.wrap():Ir,ke),this._applyUpdatedTransform(y),this._fireMoveEvents(d)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(d)},n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,d){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,d)}if(!n){const y=this.handlers;y&&y.stop(!1)}return this}_ease(n,d,y){!1===y.animate||0===y.duration?(n(1),d()):(this._easeStart=x.exported.now(),this._easeOptions=y,this._onEaseFrame=n,this._onEaseEnd=d,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((x.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,d){n=x.wrap(n,-180,180);const y=Math.abs(n-d);return Math.abs(n-360-d)<y&&(n-=360),Math.abs(n+360-d)<y&&(n+=360),n}_normalizeCenter(n){const d=this.transform;if(!d.renderWorldCopies||d.lngRange)return;const y=n.lng-d.center.lng;n.lng+=y>180?-360:y<-180?360:0}queryTerrainElevation(n){return this.terrain?this.transform.getElevation(x.LngLat.convert(n),this.terrain)-this.transform.elevation:null}}class pi{constructor(n={}){this.options=n,x.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){return this._map=n,this._compact=this.options&&this.options.compact,this._container=Pe.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=Pe.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Pe.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){Pe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(n,d){const y=this._map._getUIString(`AttributionControl.${d}`);n.title=y,n.setAttribute("aria-label",y)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))}_updateData(n){!n||"metadata"!==n.sourceDataType&&"visibility"!==n.sourceDataType&&"style"!==n.dataType&&"terrain"!==n.type||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(C=>"string"!=typeof C?"":C)):"string"==typeof this.options.customAttribution&&n.push(this.options.customAttribution)),this._map.style.stylesheet){const C=this._map.style.stylesheet;this.styleOwner=C.owner,this.styleId=C.id}const d=this._map.style.sourceCaches;for(const C in d){const N=d[C];if(N.used||N.usedForTerrain){const V=N.getSource();V.attribution&&n.indexOf(V.attribution)<0&&n.push(V.attribution)}}n=n.filter(C=>String(C).trim()),n.sort((C,N)=>C.length-N.length),n=n.filter((C,N)=>{for(let V=N+1;V<n.length;V++)if(n[V].indexOf(C)>=0)return!1;return!0});const y=n.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,n.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")}}class yc{constructor(n={}){this.options=n,x.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(n){this._map=n,this._compact=this.options&&this.options.compact,this._container=Pe.create("div","maplibregl-ctrl");const d=Pe.create("a","maplibregl-ctrl-logo");return d.target="_blank",d.rel="noopener nofollow",d.href="https://maplibre.org/",d.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),d.setAttribute("rel","noopener nofollow"),this._container.appendChild(d),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){Pe.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const n=this._container.children;if(n.length){const d=n[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&d.classList.add("maplibregl-compact"):d.classList.remove("maplibregl-compact")}}}class dn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const d=++this._id;return this._queue.push({callback:n,id:d,cancelled:!1}),d}remove(n){const d=this._currentlyRunning,y=d?this._queue.concat(d):this._queue;for(const C of y)if(C.id===n)return void(C.cancelled=!0)}run(n=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const d=this._currentlyRunning=this._queue;this._queue=[];for(const y of d)if(!y.cancelled&&(y.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const qi={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Fr=x.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class od extends x.Evented{constructor(n){super(),this.sourceCache=n,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,n.usedForTerrain=!0,n.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(n,d){this.sourceCache.update(n,d),this._renderableTilesKeys=[];const y={};for(const C of n.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:d}))y[C.key]=!0,this._renderableTilesKeys.push(C.key),this._tiles[C.key]||(C.posMatrix=new Float64Array(16),x.ortho(C.posMatrix,0,x.EXTENT,0,x.EXTENT,0,1),this._tiles[C.key]=new mt(C,this.tileSize));for(const C in this._tiles)y[C]||delete this._tiles[C]}freeRtt(n){for(const d in this._tiles){const y=this._tiles[d];(!n||y.tileID.equals(n)||y.tileID.isChildOf(n)||n.isChildOf(y.tileID))&&(y.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(n=>this.getTileByID(n))}getTileByID(n){return this._tiles[n]}getTerrainCoords(n){const d={};for(const y of this._renderableTilesKeys){const C=this._tiles[y].tileID;if(C.canonical.equals(n.canonical)){const N=n.clone();N.posMatrix=new Float64Array(16),x.ortho(N.posMatrix,0,x.EXTENT,0,x.EXTENT,0,1),d[y]=N}else if(C.canonical.isChildOf(n.canonical)){const N=n.clone();N.posMatrix=new Float64Array(16);const V=C.canonical.z-n.canonical.z,Z=C.canonical.x-(C.canonical.x>>V<<V),Y=C.canonical.y-(C.canonical.y>>V<<V),X=x.EXTENT>>V;x.ortho(N.posMatrix,0,X,0,X,0,1),x.translate(N.posMatrix,N.posMatrix,[-Z*X,-Y*X,0]),d[y]=N}else if(n.canonical.isChildOf(C.canonical)){const N=n.clone();N.posMatrix=new Float64Array(16);const V=n.canonical.z-C.canonical.z,Z=n.canonical.x-(n.canonical.x>>V<<V),Y=n.canonical.y-(n.canonical.y>>V<<V),X=x.EXTENT>>V;x.ortho(N.posMatrix,0,x.EXTENT,0,x.EXTENT,0,1),x.translate(N.posMatrix,N.posMatrix,[Z*X,Y*X,0]),x.scale(N.posMatrix,N.posMatrix,[1/2**V,1/2**V,0]),d[y]=N}}return d}getSourceTile(n,d){const y=this.sourceCache._source;let C=n.overscaledZ-this.deltaZoom;if(C>y.maxzoom&&(C=y.maxzoom),C<y.minzoom)return null;this._sourceTileCache[n.key]||(this._sourceTileCache[n.key]=n.scaledTo(C).key);let N=this.sourceCache.getTileByID(this._sourceTileCache[n.key]);if((!N||!N.dem)&&d)for(;C>=y.minzoom&&(!N||!N.dem);)N=this.sourceCache.getTileByID(n.scaledTo(C--).key);return N}tilesAfterTime(n=Date.now()){return Object.values(this._tiles).filter(d=>d.timeAdded>=n)}}class qr{constructor(n,d,y){this.painter=n,this.sourceCache=new od(d),this.options=y,this.exaggeration="number"==typeof y.exaggeration?y.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(n,d,y,C=x.EXTENT){if(!(d>=0&&d<C&&y>=0&&y<C))return 0;let N=0;const V=this.getTerrainData(n);if(V.tile&&V.tile.dem){const Z=((ke=[])[0]=(k=V.u_terrain_matrix)[0]*(O=(R=[d/C*x.EXTENT,y/C*x.EXTENT])[0])+k[4]*(z=R[1])+k[12],ke[1]=k[1]*O+k[5]*z+k[13],ke),Y=[Z[0]*V.tile.dem.dim,Z[1]*V.tile.dem.dim],X=[Math.floor(Y[0]),Math.floor(Y[1])],le=V.tile.dem.get(X[0],X[1]),ae=V.tile.dem.get(X[0],X[1]+1),De=V.tile.dem.get(X[0]+1,X[1]),ze=V.tile.dem.get(X[0]+1,X[1]+1);N=x.interpolate.number(x.interpolate.number(le,ae,Y[0]-X[0]),x.interpolate.number(De,ze,Y[0]-X[0]),Y[1]-X[1])}var ke,R,k,O,z;return N}getElevation(n,d,y,C=x.EXTENT){return this.getDEMElevation(n,d,y,C)*this.exaggeration}getTerrainData(n){if(!this._emptyDemTexture){const C=this.painter.context,N=new x.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Bt(C,N,C.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Bt(C,new x.RGBAImage({width:1,height:1}),C.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=x.identity([])}const d=this.sourceCache.getSourceTile(n,!0);if(d&&d.dem&&(!d.demTexture||d.needsTerrainPrepare)){const C=this.painter.context;d.demTexture=this.painter.getTileTexture(d.dem.stride),d.demTexture?d.demTexture.update(d.dem.getPixels(),{premultiply:!1}):d.demTexture=new Bt(C,d.dem.getPixels(),C.gl.RGBA,{premultiply:!1}),d.demTexture.bind(C.gl.NEAREST,C.gl.CLAMP_TO_EDGE),d.needsTerrainPrepare=!1}const y=d&&d+d.tileID.key+n.key;if(y&&!this._demMatrixCache[y]){const C=this.sourceCache.sourceCache._source.maxzoom;let N=n.canonical.z-d.tileID.canonical.z;n.overscaledZ>n.canonical.z&&(n.canonical.z>=C?N=n.canonical.z-C:x.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const V=n.canonical.x-(n.canonical.x>>N<<N),Z=n.canonical.y-(n.canonical.y>>N<<N),Y=x.fromScaling(new Float64Array(16),[1/(x.EXTENT<<N),1/(x.EXTENT<<N),0]);x.translate(Y,Y,[V*x.EXTENT,Z*x.EXTENT,0]),this._demMatrixCache[n.key]={matrix:Y,coord:n}}return{u_depth:2,u_terrain:3,u_terrain_dim:d&&d.dem&&d.dem.dim||1,u_terrain_matrix:y?this._demMatrixCache[n.key].matrix:this._emptyDemMatrix,u_terrain_unpack:d&&d.dem&&d.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(d&&d.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:d}}getFramebuffer(n){const d=this.painter,y=d.width/devicePixelRatio,C=d.height/devicePixelRatio;return!this._fbo||this._fbo.width===y&&this._fbo.height===C||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Bt(d.context,{width:y,height:C,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Bt(d.context,{width:y,height:C,data:null},d.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(d.context.gl.NEAREST,d.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=d.context.createFramebuffer(y,C,!0,!1),this._fbo.depthAttachment.set(d.context.createRenderbuffer(d.context.gl.DEPTH_COMPONENT16,y,C))),this._fbo.colorAttachment.set("coords"===n?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const n=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const d=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let N=0,V=0;N<this._coordsTextureSize;N++)for(let Z=0;Z<this._coordsTextureSize;Z++,V+=4)d[V+0]=255&Z,d[V+1]=255&N,d[V+2]=Z>>8<<4|N>>8,d[V+3]=0;const y=new x.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(d.buffer)),C=new Bt(n,y,n.gl.RGBA,{premultiply:!1});return C.bind(n.gl.NEAREST,n.gl.CLAMP_TO_EDGE),this._coordsTexture=C,C}pointCoordinate(n){const d=new Uint8Array(4),y=this.painter.context,C=y.gl;y.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),C.readPixels(n.x,this.painter.height/devicePixelRatio-n.y-1,1,1,C.RGBA,C.UNSIGNED_BYTE,d),y.bindFramebuffer.set(null);const N=d[0]+(d[2]>>4<<8),V=d[1]+((15&d[2])<<8),Z=this.coordsIndex[255-d[3]],Y=Z&&this.sourceCache.getTileByID(Z);if(!Y)return null;const X=this._coordsTextureSize,le=(1<<Y.tileID.canonical.z)*X;return new x.MercatorCoordinate((Y.tileID.canonical.x*X+N)/le,(Y.tileID.canonical.y*X+V)/le,this.getElevation(Y.tileID,N,V,X))}getTerrainMesh(){if(this._mesh)return this._mesh;const n=this.painter.context,d=new x.Pos3dArray,y=new x.TriangleIndexArray,C=this.meshSize,N=x.EXTENT/C,V=C*C;for(let ae=0;ae<=C;ae++)for(let De=0;De<=C;De++)d.emplaceBack(De*N,ae*N,0);for(let ae=0;ae<V;ae+=C+1)for(let De=0;De<C;De++)y.emplaceBack(De+ae,C+De+ae+1,C+De+ae+2),y.emplaceBack(De+ae,C+De+ae+2,De+ae+1);const Z=d.length,Y=Z+2*(C+1);for(const ae of[0,1])for(let De=0;De<=C;De++)for(const ze of[0,1])d.emplaceBack(De*N,ae*x.EXTENT,ze);for(let ae=0;ae<2*C;ae+=2)y.emplaceBack(Y+ae,Y+ae+1,Y+ae+3),y.emplaceBack(Y+ae,Y+ae+3,Y+ae+2),y.emplaceBack(Z+ae,Z+ae+3,Z+ae+1),y.emplaceBack(Z+ae,Z+ae+2,Z+ae+3);const X=d.length,le=X+2*(C+1);for(const ae of[0,1])for(let De=0;De<=C;De++)for(const ze of[0,1])d.emplaceBack(ae*x.EXTENT,De*N,ze);for(let ae=0;ae<2*C;ae+=2)y.emplaceBack(X+ae,X+ae+1,X+ae+3),y.emplaceBack(X+ae,X+ae+3,X+ae+2),y.emplaceBack(le+ae,le+ae+3,le+ae+1),y.emplaceBack(le+ae,le+ae+2,le+ae+3);return this._mesh={indexBuffer:n.createIndexBuffer(y),vertexBuffer:n.createVertexBuffer(d,Fr.members),segments:x.SegmentVector.simpleSegment(0,0,d.length,y.length)},this._mesh}getMeshFrameDelta(n){return 2*Math.PI*x.earthRadius/Math.pow(2,n)/5}getMinMaxElevation(n){const d=this.getTerrainData(n).tile,y={minElevation:null,maxElevation:null};return d&&d.dem&&(y.minElevation=d.dem.min*this.exaggeration,y.maxElevation=d.dem.max*this.exaggeration),y}}class Kl{constructor(n,d,y){this._context=n,this._size=d,this._tileSize=y,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const n of this._objects)n.texture.destroy(),n.fbo.destroy()}_createObject(n){const d=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),y=new Bt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return y.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),d.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),d.colorAttachment.set(y.texture),{id:n,fbo:d,texture:y,stamp:-1,inUse:!1}}getObjectForId(n){return this._objects[n]}useObject(n){n.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(d=>n.id!==d),this._recentlyUsed.push(n.id)}stampObject(n){n.stamp=++this._stamp}getOrCreateFreeObject(){for(const d of this._recentlyUsed)if(!this._objects[d].inUse)return this._objects[d];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const n=this._createObject(this._objects.length);return this._objects.push(n),n}freeObject(n){n.inUse=!1}freeAllObjects(){for(const n of this._objects)this.freeObject(n)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(n=>!n.inUse)}}const Yo={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Ar{constructor(n,d){this.painter=n,this.terrain=d,this.pool=new Kl(n.context,30,d.sourceCache.tileSize*d.qualityFactor)}destruct(){this.pool.destruct()}getTexture(n){return this.pool.getObjectForId(n.rtt[this._stacks.length-1].id).texture}prepareForRender(n,d){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=n._order.filter(y=>!n._layers[y].isHidden(d)),this._coordsDescendingInv={};for(const y in n.sourceCaches){this._coordsDescendingInv[y]={};const C=n.sourceCaches[y].getVisibleCoordinates();for(const N of C){const V=this.terrain.sourceCache.getTerrainCoords(N);for(const Z in V)this._coordsDescendingInv[y][Z]||(this._coordsDescendingInv[y][Z]=[]),this._coordsDescendingInv[y][Z].push(V[Z])}}this._coordsDescendingInvStr={};for(const y of n._order){const C=n._layers[y],N=C.source;if(Yo[C.type]&&!this._coordsDescendingInvStr[N]){this._coordsDescendingInvStr[N]={};for(const V in this._coordsDescendingInv[N])this._coordsDescendingInvStr[N][V]=this._coordsDescendingInv[N][V].map(Z=>Z.key).sort().join()}}for(const y of this._renderableTiles)for(const C in this._coordsDescendingInvStr){const N=this._coordsDescendingInvStr[C][y.tileID.key];N&&N!==y.rttCoords[C]&&(y.rtt=[])}}renderLayer(n){if(n.isHidden(this.painter.transform.zoom))return!1;const d=n.type,y=this.painter,C=this._renderableLayerIds[this._renderableLayerIds.length-1]===n.id;if(Yo[d]&&(this._prevType&&Yo[this._prevType]||this._stacks.push([]),this._prevType=d,this._stacks[this._stacks.length-1].push(n.id),!C))return!0;if(Yo[this._prevType]||Yo[d]&&C){this._prevType=d;const N=this._stacks.length-1,V=this._stacks[N]||[];for(const Z of this._renderableTiles){if(this.pool.isFull()&&(Qr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(Z),Z.rtt[N]){const X=this.pool.getObjectForId(Z.rtt[N].id);if(X.stamp===Z.rtt[N].stamp){this.pool.useObject(X);continue}}const Y=this.pool.getOrCreateFreeObject();this.pool.useObject(Y),this.pool.stampObject(Y),Z.rtt[N]={id:Y.id,stamp:Y.stamp},y.context.bindFramebuffer.set(Y.fbo.framebuffer),y.context.clear({color:x.Color.transparent,stencil:0}),y.currentStencilSource=void 0;for(let X=0;X<V.length;X++){const le=y.style._layers[V[X]],ae=le.source?this._coordsDescendingInv[le.source][Z.tileID.key]:[Z.tileID];y.context.viewport.set([0,0,Y.fbo.width,Y.fbo.height]),y._renderTileClippingMasks(le,ae),y.renderLayer(y,y.style.sourceCaches[le.source],le,ae),le.source&&(Z.rttCoords[le.source]=this._coordsDescendingInvStr[le.source][Z.tileID.key])}}return Qr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Yo[d]}return!1}}const vs={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:x.config.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0},Ol=w=>{w.touchstart=w.dragStart,w.touchmoveWindow=w.dragMove,w.touchend=w.dragEnd},jc={showCompass:!0,showZoom:!0,visualizePitch:!1};class Hc{constructor(n,d,y=!1){this._clickTolerance=10;const C=n.dragRotate._mouseRotate.getClickTolerance(),N=n.dragRotate._mousePitch.getClickTolerance();this.element=d,this.mouseRotate=Ee({clickTolerance:C,enable:!0}),this.touchRotate=(({enable:V,clickTolerance:Z,bearingDegreesPerPixelMoved:Y=.8})=>{const X=new de;return new La({clickTolerance:Z,move:(le,ae)=>({bearingDelta:(ae.x-le.x)*Y}),moveStateManager:X,enable:V,assignEvents:Ol})})({clickTolerance:C,enable:!0}),this.map=n,y&&(this.mousePitch=He({clickTolerance:N,enable:!0}),this.touchPitch=(({enable:V,clickTolerance:Z,pitchDegreesPerPixelMoved:Y=-.5})=>{const X=new de;return new La({clickTolerance:Z,move:(le,ae)=>({pitchDelta:(ae.y-le.y)*Y}),moveStateManager:X,enable:V,assignEvents:Ol})})({clickTolerance:N,enable:!0})),x.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),Pe.addEventListener(d,"mousedown",this.mousedown),Pe.addEventListener(d,"touchstart",this.touchstart,{passive:!1}),Pe.addEventListener(d,"touchcancel",this.reset)}startMouse(n,d){this.mouseRotate.dragStart(n,d),this.mousePitch&&this.mousePitch.dragStart(n,d),Pe.disableDrag()}startTouch(n,d){this.touchRotate.dragStart(n,d),this.touchPitch&&this.touchPitch.dragStart(n,d),Pe.disableDrag()}moveMouse(n,d){const y=this.map,{bearingDelta:C}=this.mouseRotate.dragMove(n,d)||{};if(C&&y.setBearing(y.getBearing()+C),this.mousePitch){const{pitchDelta:N}=this.mousePitch.dragMove(n,d)||{};N&&y.setPitch(y.getPitch()+N)}}moveTouch(n,d){const y=this.map,{bearingDelta:C}=this.touchRotate.dragMove(n,d)||{};if(C&&y.setBearing(y.getBearing()+C),this.touchPitch){const{pitchDelta:N}=this.touchPitch.dragMove(n,d)||{};N&&y.setPitch(y.getPitch()+N)}}off(){const n=this.element;Pe.removeEventListener(n,"mousedown",this.mousedown),Pe.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),Pe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Pe.removeEventListener(window,"touchend",this.touchend),Pe.removeEventListener(n,"touchcancel",this.reset),this.offTemp()}offTemp(){Pe.enableDrag(),Pe.removeEventListener(window,"mousemove",this.mousemove),Pe.removeEventListener(window,"mouseup",this.mouseup),Pe.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Pe.removeEventListener(window,"touchend",this.touchend)}mousedown(n){this.startMouse(x.extend({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),Pe.mousePos(this.element,n)),Pe.addEventListener(window,"mousemove",this.mousemove),Pe.addEventListener(window,"mouseup",this.mouseup)}mousemove(n){this.moveMouse(n,Pe.mousePos(this.element,n))}mouseup(n){this.mouseRotate.dragEnd(n),this.mousePitch&&this.mousePitch.dragEnd(n),this.offTemp()}touchstart(n){1!==n.targetTouches.length?this.reset():(this._startPos=this._lastPos=Pe.touchPos(this.element,n.targetTouches)[0],this.startTouch(n,this._startPos),Pe.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),Pe.addEventListener(window,"touchend",this.touchend))}touchmove(n){1!==n.targetTouches.length?this.reset():(this._lastPos=Pe.touchPos(this.element,n.targetTouches)[0],this.moveTouch(n,this._lastPos))}touchend(n){0===n.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}let Eo;function Ys(w,n,d){if(w=new x.LngLat(w.lng,w.lat),n){const y=new x.LngLat(w.lng-360,w.lat),C=new x.LngLat(w.lng+360,w.lat),N=d.locationPoint(w).distSqr(n);d.locationPoint(y).distSqr(n)<N?w=y:d.locationPoint(C).distSqr(n)<N&&(w=C)}for(;Math.abs(w.lng-d.center.lng)>180;){const y=d.locationPoint(w);if(y.x>=0&&y.y>=0&&y.x<=d.width&&y.y<=d.height)break;w.lng>d.center.lng?w.lng-=360:w.lng+=360}return w}const za={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function os(w,n,d){const y=w.classList;for(const C in za)y.remove(`maplibregl-${d}-anchor-${C}`);y.add(`maplibregl-${d}-anchor-${n}`)}class bs extends x.Evented{constructor(n,d){if(super(),(n instanceof HTMLElement||d)&&(n=x.extend({element:n},d)),x.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&"auto"!==n.pitchAlignment?n.pitchAlignment:this._rotationAlignment,n&&n.element)this._element=n.element,this._offset=x.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=Pe.create("div"),this._element.setAttribute("aria-label","Map marker");const y=Pe.createNS("http://www.w3.org/2000/svg","svg"),C=41,N=27;y.setAttributeNS(null,"display","block"),y.setAttributeNS(null,"height",`${C}px`),y.setAttributeNS(null,"width",`${N}px`),y.setAttributeNS(null,"viewBox",`0 0 ${N} ${C}`);const V=Pe.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"stroke","none"),V.setAttributeNS(null,"stroke-width","1"),V.setAttributeNS(null,"fill","none"),V.setAttributeNS(null,"fill-rule","evenodd");const Z=Pe.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"fill-rule","nonzero");const Y=Pe.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Y.setAttributeNS(null,"fill","#000000");const X=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const z of X){const W=Pe.createNS("http://www.w3.org/2000/svg","ellipse");W.setAttributeNS(null,"opacity","0.04"),W.setAttributeNS(null,"cx","10.5"),W.setAttributeNS(null,"cy","5.80029008"),W.setAttributeNS(null,"rx",z.rx),W.setAttributeNS(null,"ry",z.ry),Y.appendChild(W)}const le=Pe.createNS("http://www.w3.org/2000/svg","g");le.setAttributeNS(null,"fill",this._color);const ae=Pe.createNS("http://www.w3.org/2000/svg","path");ae.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),le.appendChild(ae);const De=Pe.createNS("http://www.w3.org/2000/svg","g");De.setAttributeNS(null,"opacity","0.25"),De.setAttributeNS(null,"fill","#000000");const ze=Pe.createNS("http://www.w3.org/2000/svg","path");ze.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),De.appendChild(ze);const ke=Pe.createNS("http://www.w3.org/2000/svg","g");ke.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ke.setAttributeNS(null,"fill","#FFFFFF");const R=Pe.createNS("http://www.w3.org/2000/svg","g");R.setAttributeNS(null,"transform","translate(8.0, 8.0)");const k=Pe.createNS("http://www.w3.org/2000/svg","circle");k.setAttributeNS(null,"fill","#000000"),k.setAttributeNS(null,"opacity","0.25"),k.setAttributeNS(null,"cx","5.5"),k.setAttributeNS(null,"cy","5.5"),k.setAttributeNS(null,"r","5.4999962");const O=Pe.createNS("http://www.w3.org/2000/svg","circle");O.setAttributeNS(null,"fill","#FFFFFF"),O.setAttributeNS(null,"cx","5.5"),O.setAttributeNS(null,"cy","5.5"),O.setAttributeNS(null,"r","5.4999962"),R.appendChild(k),R.appendChild(O),Z.appendChild(Y),Z.appendChild(le),Z.appendChild(De),Z.appendChild(ke),Z.appendChild(R),y.appendChild(Z),y.setAttributeNS(null,"height",C*this._scale+"px"),y.setAttributeNS(null,"width",N*this._scale+"px"),this._element.appendChild(y),this._offset=x.Point.convert(n&&n.offset||[0,-14])}this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()}),os(this._element,this._anchor,"marker"),this._popup=null}addTo(n){return this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._update),n.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Pe.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=x.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const C=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[C,-1*(24.6+C)],"bottom-right":[-C,-1*(24.6+C)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(n){const d=n.code,y=n.charCode||n.keyCode;"Space"!==d&&"Enter"!==d&&32!==y&&13!==y||this.togglePopup()}_onMapClick(n){const d=n.originalEvent.target,y=this._element;this._popup&&(d===y||y.contains(d))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?n.remove():n.addTo(this._map),this):this}_update(n){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=Ys(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let d="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?d=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let y="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?y="rotateX(0deg)":"map"===this._pitchAlignment&&(y=`rotateX(${this._map.getPitch()}deg)`),n&&"moveend"!==n.type||(this._pos=this._pos.round()),Pe.setTransform(this._element,`${za[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${y} ${d}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const C=this._map.unproject(this._pos),N=40075016.686*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=C.distanceTo(this._lngLat)>20*N?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(n){return this._offset=x.Point.convert(n),this._update(),this}_onMove(n){if(!this._isDragging){const d=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=d}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new x.Event("dragstart"))),this.fire(new x.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new x.Event("dragend")),this._state="inactive"}_addDragHandler(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._offset),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&"auto"!==n?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const hu={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Pl=0,Bs=!1;const $c={maxWidth:100,unit:"metric"};function ml(w,n,d){const y=d&&d.maxWidth||100,C=w._container.clientHeight/2,N=w.unproject([0,C]),V=w.unproject([y,C]),Z=N.distanceTo(V);if(d&&"imperial"===d.unit){const Y=3.2808*Z;Y>5280?Ka(n,y,Y/5280,w._getUIString("ScaleControl.Miles")):Ka(n,y,Y,w._getUIString("ScaleControl.Feet"))}else d&&"nautical"===d.unit?Ka(n,y,Z/1852,w._getUIString("ScaleControl.NauticalMiles")):Z>=1e3?Ka(n,y,Z/1e3,w._getUIString("ScaleControl.Kilometers")):Ka(n,y,Z,w._getUIString("ScaleControl.Meters"))}function Ka(w,n,d,y){const C=function(N){const V=Math.pow(10,`${Math.floor(N)}`.length-1);let Z=N/V;return Z=Z>=10?10:Z>=5?5:Z>=3?3:Z>=2?2:Z>=1?1:function(Y){const X=Math.pow(10,Math.ceil(-Math.log(Y)/Math.LN10));return Math.round(Y*X)/X}(Z),V*Z}(d);w.style.width=n*(C/d)+"px",w.innerHTML=`${C}&nbsp;${y}`}const _a={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Va=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function fu(w){if(w){if("number"==typeof w){const n=Math.round(Math.sqrt(.5*Math.pow(w,2)));return{center:new x.Point(0,0),top:new x.Point(0,w),"top-left":new x.Point(n,n),"top-right":new x.Point(-n,n),bottom:new x.Point(0,-w),"bottom-left":new x.Point(n,-n),"bottom-right":new x.Point(-n,-n),left:new x.Point(w,0),right:new x.Point(-w,0)}}if(w instanceof x.Point||Array.isArray(w)){const n=x.Point.convert(w);return{center:n,top:n,"top-left":n,"top-right":n,bottom:n,"bottom-left":n,"bottom-right":n,left:n,right:n}}return{center:x.Point.convert(w.center||[0,0]),top:x.Point.convert(w.top||[0,0]),"top-left":x.Point.convert(w["top-left"]||[0,0]),"top-right":x.Point.convert(w["top-right"]||[0,0]),bottom:x.Point.convert(w.bottom||[0,0]),"bottom-left":x.Point.convert(w["bottom-left"]||[0,0]),"bottom-right":x.Point.convert(w["bottom-right"]||[0,0]),left:x.Point.convert(w.left||[0,0]),right:x.Point.convert(w.right||[0,0])}}return fu(new x.Point(0,0))}const Xl={setRTLTextPlugin:x.setRTLTextPlugin,getRTLTextPluginStatus:x.getRTLTextPluginStatus,Map:class extends li{constructor(w){var n;if(x.PerformanceUtils.mark(x.PerformanceMarkers.create),null!=(w=x.extend({},vs,w)).minZoom&&null!=w.maxZoom&&w.minZoom>w.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=w.minPitch&&null!=w.maxPitch&&w.minPitch>w.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=w.minPitch&&w.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=w.maxPitch&&w.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new ka(w.minZoom,w.maxZoom,w.minPitch,w.maxPitch,w.renderWorldCopies),{bearingSnap:w.bearingSnap}),this._interactive=w.interactive,this._cooperativeGestures=w.cooperativeGestures,this._metaKey=0===navigator.platform.indexOf("Mac")?"metaKey":"ctrlKey",this._maxTileCacheSize=w.maxTileCacheSize,this._maxTileCacheZoomLevels=w.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=w.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=w.preserveDrawingBuffer,this._antialias=w.antialias,this._trackResize=w.trackResize,this._bearingSnap=w.bearingSnap,this._refreshExpiredTiles=w.refreshExpiredTiles,this._fadeDuration=w.fadeDuration,this._crossSourceCollisions=w.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=w.collectResourceTiming,this._renderTaskQueue=new dn,this._controls=[],this._mapId=x.uniqueId(),this._locale=x.extend({},qi,w.locale),this._clickTolerance=w.clickTolerance,this._pixelRatio=null!==(n=w.pixelRatio)&&void 0!==n?n:devicePixelRatio,this.transformCameraUpdate=w.transformCameraUpdate,this._imageQueueHandle=nn.addThrottleControl(()=>this.isMoving()),this._requestManager=new Tn(w.transformRequest),"string"==typeof w.container){if(this._container=document.getElementById(w.container),!this._container)throw new Error(`Container '${w.container}' not found.`)}else{if(!(w.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=w.container}if(w.maxBounds&&this.setMaxBounds(w.maxBounds),x.bindAll(["_onWindowOnline","_onMapScroll","_cooperativeGesturesOnWheel","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let d=!1;this._resizeObserver=new ResizeObserver(y=>{d?this._trackResize&&this.resize(y)._update():d=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Ba(this,w),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=w.hash&&new cu("string"==typeof w.hash&&w.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:w.center,zoom:w.zoom,bearing:w.bearing,pitch:w.pitch}),w.bounds&&(this.resize(),this.fitBounds(w.bounds,x.extend({},w.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=w.localIdeographFontFamily,this._validateStyle=w.validateStyle,w.style&&this.setStyle(w.style,{localIdeographFontFamily:w.localIdeographFontFamily}),w.attributionControl&&this.addControl(new pi({customAttribution:w.customAttribution})),w.maplibreLogo&&this.addControl(new yc,w.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",d=>{this._update("style"===d.dataType),this.fire(new x.Event(`${d.dataType}data`,d))}),this.on("dataloading",d=>{this.fire(new x.Event(`${d.dataType}dataloading`,d))}),this.on("dataabort",d=>{this.fire(new x.Event("sourcedataabort",d))})}_getMapId(){return this._mapId}addControl(w,n){if(void 0===n&&(n=w.getDefaultPosition?w.getDefaultPosition():"top-right"),!w||!w.onAdd)return this.fire(new x.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const d=w.onAdd(this);this._controls.push(w);const y=this._controlPositions[n];return-1!==n.indexOf("bottom")?y.insertBefore(d,y.firstChild):y.appendChild(d),this}removeControl(w){if(!w||!w.onRemove)return this.fire(new x.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(w);return n>-1&&this._controls.splice(n,1),w.onRemove(this),this}hasControl(w){return this._controls.indexOf(w)>-1}calculateCameraOptionsFromTo(w,n,d,y){return null==y&&this.terrain&&(y=this.transform.getElevation(d,this.terrain)),super.calculateCameraOptionsFromTo(w,n,d,y)}resize(w){var n;const d=this._containerDimensions(),y=d[0],C=d[1];this._resizeCanvas(y,C,this.getPixelRatio()),this.transform.resize(y,C),null===(n=this._requestedCameraState)||void 0===n||n.resize(y,C),this.painter.resize(y,C,this.getPixelRatio());const N=!this._moving;return N&&(this.stop(),this.fire(new x.Event("movestart",w)).fire(new x.Event("move",w))),this.fire(new x.Event("resize",w)),N&&this.fire(new x.Event("moveend",w)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(w){const[n,d]=this._containerDimensions();this._pixelRatio=w,this._resizeCanvas(n,d,w),this.painter.resize(n,d,w)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(w){return this.transform.setMaxBounds(Pt.convert(w)),this._update()}setMinZoom(w){if((w=w??-2)>=-2&&w<=this.transform.maxZoom)return this.transform.minZoom=w,this._update(),this.getZoom()<w&&this.setZoom(w),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(w){if((w=w??22)>=this.transform.minZoom)return this.transform.maxZoom=w,this._update(),this.getZoom()>w&&this.setZoom(w),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(w){if((w=w??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(w>=0&&w<=this.transform.maxPitch)return this.transform.minPitch=w,this._update(),this.getPitch()<w&&this.setPitch(w),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(w){if((w=w??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(w>=this.transform.minPitch)return this.transform.maxPitch=w,this._update(),this.getPitch()>w&&this.setPitch(w),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(w){return this.transform.renderWorldCopies=w,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(w){return this._cooperativeGestures=w,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(w){return this.transform.locationPoint(x.LngLat.convert(w),this.style&&this.terrain)}unproject(w){return this.transform.pointLocation(x.Point.convert(w),this.terrain)}isMoving(){var w;return this._moving||(null===(w=this.handlers)||void 0===w?void 0:w.isMoving())}isZooming(){var w;return this._zooming||(null===(w=this.handlers)||void 0===w?void 0:w.isZooming())}isRotating(){var w;return this._rotating||(null===(w=this.handlers)||void 0===w?void 0:w.isRotating())}_createDelegatedListener(w,n,d){if("mouseenter"===w||"mouseover"===w){let y=!1;return{layer:n,listener:d,delegates:{mousemove:N=>{const V=this.getLayer(n)?this.queryRenderedFeatures(N.point,{layers:[n]}):[];V.length?y||(y=!0,d.call(this,new po(w,this,N.originalEvent,{features:V}))):y=!1},mouseout:()=>{y=!1}}}}if("mouseleave"===w||"mouseout"===w){let y=!1;return{layer:n,listener:d,delegates:{mousemove:V=>{(this.getLayer(n)?this.queryRenderedFeatures(V.point,{layers:[n]}):[]).length?y=!0:y&&(y=!1,d.call(this,new po(w,this,V.originalEvent)))},mouseout:V=>{y&&(y=!1,d.call(this,new po(w,this,V.originalEvent)))}}}}{const y=C=>{const N=this.getLayer(n)?this.queryRenderedFeatures(C.point,{layers:[n]}):[];N.length&&(C.features=N,d.call(this,C),delete C.features)};return{layer:n,listener:d,delegates:{[w]:y}}}}on(w,n,d){if(void 0===d)return super.on(w,n);const y=this._createDelegatedListener(w,n,d);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[w]=this._delegatedListeners[w]||[],this._delegatedListeners[w].push(y);for(const C in y.delegates)this.on(C,y.delegates[C]);return this}once(w,n,d){if(void 0===d)return super.once(w,n);const y=this._createDelegatedListener(w,n,d);for(const C in y.delegates)this.once(C,y.delegates[C]);return this}off(w,n,d){return void 0===d?super.off(w,n):(this._delegatedListeners&&this._delegatedListeners[w]&&(y=>{const C=this._delegatedListeners[w];for(let N=0;N<C.length;N++){const V=C[N];if(V.layer===n&&V.listener===d){for(const Z in V.delegates)this.off(Z,V.delegates[Z]);return C.splice(N,1),this}}})(),this)}queryRenderedFeatures(w,n){if(!this.style)return[];let d;const y=w instanceof x.Point||Array.isArray(w),C=y?w:[[0,0],[this.transform.width,this.transform.height]];if(n=n||(y?{}:w)||{},C instanceof x.Point||"number"==typeof C[0])d=[x.Point.convert(C)];else{const N=x.Point.convert(C[0]),V=x.Point.convert(C[1]);d=[N,new x.Point(V.x,N.y),V,new x.Point(N.x,V.y),N]}return this.style.queryRenderedFeatures(d,n,this.transform)}querySourceFeatures(w,n){return this.style.querySourceFeatures(w,n)}setStyle(w,n){return!1!==(n=x.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&w?(this._diffStyle(w,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._updateStyle(w,n))}setTransformRequest(w){return this._requestManager.setTransformRequest(w),this}_getUIString(w){const n=this._locale[w];if(null==n)throw new Error(`Missing UI string '${w}'`);return n}_updateStyle(w,n){if(n.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(w,n));const d=this.style&&n.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!w)),w?(this.style=new Vi(this,n||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof w?this.style.loadURL(w,n,d):this.style.loadJSON(w,n,d),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Vi(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(w,n){if("string"==typeof w){const d=this._requestManager.transformRequest(w,dt.Style);x.getJSON(d,(y,C)=>{y?this.fire(new x.ErrorEvent(y)):C&&this._updateDiff(C,n)})}else"object"==typeof w&&this._updateDiff(w,n)}_updateDiff(w,n){try{this.style.setState(w,n)&&this._update(!0)}catch(d){x.warnOnce(`Unable to perform style diff: ${d.message||d.error||d}.  Rebuilding the style from scratch.`),this._updateStyle(w,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():x.warnOnce("There is no style added to the map.")}addSource(w,n){return this._lazyInitEmptyStyle(),this.style.addSource(w,n),this._update(!0)}isSourceLoaded(w){const n=this.style&&this.style.sourceCaches[w];if(void 0!==n)return n.loaded();this.fire(new x.ErrorEvent(new Error(`There is no source with ID '${w}'`)))}setTerrain(w){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),w){const n=this.style.sourceCaches[w.source];if(!n)throw new Error(`cannot load terrain, because there exists no source with ID: ${w.source}`);for(const d in this.style._layers){const y=this.style._layers[d];"hillshade"===y.type&&y.source===w.source&&x.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new qr(this.painter,n,w),this.painter.renderToTexture=new Ar(this.painter,this.terrain),this.transform.updateElevation(this.terrain),this._terrainDataCallback=d=>{"style"===d.dataType?this.terrain.sourceCache.freeRtt():"source"===d.dataType&&d.tile&&(d.sourceId===w.source&&this.transform.updateElevation(this.terrain),this.terrain.sourceCache.freeRtt(d.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.updateElevation(this.terrain);return this.fire(new x.Event("terrain",{terrain:w})),this}getTerrain(){return this.terrain&&this.terrain.options}areTilesLoaded(){const w=this.style&&this.style.sourceCaches;for(const n in w){const d=w[n]._tiles;for(const y in d){const C=d[y];if("loaded"!==C.state&&"errored"!==C.state)return!1}}return!0}addSourceType(w,n,d){return this._lazyInitEmptyStyle(),this.style.addSourceType(w,n,d)}removeSource(w){return this.style.removeSource(w),this._update(!0)}getSource(w){return this.style.getSource(w)}addImage(w,n,{pixelRatio:d=1,sdf:y=!1,stretchX:C,stretchY:N,content:V}={}){if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||x.isImageBitmap(n)){const{width:Z,height:Y,data:X}=x.exported.getImageData(n);this.style.addImage(w,{data:new x.RGBAImage({width:Z,height:Y},X),pixelRatio:d,stretchX:C,stretchY:N,content:V,sdf:y,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new x.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Z,height:Y,data:X}=n,le=n;this.style.addImage(w,{data:new x.RGBAImage({width:Z,height:Y},new Uint8Array(X)),pixelRatio:d,stretchX:C,stretchY:N,content:V,sdf:y,version:0,userImage:le}),le.onAdd&&le.onAdd(this,w)}}}updateImage(w,n){const d=this.style.getImage(w);if(!d)return this.fire(new x.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=n instanceof HTMLImageElement||x.isImageBitmap(n)?x.exported.getImageData(n):n,{width:C,height:N,data:V}=y;if(void 0===C||void 0===N)return this.fire(new x.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(C!==d.data.width||N!==d.data.height)return this.fire(new x.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const Z=!(n instanceof HTMLImageElement||x.isImageBitmap(n));d.data.replace(V,Z),this.style.updateImage(w,d)}getImage(w){return this.style.getImage(w)}hasImage(w){return w?!!this.style.getImage(w):(this.fire(new x.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(w){this.style.removeImage(w)}loadImage(w,n){nn.getImage(this._requestManager.transformRequest(w,dt.Image),n)}listImages(){return this.style.listImages()}addLayer(w,n){return this._lazyInitEmptyStyle(),this.style.addLayer(w,n),this._update(!0)}moveLayer(w,n){return this.style.moveLayer(w,n),this._update(!0)}removeLayer(w){return this.style.removeLayer(w),this._update(!0)}getLayer(w){return this.style.getLayer(w)}setLayerZoomRange(w,n,d){return this.style.setLayerZoomRange(w,n,d),this._update(!0)}setFilter(w,n,d={}){return this.style.setFilter(w,n,d),this._update(!0)}getFilter(w){return this.style.getFilter(w)}setPaintProperty(w,n,d,y={}){return this.style.setPaintProperty(w,n,d,y),this._update(!0)}getPaintProperty(w,n){return this.style.getPaintProperty(w,n)}setLayoutProperty(w,n,d,y={}){return this.style.setLayoutProperty(w,n,d,y),this._update(!0)}getLayoutProperty(w,n){return this.style.getLayoutProperty(w,n)}setGlyphs(w,n={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(w,n),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(w,n,d={}){return this._lazyInitEmptyStyle(),this.style.addSprite(w,n,d,y=>{y||this._update(!0)}),this}removeSprite(w){return this._lazyInitEmptyStyle(),this.style.removeSprite(w),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(w,n={}){return this._lazyInitEmptyStyle(),this.style.setSprite(w,n,d=>{d||this._update(!0)}),this}setLight(w,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(w,n),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(w,n){return this.style.setFeatureState(w,n),this._update()}removeFeatureState(w,n){return this.style.removeFeatureState(w,n),this._update()}getFeatureState(w){return this.style.getFeatureState(w)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let w=0,n=0;return this._container&&(w=this._container.clientWidth||400,n=this._container.clientHeight||300),[w,n]}_setupContainer(){const w=this._container;w.classList.add("maplibregl-map");const n=this._canvasContainer=Pe.create("div","maplibregl-canvas-container",w);this._interactive&&n.classList.add("maplibregl-interactive"),this._canvas=Pe.create("canvas","maplibregl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const d=this._containerDimensions();this._resizeCanvas(d[0],d[1],this.getPixelRatio());const y=this._controlContainer=Pe.create("div","maplibregl-control-container",w),C=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(N=>{C[N]=Pe.create("div",`maplibregl-ctrl-${N} `,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_cooperativeGesturesOnWheel(w){this._onCooperativeGesture(w,w[this._metaKey],1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=Pe.create("div","maplibregl-cooperative-gesture-screen",this._container);let w="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";0===navigator.platform.indexOf("Mac")&&(w="boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`\n            <div class="maplibregl-desktop-message">${w}</div>\n            <div class="maplibregl-mobile-message">${"boolean"!=typeof this._cooperativeGestures&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>\n        `,this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){Pe.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(w,n,d){this._canvas.width=d*w,this._canvas.height=d*n,this._canvas.style.width=`${w}px`,this._canvas.style.height=`${n}px`}_setupPainter(){const w={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let n=null;this._canvas.addEventListener("webglcontextcreationerror",y=>{n={requestedAttributes:w},y&&(n.statusMessage=y.statusMessage,n.type=y.type)},{once:!0});const d=this._canvas.getContext("webgl2",w)||this._canvas.getContext("webgl",w);if(!d){const y="Failed to initialize WebGL";throw n?(n.message=y,new Error(JSON.stringify(n))):new Error(y)}this.painter=new Bc(d,this.transform),Ze.testSupport(d)}_contextLost(w){w.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new x.Event("webglcontextlost",{originalEvent:w}))}_contextRestored(w){this._setupPainter(),this.resize(),this._update(),this.fire(new x.Event("webglcontextrestored",{originalEvent:w}))}_onMapScroll(w){if(w.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(w,n,d){return!n&&d<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(w){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||w,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(w){return this._update(),this._renderTaskQueue.add(w)}_cancelRenderFrame(w){this._renderTaskQueue.remove(w)}_render(w){const n=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(w),this._removed)return;let d=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const C=this.transform.zoom,N=x.exported.now();this.style.zoomHistory.update(C,N);const V=new x.EvaluationParameters(C,{now:N,fadeDuration:n,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Z=V.crossFadingFactor();1===Z&&Z===this._crossFadingFactor||(d=!0,this._crossFadingFactor=Z),this.style.update(V)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.updateElevation(this.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,n,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:n,showPadding:this.showPadding}),this.fire(new x.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,x.PerformanceUtils.mark(x.PerformanceMarkers.load),this.fire(new x.Event("load"))),this.style&&(this.style.hasTransitions()||d)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const y=this._sourcesDirty||this._styleDirty||this._placementDirty;return y||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new x.Event("idle")),!this._loaded||this._fullyLoaded||y||(this._fullyLoaded=!0,x.PerformanceUtils.mark(x.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var w;this._hash&&this._hash.remove();for(const d of this._controls)d.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),nn.removeThrottleControl(this._imageQueueHandle),null===(w=this._resizeObserver)||void 0===w||w.disconnect();const n=this.painter.context.gl.getExtension("WEBGL_lose_context");n&&n.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),Pe.remove(this._canvasContainer),Pe.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),x.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new x.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=x.exported.frame(w=>{x.PerformanceUtils.frame(w),this._frame=null,this._render(w)}))}_onWindowOnline(){this._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(w){this._showTileBoundaries!==w&&(this._showTileBoundaries=w,this._update())}get showPadding(){return!!this._showPadding}set showPadding(w){this._showPadding!==w&&(this._showPadding=w,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(w){this._showCollisionBoxes!==w&&(this._showCollisionBoxes=w,w?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(w){this._showOverdrawInspector!==w&&(this._showOverdrawInspector=w,this._update())}get repaint(){return!!this._repaint}set repaint(w){this._repaint!==w&&(this._repaint=w,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(w){this._vertices=w,this._update()}get version(){return"3.1.0"}getCameraTargetElevation(){return this.transform.elevation}},NavigationControl:class{constructor(w){this.options=x.extend({},jc,w),this._container=Pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(x.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),Pe.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),Pe.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(x.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=Pe.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const w=this._map.getZoom(),n=w===this._map.getMaxZoom(),d=w===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=d,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",d.toString())}_rotateCompassArrow(){const w=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=w}onAdd(w){return this._map=w,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Hc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){Pe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(w,n){const d=Pe.create("button",w,this._container);return d.type="button",d.addEventListener("click",n),d}_setButtonTitle(w,n){const d=this._map._getUIString(`NavigationControl.${n}`);w.title=d,w.setAttribute("aria-label",d)}},GeolocateControl:class extends x.Evented{constructor(w){super(),this.options=x.extend({},hu,w),x.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(w){return this._map=w,this._container=Pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(n,d=!1){void 0===Eo||d?void 0!==window.navigator.permissions?window.navigator.permissions.query({name:"geolocation"}).then(y=>{Eo="denied"!==y.state,n(Eo)}).catch(()=>{Eo=!!window.navigator.geolocation,n(Eo)}):(Eo=!!window.navigator.geolocation,n(Eo)):n(Eo)}(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Pe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Pl=0,Bs=!1}_isOutOfMapMaxBounds(w){const n=this._map.getMaxBounds(),d=w.coords;return n&&(d.longitude<n.getWest()||d.longitude>n.getEast()||d.latitude<n.getSouth()||d.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(w){if(this._map){if(this._isOutOfMapMaxBounds(w))return this._setErrorState(),this.fire(new x.Event("outofmaxbounds",w)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=w,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(w),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(w),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new x.Event("geolocate",w)),this._finish()}}_updateCamera(w){const n=new x.LngLat(w.coords.longitude,w.coords.latitude),d=w.coords.accuracy,y=this._map.getBearing(),C=x.extend({bearing:y},this.options.fitBoundsOptions),N=Pt.fromLngLat(n,d);this._map.fitBounds(N,C,{geolocateSource:!0})}_updateMarker(w){if(w){const n=new x.LngLat(w.coords.longitude,w.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=w.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const w=this._map.getBounds(),n=w.getSouthEast(),d=w.getNorthEast(),y=n.distanceTo(d),C=Math.ceil(this._accuracy/(y/this._map._container.clientHeight)*2);this._circleElement.style.width=`${C}px`,this._circleElement.style.height=`${C}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(w){if(this._map){if(this.options.trackUserLocation)if(1===w.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===w.code&&Bs)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new x.Event("error",w)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(w){if(this._map){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=Pe.create("button","maplibregl-ctrl-geolocate",this._container),Pe.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===w){x.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=n,this._geolocateButton.setAttribute("aria-label",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Pe.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new bs(this._dotElement),this._circleElement=Pe.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new bs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||"ACTIVE_LOCK"!==this._watchState||n.originalEvent&&"resize"===n.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new x.Event("trackuserlocationend")))})}}trigger(){if(!this._setup)return x.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new x.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Pl--,Bs=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new x.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new x.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let w;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Pl++,Pl>1?(w={maximumAge:6e5,timeout:0},Bs=!0):(w=this.options.positionOptions,Bs=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,w)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:pi,LogoControl:yc,ScaleControl:class{constructor(w){this.options=x.extend({},$c,w),x.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){ml(this._map,this._container,this.options)}onAdd(w){return this._map=w,this._container=Pe.create("div","maplibregl-ctrl maplibregl-ctrl-scale",w.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){Pe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(w){this.options.unit=w,ml(this._map,this._container,this.options)}},FullscreenControl:class extends x.Evented{constructor(w={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,w&&w.container&&(w.container instanceof HTMLElement?this._container=w.container:x.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(w){return this._map=w,this._container||(this._container=this._map.getContainer()),this._controlContainer=Pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){Pe.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const w=this._fullscreenButton=Pe.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);Pe.create("span","maplibregl-ctrl-icon",w).setAttribute("aria-hidden","true"),w.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const w=this._getTitle();this._fullscreenButton.setAttribute("aria-label",w),this._fullscreenButton.title=w}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new x.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new x.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},TerrainControl:class{constructor(w){this.options=w,x.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(w){return this._map=w,this._container=Pe.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Pe.create("button","maplibregl-ctrl-terrain",this._container),Pe.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){Pe.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends x.Evented{constructor(w){super(),this.options=x.extend(Object.create(_a),w),x.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(w){return this._map&&this.remove(),this._map=w,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new x.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&Pe.remove(this._content),this._container&&(Pe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new x.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(w){return this._lngLat=x.LngLat.convert(w),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(w){return this.setDOMContent(document.createTextNode(w))}setHTML(w){const n=document.createDocumentFragment(),d=document.createElement("body");let y;for(d.innerHTML=w;y=d.firstChild,y;)n.appendChild(y);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(w){return this.options.maxWidth=w,this._update(),this}setDOMContent(w){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Pe.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(w),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(w){this._container&&this._container.classList.add(w)}removeClassName(w){this._container&&this._container.classList.remove(w)}setOffset(w){return this.options.offset=w,this._update(),this}toggleClassName(w){if(this._container)return this._container.classList.toggle(w)}_createCloseButton(){this.options.closeButton&&(this._closeButton=Pe.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(w){this._update(w.point)}_onMouseMove(w){this._update(w.point)}_onDrag(w){this._update(w.point)}_update(w){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=Pe.create("div","maplibregl-popup",this._map.getContainer()),this._tip=Pe.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(N=>this._container.classList.add(N)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ys(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!w))return;const n=this._pos=this._trackPointer&&w?w:this._map.project(this._lngLat);let d=this.options.anchor;const y=fu(this.options.offset);if(!d){const N=this._container.offsetWidth,V=this._container.offsetHeight;let Z;Z=n.y+y.bottom.y<V?["top"]:n.y>this._map.transform.height-V?["bottom"]:[],n.x<N/2?Z.push("left"):n.x>this._map.transform.width-N/2&&Z.push("right"),d=0===Z.length?"bottom":Z.join("-")}const C=n.add(y[d]).round();Pe.setTransform(this._container,`${za[d]} translate(${C.x}px,${C.y}px)`),os(this._container,d,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const w=this._container.querySelector(Va);w&&w.focus()}_onClose(){this.remove()}},Marker:bs,Style:Vi,LngLat:x.LngLat,LngLatBounds:Pt,Point:x.Point,MercatorCoordinate:x.MercatorCoordinate,Evented:x.Evented,AJAXError:x.AJAXError,config:x.config,CanvasSource:st,GeoJSONSource:mi,ImageSource:di,RasterDEMTileSource:oi,RasterTileSource:ln,VectorTileSource:hn,VideoSource:Si,prewarm:function(){Kn().acquire(jn)},clearPrewarmedResources:function(){const w=yn;w&&(w.isPreloaded()&&1===w.numActive()?(w.release(jn),yn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return"3.1.0"},get workerCount(){return at.workerCount},set workerCount(w){at.workerCount=w},get maxParallelImageRequests(){return x.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(w){x.config.MAX_PARALLEL_IMAGE_REQUESTS=w},get workerUrl(){return x.config.WORKER_URL},set workerUrl(w){x.config.WORKER_URL=w},addProtocol(w,n){x.config.REGISTERED_PROTOCOLS[w]=n},removeProtocol(w){delete x.config.REGISTERED_PROTOCOLS[w]}};return ys.extend(Xl,{isSafari:x.isSafari,getPerformanceMetrics:x.PerformanceUtils.getPerformanceMetrics}),Xl}),m}()},6814:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{Do:()=>Tn,EM:()=>Ia,HT:()=>x,JF:()=>uo,K0:()=>Pe,Mn:()=>Jt,Mx:()=>tr,O5:()=>es,Ov:()=>$r,PM:()=>Aa,S$:()=>Zt,Tn:()=>zt,UT:()=>Pn,V_:()=>yt,Ye:()=>Gn,ax:()=>Vi,b0:()=>nn,bD:()=>yr,ez:()=>ps,mk:()=>hi,p6:()=>Kn,q:()=>ge,sg:()=>Vi,tP:()=>Qs,w_:()=>tt,x:()=>lt});var m=_e(9468);let be=null;function ge(){return be}function x(G){be||(be=G)}class tt{}const Pe=new m.OlP("DocumentToken");let Ze=(()=>{class G{historyGo(K){throw new Error("Not implemented")}}return G.\u0275fac=function(K){return new(K||G)},G.\u0275prov=m.Yz7({token:G,factory:function(){return(0,m.f3M)(Ht)},providedIn:"platform"}),G})();const yt=new m.OlP("Location Initialized");let Ht=(()=>{class G extends Ze{constructor(){super(),this._doc=(0,m.f3M)(Pe),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return ge().getBaseHref(this._doc)}onPopState(K){const Ee=ge().getGlobalEventTarget(this._doc,"window");return Ee.addEventListener("popstate",K,!1),()=>Ee.removeEventListener("popstate",K)}onHashChange(K){const Ee=ge().getGlobalEventTarget(this._doc,"window");return Ee.addEventListener("hashchange",K,!1),()=>Ee.removeEventListener("hashchange",K)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(K){this._location.pathname=K}pushState(K,Ee,He){this._history.pushState(K,Ee,He)}replaceState(K,Ee,He){this._history.replaceState(K,Ee,He)}forward(){this._history.forward()}back(){this._history.back()}historyGo(K=0){this._history.go(K)}getState(){return this._history.state}}return G.\u0275fac=function(K){return new(K||G)},G.\u0275prov=m.Yz7({token:G,factory:function(){return new G},providedIn:"platform"}),G})();function $t(G,de){if(0==G.length)return de;if(0==de.length)return G;let K=0;return G.endsWith("/")&&K++,de.startsWith("/")&&K++,2==K?G+de.substring(1):1==K?G+de:G+"/"+de}function It(G){const de=G.match(/#|\?|$/),K=de&&de.index||G.length;return G.slice(0,K-("/"===G[K-1]?1:0))+G.slice(K)}function bt(G){return G&&"?"!==G[0]?"?"+G:G}let Zt=(()=>{class G{historyGo(K){throw new Error("Not implemented")}}return G.\u0275fac=function(K){return new(K||G)},G.\u0275prov=m.Yz7({token:G,factory:function(){return(0,m.f3M)(nn)},providedIn:"root"}),G})();const dt=new m.OlP("appBaseHref");let nn=(()=>{class G extends Zt{constructor(K,Ee){super(),this._platformLocation=K,this._removeListenerFns=[],this._baseHref=Ee??this._platformLocation.getBaseHrefFromDOM()??(0,m.f3M)(Pe).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(K){this._removeListenerFns.push(this._platformLocation.onPopState(K),this._platformLocation.onHashChange(K))}getBaseHref(){return this._baseHref}prepareExternalUrl(K){return $t(this._baseHref,K)}path(K=!1){const Ee=this._platformLocation.pathname+bt(this._platformLocation.search),He=this._platformLocation.hash;return He&&K?`${Ee}${He}`:Ee}pushState(K,Ee,He,St){const Kt=this.prepareExternalUrl(He+bt(St));this._platformLocation.pushState(K,Ee,Kt)}replaceState(K,Ee,He,St){const Kt=this.prepareExternalUrl(He+bt(St));this._platformLocation.replaceState(K,Ee,Kt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(K=0){this._platformLocation.historyGo?.(K)}}return G.\u0275fac=function(K){return new(K||G)(m.LFG(Ze),m.LFG(dt,8))},G.\u0275prov=m.Yz7({token:G,factory:G.\u0275fac,providedIn:"root"}),G})(),Tn=(()=>{class G extends Zt{constructor(K,Ee){super(),this._platformLocation=K,this._baseHref="",this._removeListenerFns=[],null!=Ee&&(this._baseHref=Ee)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(K){this._removeListenerFns.push(this._platformLocation.onPopState(K),this._platformLocation.onHashChange(K))}getBaseHref(){return this._baseHref}path(K=!1){let Ee=this._platformLocation.hash;return null==Ee&&(Ee="#"),Ee.length>0?Ee.substring(1):Ee}prepareExternalUrl(K){const Ee=$t(this._baseHref,K);return Ee.length>0?"#"+Ee:Ee}pushState(K,Ee,He,St){let Kt=this.prepareExternalUrl(He+bt(St));0==Kt.length&&(Kt=this._platformLocation.pathname),this._platformLocation.pushState(K,Ee,Kt)}replaceState(K,Ee,He,St){let Kt=this.prepareExternalUrl(He+bt(St));0==Kt.length&&(Kt=this._platformLocation.pathname),this._platformLocation.replaceState(K,Ee,Kt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(K=0){this._platformLocation.historyGo?.(K)}}return G.\u0275fac=function(K){return new(K||G)(m.LFG(Ze),m.LFG(dt,8))},G.\u0275prov=m.Yz7({token:G,factory:G.\u0275fac}),G})(),Gn=(()=>{class G{constructor(K){this._subject=new m.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=K;const Ee=this._locationStrategy.getBaseHref();this._basePath=function Tt(G){if(new RegExp("^(https?:)?//").test(G)){const[,K]=G.split(/\/\/[^\/]+/);return K}return G}(It(Vt(Ee))),this._locationStrategy.onPopState(He=>{this._subject.emit({url:this.path(!0),pop:!0,state:He.state,type:He.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(K=!1){return this.normalize(this._locationStrategy.path(K))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(K,Ee=""){return this.path()==this.normalize(K+bt(Ee))}normalize(K){return G.stripTrailingSlash(function vi(G,de){if(!G||!de.startsWith(G))return de;const K=de.substring(G.length);return""===K||["/",";","?","#"].includes(K[0])?K:de}(this._basePath,Vt(K)))}prepareExternalUrl(K){return K&&"/"!==K[0]&&(K="/"+K),this._locationStrategy.prepareExternalUrl(K)}go(K,Ee="",He=null){this._locationStrategy.pushState(He,"",K,Ee),this._notifyUrlChangeListeners(this.prepareExternalUrl(K+bt(Ee)),He)}replaceState(K,Ee="",He=null){this._locationStrategy.replaceState(He,"",K,Ee),this._notifyUrlChangeListeners(this.prepareExternalUrl(K+bt(Ee)),He)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(K=0){this._locationStrategy.historyGo?.(K)}onUrlChange(K){return this._urlChangeListeners.push(K),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(Ee=>{this._notifyUrlChangeListeners(Ee.url,Ee.state)})),()=>{const Ee=this._urlChangeListeners.indexOf(K);this._urlChangeListeners.splice(Ee,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(K="",Ee){this._urlChangeListeners.forEach(He=>He(K,Ee))}subscribe(K,Ee,He){return this._subject.subscribe({next:K,error:Ee,complete:He})}}return G.normalizeQueryParams=bt,G.joinWithSlash=$t,G.stripTrailingSlash=It,G.\u0275fac=function(K){return new(K||G)(m.LFG(Zt))},G.\u0275prov=m.Yz7({token:G,factory:function(){return function yi(){return new Gn((0,m.LFG)(Zt))}()},providedIn:"root"}),G})();function Vt(G){return G.replace(/\/index.html$/,"")}var lt=(()=>((lt=lt||{})[lt.Format=0]="Format",lt[lt.Standalone=1]="Standalone",lt))(),zt=(()=>((zt=zt||{})[zt.Narrow=0]="Narrow",zt[zt.Abbreviated=1]="Abbreviated",zt[zt.Wide=2]="Wide",zt[zt.Short=3]="Short",zt))(),nt=(()=>((nt=nt||{})[nt.Short=0]="Short",nt[nt.Medium=1]="Medium",nt[nt.Long=2]="Long",nt[nt.Full=3]="Full",nt))(),xt=(()=>((xt=xt||{})[xt.Decimal=0]="Decimal",xt[xt.Group=1]="Group",xt[xt.List=2]="List",xt[xt.PercentSign=3]="PercentSign",xt[xt.PlusSign=4]="PlusSign",xt[xt.MinusSign=5]="MinusSign",xt[xt.Exponential=6]="Exponential",xt[xt.SuperscriptingExponent=7]="SuperscriptingExponent",xt[xt.PerMille=8]="PerMille",xt[xt.Infinity=9]="Infinity",xt[xt.NaN=10]="NaN",xt[xt.TimeSeparator=11]="TimeSeparator",xt[xt.CurrencyDecimal=12]="CurrencyDecimal",xt[xt.CurrencyGroup=13]="CurrencyGroup",xt))();function Jt(G,de,K){const Ee=(0,m.cg1)(G),St=An([Ee[m.wAp.DaysFormat],Ee[m.wAp.DaysStandalone]],de);return An(St,K)}function Pn(G,de,K){const Ee=(0,m.cg1)(G),St=An([Ee[m.wAp.MonthsFormat],Ee[m.wAp.MonthsStandalone]],de);return An(St,K)}function ht(G,de){return An((0,m.cg1)(G)[m.wAp.DateFormat],de)}function Pt(G,de){return An((0,m.cg1)(G)[m.wAp.TimeFormat],de)}function Nt(G,de){return An((0,m.cg1)(G)[m.wAp.DateTimeFormat],de)}function hn(G,de){const K=(0,m.cg1)(G),Ee=K[m.wAp.NumberSymbols][de];if(typeof Ee>"u"){if(de===xt.CurrencyDecimal)return K[m.wAp.NumberSymbols][xt.Decimal];if(de===xt.CurrencyGroup)return K[m.wAp.NumberSymbols][xt.Group]}return Ee}function st(G){if(!G[m.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${G[m.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function An(G,de){for(let K=de;K>-1;K--)if(typeof G[K]<"u")return G[K];throw new Error("Locale data API: locale data undefined")}function mt(G){const[de,K]=G.split(":");return{hours:+de,minutes:+K}}const gn=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Yt={},jn=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var at=(()=>((at=at||{})[at.Short=0]="Short",at[at.ShortGMT=1]="ShortGMT",at[at.Long=2]="Long",at[at.Extended=3]="Extended",at))(),qt=(()=>((qt=qt||{})[qt.FullYear=0]="FullYear",qt[qt.Month=1]="Month",qt[qt.Date=2]="Date",qt[qt.Hours=3]="Hours",qt[qt.Minutes=4]="Minutes",qt[qt.Seconds=5]="Seconds",qt[qt.FractionalSeconds=6]="FractionalSeconds",qt[qt.Day=7]="Day",qt))(),yn=(()=>((yn=yn||{})[yn.DayPeriods=0]="DayPeriods",yn[yn.Days=1]="Days",yn[yn.Months=2]="Months",yn[yn.Eras=3]="Eras",yn))();function Kn(G,de,K,Ee){let He=function we(G){if(oe(G))return G;if("number"==typeof G&&!isNaN(G))return new Date(G);if("string"==typeof G){if(G=G.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(G)){const[He,St=1,Kt=1]=G.split("-").map(ni=>+ni);return qn(He,St-1,Kt)}const K=parseFloat(G);if(!isNaN(G-K))return new Date(K);let Ee;if(Ee=G.match(gn))return function me(G){const de=new Date(0);let K=0,Ee=0;const He=G[8]?de.setUTCFullYear:de.setFullYear,St=G[8]?de.setUTCHours:de.setHours;G[9]&&(K=Number(G[9]+G[10]),Ee=Number(G[9]+G[11])),He.call(de,Number(G[1]),Number(G[2])-1,Number(G[3]));const Kt=Number(G[4]||0)-K,ni=Number(G[5]||0)-Ee,sr=Number(G[6]||0),Ri=Math.floor(1e3*parseFloat("0."+(G[7]||0)));return St.call(de,Kt,ni,sr,Ri),de}(Ee)}const de=new Date(G);if(!oe(de))throw new Error(`Unable to convert "${G}" into a date`);return de}(G);de=rn(K,de)||de;let ni,Kt=[];for(;de;){if(ni=jn.exec(de),!ni){Kt.push(de);break}{Kt=Kt.concat(ni.slice(1));const lr=Kt.pop();if(!lr)break;de=lr}}let sr=He.getTimezoneOffset();Ee&&(sr=Ie(Ee,sr),He=function $e(G,de,K){const Ee=K?-1:1,He=G.getTimezoneOffset();return function Ve(G,de){return(G=new Date(G.getTime())).setMinutes(G.getMinutes()+de),G}(G,Ee*(Ie(de,He)-He))}(He,Ee,!0));let Ri="";return Kt.forEach(lr=>{const Yi=function ye(G){if(he[G])return he[G];let de;switch(G){case"G":case"GG":case"GGG":de=Li(yn.Eras,zt.Abbreviated);break;case"GGGG":de=Li(yn.Eras,zt.Wide);break;case"GGGGG":de=Li(yn.Eras,zt.Narrow);break;case"y":de=ii(qt.FullYear,1,0,!1,!0);break;case"yy":de=ii(qt.FullYear,2,0,!0,!0);break;case"yyy":de=ii(qt.FullYear,3,0,!1,!0);break;case"yyyy":de=ii(qt.FullYear,4,0,!1,!0);break;case"Y":de=Le(1);break;case"YY":de=Le(2,!0);break;case"YYY":de=Le(3);break;case"YYYY":de=Le(4);break;case"M":case"L":de=ii(qt.Month,1,1);break;case"MM":case"LL":de=ii(qt.Month,2,1);break;case"MMM":de=Li(yn.Months,zt.Abbreviated);break;case"MMMM":de=Li(yn.Months,zt.Wide);break;case"MMMMM":de=Li(yn.Months,zt.Narrow);break;case"LLL":de=Li(yn.Months,zt.Abbreviated,lt.Standalone);break;case"LLLL":de=Li(yn.Months,zt.Wide,lt.Standalone);break;case"LLLLL":de=Li(yn.Months,zt.Narrow,lt.Standalone);break;case"w":de=Vo(1);break;case"ww":de=Vo(2);break;case"W":de=Vo(1,!0);break;case"d":de=ii(qt.Date,1);break;case"dd":de=ii(qt.Date,2);break;case"c":case"cc":de=ii(qt.Day,1);break;case"ccc":de=Li(yn.Days,zt.Abbreviated,lt.Standalone);break;case"cccc":de=Li(yn.Days,zt.Wide,lt.Standalone);break;case"ccccc":de=Li(yn.Days,zt.Narrow,lt.Standalone);break;case"cccccc":de=Li(yn.Days,zt.Short,lt.Standalone);break;case"E":case"EE":case"EEE":de=Li(yn.Days,zt.Abbreviated);break;case"EEEE":de=Li(yn.Days,zt.Wide);break;case"EEEEE":de=Li(yn.Days,zt.Narrow);break;case"EEEEEE":de=Li(yn.Days,zt.Short);break;case"a":case"aa":case"aaa":de=Li(yn.DayPeriods,zt.Abbreviated);break;case"aaaa":de=Li(yn.DayPeriods,zt.Wide);break;case"aaaaa":de=Li(yn.DayPeriods,zt.Narrow);break;case"b":case"bb":case"bbb":de=Li(yn.DayPeriods,zt.Abbreviated,lt.Standalone,!0);break;case"bbbb":de=Li(yn.DayPeriods,zt.Wide,lt.Standalone,!0);break;case"bbbbb":de=Li(yn.DayPeriods,zt.Narrow,lt.Standalone,!0);break;case"B":case"BB":case"BBB":de=Li(yn.DayPeriods,zt.Abbreviated,lt.Format,!0);break;case"BBBB":de=Li(yn.DayPeriods,zt.Wide,lt.Format,!0);break;case"BBBBB":de=Li(yn.DayPeriods,zt.Narrow,lt.Format,!0);break;case"h":de=ii(qt.Hours,1,-12);break;case"hh":de=ii(qt.Hours,2,-12);break;case"H":de=ii(qt.Hours,1);break;case"HH":de=ii(qt.Hours,2);break;case"m":de=ii(qt.Minutes,1);break;case"mm":de=ii(qt.Minutes,2);break;case"s":de=ii(qt.Seconds,1);break;case"ss":de=ii(qt.Seconds,2);break;case"S":de=ii(qt.FractionalSeconds,1);break;case"SS":de=ii(qt.FractionalSeconds,2);break;case"SSS":de=ii(qt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":de=_r(at.Short);break;case"ZZZZZ":de=_r(at.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":de=_r(at.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":de=_r(at.Long);break;default:return null}return he[G]=de,de}(lr);Ri+=Yi?Yi(He,K,sr):"''"===lr?"'":lr.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),Ri}function qn(G,de,K){const Ee=new Date(0);return Ee.setFullYear(G,de,K),Ee.setHours(0,0,0),Ee}function rn(G,de){const K=function en(G){return(0,m.cg1)(G)[m.wAp.LocaleId]}(G);if(Yt[K]=Yt[K]||{},Yt[K][de])return Yt[K][de];let Ee="";switch(de){case"shortDate":Ee=ht(G,nt.Short);break;case"mediumDate":Ee=ht(G,nt.Medium);break;case"longDate":Ee=ht(G,nt.Long);break;case"fullDate":Ee=ht(G,nt.Full);break;case"shortTime":Ee=Pt(G,nt.Short);break;case"mediumTime":Ee=Pt(G,nt.Medium);break;case"longTime":Ee=Pt(G,nt.Long);break;case"fullTime":Ee=Pt(G,nt.Full);break;case"short":const He=rn(G,"shortTime"),St=rn(G,"shortDate");Ee=On(Nt(G,nt.Short),[He,St]);break;case"medium":const Kt=rn(G,"mediumTime"),ni=rn(G,"mediumDate");Ee=On(Nt(G,nt.Medium),[Kt,ni]);break;case"long":const sr=rn(G,"longTime"),Ri=rn(G,"longDate");Ee=On(Nt(G,nt.Long),[sr,Ri]);break;case"full":const lr=rn(G,"fullTime"),Yi=rn(G,"fullDate");Ee=On(Nt(G,nt.Full),[lr,Yi])}return Ee&&(Yt[K][de]=Ee),Ee}function On(G,de){return de&&(G=G.replace(/\{([^}]+)}/g,function(K,Ee){return null!=de&&Ee in de?de[Ee]:K})),G}function Qt(G,de,K="-",Ee,He){let St="";(G<0||He&&G<=0)&&(He?G=1-G:(G=-G,St=K));let Kt=String(G);for(;Kt.length<de;)Kt="0"+Kt;return Ee&&(Kt=Kt.slice(Kt.length-de)),St+Kt}function ii(G,de,K=0,Ee=!1,He=!1){return function(St,Kt){let ni=function Rn(G,de){switch(G){case qt.FullYear:return de.getFullYear();case qt.Month:return de.getMonth();case qt.Date:return de.getDate();case qt.Hours:return de.getHours();case qt.Minutes:return de.getMinutes();case qt.Seconds:return de.getSeconds();case qt.FractionalSeconds:return de.getMilliseconds();case qt.Day:return de.getDay();default:throw new Error(`Unknown DateType value "${G}".`)}}(G,St);if((K>0||ni>-K)&&(ni+=K),G===qt.Hours)0===ni&&-12===K&&(ni=12);else if(G===qt.FractionalSeconds)return function mr(G,de){return Qt(G,3).substring(0,de)}(ni,de);const sr=hn(Kt,xt.MinusSign);return Qt(ni,de,sr,Ee,He)}}function Li(G,de,K=lt.Format,Ee=!1){return function(He,St){return function Lr(G,de,K,Ee,He,St){switch(K){case yn.Months:return Pn(de,He,Ee)[G.getMonth()];case yn.Days:return Jt(de,He,Ee)[G.getDay()];case yn.DayPeriods:const Kt=G.getHours(),ni=G.getMinutes();if(St){const Ri=function Ci(G){const de=(0,m.cg1)(G);return st(de),(de[m.wAp.ExtraData][2]||[]).map(Ee=>"string"==typeof Ee?mt(Ee):[mt(Ee[0]),mt(Ee[1])])}(de),lr=function er(G,de,K){const Ee=(0,m.cg1)(G);st(Ee);const St=An([Ee[m.wAp.ExtraData][0],Ee[m.wAp.ExtraData][1]],de)||[];return An(St,K)||[]}(de,He,Ee),Yi=Ri.findIndex(Wr=>{if(Array.isArray(Wr)){const[Ii,Vr]=Wr,eo=Kt>=Ii.hours&&ni>=Ii.minutes,Ps=Kt<Vr.hours||Kt===Vr.hours&&ni<Vr.minutes;if(Ii.hours<Vr.hours){if(eo&&Ps)return!0}else if(eo||Ps)return!0}else if(Wr.hours===Kt&&Wr.minutes===ni)return!0;return!1});if(-1!==Yi)return lr[Yi]}return function ui(G,de,K){const Ee=(0,m.cg1)(G),St=An([Ee[m.wAp.DayPeriodsFormat],Ee[m.wAp.DayPeriodsStandalone]],de);return An(St,K)}(de,He,Ee)[Kt<12?0:1];case yn.Eras:return function Mi(G,de){return An((0,m.cg1)(G)[m.wAp.Eras],de)}(de,Ee)[G.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${K}`)}}(He,St,G,de,K,Ee)}}function _r(G){return function(de,K,Ee){const He=-1*Ee,St=hn(K,xt.MinusSign),Kt=He>0?Math.floor(He/60):Math.ceil(He/60);switch(G){case at.Short:return(He>=0?"+":"")+Qt(Kt,2,St)+Qt(Math.abs(He%60),2,St);case at.ShortGMT:return"GMT"+(He>=0?"+":"")+Qt(Kt,1,St);case at.Long:return"GMT"+(He>=0?"+":"")+Qt(Kt,2,St)+":"+Qt(Math.abs(He%60),2,St);case at.Extended:return 0===Ee?"Z":(He>=0?"+":"")+Qt(Kt,2,St)+":"+Qt(Math.abs(He%60),2,St);default:throw new Error(`Unknown zone width "${G}"`)}}}const Ai=0,ur=4;function Br(G){return qn(G.getFullYear(),G.getMonth(),G.getDate()+(ur-G.getDay()))}function Vo(G,de=!1){return function(K,Ee){let He;if(de){const St=new Date(K.getFullYear(),K.getMonth(),1).getDay()-1,Kt=K.getDate();He=1+Math.floor((Kt+St)/7)}else{const St=Br(K),Kt=function si(G){const de=qn(G,Ai,1).getDay();return qn(G,0,1+(de<=ur?ur:ur+7)-de)}(St.getFullYear()),ni=St.getTime()-Kt.getTime();He=1+Math.round(ni/6048e5)}return Qt(He,G,hn(Ee,xt.MinusSign))}}function Le(G,de=!1){return function(K,Ee){return Qt(Br(K).getFullYear(),G,hn(Ee,xt.MinusSign),de)}}const he={};function Ie(G,de){G=G.replace(/:/g,"");const K=Date.parse("Jan 01, 1970 00:00:00 "+G)/6e4;return isNaN(K)?de:K}function oe(G){return G instanceof Date&&!isNaN(G.valueOf())}function tr(G,de){de=encodeURIComponent(de);for(const K of G.split(";")){const Ee=K.indexOf("="),[He,St]=-1==Ee?[K,""]:[K.slice(0,Ee),K.slice(Ee+1)];if(He.trim()===de)return decodeURIComponent(St)}return null}const Hr=/\s+/,Hi=[];let hi=(()=>{class G{constructor(K,Ee,He,St){this._iterableDiffers=K,this._keyValueDiffers=Ee,this._ngEl=He,this._renderer=St,this.initialClasses=Hi,this.stateMap=new Map}set klass(K){this.initialClasses=null!=K?K.trim().split(Hr):Hi}set ngClass(K){this.rawClass="string"==typeof K?K.trim().split(Hr):K}ngDoCheck(){for(const Ee of this.initialClasses)this._updateState(Ee,!0);const K=this.rawClass;if(Array.isArray(K)||K instanceof Set)for(const Ee of K)this._updateState(Ee,!0);else if(null!=K)for(const Ee of Object.keys(K))this._updateState(Ee,!!K[Ee]);this._applyStateDiff()}_updateState(K,Ee){const He=this.stateMap.get(K);void 0!==He?(He.enabled!==Ee&&(He.changed=!0,He.enabled=Ee),He.touched=!0):this.stateMap.set(K,{enabled:Ee,changed:!0,touched:!0})}_applyStateDiff(){for(const K of this.stateMap){const Ee=K[0],He=K[1];He.changed?(this._toggleClass(Ee,He.enabled),He.changed=!1):He.touched||(He.enabled&&this._toggleClass(Ee,!1),this.stateMap.delete(Ee)),He.touched=!1}}_toggleClass(K,Ee){(K=K.trim()).length>0&&K.split(Hr).forEach(He=>{Ee?this._renderer.addClass(this._ngEl.nativeElement,He):this._renderer.removeClass(this._ngEl.nativeElement,He)})}}return G.\u0275fac=function(K){return new(K||G)(m.Y36(m.ZZ4),m.Y36(m.aQg),m.Y36(m.SBq),m.Y36(m.Qsj))},G.\u0275dir=m.lG2({type:G,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),G})();class lo{constructor(de,K,Ee,He){this.$implicit=de,this.ngForOf=K,this.index=Ee,this.count=He}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Vi=(()=>{class G{set ngForOf(K){this._ngForOf=K,this._ngForOfDirty=!0}set ngForTrackBy(K){this._trackByFn=K}get ngForTrackBy(){return this._trackByFn}constructor(K,Ee,He){this._viewContainer=K,this._template=Ee,this._differs=He,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(K){K&&(this._template=K)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const K=this._ngForOf;!this._differ&&K&&(this._differ=this._differs.find(K).create(this.ngForTrackBy))}if(this._differ){const K=this._differ.diff(this._ngForOf);K&&this._applyChanges(K)}}_applyChanges(K){const Ee=this._viewContainer;K.forEachOperation((He,St,Kt)=>{if(null==He.previousIndex)Ee.createEmbeddedView(this._template,new lo(He.item,this._ngForOf,-1,-1),null===Kt?void 0:Kt);else if(null==Kt)Ee.remove(null===St?void 0:St);else if(null!==St){const ni=Ee.get(St);Ee.move(ni,Kt),us(ni,He)}});for(let He=0,St=Ee.length;He<St;He++){const ni=Ee.get(He).context;ni.index=He,ni.count=St,ni.ngForOf=this._ngForOf}K.forEachIdentityChange(He=>{us(Ee.get(He.currentIndex),He)})}static ngTemplateContextGuard(K,Ee){return!0}}return G.\u0275fac=function(K){return new(K||G)(m.Y36(m.s_b),m.Y36(m.Rgc),m.Y36(m.ZZ4))},G.\u0275dir=m.lG2({type:G,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),G})();function us(G,de){G.context.$implicit=de.item}let es=(()=>{class G{constructor(K,Ee){this._viewContainer=K,this._context=new ir,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=Ee}set ngIf(K){this._context.$implicit=this._context.ngIf=K,this._updateView()}set ngIfThen(K){Ts("ngIfThen",K),this._thenTemplateRef=K,this._thenViewRef=null,this._updateView()}set ngIfElse(K){Ts("ngIfElse",K),this._elseTemplateRef=K,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(K,Ee){return!0}}return G.\u0275fac=function(K){return new(K||G)(m.Y36(m.s_b),m.Y36(m.Rgc))},G.\u0275dir=m.lG2({type:G,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),G})();class ir{constructor(){this.$implicit=null,this.ngIf=null}}function Ts(G,de){if(de&&!de.createEmbeddedView)throw new Error(`${G} must be a TemplateRef, but received '${(0,m.AaK)(de)}'.`)}let Qs=(()=>{class G{constructor(K){this._viewContainerRef=K,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(K){if(K.ngTemplateOutlet||K.ngTemplateOutletInjector){const Ee=this._viewContainerRef;if(this._viewRef&&Ee.remove(Ee.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:He,ngTemplateOutletContext:St,ngTemplateOutletInjector:Kt}=this;this._viewRef=Ee.createEmbeddedView(He,St,Kt?{injector:Kt}:void 0)}else this._viewRef=null}else this._viewRef&&K.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return G.\u0275fac=function(K){return new(K||G)(m.Y36(m.s_b))},G.\u0275dir=m.lG2({type:G,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[m.TTD]}),G})();class Ya{createSubscription(de,K){return(0,m.rg0)(()=>de.subscribe({next:K,error:Ee=>{throw Ee}}))}dispose(de){(0,m.rg0)(()=>de.unsubscribe())}}class Ma{createSubscription(de,K){return de.then(K,Ee=>{throw Ee})}dispose(de){}}const dl=new Ma,dr=new Ya;let $r=(()=>{class G{constructor(K){this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null,this._ref=K}ngOnDestroy(){this._subscription&&this._dispose(),this._ref=null}transform(K){return this._obj?K!==this._obj?(this._dispose(),this.transform(K)):this._latestValue:(K&&this._subscribe(K),this._latestValue)}_subscribe(K){this._obj=K,this._strategy=this._selectStrategy(K),this._subscription=this._strategy.createSubscription(K,Ee=>this._updateLatestValue(K,Ee))}_selectStrategy(K){if((0,m.QGY)(K))return dl;if((0,m.F4k)(K))return dr;throw function Oo(G,de){return new m.vHH(2100,!1)}()}_dispose(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}_updateLatestValue(K,Ee){K===this._obj&&(this._latestValue=Ee,this._ref.markForCheck())}}return G.\u0275fac=function(K){return new(K||G)(m.Y36(m.sBO,16))},G.\u0275pipe=m.Yjl({name:"async",type:G,pure:!1,standalone:!0}),G})(),ps=(()=>{class G{}return G.\u0275fac=function(K){return new(K||G)},G.\u0275mod=m.oAB({type:G}),G.\u0275inj=m.cJS({}),G})();const yr="browser",ha="server";function Aa(G){return G===ha}let Ia=(()=>{class G{}return G.\u0275prov=(0,m.Yz7)({token:G,providedIn:"root",factory:()=>new Ui((0,m.LFG)(Pe),window)}),G})();class Ui{constructor(de,K){this.document=de,this.window=K,this.offset=()=>[0,0]}setOffset(de){this.offset=Array.isArray(de)?()=>de:de}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(de){this.supportsScrolling()&&this.window.scrollTo(de[0],de[1])}scrollToAnchor(de){if(!this.supportsScrolling())return;const K=function pa(G,de){const K=G.getElementById(de)||G.getElementsByName(de)[0];if(K)return K;if("function"==typeof G.createTreeWalker&&G.body&&"function"==typeof G.body.attachShadow){const Ee=G.createTreeWalker(G.body,NodeFilter.SHOW_ELEMENT);let He=Ee.currentNode;for(;He;){const St=He.shadowRoot;if(St){const Kt=St.getElementById(de)||St.querySelector(`[name="${de}"]`);if(Kt)return Kt}He=Ee.nextNode()}}return null}(this.document,de);K&&(this.scrollToElement(K),K.focus())}setHistoryScrollRestoration(de){if(this.supportScrollRestoration()){const K=this.window.history;K&&K.scrollRestoration&&(K.scrollRestoration=de)}}scrollToElement(de){const K=de.getBoundingClientRect(),Ee=K.left+this.window.pageXOffset,He=K.top+this.window.pageYOffset,St=this.offset();this.window.scrollTo(Ee-St[0],He-St[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const de=ea(this.window.history)||ea(Object.getPrototypeOf(this.window.history));return!(!de||!de.writable&&!de.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function ea(G){return Object.getOwnPropertyDescriptor(G,"scrollRestoration")}class uo{}},9862:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{JF:()=>Se,UA:()=>Mi,eN:()=>ft});var m=_e(9468),be=_e(2096),ge=_e(7715),x=_e(5592),tt=_e(6328),Pe=_e(2181),Ze=_e(7398),yt=_e(4716),Ht=_e(4664),$t=_e(6814);class It{}class bt{}class Zt{constructor(Oe){this.normalizedNames=new Map,this.lazyUpdate=null,Oe?"string"==typeof Oe?this.lazyInit=()=>{this.headers=new Map,Oe.split("\n").forEach(Ge=>{const Gt=Ge.indexOf(":");if(Gt>0){const tn=Ge.slice(0,Gt),Wt=tn.toLowerCase(),cn=Ge.slice(Gt+1).trim();this.maybeSetNormalizedName(tn,Wt),this.headers.has(Wt)?this.headers.get(Wt).push(cn):this.headers.set(Wt,[cn])}})}:typeof Headers<"u"&&Oe instanceof Headers?(this.headers=new Map,Oe.forEach((Ge,Gt)=>{this.setHeaderEntries(Gt,Ge)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(Oe).forEach(([Ge,Gt])=>{this.setHeaderEntries(Ge,Gt)})}:this.headers=new Map}has(Oe){return this.init(),this.headers.has(Oe.toLowerCase())}get(Oe){this.init();const Ge=this.headers.get(Oe.toLowerCase());return Ge&&Ge.length>0?Ge[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(Oe){return this.init(),this.headers.get(Oe.toLowerCase())||null}append(Oe,Ge){return this.clone({name:Oe,value:Ge,op:"a"})}set(Oe,Ge){return this.clone({name:Oe,value:Ge,op:"s"})}delete(Oe,Ge){return this.clone({name:Oe,value:Ge,op:"d"})}maybeSetNormalizedName(Oe,Ge){this.normalizedNames.has(Ge)||this.normalizedNames.set(Ge,Oe)}init(){this.lazyInit&&(this.lazyInit instanceof Zt?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(Oe=>this.applyUpdate(Oe)),this.lazyUpdate=null))}copyFrom(Oe){Oe.init(),Array.from(Oe.headers.keys()).forEach(Ge=>{this.headers.set(Ge,Oe.headers.get(Ge)),this.normalizedNames.set(Ge,Oe.normalizedNames.get(Ge))})}clone(Oe){const Ge=new Zt;return Ge.lazyInit=this.lazyInit&&this.lazyInit instanceof Zt?this.lazyInit:this,Ge.lazyUpdate=(this.lazyUpdate||[]).concat([Oe]),Ge}applyUpdate(Oe){const Ge=Oe.name.toLowerCase();switch(Oe.op){case"a":case"s":let Gt=Oe.value;if("string"==typeof Gt&&(Gt=[Gt]),0===Gt.length)return;this.maybeSetNormalizedName(Oe.name,Ge);const tn=("a"===Oe.op?this.headers.get(Ge):void 0)||[];tn.push(...Gt),this.headers.set(Ge,tn);break;case"d":const Wt=Oe.value;if(Wt){let cn=this.headers.get(Ge);if(!cn)return;cn=cn.filter(Zi=>-1===Wt.indexOf(Zi)),0===cn.length?(this.headers.delete(Ge),this.normalizedNames.delete(Ge)):this.headers.set(Ge,cn)}else this.headers.delete(Ge),this.normalizedNames.delete(Ge)}}setHeaderEntries(Oe,Ge){const Gt=(Array.isArray(Ge)?Ge:[Ge]).map(Wt=>Wt.toString()),tn=Oe.toLowerCase();this.headers.set(tn,Gt),this.maybeSetNormalizedName(Oe,tn)}forEach(Oe){this.init(),Array.from(this.normalizedNames.keys()).forEach(Ge=>Oe(this.normalizedNames.get(Ge),this.headers.get(Ge)))}}class nn{encodeKey(Oe){return vi(Oe)}encodeValue(Oe){return vi(Oe)}decodeKey(Oe){return decodeURIComponent(Oe)}decodeValue(Oe){return decodeURIComponent(Oe)}}const Gn=/%(\d[a-f0-9])/gi,yi={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function vi(ut){return encodeURIComponent(ut).replace(Gn,(Oe,Ge)=>yi[Ge]??Oe)}function Vt(ut){return`${ut}`}class Tt{constructor(Oe={}){if(this.updates=null,this.cloneFrom=null,this.encoder=Oe.encoder||new nn,Oe.fromString){if(Oe.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Tn(ut,Oe){const Ge=new Map;return ut.length>0&&ut.replace(/^\?/,"").split("&").forEach(tn=>{const Wt=tn.indexOf("="),[cn,Zi]=-1==Wt?[Oe.decodeKey(tn),""]:[Oe.decodeKey(tn.slice(0,Wt)),Oe.decodeValue(tn.slice(Wt+1))],Qn=Ge.get(cn)||[];Qn.push(Zi),Ge.set(cn,Qn)}),Ge}(Oe.fromString,this.encoder)}else Oe.fromObject?(this.map=new Map,Object.keys(Oe.fromObject).forEach(Ge=>{const Gt=Oe.fromObject[Ge],tn=Array.isArray(Gt)?Gt.map(Vt):[Vt(Gt)];this.map.set(Ge,tn)})):this.map=null}has(Oe){return this.init(),this.map.has(Oe)}get(Oe){this.init();const Ge=this.map.get(Oe);return Ge?Ge[0]:null}getAll(Oe){return this.init(),this.map.get(Oe)||null}keys(){return this.init(),Array.from(this.map.keys())}append(Oe,Ge){return this.clone({param:Oe,value:Ge,op:"a"})}appendAll(Oe){const Ge=[];return Object.keys(Oe).forEach(Gt=>{const tn=Oe[Gt];Array.isArray(tn)?tn.forEach(Wt=>{Ge.push({param:Gt,value:Wt,op:"a"})}):Ge.push({param:Gt,value:tn,op:"a"})}),this.clone(Ge)}set(Oe,Ge){return this.clone({param:Oe,value:Ge,op:"s"})}delete(Oe,Ge){return this.clone({param:Oe,value:Ge,op:"d"})}toString(){return this.init(),this.keys().map(Oe=>{const Ge=this.encoder.encodeKey(Oe);return this.map.get(Oe).map(Gt=>Ge+"="+this.encoder.encodeValue(Gt)).join("&")}).filter(Oe=>""!==Oe).join("&")}clone(Oe){const Ge=new Tt({encoder:this.encoder});return Ge.cloneFrom=this.cloneFrom||this,Ge.updates=(this.updates||[]).concat(Oe),Ge}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(Oe=>this.map.set(Oe,this.cloneFrom.map.get(Oe))),this.updates.forEach(Oe=>{switch(Oe.op){case"a":case"s":const Ge=("a"===Oe.op?this.map.get(Oe.param):void 0)||[];Ge.push(Vt(Oe.value)),this.map.set(Oe.param,Ge);break;case"d":if(void 0===Oe.value){this.map.delete(Oe.param);break}{let Gt=this.map.get(Oe.param)||[];const tn=Gt.indexOf(Vt(Oe.value));-1!==tn&&Gt.splice(tn,1),Gt.length>0?this.map.set(Oe.param,Gt):this.map.delete(Oe.param)}}}),this.cloneFrom=this.updates=null)}}class Et{constructor(){this.map=new Map}set(Oe,Ge){return this.map.set(Oe,Ge),this}get(Oe){return this.map.has(Oe)||this.map.set(Oe,Oe.defaultValue()),this.map.get(Oe)}delete(Oe){return this.map.delete(Oe),this}has(Oe){return this.map.has(Oe)}keys(){return this.map.keys()}}function lt(ut){return typeof ArrayBuffer<"u"&&ut instanceof ArrayBuffer}function zt(ut){return typeof Blob<"u"&&ut instanceof Blob}function nt(ut){return typeof FormData<"u"&&ut instanceof FormData}class bn{constructor(Oe,Ge,Gt,tn){let Wt;if(this.url=Ge,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=Oe.toUpperCase(),function Bt(ut){switch(ut){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||tn?(this.body=void 0!==Gt?Gt:null,Wt=tn):Wt=Gt,Wt&&(this.reportProgress=!!Wt.reportProgress,this.withCredentials=!!Wt.withCredentials,Wt.responseType&&(this.responseType=Wt.responseType),Wt.headers&&(this.headers=Wt.headers),Wt.context&&(this.context=Wt.context),Wt.params&&(this.params=Wt.params)),this.headers||(this.headers=new Zt),this.context||(this.context=new Et),this.params){const cn=this.params.toString();if(0===cn.length)this.urlWithParams=Ge;else{const Zi=Ge.indexOf("?");this.urlWithParams=Ge+(-1===Zi?"?":Zi<Ge.length-1?"&":"")+cn}}else this.params=new Tt,this.urlWithParams=Ge}serializeBody(){return null===this.body?null:lt(this.body)||zt(this.body)||nt(this.body)||function xt(ut){return typeof URLSearchParams<"u"&&ut instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Tt?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||nt(this.body)?null:zt(this.body)?this.body.type||null:lt(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Tt?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(Oe={}){const Ge=Oe.method||this.method,Gt=Oe.url||this.url,tn=Oe.responseType||this.responseType,Wt=void 0!==Oe.body?Oe.body:this.body,cn=void 0!==Oe.withCredentials?Oe.withCredentials:this.withCredentials,Zi=void 0!==Oe.reportProgress?Oe.reportProgress:this.reportProgress;let Qn=Oe.headers||this.headers,nr=Oe.params||this.params;const ji=Oe.context??this.context;return void 0!==Oe.setHeaders&&(Qn=Object.keys(Oe.setHeaders).reduce((Pr,Ki)=>Pr.set(Ki,Oe.setHeaders[Ki]),Qn)),Oe.setParams&&(nr=Object.keys(Oe.setParams).reduce((Pr,Ki)=>Pr.set(Ki,Oe.setParams[Ki]),nr)),new bn(Ge,Gt,Wt,{params:nr,headers:Qn,context:ji,reportProgress:Zi,responseType:tn,withCredentials:cn})}}var en=(()=>((en=en||{})[en.Sent=0]="Sent",en[en.UploadProgress=1]="UploadProgress",en[en.ResponseHeader=2]="ResponseHeader",en[en.DownloadProgress=3]="DownloadProgress",en[en.Response=4]="Response",en[en.User=5]="User",en))();class ui{constructor(Oe,Ge=200,Gt="OK"){this.headers=Oe.headers||new Zt,this.status=void 0!==Oe.status?Oe.status:Ge,this.statusText=Oe.statusText||Gt,this.url=Oe.url||null,this.ok=this.status>=200&&this.status<300}}class Jt extends ui{constructor(Oe={}){super(Oe),this.type=en.ResponseHeader}clone(Oe={}){return new Jt({headers:Oe.headers||this.headers,status:void 0!==Oe.status?Oe.status:this.status,statusText:Oe.statusText||this.statusText,url:Oe.url||this.url||void 0})}}class Pn extends ui{constructor(Oe={}){super(Oe),this.type=en.Response,this.body=void 0!==Oe.body?Oe.body:null}clone(Oe={}){return new Pn({body:void 0!==Oe.body?Oe.body:this.body,headers:Oe.headers||this.headers,status:void 0!==Oe.status?Oe.status:this.status,statusText:Oe.statusText||this.statusText,url:Oe.url||this.url||void 0})}}class Mi extends ui{constructor(Oe){super(Oe,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${Oe.url||"(unknown url)"}`:`Http failure response for ${Oe.url||"(unknown url)"}: ${Oe.status} ${Oe.statusText}`,this.error=Oe.error||null}}function bi(ut,Oe){return{body:Oe,headers:ut.headers,context:ut.context,observe:ut.observe,params:ut.params,reportProgress:ut.reportProgress,responseType:ut.responseType,withCredentials:ut.withCredentials}}let ft=(()=>{class ut{constructor(Ge){this.handler=Ge}request(Ge,Gt,tn={}){let Wt;if(Ge instanceof bn)Wt=Ge;else{let Qn,nr;Qn=tn.headers instanceof Zt?tn.headers:new Zt(tn.headers),tn.params&&(nr=tn.params instanceof Tt?tn.params:new Tt({fromObject:tn.params})),Wt=new bn(Ge,Gt,void 0!==tn.body?tn.body:null,{headers:Qn,context:tn.context,params:nr,reportProgress:tn.reportProgress,responseType:tn.responseType||"json",withCredentials:tn.withCredentials})}const cn=(0,be.of)(Wt).pipe((0,tt.b)(Qn=>this.handler.handle(Qn)));if(Ge instanceof bn||"events"===tn.observe)return cn;const Zi=cn.pipe((0,Pe.h)(Qn=>Qn instanceof Pn));switch(tn.observe||"body"){case"body":switch(Wt.responseType){case"arraybuffer":return Zi.pipe((0,Ze.U)(Qn=>{if(null!==Qn.body&&!(Qn.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return Qn.body}));case"blob":return Zi.pipe((0,Ze.U)(Qn=>{if(null!==Qn.body&&!(Qn.body instanceof Blob))throw new Error("Response is not a Blob.");return Qn.body}));case"text":return Zi.pipe((0,Ze.U)(Qn=>{if(null!==Qn.body&&"string"!=typeof Qn.body)throw new Error("Response is not a string.");return Qn.body}));default:return Zi.pipe((0,Ze.U)(Qn=>Qn.body))}case"response":return Zi;default:throw new Error(`Unreachable: unhandled observe type ${tn.observe}}`)}}delete(Ge,Gt={}){return this.request("DELETE",Ge,Gt)}get(Ge,Gt={}){return this.request("GET",Ge,Gt)}head(Ge,Gt={}){return this.request("HEAD",Ge,Gt)}jsonp(Ge,Gt){return this.request("JSONP",Ge,{params:(new Tt).append(Gt,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(Ge,Gt={}){return this.request("OPTIONS",Ge,Gt)}patch(Ge,Gt,tn={}){return this.request("PATCH",Ge,bi(tn,Gt))}post(Ge,Gt,tn={}){return this.request("POST",Ge,bi(tn,Gt))}put(Ge,Gt,tn={}){return this.request("PUT",Ge,bi(tn,Gt))}}return ut.\u0275fac=function(Ge){return new(Ge||ut)(m.LFG(It))},ut.\u0275prov=m.Yz7({token:ut,factory:ut.\u0275fac}),ut})();function zi(ut,Oe){return Oe(ut)}function di(ut,Oe){return(Ge,Gt)=>Oe.intercept(Ge,{handle:tn=>ut(tn,Gt)})}const st=new m.OlP(""),Ci=new m.OlP(""),er=new m.OlP("");function Mn(){let ut=null;return(Oe,Ge)=>{null===ut&&(ut=((0,m.f3M)(st,{optional:!0})??[]).reduceRight(di,zi));const Gt=(0,m.f3M)(m.HDt),tn=Gt.add();return ut(Oe,Ge).pipe((0,yt.x)(()=>Gt.remove(tn)))}}let An=(()=>{class ut extends It{constructor(Ge,Gt){super(),this.backend=Ge,this.injector=Gt,this.chain=null,this.pendingTasks=(0,m.f3M)(m.HDt)}handle(Ge){if(null===this.chain){const tn=Array.from(new Set([...this.injector.get(Ci),...this.injector.get(er,[])]));this.chain=tn.reduceRight((Wt,cn)=>function Si(ut,Oe,Ge){return(Gt,tn)=>Ge.runInContext(()=>Oe(Gt,Wt=>ut(Wt,tn)))}(Wt,cn,this.injector),zi)}const Gt=this.pendingTasks.add();return this.chain(Ge,tn=>this.backend.handle(tn)).pipe((0,yt.x)(()=>this.pendingTasks.remove(Gt)))}}return ut.\u0275fac=function(Ge){return new(Ge||ut)(m.LFG(bt),m.LFG(m.lqb))},ut.\u0275prov=m.Yz7({token:ut,factory:ut.\u0275fac}),ut})();const qn=/^\)\]\}',?\n/;let On=(()=>{class ut{constructor(Ge){this.xhrFactory=Ge}handle(Ge){if("JSONP"===Ge.method)throw new m.vHH(-2800,!1);const Gt=this.xhrFactory;return(Gt.\u0275loadImpl?(0,ge.D)(Gt.\u0275loadImpl()):(0,be.of)(null)).pipe((0,Ht.w)(()=>new x.y(Wt=>{const cn=Gt.build();if(cn.open(Ge.method,Ge.urlWithParams),Ge.withCredentials&&(cn.withCredentials=!0),Ge.headers.forEach((Hi,hi)=>cn.setRequestHeader(Hi,hi.join(","))),Ge.headers.has("Accept")||cn.setRequestHeader("Accept","application/json, text/plain, */*"),!Ge.headers.has("Content-Type")){const Hi=Ge.detectContentTypeHeader();null!==Hi&&cn.setRequestHeader("Content-Type",Hi)}if(Ge.responseType){const Hi=Ge.responseType.toLowerCase();cn.responseType="json"!==Hi?Hi:"text"}const Zi=Ge.serializeBody();let Qn=null;const nr=()=>{if(null!==Qn)return Qn;const Hi=cn.statusText||"OK",hi=new Zt(cn.getAllResponseHeaders()),Uo=function rn(ut){return"responseURL"in ut&&ut.responseURL?ut.responseURL:/^X-Request-URL:/m.test(ut.getAllResponseHeaders())?ut.getResponseHeader("X-Request-URL"):null}(cn)||Ge.url;return Qn=new Jt({headers:hi,status:cn.status,statusText:Hi,url:Uo}),Qn},ji=()=>{let{headers:Hi,status:hi,statusText:Uo,url:mo}=nr(),lo=null;204!==hi&&(lo=typeof cn.response>"u"?cn.responseText:cn.response),0===hi&&(hi=lo?200:0);let Vi=hi>=200&&hi<300;if("json"===Ge.responseType&&"string"==typeof lo){const us=lo;lo=lo.replace(qn,"");try{lo=""!==lo?JSON.parse(lo):null}catch(ds){lo=us,Vi&&(Vi=!1,lo={error:ds,text:lo})}}Vi?(Wt.next(new Pn({body:lo,headers:Hi,status:hi,statusText:Uo,url:mo||void 0})),Wt.complete()):Wt.error(new Mi({error:lo,headers:Hi,status:hi,statusText:Uo,url:mo||void 0}))},Pr=Hi=>{const{url:hi}=nr(),Uo=new Mi({error:Hi,status:cn.status||0,statusText:cn.statusText||"Unknown Error",url:hi||void 0});Wt.error(Uo)};let Ki=!1;const tr=Hi=>{Ki||(Wt.next(nr()),Ki=!0);let hi={type:en.DownloadProgress,loaded:Hi.loaded};Hi.lengthComputable&&(hi.total=Hi.total),"text"===Ge.responseType&&cn.responseText&&(hi.partialText=cn.responseText),Wt.next(hi)},Hr=Hi=>{let hi={type:en.UploadProgress,loaded:Hi.loaded};Hi.lengthComputable&&(hi.total=Hi.total),Wt.next(hi)};return cn.addEventListener("load",ji),cn.addEventListener("error",Pr),cn.addEventListener("timeout",Pr),cn.addEventListener("abort",Pr),Ge.reportProgress&&(cn.addEventListener("progress",tr),null!==Zi&&cn.upload&&cn.upload.addEventListener("progress",Hr)),cn.send(Zi),Wt.next({type:en.Sent}),()=>{cn.removeEventListener("error",Pr),cn.removeEventListener("abort",Pr),cn.removeEventListener("load",ji),cn.removeEventListener("timeout",Pr),Ge.reportProgress&&(cn.removeEventListener("progress",tr),null!==Zi&&cn.upload&&cn.upload.removeEventListener("progress",Hr)),cn.readyState!==cn.DONE&&cn.abort()}})))}}return ut.\u0275fac=function(Ge){return new(Ge||ut)(m.LFG($t.JF))},ut.\u0275prov=m.Yz7({token:ut,factory:ut.\u0275fac}),ut})();const Qt=new m.OlP("XSRF_ENABLED"),ii=new m.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Li=new m.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Lr{}let _r=(()=>{class ut{constructor(Ge,Gt,tn){this.doc=Ge,this.platform=Gt,this.cookieName=tn,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const Ge=this.doc.cookie||"";return Ge!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,$t.Mx)(Ge,this.cookieName),this.lastCookieString=Ge),this.lastToken}}return ut.\u0275fac=function(Ge){return new(Ge||ut)(m.LFG($t.K0),m.LFG(m.Lbi),m.LFG(ii))},ut.\u0275prov=m.Yz7({token:ut,factory:ut.\u0275fac}),ut})();function Ai(ut,Oe){const Ge=ut.url.toLowerCase();if(!(0,m.f3M)(Qt)||"GET"===ut.method||"HEAD"===ut.method||Ge.startsWith("http://")||Ge.startsWith("https://"))return Oe(ut);const Gt=(0,m.f3M)(Lr).getToken(),tn=(0,m.f3M)(Li);return null!=Gt&&!ut.headers.has(tn)&&(ut=ut.clone({headers:ut.headers.set(tn,Gt)})),Oe(ut)}var si=(()=>((si=si||{})[si.Interceptors=0]="Interceptors",si[si.LegacyInterceptors=1]="LegacyInterceptors",si[si.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",si[si.NoXsrfProtection=3]="NoXsrfProtection",si[si.JsonpSupport=4]="JsonpSupport",si[si.RequestsMadeViaParent=5]="RequestsMadeViaParent",si[si.Fetch=6]="Fetch",si))();function Br(ut,Oe){return{\u0275kind:ut,\u0275providers:Oe}}function Vo(...ut){const Oe=[ft,On,An,{provide:It,useExisting:An},{provide:bt,useExisting:On},{provide:Ci,useValue:Ai,multi:!0},{provide:Qt,useValue:!0},{provide:Lr,useClass:_r}];for(const Ge of ut)Oe.push(...Ge.\u0275providers);return(0,m.MR2)(Oe)}const he=new m.OlP("LEGACY_INTERCEPTOR_FN");let Se=(()=>{class ut{}return ut.\u0275fac=function(Ge){return new(Ge||ut)},ut.\u0275mod=m.oAB({type:ut}),ut.\u0275inj=m.cJS({providers:[Vo(Br(si.LegacyInterceptors,[{provide:he,useFactory:Mn},{provide:Ci,useExisting:he,multi:!0}]))]}),ut})()},9468:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{tb:()=>rv,AFp:()=>ei,ip1:()=>Jb,hGG:()=>bC,z2F:()=>pg,Ojb:()=>_n,sBO:()=>rC,Sil:()=>BD,EJc:()=>FD,Xts:()=>Au,SBq:()=>mh,lqb:()=>xe,qLn:()=>au,vpe:()=>Th,XFs:()=>qn,OlP:()=>wr,zs3:()=>yh,ZZ4:()=>uv,aQg:()=>dv,soG:()=>l_,YKP:()=>X0,h0i:()=>dg,PXZ:()=>KD,R0b:()=>Lc,FiY:()=>Lu,Lbi:()=>In,g9A:()=>kn,Qsj:()=>Gp,FYo:()=>$p,JOm:()=>xl,tp0:()=>ja,Rgc:()=>tm,dDg:()=>WD,eoX:()=>u1,GfV:()=>Zp,s_b:()=>s_,ifc:()=>Fn,VuI:()=>AC,LMc:()=>OC,MMx:()=>Q0,Lck:()=>Ew,eFA:()=>p1,Gpc:()=>vi,f3M:()=>oe,$WT:()=>xo,MR2:()=>ou,_c5:()=>vC,qFp:()=>PC,rg0:()=>Zl,c2e:()=>Qb,zSh:()=>$,HDt:()=>e1,wAp:()=>Wi,vHH:()=>lt,lri:()=>l1,rWj:()=>c1,cg1:()=>Ay,kL8:()=>x0,dqk:()=>Rn,Z0I:()=>kt,eJc:()=>Yy,QGY:()=>Ea,F4k:()=>uc,RDi:()=>Ga,AaK:()=>Tn,zW0:()=>Nu,qOj:()=>Lg,Xq5:()=>Fd,TTD:()=>Yl,_Bn:()=>K0,jDz:()=>eb,xp6:()=>cm,uIk:()=>Bg,Tol:()=>Zv,ekj:()=>Ey,Suo:()=>Ib,Xpm:()=>Ta,lG2:()=>Ma,Yz7:()=>An,cJS:()=>We,oAB:()=>$s,Yjl:()=>dl,Y36:()=>zf,_UZ:()=>jt,BQk:()=>fi,ynx:()=>En,qZA:()=>rt,TgZ:()=>Qe,EpF:()=>jr,n5z:()=>yf,Ikx:()=>My,SDv:()=>Z0,LFG:()=>we,$8M:()=>$d,$Z:()=>gm,NdJ:()=>Io,CRH:()=>Ob,oxw:()=>Op,ALo:()=>gb,lcZ:()=>mb,xi3:()=>_b,Hsn:()=>Jf,F$t:()=>Xf,Q6J:()=>Me,s9C:()=>_f,MGl:()=>Dh,VKq:()=>ab,WLB:()=>lb,kEZ:()=>cb,iGM:()=>Mb,MAs:()=>pe,KtG:()=>od,CHM:()=>Fr,P3R:()=>hh,YNc:()=>v,W1O:()=>kb,_uU:()=>e0,Oqu:()=>Sy,hij:()=>e_,Gf:()=>Ab});var m=_e(8645),be=_e(7394),ge=_e(5619),x=_e(5592),tt=_e(3019),Pe=_e(2096),Ze=_e(4829),yt=_e(305),Ht=_e(9360);function $t(e={}){const{connector:i=(()=>new m.x),resetOnError:a=!0,resetOnComplete:h=!0,resetOnRefCountZero:_=!0}=e;return T=>{let F,j,q,ce=0,Ce=!1,Be=!1;const ct=()=>{j?.unsubscribe(),j=void 0},_t=()=>{ct(),F=q=void 0,Ce=Be=!1},an=()=>{const xn=F;_t(),xn?.unsubscribe()};return(0,Ht.e)((xn,ti)=>{ce++,!Be&&!Ce&&ct();const Di=q=q??i();ti.add(()=>{ce--,0===ce&&!Be&&!Ce&&(j=It(an,_))}),Di.subscribe(ti),!F&&ce>0&&(F=new yt.Hp({next:un=>Di.next(un),error:un=>{Be=!0,ct(),j=It(_t,a,un),Di.error(un)},complete:()=>{Ce=!0,ct(),j=It(_t,h),Di.complete()}}),(0,Ze.Xf)(xn).subscribe(F))})(T)}}function It(e,i,...a){if(!0===i)return void e();if(!1===i)return;const h=new yt.Hp({next:()=>{h.unsubscribe(),e()}});return(0,Ze.Xf)(i(...a)).subscribe(h)}var bt=_e(4664),Zt=_e(3997);function dt(e){for(let i in e)if(e[i]===dt)return i;throw Error("Could not find renamed property on target object.")}function nn(e,i){for(const a in i)i.hasOwnProperty(a)&&!e.hasOwnProperty(a)&&(e[a]=i[a])}function Tn(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(Tn).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const i=e.toString();if(null==i)return""+i;const a=i.indexOf("\n");return-1===a?i:i.substring(0,a)}function Gn(e,i){return null==e||""===e?null===i?"":i:null==i||""===i?e:e+" "+i}const yi=dt({__forward_ref__:dt});function vi(e){return e.__forward_ref__=vi,e.toString=function(){return Tn(this())},e}function Vt(e){return Tt(e)?e():e}function Tt(e){return"function"==typeof e&&e.hasOwnProperty(yi)&&e.__forward_ref__===vi}function wt(e){return e&&!!e.\u0275providers}const Bt="https://g.co/ng/security#xss";class lt extends Error{constructor(i,a){super(function zt(e,i){return`NG0${Math.abs(e)}${i?": "+i:""}`}(i,a)),this.code=i}}function nt(e){return"string"==typeof e?e:null==e?"":String(e)}function Jt(e,i){throw new lt(-201,!1)}function st(e,i,a,h){throw new Error(`ASSERTION ERROR: ${e}`+(null==h?"":` [Expected=> ${a} ${h} ${i} <=Actual]`))}function An(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function We(e){return{providers:e.providers||[],imports:e.imports||[]}}function Ot(e){return gn(e,at)||gn(e,yn)}function kt(e){return null!==Ot(e)}function gn(e,i){return e.hasOwnProperty(i)?e[i]:null}function jn(e){return e&&(e.hasOwnProperty(qt)||e.hasOwnProperty(Kn))?e[qt]:null}const at=dt({\u0275prov:dt}),qt=dt({\u0275inj:dt}),yn=dt({ngInjectableDef:dt}),Kn=dt({ngInjectorDef:dt});var qn=(()=>((qn=qn||{})[qn.Default=0]="Default",qn[qn.Host=1]="Host",qn[qn.Self=2]="Self",qn[qn.SkipSelf=4]="SkipSelf",qn[qn.Optional=8]="Optional",qn))();let rn;function Qt(e){const i=rn;return rn=e,i}function mr(e,i,a){const h=Ot(e);return h&&"root"==h.providedIn?void 0===h.value?h.value=h.factory():h.value:a&qn.Optional?null:void 0!==i?i:void Jt(Tn(e))}const Rn=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Ai={},ur="__NG_DI_FLAG__",si="ngTempTokenPath",Vo=/\n/gm,he="__source";let ye;function Ve(e){const i=ye;return ye=e,i}function $e(e,i=qn.Default){if(void 0===ye)throw new lt(-203,!1);return null===ye?mr(e,void 0,i):ye.get(e,i&qn.Optional?null:void 0,i)}function we(e,i=qn.Default){return(function On(){return rn}()||$e)(Vt(e),i)}function oe(e,i=qn.Default){return we(e,Se(i))}function Se(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function Ye(e){const i=[];for(let a=0;a<e.length;a++){const h=Vt(e[a]);if(Array.isArray(h)){if(0===h.length)throw new lt(900,!1);let _,T=qn.Default;for(let F=0;F<h.length;F++){const j=h[F],q=gt(j);"number"==typeof q?-1===q?_=j.token:T|=q:_=j}i.push(we(_,T))}else i.push(we(h))}return i}function Xe(e,i){return e[ur]=i,e.prototype[ur]=i,e}function gt(e){return e[ur]}function sn(e){return{toString:e}.toString()}var Cn=(()=>((Cn=Cn||{})[Cn.OnPush=0]="OnPush",Cn[Cn.Default=1]="Default",Cn))(),Fn=(()=>{return(e=Fn||(Fn={}))[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",Fn;var e})();const ut={},Oe=[],Ge=dt({\u0275cmp:dt}),Gt=dt({\u0275dir:dt}),tn=dt({\u0275pipe:dt}),Wt=dt({\u0275mod:dt}),cn=dt({\u0275fac:dt}),Zi=dt({__NG_ELEMENT_ID__:dt}),Qn=dt({__NG_ENV_ID__:dt});function nr(e,i,a){let h=e.length;for(;;){const _=e.indexOf(i,a);if(-1===_)return _;if(0===_||e.charCodeAt(_-1)<=32){const T=i.length;if(_+T===h||e.charCodeAt(_+T)<=32)return _}a=_+1}}function ji(e,i,a){let h=0;for(;h<a.length;){const _=a[h];if("number"==typeof _){if(0!==_)break;h++;const T=a[h++],F=a[h++],j=a[h++];e.setAttribute(i,F,j,T)}else{const T=_,F=a[++h];Ki(T)?e.setProperty(i,T,F):e.setAttribute(i,T,F),h++}}return h}function Pr(e){return 3===e||4===e||6===e}function Ki(e){return 64===e.charCodeAt(0)}function tr(e,i){if(null!==i&&0!==i.length)if(null===e||0===e.length)e=i.slice();else{let a=-1;for(let h=0;h<i.length;h++){const _=i[h];"number"==typeof _?a=_:0===a||Hr(e,a,_,null,-1===a||2===a?i[++h]:null)}}return e}function Hr(e,i,a,h,_){let T=0,F=e.length;if(-1===i)F=-1;else for(;T<e.length;){const j=e[T++];if("number"==typeof j){if(j===i){F=-1;break}if(j>i){F=T-1;break}}}for(;T<e.length;){const j=e[T];if("number"==typeof j)break;if(j===a){if(null===h)return void(null!==_&&(e[T+1]=_));if(h===e[T+1])return void(e[T+2]=_)}T++,null!==h&&T++,null!==_&&T++}-1!==F&&(e.splice(F,0,i),T=F+1),e.splice(T++,0,a),null!==h&&e.splice(T++,0,h),null!==_&&e.splice(T++,0,_)}const Hi="ng-template";function hi(e,i,a){let h=0,_=!0;for(;h<e.length;){let T=e[h++];if("string"==typeof T&&_){const F=e[h++];if(a&&"class"===T&&-1!==nr(F.toLowerCase(),i,0))return!0}else{if(1===T){for(;h<e.length&&"string"==typeof(T=e[h++]);)if(T.toLowerCase()===i)return!0;return!1}"number"==typeof T&&(_=!1)}}return!1}function Uo(e){return 4===e.type&&e.value!==Hi}function mo(e,i,a){return i===(4!==e.type||a?e.value:Hi)}function lo(e,i,a){let h=4;const _=e.attrs||[],T=function ir(e){for(let i=0;i<e.length;i++)if(Pr(e[i]))return i;return e.length}(_);let F=!1;for(let j=0;j<i.length;j++){const q=i[j];if("number"!=typeof q){if(!F)if(4&h){if(h=2|1&h,""!==q&&!mo(e,q,a)||""===q&&1===i.length){if(Vi(h))return!1;F=!0}}else{const ce=8&h?q:i[++j];if(8&h&&null!==e.attrs){if(!hi(e.attrs,ce,a)){if(Vi(h))return!1;F=!0}continue}const Be=us(8&h?"class":q,_,Uo(e),a);if(-1===Be){if(Vi(h))return!1;F=!0;continue}if(""!==ce){let ct;ct=Be>T?"":_[Be+1].toLowerCase();const _t=8&h?ct:null;if(_t&&-1!==nr(_t,ce,0)||2&h&&ce!==ct){if(Vi(h))return!1;F=!0}}}}else{if(!F&&!Vi(h)&&!Vi(q))return!1;if(F&&Vi(q))continue;F=!1,h=q|1&h}}return Vi(h)||F}function Vi(e){return 0==(1&e)}function us(e,i,a,h){if(null===i)return-1;let _=0;if(h||!a){let T=!1;for(;_<i.length;){const F=i[_];if(F===e)return _;if(3===F||6===F)T=!0;else{if(1===F||2===F){let j=i[++_];for(;"string"==typeof j;)j=i[++_];continue}if(4===F)break;if(0===F){_+=4;continue}}_+=T?1:2}return-1}return function Ts(e,i){let a=e.indexOf(4);if(a>-1)for(a++;a<e.length;){const h=e[a];if("number"==typeof h)return-1;if(h===i)return a;a++}return-1}(i,e)}function ds(e,i,a=!1){for(let h=0;h<i.length;h++)if(lo(e,i[h],a))return!0;return!1}function da(e,i){e:for(let a=0;a<i.length;a++){const h=i[a];if(e.length===h.length){for(let _=0;_<e.length;_++)if(e[_]!==h[_])continue e;return!0}}return!1}function Ss(e,i){return e?":not("+i.trim()+")":i}function io(e){let i=e[0],a=1,h=2,_="",T=!1;for(;a<e.length;){let F=e[a];if("string"==typeof F)if(2&h){const j=e[++a];_+="["+F+(j.length>0?'="'+j+'"':"")+"]"}else 8&h?_+="."+F:4&h&&(_+=" "+F);else""!==_&&!Vi(F)&&(i+=Ss(T,_),_=""),h=F,T=T||!Vi(h);a++}return""!==_&&(i+=Ss(T,_)),i}function Ta(e){return sn(()=>{const i=Ms(e),a={...i,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Cn.OnPush,directiveDefs:null,pipeDefs:null,dependencies:i.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||Fn.Emulated,styles:e.styles||Oe,_:null,schemas:e.schemas||null,tView:null,id:""};ks(a);const h=e.dependencies;return a.directiveDefs=Gs(h,!1),a.pipeDefs=Gs(h,!0),a.id=function Fs(e){let i=0;const a=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(const _ of a)i=Math.imul(31,i)+_.charCodeAt(0)<<0;return i+=2147483648,"c"+i}(a),a})}function Sa(e){return dr(e)||$r(e)}function Qs(e){return null!==e}function $s(e){return sn(()=>({type:e.type,bootstrap:e.bootstrap||Oe,declarations:e.declarations||Oe,imports:e.imports||Oe,exports:e.exports||Oe,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function Ya(e,i){if(null==e)return ut;const a={};for(const h in e)if(e.hasOwnProperty(h)){let _=e[h],T=_;Array.isArray(_)&&(T=_[1],_=_[0]),a[_]=h,i&&(i[_]=T)}return a}function Ma(e){return sn(()=>{const i=Ms(e);return ks(i),i})}function dl(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,standalone:!0===e.standalone,onDestroy:e.type.prototype.ngOnDestroy||null}}function dr(e){return e[Ge]||null}function $r(e){return e[Gt]||null}function bo(e){return e[tn]||null}function xo(e){const i=dr(e)||$r(e)||bo(e);return null!==i&&i.standalone}function Po(e,i){const a=e[Wt]||null;if(!a&&!0===i)throw new Error(`Type ${Tn(e)} does not have '\u0275mod' property.`);return a}function Ms(e){const i={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:i,inputTransforms:null,inputConfig:e.inputs||ut,exportAs:e.exportAs||null,standalone:!0===e.standalone,signals:!0===e.signals,selectors:e.selectors||Oe,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Ya(e.inputs,i),outputs:Ya(e.outputs)}}function ks(e){e.features?.forEach(i=>i(e))}function Gs(e,i){if(!e)return null;const a=i?bo:Sa;return()=>("function"==typeof e?e():e).map(h=>a(h)).filter(Qs)}const rr=0,Ln=1,ai=2,Fi=3,ro=4,$i=5,Zr=6,fs=7,zr=8,Gr=9,Ni=10,Ei=11,ns=12,As=13,ps=14,yr=15,ha=16,fa=17,Zo=18,hl=19,Aa=20,jo=21,co=22,Ls=23,Ia=24,Ui=25,pa=1,Dl=2,uo=7,Er=9,ho=11;function Bo(e){return Array.isArray(e)&&"object"==typeof e[pa]}function wi(e){return Array.isArray(e)&&!0===e[pa]}function ga(e){return 0!=(4&e.flags)}function Oa(e){return e.componentOffset>-1}function Pa(e){return 1==(1&e.flags)}function Ho(e){return!!e.template}function Cl(e){return 0!=(512&e[ai])}function Tl(e,i){return e.hasOwnProperty(cn)?e[cn]:null}let gc=Rn.WeakRef??class pc{constructor(i){this.ref=i}deref(){return this.ref}},ma=0,Do=null,Wl=!1;function Qr(e){const i=Do;return Do=e,i}class Sl{constructor(){this.id=ma++,this.ref=function Na(e){return new gc(e)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[i,a]of this.producers){const h=a.producerNode.deref();if(void 0!==h&&a.atTrackingVersion===this.trackingVersion){if(h.producerPollStatus(a.seenValueVersion))return!0}else this.producers.delete(i),h?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const i=Wl;Wl=!0;try{for(const[a,h]of this.consumers){const _=h.consumerNode.deref();void 0!==_&&_.trackingVersion===h.atTrackingVersion?_.onConsumerDependencyMayHaveChanged():(this.consumers.delete(a),_?.producers.delete(this.id))}}finally{Wl=i}}producerAccessed(){if(Wl)throw new Error("");if(null===Do)return;let i=Do.producers.get(this.id);void 0===i?(i={consumerNode:Do.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Do.trackingVersion},Do.producers.set(this.id,i),this.consumers.set(Do.id,i)):(i.seenValueVersion=this.valueVersion,i.atTrackingVersion=Do.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Do?.consumerAllowSignalWrites}producerPollStatus(i){return this.valueVersion!==i||(this.onProducerUpdateValueVersion(),this.valueVersion!==i)}}let Al=null;function Zl(e){const i=Qr(null);try{return e()}finally{Qr(i)}}const po=()=>{};class Fa extends Sl{constructor(i,a,h){super(),this.watch=i,this.schedule=a,this.dirty=!1,this.cleanupFn=po,this.registerOnCleanup=_=>{this.cleanupFn=_},this.consumerAllowSignalWrites=h}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const i=Qr(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=po,this.watch(this.registerOnCleanup)}finally{Qr(i)}}cleanup(){this.cleanupFn()}}class rd{constructor(i,a,h){this.previousValue=i,this.currentValue=a,this.firstChange=h}isFirstChange(){return this.firstChange}}function Yl(){return uu}function uu(e){return e.type.prototype.ngOnChanges&&(e.setInput=_c),Il}function Il(){const e=Xn(this),i=e?.current;if(i){const a=e.previous;if(a===ut)e.previous=i;else for(let h in i)a[h]=i[h];e.current=null,this.ngOnChanges(i)}}function _c(e,i,a,h){const _=this.declaredInputs[a],T=Xn(e)||function Vc(e,i){return e[ra]=i}(e,{previous:ut,current:null}),F=T.current||(T.current={}),j=T.previous,q=j[_];F[_]=new rd(q&&q.currentValue,i,j===ut),e[h]=i}Yl.ngInherit=!0;const ra="__ngSimpleChanges__";function Xn(e){return e[ra]||null}const rs=function(e,i,a){};function K(e){for(;Array.isArray(e);)e=e[rr];return e}function He(e,i){return K(i[e])}function St(e,i){return K(i[e.index])}function ni(e,i){return e.data[i]}function sr(e,i){return e[i]}function Ri(e,i){const a=i[e];return Bo(a)?a:a[rr]}function Ii(e,i){return null==i?null:e[i]}function Vr(e){e[fa]=0}function eo(e){1024&e[ai]||(e[ai]|=1024,oa(e,1))}function Ps(e){1024&e[ai]&&(e[ai]&=-1025,oa(e,-1))}function oa(e,i){let a=e[Fi];if(null===a)return;a[$i]+=i;let h=a;for(a=a[Fi];null!==a&&(1===i&&1===h[$i]||-1===i&&0===h[$i]);)a[$i]+=i,h=a,a=a[Fi]}const Nn={lFrame:n(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function du(){return Nn.bindingsEnabled}function Zs(){return null!==Nn.skipHydrationRootTNode}function dn(){return Nn.lFrame.lView}function qi(){return Nn.lFrame.tView}function Fr(e){return Nn.lFrame.contextLView=e,e[zr]}function od(e){return Nn.lFrame.contextLView=null,e}function qr(){let e=Kl();for(;null!==e&&64===e.type;)e=e.parent;return e}function Kl(){return Nn.lFrame.currentTNode}function Yo(){const e=Nn.lFrame,i=e.currentTNode;return e.isParent?i:i.parent}function Ar(e,i){const a=Nn.lFrame;a.currentTNode=e,a.isParent=i}function yo(){return Nn.lFrame.isParent}function vs(){Nn.lFrame.isParent=!1}function Eo(){const e=Nn.lFrame;let i=e.bindingRootIndex;return-1===i&&(i=e.bindingRootIndex=e.tView.bindingStartIndex),i}function os(){return Nn.lFrame.bindingIndex++}function bs(e){const i=Nn.lFrame,a=i.bindingIndex;return i.bindingIndex=i.bindingIndex+e,a}function Pl(e){Nn.lFrame.inI18n=e}function Bs(e,i){const a=Nn.lFrame;a.bindingIndex=a.bindingRootIndex=e,ml(i)}function ml(e){Nn.lFrame.currentDirectiveIndex=e}function _a(){return Nn.lFrame.currentQueryIndex}function Va(e){Nn.lFrame.currentQueryIndex=e}function fu(e){const i=e[Ln];return 2===i.type?i.declTNode:1===i.type?e[Zr]:null}function Nl(e,i,a){if(a&qn.SkipSelf){let _=i,T=e;for(;!(_=_.parent,null!==_||a&qn.Host||(_=fu(T),null===_||(T=T[ps],10&_.type))););if(null===_)return!1;i=_,e=T}const h=Nn.lFrame=w();return h.currentTNode=i,h.lView=e,!0}function Xl(e){const i=w(),a=e[Ln];Nn.lFrame=i,i.currentTNode=a.firstChild,i.lView=e,i.tView=a,i.contextLView=e,i.bindingIndex=a.bindingStartIndex,i.inI18n=!1}function w(){const e=Nn.lFrame,i=null===e?null:e.child;return null===i?n(e):i}function n(e){const i={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=i),i}function d(){const e=Nn.lFrame;return Nn.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const y=d;function C(){const e=d();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function Z(){return Nn.lFrame.selectedIndex}function Y(e){Nn.lFrame.selectedIndex=e}function X(){const e=Nn.lFrame;return ni(e.tView,e.selectedIndex)}let R=!0;function k(){return R}function O(e){R=e}function W(e,i){for(let a=i.directiveStart,h=i.directiveEnd;a<h;a++){const T=e.data[a].type.prototype,{ngAfterContentInit:F,ngAfterContentChecked:j,ngAfterViewInit:q,ngAfterViewChecked:ce,ngOnDestroy:Ce}=T;F&&(e.contentHooks??=[]).push(-a,F),j&&((e.contentHooks??=[]).push(a,j),(e.contentCheckHooks??=[]).push(a,j)),q&&(e.viewHooks??=[]).push(-a,q),ce&&((e.viewHooks??=[]).push(a,ce),(e.viewCheckHooks??=[]).push(a,ce)),null!=Ce&&(e.destroyHooks??=[]).push(a,Ce)}}function ie(e,i,a){et(e,i,3,a)}function ue(e,i,a,h){(3&e[ai])===a&&et(e,i,a,h)}function Ne(e,i){let a=e[ai];(3&a)===i&&(a&=8191,a+=1,e[ai]=a)}function et(e,i,a,h){const T=h??-1,F=i.length-1;let j=0;for(let q=void 0!==h?65535&e[fa]:0;q<F;q++)if("number"==typeof i[q+1]){if(j=i[q],null!=h&&j>=h)break}else i[q]<0&&(e[fa]+=65536),(j<T||-1==T)&&(vt(e,a,i,q),e[fa]=(4294901760&e[fa])+q+2),q++}function Mt(e,i){rs(4,e,i);const a=Qr(null);try{i.call(e)}finally{Qr(a),rs(5,e,i)}}function vt(e,i,a,h){const _=a[h]<0,T=a[h+1],j=e[_?-a[h]:a[h]];_?e[ai]>>13<e[fa]>>16&&(3&e[ai])===i&&(e[ai]+=8192,Mt(j,T)):Mt(j,T)}const on=-1;class Hn{constructor(i,a,h){this.factory=i,this.resolving=!1,this.canSeeViewProviders=a,this.injectImpl=h}}function Kr(e){return e!==on}function xs(e){return 32767&e}function ar(e,i){let a=function No(e){return e>>16}(e),h=i;for(;a>0;)h=h[ps],a--;return h}let qs=!0;function sa(e){const i=qs;return qs=e,i}const ci=255,Xa=5;let yl=0;const vo={};function br(e,i){const a=$o(e,i);if(-1!==a)return a;const h=i[Ln];h.firstCreatePass&&(e.injectorIndex=i.length,Ro(h.data,e),Ro(i,null),Ro(h.blueprint,null));const _=Cr(e,i),T=e.injectorIndex;if(Kr(_)){const F=xs(_),j=ar(_,i),q=j[Ln].data;for(let ce=0;ce<8;ce++)i[T+ce]=j[F+ce]|q[F+ce]}return i[T+8]=_,T}function Ro(e,i){e.push(0,0,0,0,0,0,0,0,i)}function $o(e,i){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===i[e.injectorIndex+8]?-1:e.injectorIndex}function Cr(e,i){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let a=0,h=null,_=i;for(;null!==_;){if(h=Hd(_),null===h)return on;if(a++,_=_[ps],-1!==h.injectorIndex)return h.injectorIndex|a<<16}return on}function So(e,i,a){!function qo(e,i,a){let h;"string"==typeof a?h=a.charCodeAt(0)||0:a.hasOwnProperty(Zi)&&(h=a[Zi]),null==h&&(h=a[Zi]=yl++);const _=h&ci;i.data[e+(_>>Xa)]|=1<<_}(e,i,a)}function Gc(e,i,a){if(a&qn.Optional||void 0!==e)return e;Jt()}function vl(e,i,a,h){if(a&qn.Optional&&void 0===h&&(h=null),!(a&(qn.Self|qn.Host))){const _=e[Gr],T=Qt(void 0);try{return _?_.get(i,h,a&qn.Optional):mr(i,h,a&qn.Optional)}finally{Qt(T)}}return Gc(h,0,a)}function sd(e,i,a,h=qn.Default,_){if(null!==e){if(2048&i[ai]&&!(h&qn.Self)){const F=function tp(e,i,a,h,_){let T=e,F=i;for(;null!==T&&null!==F&&2048&F[ai]&&!(512&F[ai]);){const j=ku(T,F,a,h|qn.Self,vo);if(j!==vo)return j;let q=T.parent;if(!q){const ce=F[Aa];if(ce){const Ce=ce.get(a,vo,h);if(Ce!==vo)return Ce}q=Hd(F),F=F[ps]}T=q}return _}(e,i,a,h,vo);if(F!==vo)return F}const T=ku(e,i,a,h,vo);if(T!==vo)return T}return vl(i,a,h,_)}function ku(e,i,a,h,_){const T=function Rl(e){if("string"==typeof e)return e.charCodeAt(0)||0;const i=e.hasOwnProperty(Zi)?e[Zi]:void 0;return"number"==typeof i?i>=0?i&ci:kl:i}(a);if("function"==typeof T){if(!Nl(i,e,h))return h&qn.Host?Gc(_,0,h):vl(i,a,h,_);try{const F=T(h);if(null!=F||h&qn.Optional)return F;Jt()}finally{y()}}else if("number"==typeof T){let F=null,j=$o(e,i),q=on,ce=h&qn.Host?i[yr][Zr]:null;for((-1===j||h&qn.SkipSelf)&&(q=-1===j?Cr(e,i):i[j+8],q!==on&&ad(h,!1)?(F=i[Ln],j=xs(q),i=ar(q,i)):j=-1);-1!==j;){const Ce=i[Ln];if(Wc(T,j,Ce.data)){const Be=oo(j,i,a,F,h,ce);if(Be!==vo)return Be}q=i[j+8],q!==on&&ad(h,i[Ln].data[j+8]===ce)&&Wc(T,j,i)?(F=Ce,j=xs(q),i=ar(q,i)):j=-1}}return _}function oo(e,i,a,h,_,T){const F=i[Ln],j=F.data[e+8],Ce=ya(j,F,a,null==h?Oa(j)&&qs:h!=F&&0!=(3&j.type),_&qn.Host&&T===j);return null!==Ce?aa(i,F,Ce,j):vo}function ya(e,i,a,h,_){const T=e.providerIndexes,F=i.data,j=1048575&T,q=e.directiveStart,Ce=T>>20,ct=_?j+Ce:e.directiveEnd;for(let _t=h?j:j+Ce;_t<ct;_t++){const an=F[_t];if(_t<q&&a===an||_t>=q&&an.type===a)return _t}if(_){const _t=F[q];if(_t&&Ho(_t)&&_t.type===a)return q}return null}function aa(e,i,a,h){let _=e[a];const T=i.data;if(function Pi(e){return e instanceof Hn}(_)){const F=_;F.resolving&&function bn(e,i){const a=i?`. Dependency path: ${i.join(" > ")} > ${e}`:"";throw new lt(-200,`Circular dependency in DI detected for ${e}${a}`)}(function xt(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():nt(e)}(T[a]));const j=sa(F.canSeeViewProviders);F.resolving=!0;const q=F.injectImpl?Qt(F.injectImpl):null;Nl(e,h,qn.Default);try{_=e[a]=F.factory(void 0,T,e,h),i.firstCreatePass&&a>=h.directiveStart&&function z(e,i,a){const{ngOnChanges:h,ngOnInit:_,ngDoCheck:T}=i.type.prototype;if(h){const F=uu(i);(a.preOrderHooks??=[]).push(e,F),(a.preOrderCheckHooks??=[]).push(e,F)}_&&(a.preOrderHooks??=[]).push(0-e,_),T&&((a.preOrderHooks??=[]).push(e,T),(a.preOrderCheckHooks??=[]).push(e,T))}(a,T[a],i)}finally{null!==q&&Qt(q),sa(j),F.resolving=!1,y()}}return _}function Wc(e,i,a){return!!(a[i+(e>>Xa)]&1<<e)}function ad(e,i){return!(e&qn.Self||e&qn.Host&&i)}class Zc{constructor(i,a){this._tNode=i,this._lView=a}get(i,a,h){return sd(this._tNode,this._lView,i,Se(h),a)}}function kl(){return new Zc(qr(),dn())}function yf(e){return sn(()=>{const i=e.prototype.constructor,a=i[cn]||jd(i),h=Object.prototype;let _=Object.getPrototypeOf(e.prototype).constructor;for(;_&&_!==h;){const T=_[cn]||jd(_);if(T&&T!==a)return T;_=Object.getPrototypeOf(_)}return T=>new T})}function jd(e){return Tt(e)?()=>{const i=jd(Vt(e));return i&&i()}:Tl(e)}function Hd(e){const i=e[Ln],a=i.type;return 2===a?i.declTNode:1===a?e[Zr]:null}function $d(e){return function ws(e,i){if("class"===i)return e.classes;if("style"===i)return e.styles;const a=e.attrs;if(a){const h=a.length;let _=0;for(;_<h;){const T=a[_];if(Pr(T))break;if(0===T)_+=2;else if("number"==typeof T)for(_++;_<h&&"string"==typeof a[_];)_++;else{if(T===i)return a[_+1];_+=2}}}return null}(qr(),e)}const Yc="__parameters__";function Ja(e,i,a){return sn(()=>{const h=function Sh(e){return function(...a){if(e){const h=e(...a);for(const _ in h)this[_]=h[_]}}}(i);function _(...T){if(this instanceof _)return h.apply(this,T),this;const F=new _(...T);return j.annotation=F,j;function j(q,ce,Ce){const Be=q.hasOwnProperty(Yc)?q[Yc]:Object.defineProperty(q,Yc,{value:[]})[Yc];for(;Be.length<=Ce;)Be.push(null);return(Be[Ce]=Be[Ce]||[]).push(F),q}}return a&&(_.prototype=Object.create(a.prototype)),_.prototype.ngMetadataName=e,_.annotationCls=_,_})}function gu(e,i){e.forEach(a=>Array.isArray(a)?gu(a,i):i(a))}function Mh(e,i,a){i>=e.length?e.push(a):e.splice(i,0,a)}function Fu(e,i){return i>=e.length-1?e.pop():e.splice(i,1)[0]}function Xc(e,i){const a=[];for(let h=0;h<e;h++)a.push(i);return a}function Go(e,i,a){let h=el(e,i);return h>=0?e[1|h]=a:(h=~h,function Zd(e,i,a,h){let _=e.length;if(_==i)e.push(a,h);else if(1===_)e.push(h,e[0]),e[0]=a;else{for(_--,e.push(e[_-1],e[_]);_>i;)e[_]=e[_-2],_--;e[i]=a,e[i+1]=h}}(e,h,i,a)),h}function Mo(e,i){const a=el(e,i);if(a>=0)return e[1|a]}function el(e,i){return function dd(e,i,a){let h=0,_=e.length>>a;for(;_!==h;){const T=h+(_-h>>1),F=e[T<<a];if(i===F)return T<<a;F>i?_=T:h=T+1}return~(_<<a)}(e,i,1)}const Lu=Xe(Ja("Optional"),8),ja=Xe(Ja("SkipSelf"),4);function yd(e){return 128==(128&e.flags)}var xl=(()=>((xl=xl||{})[xl.Important=1]="Important",xl[xl.DashCase=2]="DashCase",xl))();const up=/^>|^->|<!--|-->|--!>|<!-$/g,$u=/(<|>)/,Cf="\u200b$1\u200b";const zh=new Map;let bd=0;const th="__ngContext__";function Ds(e,i){Bo(i)?(e[th]=i[hl],function eh(e){zh.set(e[hl],e)}(i)):e[th]=i}let xd;function Ur(e,i){return xd(e,i)}function eu(e){const i=e[Fi];return wi(i)?i[Fi]:i}function Cc(e){return wd(e[ns])}function Sf(e){return wd(e[ro])}function wd(e){for(;null!==e&&!wi(e);)e=e[ro];return e}function Ha(e,i,a,h,_){if(null!=h){let T,F=!1;wi(h)?T=h:Bo(h)&&(F=!0,h=h[rr]);const j=K(h);0===e&&null!==a?null==_?Af(i,a,j):ic(i,a,j,_||null,!0):1===e&&null!==a?ic(i,a,j,_||null,!0):2===e?function Ku(e,i,a){const h=Ec(e,i);h&&function oh(e,i,a,h){e.removeChild(i,a,h)}(e,h,i,a)}(i,j,F):3===e&&i.destroyNode(j),null!=T&&function nf(e,i,a,h,_){const T=a[uo];T!==K(a)&&Ha(i,e,h,T,_);for(let j=ho;j<a.length;j++){const q=a[j];Sc(q[Ln],q,e,i,h,T)}}(i,e,T,a,_)}}function Ll(e,i){return e.createText(i)}function Kh(e,i){return e.createComment(function Bh(e){return e.replace(up,i=>i.replace($u,Cf))}(i))}function Xh(e,i,a){return e.createElement(i,a)}function Yu(e,i){const a=e[Er],h=a.indexOf(i);Ps(i),a.splice(h,1)}function Cd(e,i){if(e.length<=ho)return;const a=ho+i,h=e[a];if(h){const _=h[ha];null!==_&&_!==e&&Yu(_,h),i>0&&(e[a-1][ro]=h[ro]);const T=Fu(e,ho+i);!function Mf(e,i){Sc(e,i,i[Ei],2,null,null),i[rr]=null,i[Zr]=null}(h[Ln],h);const F=T[Zo];null!==F&&F.detachView(T[Ln]),h[Fi]=null,h[ro]=null,h[ai]&=-129}return h}function fp(e,i){if(!(256&i[ai])){const a=i[Ei];i[Ls]?.destroy(),i[Ia]?.destroy(),a.destroyNode&&Sc(e,i,a,3,null,null),function Dd(e){let i=e[ns];if(!i)return Qh(e[Ln],e);for(;i;){let a=null;if(Bo(i))a=i[ns];else{const h=i[ho];h&&(a=h)}if(!a){for(;i&&!i[ro]&&i!==e;)Bo(i)&&Qh(i[Ln],i),i=i[Fi];null===i&&(i=e),Bo(i)&&Qh(i[Ln],i),a=i&&i[ro]}i=a}}(i)}}function Qh(e,i){if(!(256&i[ai])){i[ai]&=-129,i[ai]|=256,function $a(e,i){let a;if(null!=e&&null!=(a=e.destroyHooks))for(let h=0;h<a.length;h+=2){const _=i[a[h]];if(!(_ instanceof Hn)){const T=a[h+1];if(Array.isArray(T))for(let F=0;F<T.length;F+=2){const j=_[T[F]],q=T[F+1];rs(4,j,q);try{q.call(j)}finally{rs(5,j,q)}}else{rs(4,_,T);try{T.call(_)}finally{rs(5,_,T)}}}}}(e,i),function pp(e,i){const a=e.cleanup,h=i[fs];if(null!==a)for(let T=0;T<a.length-1;T+=2)if("string"==typeof a[T]){const F=a[T+3];F>=0?h[F]():h[-F].unsubscribe(),T+=2}else a[T].call(h[a[T+1]]);null!==h&&(i[fs]=null);const _=i[jo];if(null!==_){i[jo]=null;for(let T=0;T<_.length;T++)(0,_[T])()}}(e,i),1===i[Ln].type&&i[Ei].destroy();const a=i[ha];if(null!==a&&wi(i[Fi])){a!==i[Fi]&&Yu(a,i);const h=i[Zo];null!==h&&h.detachView(e)}!function Ef(e){zh.delete(e[hl])}(i)}}function rh(e,i,a){return ba(e,i.parent,a)}function ba(e,i,a){let h=i;for(;null!==h&&40&h.type;)h=(i=h).parent;if(null===h)return a[rr];{const{componentOffset:_}=h;if(_>-1){const{encapsulation:T}=e.data[h.directiveStart+_];if(T===Fn.None||T===Fn.Emulated)return null}return St(h,a)}}function ic(e,i,a,h,_){e.insertBefore(i,a,h,_)}function Af(e,i,a){e.appendChild(i,a)}function tu(e,i,a,h,_){null!==h?ic(e,i,a,h,_):Af(e,i,a)}function Ec(e,i){return e.parentNode(i)}function Ed(e,i,a){return ah(e,i,a)}function Td(e,i,a){return 40&e.type?St(e,a):null}let wu,Xu,Eu,Od,ah=Td;function Tc(e,i){ah=e,wu=i}function qu(e,i,a,h){const _=rh(e,h,i),T=i[Ei],j=Ed(h.parent||i[Zr],h,i);if(null!=_)if(Array.isArray(a))for(let q=0;q<a.length;q++)tu(T,_,a[q],j,!1);else tu(T,_,a,j,!1);void 0!==wu&&wu(T,h,i,a,_)}function Du(e,i){if(null!==i){const a=i.type;if(3&a)return St(i,e);if(4&a)return Sd(-1,e[i.index]);if(8&a){const h=i.child;if(null!==h)return Du(e,h);{const _=e[i.index];return wi(_)?Sd(-1,_):K(_)}}if(32&a)return Ur(i,e)()||K(e[i.index]);{const h=lh(e,i);return null!==h?Array.isArray(h)?h[0]:Du(eu(e[yr]),h):Du(e,i.next)}}return null}function lh(e,i){return null!==i?e[yr][Zr].projection[i.projection]:null}function Sd(e,i){const a=ho+e+1;if(a<i.length){const h=i[a],_=h[Ln].firstChild;if(null!==_)return Du(h,_)}return i[uo]}function tf(e,i,a,h,_,T,F){for(;null!=a;){const j=h[a.index],q=a.type;if(F&&0===i&&(j&&Ds(K(j),h),a.flags|=2),32!=(32&a.flags))if(8&q)tf(e,i,a.child,h,_,T,!1),Ha(i,e,_,j,T);else if(32&q){const ce=Ur(a,h);let Ce;for(;Ce=ce();)Ha(i,e,_,Ce,T);Ha(i,e,_,j,T)}else 16&q?nu(e,i,h,a,_,T):Ha(i,e,_,j,T);a=F?a.projectionNext:a.next}}function Sc(e,i,a,h,_,T){tf(a,h,e.firstChild,i,_,T,!1)}function nu(e,i,a,h,_,T){const F=a[yr],q=F[Zr].projection[h.projection];if(Array.isArray(q))for(let ce=0;ce<q.length;ce++)Ha(i,e,_,q[ce],T);else{let ce=q;const Ce=F[Fi];yd(h)&&(ce.flags|=128),tf(e,i,ce,Ce,_,T,!0)}}function gp(e,i,a){""===a?e.removeAttribute(i,"class"):e.setAttribute(i,"class",a)}function ch(e,i,a){const{mergedAttrs:h,classes:_,styles:T}=a;null!==h&&ji(e,i,h),null!==_&&gp(e,i,_),null!==T&&function Up(e,i,a){e.setAttribute(i,"style",a)}(e,i,T)}function Cu(e){return function Of(){if(void 0===Xu&&(Xu=null,Rn.trustedTypes))try{Xu=Rn.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Xu}()?.createHTML(e)||e}function Ga(e){Eu=e}function Tu(){if(void 0!==Eu)return Eu;if(typeof document<"u")return document;throw new lt(210,!1)}function uh(e){return function sf(){if(void 0===Od&&(Od=null,Rn.trustedTypes))try{Od=Rn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Od}()?.createScriptURL(e)||e}class Rf{constructor(i){this.changingThisBreaksApplicationSecurity=i}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Bt})`}}function U(e){return e instanceof Rf?e.changingThisBreaksApplicationSecurity:e}function te(e,i){const a=function Fe(e){return e instanceof Rf&&e.getTypeName()||null}(e);if(null!=a&&a!==i){if("ResourceURL"===a&&"URL"===i)return!0;throw new Error(`Required a safe ${i}, got a ${a} (see ${Bt})`)}return a===i}class Wn{constructor(i){this.inertDocumentHelper=i}getInertBodyElement(i){i="<body><remove></remove>"+i;try{const a=(new window.DOMParser).parseFromString(Cu(i),"text/html").body;return null===a?this.inertDocumentHelper.getInertBodyElement(i):(a.removeChild(a.firstChild),a)}catch{return null}}}class Tr{constructor(i){this.defaultDoc=i,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(i){const a=this.inertDocument.createElement("template");return a.innerHTML=Cu(i),a}}const Ji=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function xr(e){return(e=String(e)).match(Ji)?e:"unsafe:"+e}function Gi(e){const i={};for(const a of e.split(","))i[a]=!0;return i}function no(...e){const i={};for(const a of e)for(const h in a)a.hasOwnProperty(h)&&(i[h]=!0);return i}const hr=Gi("area,br,col,hr,img,wbr"),Or=Gi("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Qi=Gi("rp,rt"),Jo=no(hr,no(Or,Gi("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),no(Qi,Gi("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),no(Qi,Or)),Vs=Gi("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),tl=no(Vs,Gi("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Gi("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext"));var ko=(()=>((ko=ko||{})[ko.NONE=0]="NONE",ko[ko.HTML=1]="HTML",ko[ko.STYLE=2]="STYLE",ko[ko.SCRIPT=3]="SCRIPT",ko[ko.URL=4]="URL",ko[ko.RESOURCE_URL=5]="RESOURCE_URL",ko))();function Ju(e){const i=Mu();return i?i.sanitize(ko.URL,e)||"":te(e,"URL")?U(e):xr(nt(e))}function sc(e){const i=Mu();if(i)return uh(i.sanitize(ko.RESOURCE_URL,e)||"");if(te(e,"ResourceURL"))return uh(U(e));throw new lt(904,!1)}function hh(e,i,a){return function _p(e,i){return"src"===i&&("embed"===e||"frame"===e||"iframe"===e||"media"===e||"script"===e)||"href"===i&&("base"===e||"link"===e)?sc:Ju}(i,a)(e)}function Mu(){const e=dn();return e&&e[Ni].sanitizer}class wr{constructor(i,a){this._desc=i,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof a?this.__NG_ELEMENT_ID__=a:void 0!==a&&(this.\u0275prov=An({token:this,providedIn:a.providedIn||"root",factory:a.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const Au=new wr("ENVIRONMENT_INITIALIZER"),Ac=new wr("INJECTOR",-1),ac=new wr("INJECTOR_DEF_TYPES");class ru{get(i,a=Ai){if(a===Ai){const h=new Error(`NullInjectorError: No provider for ${Tn(i)}!`);throw h.name="NullInjectorError",h}return a}}function ou(e){return{\u0275providers:e}}function fh(...e){return{\u0275providers:Qu(0,e),\u0275fromNgModule:!0}}function Qu(e,...i){const a=[],h=new Set;let _;return gu(i,T=>{const F=T;ph(F,a,[],h)&&(_||=[],_.push(F))}),void 0!==_&&Iu(_,a),a}function Iu(e,i){for(let a=0;a<e.length;a++){const{providers:_}=e[a];t(_,T=>{i.push(T)})}}function ph(e,i,a,h){if(!(e=Vt(e)))return!1;let _=null,T=jn(e);const F=!T&&dr(e);if(T||F){if(F&&!F.standalone)return!1;_=e}else{const q=e.ngModule;if(T=jn(q),!T)return!1;_=q}const j=h.has(_);if(F){if(j)return!1;if(h.add(_),F.dependencies){const q="function"==typeof F.dependencies?F.dependencies():F.dependencies;for(const ce of q)ph(ce,i,a,h)}}else{if(!T)return!1;{if(null!=T.imports&&!j){let ce;h.add(_);try{gu(T.imports,Ce=>{ph(Ce,i,a,h)&&(ce||=[],ce.push(Ce))})}finally{}void 0!==ce&&Iu(ce,i)}if(!j){const ce=Tl(_)||(()=>new _);i.push({provide:_,useFactory:ce,deps:Oe},{provide:ac,useValue:_,multi:!0},{provide:Au,useValue:()=>we(_),multi:!0})}const q=T.providers;null==q||j||t(q,Ce=>{i.push(Ce)})}}return _!==e&&void 0!==e.providers}function t(e,i){for(let a of e)wt(a)&&(a=a.\u0275providers),Array.isArray(a)?t(a,i):i(a)}const c=dt({provide:String,useValue:dt});function g(e){return null!==e&&"object"==typeof e&&c in e}function P(e){return"function"==typeof e}const $=new wr("Set Injector scope."),ee={},se={};let fe;function ve(){return void 0===fe&&(fe=new ru),fe}class xe{}class Te extends xe{get destroyed(){return this._destroyed}constructor(i,a,h,_){super(),this.parent=a,this.source=h,this.scopes=_,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Jn(i,F=>this.processProvider(F)),this.records.set(Ac,Je(void 0,this)),_.has("environment")&&this.records.set(xe,Je(void 0,this));const T=this.records.get($);null!=T&&"string"==typeof T.value&&this.scopes.add(T.value),this.injectorDefTypes=new Set(this.get(ac.multi,Oe,qn.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const a of this._ngOnDestroyHooks)a.ngOnDestroy();const i=this._onDestroyHooks;this._onDestroyHooks=[];for(const a of i)a()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(i){return this.assertNotDestroyed(),this._onDestroyHooks.push(i),()=>this.removeOnDestroy(i)}runInContext(i){this.assertNotDestroyed();const a=Ve(this),h=Qt(void 0);try{return i()}finally{Ve(a),Qt(h)}}get(i,a=Ai,h=qn.Default){if(this.assertNotDestroyed(),i.hasOwnProperty(Qn))return i[Qn](this);h=Se(h);const _=Ve(this),T=Qt(void 0);try{if(!(h&qn.SkipSelf)){let j=this.records.get(i);if(void 0===j){const q=function Xt(e){return"function"==typeof e||"object"==typeof e&&e instanceof wr}(i)&&Ot(i);j=q&&this.injectableDefInScope(q)?Je(je(i),ee):null,this.records.set(i,j)}if(null!=j)return this.hydrate(i,j)}return(h&qn.Self?ve():this.parent).get(i,a=h&qn.Optional&&a===Ai?null:a)}catch(F){if("NullInjectorError"===F.name){if((F[si]=F[si]||[]).unshift(Tn(i)),_)throw F;return function mn(e,i,a,h){const _=e[si];throw i[he]&&_.unshift(i[he]),e.message=function wn(e,i,a,h=null){e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.slice(2):e;let _=Tn(i);if(Array.isArray(i))_=i.map(Tn).join(" -> ");else if("object"==typeof i){let T=[];for(let F in i)if(i.hasOwnProperty(F)){let j=i[F];T.push(F+":"+("string"==typeof j?JSON.stringify(j):Tn(j)))}_=`{${T.join(", ")}}`}return`${a}${h?"("+h+")":""}[${_}]: ${e.replace(Vo,"\n  ")}`}("\n"+e.message,_,a,h),e.ngTokenPath=_,e[si]=null,e}(F,i,"R3InjectorError",this.source)}throw F}finally{Qt(T),Ve(_)}}resolveInjectorInitializers(){const i=Ve(this),a=Qt(void 0);try{const h=this.get(Au.multi,Oe,qn.Self);for(const _ of h)_()}finally{Ve(i),Qt(a)}}toString(){const i=[],a=this.records;for(const h of a.keys())i.push(Tn(h));return`R3Injector[${i.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new lt(205,!1)}processProvider(i){let a=P(i=Vt(i))?i:Vt(i&&i.provide);const h=function it(e){return g(e)?Je(void 0,e.useValue):Je(pt(e),ee)}(i);if(P(i)||!0!==i.multi)this.records.get(a);else{let _=this.records.get(a);_||(_=Je(void 0,ee,!0),_.factory=()=>Ye(_.multi),this.records.set(a,_)),a=i,_.multi.push(i)}this.records.set(a,h)}hydrate(i,a){return a.value===ee&&(a.value=se,a.value=a.factory()),"object"==typeof a.value&&a.value&&function At(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(a.value)&&this._ngOnDestroyHooks.add(a.value),a.value}injectableDefInScope(i){if(!i.providedIn)return!1;const a=Vt(i.providedIn);return"string"==typeof a?"any"===a||this.scopes.has(a):this.injectorDefTypes.has(a)}removeOnDestroy(i){const a=this._onDestroyHooks.indexOf(i);-1!==a&&this._onDestroyHooks.splice(a,1)}}function je(e){const i=Ot(e),a=null!==i?i.factory:Tl(e);if(null!==a)return a;if(e instanceof wr)throw new lt(204,!1);if(e instanceof Function)return function Ue(e){const i=e.length;if(i>0)throw Xc(i,"?"),new lt(204,!1);const a=function Yt(e){return e&&(e[at]||e[yn])||null}(e);return null!==a?()=>a.factory(e):()=>new e}(e);throw new lt(204,!1)}function pt(e,i,a){let h;if(P(e)){const _=Vt(e);return Tl(_)||je(_)}if(g(e))h=()=>Vt(e.useValue);else if(function M(e){return!(!e||!e.useFactory)}(e))h=()=>e.useFactory(...Ye(e.deps||[]));else if(function D(e){return!(!e||!e.useExisting)}(e))h=()=>we(Vt(e.useExisting));else{const _=Vt(e&&(e.useClass||e.provide));if(!function Ct(e){return!!e.deps}(e))return Tl(_)||je(_);h=()=>new _(...Ye(e.deps))}return h}function Je(e,i,a=!1){return{factory:e,value:i,multi:a?[]:void 0}}function Jn(e,i){for(const a of e)Array.isArray(a)?Jn(a,i):a&&wt(a)?Jn(a.\u0275providers,i):i(a)}const ei=new wr("AppId",{providedIn:"root",factory:()=>$n}),$n="ng",kn=new wr("Platform Initializer"),In=new wr("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),_n=new wr("CSP nonce",{providedIn:"root",factory:()=>Tu().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Wo=(e,i)=>null;function sl(e,i){return Wo(e,i)}class uf{}class Bf{}class vp{resolveComponentFactory(i){throw function df(e){const i=Error(`No component factory found for ${Tn(e)}.`);return i.ngComponent=e,i}(i)}}let hf=(()=>{class e{}return e.NULL=new vp,e})();function jp(){return gh(qr(),dn())}function gh(e,i){return new mh(St(e,i))}let mh=(()=>{class e{constructor(a){this.nativeElement=a}}return e.__NG_ELEMENT_ID__=jp,e})();function Hp(e){return e instanceof mh?e.nativeElement:e}class $p{}let Gp=(()=>{class e{constructor(){this.destroyNode=null}}return e.__NG_ELEMENT_ID__=()=>function Wp(){const e=dn(),a=Ri(qr().index,e);return(Bo(a)?a:e)[Ei]}(),e})(),yg=(()=>{class e{}return e.\u0275prov=An({token:e,providedIn:"root",factory:()=>null}),e})();class Zp{constructor(i){this.full=i,this.major=i.split(".")[0],this.minor=i.split(".")[1],this.patch=i.split(".").slice(2).join(".")}}const Nc=new Zp("16.1.4"),Nd={};function _h(e){for(;e;){e[ai]|=64;const i=eu(e);if(Cl(e)&&!i)return e;e=i}return null}function Rd(e){return e.ngOriginalError}class au{constructor(){this._console=console}handleError(i){const a=this._findOriginalError(i);this._console.error("ERROR",i),a&&this._console.error("ORIGINAL ERROR",a)}_findOriginalError(i){let a=i&&Rd(i);for(;a&&Rd(a);)a=Rd(a);return a||null}}const im=new wr("",{providedIn:"root",factory:()=>!1});function kd(e){return e instanceof Function?e():e}class am extends Sl{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(i){this._lView=i}onConsumerDependencyMayHaveChanged(){_h(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(i,a,h){const _=Qr(this);this.trackingVersion++;try{i(a,h)}finally{Qr(_)}}destroy(){this.trackingVersion++}}let Yp=null;function qp(){return Yp??=new am,Yp}function lm(e,i){return e[i]??qp()}function Kp(e,i){const a=qp();a.hasReadASignal&&(e[i]=Yp,a.lView=e,Yp=new am)}const pr={};function cm(e){xg(qi(),dn(),Z()+e,!1)}function xg(e,i,a,h){if(!h)if(3==(3&i[ai])){const T=e.preOrderCheckHooks;null!==T&&ie(i,T,a)}else{const T=e.preOrderHooks;null!==T&&ue(i,T,0,a)}Y(a)}function pm(e,i=null,a=null,h){const _=Cg(e,i,a,h);return _.resolveInjectorInitializers(),_}function Cg(e,i=null,a=null,h,_=new Set){const T=[a||Oe,fh(e)];return h=h||("object"==typeof e?void 0:Tn(e)),new Te(T,i||ve(),h||null,_)}let yh=(()=>{class e{static create(a,h){if(Array.isArray(a))return pm({name:""},h,a,"");{const _=a.name??"";return pm({name:_},a.parent,a.providers,_)}}}return e.THROW_IF_NOT_FOUND=Ai,e.NULL=new ru,e.\u0275prov=An({token:e,providedIn:"any",factory:()=>we(Ac)}),e.__NG_ELEMENT_ID__=-1,e})();function zf(e,i=qn.Default){const a=dn();return null===a?we(e,i):sd(qr(),a,Vt(e),i)}function gm(){throw new Error("invalid")}function Xp(e,i,a,h,_,T,F,j,q,ce,Ce){const Be=i.blueprint.slice();return Be[rr]=_,Be[ai]=140|h,(null!==ce||e&&2048&e[ai])&&(Be[ai]|=2048),Vr(Be),Be[Fi]=Be[ps]=e,Be[zr]=a,Be[Ni]=F||e&&e[Ni],Be[Ei]=j||e&&e[Ei],Be[Gr]=q||e&&e[Gr]||null,Be[Zr]=T,Be[hl]=function Gu(){return bd++}(),Be[co]=Ce,Be[Aa]=ce,Be[yr]=2==i.type?e[yr]:Be,Be}function Vf(e,i,a,h,_){let T=e.data[i];if(null===T)T=Eg(e,i,a,h,_),function hu(){return Nn.lFrame.inI18n}()&&(T.flags|=32);else if(64&T.type){T.type=a,T.value=h,T.attrs=_;const F=Yo();T.injectorIndex=null===F?-1:F.injectorIndex}return Ar(T,!0),T}function Eg(e,i,a,h,_){const T=Kl(),F=yo(),q=e.data[i]=function S_(e,i,a,h,_,T){let F=i?i.injectorIndex:-1,j=0;return Zs()&&(j|=128),{type:a,index:h,insertBeforeIndex:null,injectorIndex:F,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:j,providerIndexes:0,value:_,attrs:T,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:i,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,F?T:T&&T.parent,a,i,h,_);return null===e.firstChild&&(e.firstChild=q),null!==T&&(F?null==T.child&&null!==q.parent&&(T.child=q):null===T.next&&(T.next=q,q.prev=T)),q}function xp(e,i,a,h){if(0===a)return-1;const _=i.length;for(let T=0;T<a;T++)i.push(h),e.blueprint.push(h),e.data.push(null);return _}function _m(e,i,a,h,_){const T=lm(i,Ls),F=Z(),j=2&h;try{if(Y(-1),j&&i.length>Ui&&xg(e,i,Ui,!1),rs(j?2:0,_),j)T.runInContext(a,h,_);else{const ce=Qr(null);try{a(h,_)}finally{Qr(ce)}}}finally{j&&null===i[Ls]&&Kp(i,Ls),Y(F),rs(j?3:1,_)}}function Tg(e,i,a){if(ga(i)){const h=Qr(null);try{const T=i.directiveEnd;for(let F=i.directiveStart;F<T;F++){const j=e.data[F];j.contentQueries&&j.contentQueries(1,a[F],F)}}finally{Qr(h)}}}function Sg(e,i,a){du()&&(function N_(e,i,a,h){const _=a.directiveStart,T=a.directiveEnd;Oa(a)&&function Tm(e,i,a){const h=St(i,e),_=ym(a);let F=16;a.signals?F=4096:a.onPush&&(F=64);const j=eg(e,Xp(e,_,null,F,h,i,null,e[Ni].rendererFactory.createRenderer(h,a),null,null,null));e[i.index]=j}(i,a,e.data[_+a.componentOffset]),e.firstCreatePass||br(a,i),Ds(h,i);const F=a.initialInputs;for(let j=_;j<T;j++){const q=e.data[j],ce=aa(i,e,j,a);Ds(ce,i),null!==F&&L_(0,j-_,ce,q,0,F),Ho(q)&&(Ri(a.index,i)[zr]=aa(i,e,j,a))}}(e,i,a,St(a,i)),64==(64&a.flags)&&Dm(e,i,a))}function Mg(e,i,a=St){const h=i.localNames;if(null!==h){let _=i.index+1;for(let T=0;T<h.length;T+=2){const F=h[T+1],j=-1===F?a(i,e):e[F];e[_++]=j}}}function ym(e){const i=e.tView;return null===i||i.incompleteFirstPass?e.tView=Ag(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):i}function Ag(e,i,a,h,_,T,F,j,q,ce,Ce){const Be=Ui+h,ct=Be+_,_t=function x_(e,i){const a=[];for(let h=0;h<i;h++)a.push(h<e?null:pr);return a}(Be,ct),an="function"==typeof ce?ce():ce;return _t[Ln]={type:e,blueprint:_t,template:a,queries:null,viewQuery:j,declTNode:i,data:_t.slice().fill(null,Be),bindingStartIndex:Be,expandoStartIndex:ct,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof T?T():T,pipeRegistry:"function"==typeof F?F():F,firstChild:null,schemas:q,consts:an,incompleteFirstPass:!1,ssrId:Ce}}let vm=e=>null;function bm(e,i,a,h){for(let _ in e)if(e.hasOwnProperty(_)){a=null===a?{}:a;const T=e[_];null===h?xm(a,i,_,T):h.hasOwnProperty(_)&&xm(a,i,h[_],T)}return a}function xm(e,i,a,h){e.hasOwnProperty(a)?e[a].push(i,h):e[a]=[i,h]}function Rc(e,i,a,h,_,T,F,j){const q=St(i,a);let Ce,ce=i.inputs;!j&&null!=ce&&(Ce=ce[h])?(Ng(e,a,Ce,h,_),Oa(i)&&function I_(e,i){const a=Ri(i,e);16&a[ai]||(a[ai]|=64)}(a,i.index)):3&i.type&&(h=function A_(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(h),_=null!=F?F(_,i.value||"",h):_,T.setProperty(q,h,_))}function Ig(e,i,a,h){if(du()){const _=null===h?null:{"":-1},T=function Cm(e,i){const a=e.directiveRegistry;let h=null,_=null;if(a)for(let T=0;T<a.length;T++){const F=a[T];if(ds(i,F.selectors,!1))if(h||(h=[]),Ho(F))if(null!==F.findHostDirectiveDefs){const j=[];_=_||new Map,F.findHostDirectiveDefs(F,j,_),h.unshift(...j,F),gf(e,i,j.length)}else h.unshift(F),gf(e,i,0);else _=_||new Map,F.findHostDirectiveDefs?.(F,h,_),h.push(F)}return null===h?null:[h,_]}(e,a);let F,j;null===T?F=j=null:[F,j]=T,null!==F&&wm(e,i,a,F,_,j),_&&function k_(e,i,a){if(i){const h=e.localNames=[];for(let _=0;_<i.length;_+=2){const T=a[i[_+1]];if(null==T)throw new lt(-301,!1);h.push(i[_],T)}}}(a,h,_)}a.mergedAttrs=tr(a.mergedAttrs,a.attrs)}function wm(e,i,a,h,_,T){for(let ce=0;ce<h.length;ce++)So(br(a,i),e,h[ce].type);!function F_(e,i,a){e.flags|=1,e.directiveStart=i,e.directiveEnd=i+a,e.providerIndexes=i}(a,e.data.length,h.length);for(let ce=0;ce<h.length;ce++){const Ce=h[ce];Ce.providersResolver&&Ce.providersResolver(Ce)}let F=!1,j=!1,q=xp(e,i,h.length,null);for(let ce=0;ce<h.length;ce++){const Ce=h[ce];a.mergedAttrs=tr(a.mergedAttrs,Ce.hostAttrs),Em(e,a,i,q,Ce),Og(q,Ce,_),null!==Ce.contentQueries&&(a.flags|=4),(null!==Ce.hostBindings||null!==Ce.hostAttrs||0!==Ce.hostVars)&&(a.flags|=64);const Be=Ce.type.prototype;!F&&(Be.ngOnChanges||Be.ngOnInit||Be.ngDoCheck)&&((e.preOrderHooks??=[]).push(a.index),F=!0),!j&&(Be.ngOnChanges||Be.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(a.index),j=!0),q++}!function M_(e,i,a){const _=i.directiveEnd,T=e.data,F=i.attrs,j=[];let q=null,ce=null;for(let Ce=i.directiveStart;Ce<_;Ce++){const Be=T[Ce],ct=a?a.get(Be):null,an=ct?ct.outputs:null;q=bm(Be.inputs,Ce,q,ct?ct.inputs:null),ce=bm(Be.outputs,Ce,ce,an);const xn=null===q||null===F||Uo(i)?null:B_(q,Ce,F);j.push(xn)}null!==q&&(q.hasOwnProperty("class")&&(i.flags|=8),q.hasOwnProperty("style")&&(i.flags|=16)),i.initialInputs=j,i.inputs=q,i.outputs=ce}(e,a,T)}function Dm(e,i,a){const h=a.directiveStart,_=a.directiveEnd,T=a.index,F=function $c(){return Nn.lFrame.currentDirectiveIndex}();try{Y(T);for(let j=h;j<_;j++){const q=e.data[j],ce=i[j];ml(j),(null!==q.hostBindings||0!==q.hostVars||null!==q.hostAttrs)&&R_(q,ce)}}finally{Y(-1),ml(F)}}function R_(e,i){null!==e.hostBindings&&e.hostBindings(1,i)}function gf(e,i,a){i.componentOffset=a,(e.components??=[]).push(i.index)}function Og(e,i,a){if(a){if(i.exportAs)for(let h=0;h<i.exportAs.length;h++)a[i.exportAs[h]]=e;Ho(i)&&(a[""]=e)}}function Em(e,i,a,h,_){e.data[h]=_;const T=_.factory||(_.factory=Tl(_.type)),F=new Hn(T,Ho(_),zf);e.blueprint[h]=F,a[h]=F,function ls(e,i,a,h,_){const T=_.hostBindings;if(T){let F=e.hostBindingOpCodes;null===F&&(F=e.hostBindingOpCodes=[]);const j=~i.index;(function P_(e){let i=e.length;for(;i>0;){const a=e[--i];if("number"==typeof a&&a<0)return a}return 0})(F)!=j&&F.push(j),F.push(a,h,T)}}(e,i,h,xp(e,a,_.hostVars,pr),_)}function td(e,i,a,h,_,T){const F=St(e,i);!function Jp(e,i,a,h,_,T,F){if(null==T)e.removeAttribute(i,_,a);else{const j=null==F?nt(T):F(T,h||"",_);e.setAttribute(i,_,j,a)}}(i[Ei],F,T,e.value,a,h,_)}function L_(e,i,a,h,_,T){const F=T[i];if(null!==F)for(let j=0;j<F.length;)Qp(h,a,F[j++],F[j++],F[j++])}function Qp(e,i,a,h,_){const T=Qr(null);try{const F=e.inputTransforms;null!==F&&F.hasOwnProperty(h)&&(_=F[h].call(i,_)),null!==e.setInput?e.setInput(i,_,a,h):i[h]=_}finally{Qr(T)}}function B_(e,i,a){let h=null,_=0;for(;_<a.length;){const T=a[_];if(0!==T)if(5!==T){if("number"==typeof T)break;if(e.hasOwnProperty(T)){null===h&&(h=[]);const F=e[T];for(let j=0;j<F.length;j+=2)if(F[j]===i){h.push(T,F[j+1],a[_+1]);break}}_+=2}else _+=2;else _+=4}return h}function Sm(e,i,a,h){return[e,!0,!1,i,null,0,h,a,null,null,null]}function Mm(e,i){const a=e.contentQueries;if(null!==a)for(let h=0;h<a.length;h+=2){const T=a[h+1];if(-1!==T){const F=e.data[T];Va(a[h]),F.contentQueries(2,i[T],T)}}}function eg(e,i){return e[ns]?e[As][ro]=i:e[ns]=i,e[As]=i,i}function Pg(e,i,a){Va(0);const h=Qr(null);try{i(e,a)}finally{Qr(h)}}function Am(e){return e[fs]||(e[fs]=[])}function Im(e){return e.cleanup||(e.cleanup=[])}function Pm(e,i){const a=e[Gr],h=a?a.get(au,null):null;h&&h.handleError(i)}function Ng(e,i,a,h,_){for(let T=0;T<a.length;){const F=a[T++],j=a[T++];Qp(e.data[F],i[F],h,j,_)}}function z_(e,i){const a=Ri(i,e),h=a[Ln];!function V_(e,i){for(let a=i.length;a<e.blueprint.length;a++)i.push(e.blueprint[a])}(h,a);const _=a[rr];null!==_&&null===a[co]&&(a[co]=sl(_,a[Gr])),Rg(h,a,a[zr])}function Rg(e,i,a){Xl(i);try{const h=e.viewQuery;null!==h&&Pg(1,h,a);const _=e.template;null!==_&&_m(e,i,_,1,a),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&Mm(e,i),e.staticViewQueries&&Pg(2,e.viewQuery,a);const T=e.components;null!==T&&function U_(e,i){for(let a=0;a<i.length;a++)z_(e,i[a])}(i,T)}catch(h){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),h}finally{i[ai]&=-5,C()}}let Nm=(()=>{class e{constructor(){this.all=new Set,this.queue=new Map}create(a,h,_){const T=typeof Zone>"u"?null:Zone.current,F=new Fa(a,ce=>{this.all.has(ce)&&this.queue.set(ce,T)},_);let j;this.all.add(F),F.notify();const q=()=>{F.cleanup(),j?.(),this.all.delete(F),this.queue.delete(F)};return j=h?.onDestroy(q),{destroy:q}}flush(){if(0!==this.queue.size)for(const[a,h]of this.queue)this.queue.delete(a),h?h.run(()=>a.run()):a.run()}get isQueueEmpty(){return 0===this.queue.size}}return e.\u0275prov=An({token:e,providedIn:"root",factory:()=>new e}),e})();function tg(e,i,a){let h=a?e.styles:null,_=a?e.classes:null,T=0;if(null!==i)for(let F=0;F<i.length;F++){const j=i[F];"number"==typeof j?T=j:1==T?_=Gn(_,j):2==T&&(h=Gn(h,j+": "+i[++F]+";"))}a?e.styles=h:e.stylesWithoutHost=h,a?e.classes=_:e.classesWithoutHost=_}function wp(e,i,a,h,_=!1){for(;null!==a;){const T=i[a.index];if(null!==T&&h.push(K(T)),wi(T)){for(let j=ho;j<T.length;j++){const q=T[j],ce=q[Ln].firstChild;null!==ce&&wp(q[Ln],q,ce,h)}T[uo]!==T[rr]&&h.push(T[uo])}const F=a.type;if(8&F)wp(e,i,a.child,h);else if(32&F){const j=Ur(a,i);let q;for(;q=j();)h.push(q)}else if(16&F){const j=lh(i,a);if(Array.isArray(j))h.push(...j);else{const q=eu(i[yr]);wp(q[Ln],q,j,h,!0)}}a=_?a.projectionNext:a.next}return h}function Dp(e,i,a,h=!0){const _=i[Ni].rendererFactory;_.begin&&_.begin();try{Rm(e,i,e.template,a)}catch(F){throw h&&Pm(i,F),F}finally{_.end&&_.end(),i[Ni].effectManager?.flush()}}function Rm(e,i,a,h){const _=i[ai];if(256!=(256&_)){i[Ni].effectManager?.flush(),Xl(i);try{Vr(i),function za(e){return Nn.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==a&&_m(e,i,a,2,h);const F=3==(3&_);if(F){const ce=e.preOrderCheckHooks;null!==ce&&ie(i,ce,null)}else{const ce=e.preOrderHooks;null!==ce&&ue(i,ce,0,null),Ne(i,0)}if(function Fm(e){for(let i=Cc(e);null!==i;i=Sf(i)){if(!i[Dl])continue;const a=i[Er];for(let h=0;h<a.length;h++){eo(a[h])}}}(i),km(i,2),null!==e.contentQueries&&Mm(e,i),F){const ce=e.contentCheckHooks;null!==ce&&ie(i,ce)}else{const ce=e.contentHooks;null!==ce&&ue(i,ce,1),Ne(i,1)}!function mm(e,i){const a=e.hostBindingOpCodes;if(null===a)return;const h=lm(i,Ia);try{for(let _=0;_<a.length;_++){const T=a[_];if(T<0)Y(~T);else{const F=T,j=a[++_],q=a[++_];Bs(j,F),h.runInContext(q,2,i[F])}}}finally{null===i[Ia]&&Kp(i,Ia),Y(-1)}}(e,i);const j=e.components;null!==j&&kg(i,j,0);const q=e.viewQuery;if(null!==q&&Pg(2,q,h),F){const ce=e.viewCheckHooks;null!==ce&&ie(i,ce)}else{const ce=e.viewHooks;null!==ce&&ue(i,ce,2),Ne(i,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),i[ai]&=-73,Ps(i)}finally{C()}}}function km(e,i){for(let a=Cc(e);null!==a;a=Sf(a))for(let h=ho;h<a.length;h++)Lm(a[h],i)}function W_(e,i,a){Lm(Ri(i,e),a)}function Lm(e,i){if(!function Yi(e){return 128==(128&e[ai])}(e))return;const a=e[Ln];if(80&e[ai]&&0===i||1024&e[ai]||2===i)Rm(a,e,a.template,e[zr]);else if(e[$i]>0){km(e,1);const _=e[Ln].components;null!==_&&kg(e,_,1)}}function kg(e,i,a){for(let h=0;h<i.length;h++)W_(e,i[h],a)}class Cp{get rootNodes(){const i=this._lView,a=i[Ln];return wp(a,i,a.firstChild,[])}constructor(i,a){this._lView=i,this._cdRefInjectingView=a,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[zr]}set context(i){this._lView[zr]=i}get destroyed(){return 256==(256&this._lView[ai])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const i=this._lView[Fi];if(wi(i)){const a=i[8],h=a?a.indexOf(this):-1;h>-1&&(Cd(i,h),Fu(a,h))}this._attachedToViewContainer=!1}fp(this._lView[Ln],this._lView)}onDestroy(i){!function Co(e,i){if(256==(256&e[ai]))throw new lt(911,!1);null===e[jo]&&(e[jo]=[]),e[jo].push(i)}(this._lView,i)}markForCheck(){_h(this._cdRefInjectingView||this._lView)}detach(){this._lView[ai]&=-129}reattach(){this._lView[ai]|=128}detectChanges(){Dp(this._lView[Ln],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new lt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function hp(e,i){Sc(e,i,i[Ei],2,null,null)}(this._lView[Ln],this._lView)}attachToAppRef(i){if(this._attachedToViewContainer)throw new lt(902,!1);this._appRef=i}}class Z_ extends Cp{constructor(i){super(i),this._view=i}detectChanges(){const i=this._view;Dp(i[Ln],i,i[zr],!1)}checkNoChanges(){}get context(){return null}}class Fg extends hf{constructor(i){super(),this.ngModule=i}resolveComponentFactory(i){const a=dr(i);return new Ep(a,this.ngModule)}}function Bm(e){const i=[];for(let a in e)e.hasOwnProperty(a)&&i.push({propName:e[a],templateName:a});return i}class q_{constructor(i,a){this.injector=i,this.parentInjector=a}get(i,a,h){h=Se(h);const _=this.injector.get(i,Nd,h);return _!==Nd||a===Nd?_:this.parentInjector.get(i,a,h)}}class Ep extends Bf{get inputs(){const i=this.componentDef,a=i.inputTransforms,h=Bm(i.inputs);if(null!==a)for(const _ of h)a.hasOwnProperty(_.propName)&&(_.transform=a[_.propName]);return h}get outputs(){return Bm(this.componentDef.outputs)}constructor(i,a){super(),this.componentDef=i,this.ngModule=a,this.componentType=i.type,this.selector=function Za(e){return e.map(io).join(",")}(i.selectors),this.ngContentSelectors=i.ngContentSelectors?i.ngContentSelectors:[],this.isBoundToModule=!!a}create(i,a,h,_){let T=(_=_||this.ngModule)instanceof xe?_:_?.injector;T&&null!==this.componentDef.getStandaloneInjector&&(T=this.componentDef.getStandaloneInjector(T)||T);const F=T?new q_(i,T):i,j=F.get($p,null);if(null===j)throw new lt(407,!1);const Ce={rendererFactory:j,sanitizer:F.get(yg,null),effectManager:F.get(Nm,null)},Be=j.createRenderer(null,this.componentDef),ct=this.componentDef.selectors[0][0]||"div",_t=h?function w_(e,i,a,h){const T=h.get(im,!1)||a===Fn.ShadowDom,F=e.selectRootElement(i,T);return function D_(e){vm(e)}(F),F}(Be,h,this.componentDef.encapsulation,F):Xh(Be,ct,function Y_(e){const i=e.toLowerCase();return"svg"===i?"svg":"math"===i?"math":null}(ct)),ti=this.componentDef.signals?4608:this.componentDef.onPush?576:528,Di=Ag(0,null,null,1,0,null,null,null,null,null,null),un=Xp(null,Di,null,ti,null,null,Ce,Be,F,null,null);let gr,Xr;Xl(un);try{const ao=this.componentDef;let dc,f_=null;ao.findHostDirectiveDefs?(dc=[],f_=new Map,ao.findHostDirectiveDefs(ao,dc,f_),dc.push(ao)):dc=[ao];const NC=function X_(e,i){const a=e[Ln],h=Ui;return e[h]=i,Vf(a,h,2,"#host",null)}(un,_t),RC=function J_(e,i,a,h,_,T,F){const j=_[Ln];!function Q_(e,i,a,h){for(const _ of e)i.mergedAttrs=tr(i.mergedAttrs,_.hostAttrs);null!==i.mergedAttrs&&(tg(i,i.mergedAttrs,!0),null!==a&&ch(h,a,i))}(h,e,i,F);let q=null;null!==i&&(q=sl(i,_[Gr]));const ce=T.rendererFactory.createRenderer(i,a);let Ce=16;a.signals?Ce=4096:a.onPush&&(Ce=64);const Be=Xp(_,ym(a),null,Ce,_[e.index],e,T,ce,null,null,q);return j.firstCreatePass&&gf(j,e,h.length-1),eg(_,Be),_[e.index]=Be}(NC,_t,ao,dc,un,Ce,Be);Xr=ni(Di,Ui),_t&&function Tv(e,i,a,h){if(h)ji(e,a,["ng-version",Nc.full]);else{const{attrs:_,classes:T}=function ts(e){const i=[],a=[];let h=1,_=2;for(;h<e.length;){let T=e[h];if("string"==typeof T)2===_?""!==T&&i.push(T,e[++h]):8===_&&a.push(T);else{if(!Vi(_))break;_=T}h++}return{attrs:i,classes:a}}(i.selectors[0]);_&&ji(e,a,_),T&&T.length>0&&gp(e,a,T.join(" "))}}(Be,ao,_t,h),void 0!==a&&function ty(e,i,a){const h=e.projection=[];for(let _=0;_<i.length;_++){const T=a[_];h.push(null!=T?Array.from(T):null)}}(Xr,this.ngContentSelectors,a),gr=function ey(e,i,a,h,_,T){const F=qr(),j=_[Ln],q=St(F,_);wm(j,_,F,a,null,h);for(let Ce=0;Ce<a.length;Ce++)Ds(aa(_,j,F.directiveStart+Ce,F),_);Dm(j,_,F),q&&Ds(q,_);const ce=aa(_,j,F.directiveStart+F.componentOffset,F);if(e[zr]=_[zr]=ce,null!==T)for(const Ce of T)Ce(ce,i);return Tg(j,F,e),ce}(RC,ao,dc,f_,un,[ny]),Rg(Di,un,null)}finally{C()}return new K_(this.componentType,gr,gh(Xr,un),un,Xr)}}class K_ extends uf{constructor(i,a,h,_,T){super(),this.location=h,this._rootLView=_,this._tNode=T,this.previousInputValues=null,this.instance=a,this.hostView=this.changeDetectorRef=new Z_(_),this.componentType=i}setInput(i,a){const h=this._tNode.inputs;let _;if(null!==h&&(_=h[i])){if(this.previousInputValues??=new Map,this.previousInputValues.has(i)&&Object.is(this.previousInputValues.get(i),a))return;const T=this._rootLView;Ng(T[Ln],T,_,i,a),this.previousInputValues.set(i,a),_h(Ri(this._tNode.index,T))}}get injector(){return new Zc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(i){this.hostView.onDestroy(i)}}function ny(){const e=qr();W(dn()[Ln],e)}function Lg(e){let i=function zm(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),a=!0;const h=[e];for(;i;){let _;if(Ho(e))_=i.\u0275cmp||i.\u0275dir;else{if(i.\u0275cmp)throw new lt(903,!1);_=i.\u0275dir}if(_){if(a){h.push(_);const F=e;F.inputs=ng(e.inputs),F.inputTransforms=ng(e.inputTransforms),F.declaredInputs=ng(e.declaredInputs),F.outputs=ng(e.outputs);const j=_.hostBindings;j&&oy(e,j);const q=_.viewQuery,ce=_.contentQueries;if(q&&ry(e,q),ce&&Sv(e,ce),nn(e.inputs,_.inputs),nn(e.declaredInputs,_.declaredInputs),nn(e.outputs,_.outputs),null!==_.inputTransforms&&(null===F.inputTransforms&&(F.inputTransforms={}),nn(F.inputTransforms,_.inputTransforms)),Ho(_)&&_.data.animation){const Ce=e.data;Ce.animation=(Ce.animation||[]).concat(_.data.animation)}}const T=_.features;if(T)for(let F=0;F<T.length;F++){const j=T[F];j&&j.ngInherit&&j(e),j===Lg&&(a=!1)}}i=Object.getPrototypeOf(i)}!function iy(e){let i=0,a=null;for(let h=e.length-1;h>=0;h--){const _=e[h];_.hostVars=i+=_.hostVars,_.hostAttrs=tr(_.hostAttrs,a=tr(a,_.hostAttrs))}}(h)}function ng(e){return e===ut?{}:e===Oe?[]:e}function ry(e,i){const a=e.viewQuery;e.viewQuery=a?(h,_)=>{i(h,_),a(h,_)}:i}function Sv(e,i){const a=e.contentQueries;e.contentQueries=a?(h,_,T)=>{i(h,_,T),a(h,_,T)}:i}function oy(e,i){const a=e.hostBindings;e.hostBindings=a?(h,_)=>{i(h,_),a(h,_)}:i}function Nu(e){return i=>{i.findHostDirectiveDefs=Um,i.hostDirectives=(Array.isArray(e)?e:e()).map(a=>"function"==typeof a?{directive:Vt(a),inputs:ut,outputs:ut}:{directive:Vt(a.directive),inputs:jm(a.inputs),outputs:jm(a.outputs)})}}function Um(e,i,a){if(null!==e.hostDirectives)for(const h of e.hostDirectives){const _=$r(h.directive);vh(_.declaredInputs,h.inputs),Um(_,i,a),a.set(_,h),i.push(_)}}function jm(e){if(void 0===e||0===e.length)return ut;const i={};for(let a=0;a<e.length;a+=2)i[e[a]]=e[a+1];return i}function vh(e,i){for(const a in i)i.hasOwnProperty(a)&&(e[i[a]]=e[a])}function Fd(e){const i=e.inputConfig,a={};for(const h in i)if(i.hasOwnProperty(h)){const _=i[h];Array.isArray(_)&&_[2]&&(a[h]=_[2])}e.inputTransforms=a}function ig(e){return!!Sp(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function Sp(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function id(e,i,a){return e[i]=a}function ll(e,i,a){return!Object.is(e[i],a)&&(e[i]=a,!0)}function bh(e,i,a,h){const _=ll(e,i,a);return ll(e,i+1,h)||_}function Bg(e,i,a,h){const _=dn();return ll(_,os(),i)&&(qi(),td(X(),_,e,i,a,h)),Bg}function Bd(e,i,a,h){return ll(e,os(),a)?i+nt(a)+h:pr}function v(e,i,a,h,_,T,F,j){const q=dn(),ce=qi(),Ce=e+Ui,Be=ce.firstCreatePass?function p(e,i,a,h,_,T,F,j,q){const ce=i.consts,Ce=Vf(i,e,4,F||null,Ii(ce,j));Ig(i,a,Ce,Ii(ce,q)),W(i,Ce);const Be=Ce.tView=Ag(2,Ce,h,_,T,i.directiveRegistry,i.pipeRegistry,null,i.schemas,ce,null);return null!==i.queries&&(i.queries.template(i,Ce),Be.queries=i.queries.embeddedTView(Ce)),Ce}(Ce,ce,q,i,a,h,_,T,F):ce.data[Ce];Ar(Be,!1);const ct=E(ce,q,Be,e);k()&&qu(ce,q,ct,Be),Ds(ct,q),eg(q,q[Ce]=Sm(ct,q,ct,Be)),Pa(Be)&&Sg(ce,q,Be),null!=F&&Mg(q,Be,j)}let E=function I(e,i,a,h){return O(!0),i[Ei].createComment("")};function pe(e){return sr(function Ol(){return Nn.lFrame.contextLView}(),Ui+e)}function Me(e,i,a){const h=dn();return ll(h,os(),i)&&Rc(qi(),X(),h,e,i,h[Ei],a,!1),Me}function Re(e,i,a,h,_){const F=_?"class":"style";Ng(e,a,i.inputs[F],F,h)}function Qe(e,i,a,h){const _=dn(),T=qi(),F=Ui+e,j=_[Ei],q=T.firstCreatePass?function qe(e,i,a,h,_,T){const F=i.consts,q=Vf(i,e,2,h,Ii(F,_));return Ig(i,a,q,Ii(F,T)),null!==q.attrs&&tg(q,q.attrs,!1),null!==q.mergedAttrs&&tg(q,q.mergedAttrs,!0),null!==i.queries&&i.queries.elementStart(i,q),q}(F,T,_,i,a,h):T.data[F],ce=Ut(T,_,q,j,i,e);_[F]=ce;const Ce=Pa(q);return Ar(q,!0),ch(j,ce,q),32!=(32&q.flags)&&k()&&qu(T,_,ce,q),0===function _o(){return Nn.lFrame.elementDepthCount}()&&Ds(ce,_),function Ru(){Nn.lFrame.elementDepthCount++}(),Ce&&(Sg(T,_,q),Tg(T,q,_)),null!==h&&Mg(_,q),Qe}function rt(){let e=qr();yo()?vs():(e=e.parent,Ar(e,!1));const i=e;(function Ba(e){return Nn.skipHydrationRootTNode===e})(i)&&function yc(){Nn.skipHydrationRootTNode=null}(),function ql(){Nn.lFrame.elementDepthCount--}();const a=qi();return a.firstCreatePass&&(W(a,e),ga(e)&&a.queries.elementEnd(e)),null!=i.classesWithoutHost&&function cr(e){return 0!=(8&e.flags)}(i)&&Re(a,i,dn(),i.classesWithoutHost,!0),null!=i.stylesWithoutHost&&function To(e){return 0!=(16&e.flags)}(i)&&Re(a,i,dn(),i.stylesWithoutHost,!1),rt}function jt(e,i,a,h){return Qe(e,i,a,h),rt(),jt}let Ut=(e,i,a,h,_,T)=>(O(!0),Xh(h,_,function ke(){return Nn.lFrame.currentNamespace}()));function En(e,i,a){const h=dn(),_=qi(),T=e+Ui,F=_.firstCreatePass?function fn(e,i,a,h,_){const T=i.consts,F=Ii(T,h),j=Vf(i,e,8,"ng-container",F);return null!==F&&tg(j,F,!0),Ig(i,a,j,Ii(T,_)),null!==i.queries&&i.queries.elementStart(i,j),j}(T,_,h,i,a):_.data[T];Ar(F,!0);const j=Ti(_,h,F,e);return h[T]=j,k()&&qu(_,h,j,F),Ds(j,h),Pa(F)&&(Sg(_,h,F),Tg(_,F,h)),null!=a&&Mg(h,F),En}function fi(){let e=qr();const i=qi();return yo()?vs():(e=e.parent,Ar(e,!1)),i.firstCreatePass&&(W(i,e),ga(e)&&i.queries.elementEnd(e)),fi}let Ti=(e,i,a,h)=>(O(!0),Kh(i[Ei],""));function jr(){return dn()}function Ea(e){return!!e&&"function"==typeof e.then}function uc(e){return!!e&&"function"==typeof e.subscribe}function Io(e,i,a,h){const _=dn(),T=qi(),F=qr();return function lu(e,i,a,h,_,T,F){const j=Pa(h),ce=e.firstCreatePass&&Im(e),Ce=i[zr],Be=Am(i);let ct=!0;if(3&h.type||F){const xn=St(h,i),ti=F?F(xn):xn,Di=Be.length,un=F?Xr=>F(K(Xr[h.index])):h.index;let gr=null;if(!F&&j&&(gr=function Js(e,i,a,h){const _=e.cleanup;if(null!=_)for(let T=0;T<_.length-1;T+=2){const F=_[T];if(F===a&&_[T+1]===h){const j=i[fs],q=_[T+2];return j.length>q?j[q]:null}"string"==typeof F&&(T+=2)}return null}(e,i,_,h.index)),null!==gr)(gr.__ngLastListenerFn__||gr).__ngNextListenerFn__=T,gr.__ngLastListenerFn__=T,ct=!1;else{T=mf(h,i,Ce,T,!1);const Xr=a.listen(ti,_,T);Be.push(T,Xr),ce&&ce.push(_,un,Di,Di+1)}}else T=mf(h,i,Ce,T,!1);const _t=h.outputs;let an;if(ct&&null!==_t&&(an=_t[_])){const xn=an.length;if(xn)for(let ti=0;ti<xn;ti+=2){const ao=i[an[ti]][an[ti+1]].subscribe(T),dc=Be.length;Be.push(T,ao),ce&&ce.push(_,h.index,dc,-(dc+1))}}}(T,_,_[Ei],F,e,i,h),Io}function cl(e,i,a,h){try{return rs(6,i,a),!1!==a(h)}catch(_){return Pm(e,_),!1}finally{rs(7,i,a)}}function mf(e,i,a,h,_){return function T(F){if(F===Function)return h;_h(e.componentOffset>-1?Ri(e.index,i):i);let q=cl(i,a,h,F),ce=T.__ngNextListenerFn__;for(;ce;)q=cl(i,a,ce,F)&&q,ce=ce.__ngNextListenerFn__;return _&&!1===q&&F.preventDefault(),q}}function Op(e=1){return function N(e){return(Nn.lFrame.contextLView=function V(e,i){for(;e>0;)i=i[ps],e--;return i}(e,Nn.lFrame.contextLView))[zr]}(e)}function Kf(e,i){let a=null;const h=function es(e){const i=e.attrs;if(null!=i){const a=i.indexOf(5);if(!(1&a))return i[a+1]}return null}(e);for(let _=0;_<i.length;_++){const T=i[_];if("*"!==T){if(null===h?ds(e,T,!0):da(h,T))return _}else a=_}return a}function Xf(e){const i=dn()[yr][Zr];if(!i.projection){const h=i.projection=Xc(e?e.length:1,null),_=h.slice();let T=i.child;for(;null!==T;){const F=e?Kf(T,e):0;null!==F&&(_[F]?_[F].projectionNext=T:h[F]=T,_[F]=T),T=T.next}}}function Jf(e,i=0,a){const h=dn(),_=qi(),T=Vf(_,Ui+e,16,null,a||null);null===T.projection&&(T.projection=i),vs(),(!h[co]||Zs())&&32!=(32&T.flags)&&function Mc(e,i,a){nu(i[Ei],0,i,a,rh(e,a,i),Ed(a.parent||i[Zr],a,i))}(_,h,T)}function _f(e,i,a){return Dh(e,"",i,"",a),_f}function Dh(e,i,a,h,_){const T=dn(),F=Bd(T,i,a,h);return F!==pr&&Rc(qi(),X(),T,e,F,T[Ei],_,!1),Dh}function Jm(e,i){return e<<17|i<<2}function Qf(e){return e>>17&32767}function wy(e){return 2|e}function Pp(e){return(131068&e)>>2}function Dy(e,i){return-131069&e|i<<2}function Cy(e){return 1|e}function zv(e,i,a,h,_){const T=e[a+1],F=null===i;let j=h?Qf(T):Pp(T),q=!1;for(;0!==j&&(!1===q||F);){const Ce=e[j+1];$1(e[j],i)&&(q=!0,e[j+1]=h?Cy(Ce):wy(Ce)),j=h?Qf(Ce):Pp(Ce)}q&&(e[a+1]=h?wy(T):Cy(T))}function $1(e,i){return null===e||null==i||(Array.isArray(e)?e[1]:e)===i||!(!Array.isArray(e)||"string"!=typeof i)&&el(e,i)>=0}const ul={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Vv(e){return e.substring(ul.key,ul.keyEnd)}function Uv(e,i){const a=ul.textEnd;return a===i?-1:(i=ul.keyEnd=function Y1(e,i,a){for(;i<a&&e.charCodeAt(i)>32;)i++;return i}(e,ul.key=i,a),lg(e,i,a))}function lg(e,i,a){for(;i<a&&e.charCodeAt(i)<=32;)i++;return i}function Ey(e,i){return function zd(e,i,a,h){const _=dn(),T=qi(),F=bs(2);T.firstUpdatePass&&qv(T,e,F,h),i!==pr&&ll(_,F,i)&&Xv(T,T.data[Z()],_,_[Ei],e,_[F+1]=function ox(e,i){return null==e||""===e||("string"==typeof i?e+=i:"object"==typeof e&&(e=Tn(U(e)))),e}(i,a),h,F)}(e,i,null,!0),Ey}function Zv(e){!function Vd(e,i,a,h){const _=qi(),T=bs(2);_.firstUpdatePass&&qv(_,null,T,h);const F=dn();if(a!==pr&&ll(F,T,a)){const j=_.data[Z()];if(Qv(j,h)&&!Yv(_,T)){let q=h?j.classesWithoutHost:j.stylesWithoutHost;null!==q&&(a=Gn(q,a||"")),Re(_,j,F,a,h)}else!function rx(e,i,a,h,_,T,F,j){_===pr&&(_=Oe);let q=0,ce=0,Ce=0<_.length?_[0]:null,Be=0<T.length?T[0]:null;for(;null!==Ce||null!==Be;){const ct=q<_.length?_[q+1]:void 0,_t=ce<T.length?T[ce+1]:void 0;let xn,an=null;Ce===Be?(q+=2,ce+=2,ct!==_t&&(an=Be,xn=_t)):null===Be||null!==Ce&&Ce<Be?(q+=2,an=Ce):(ce+=2,an=Be,xn=_t),null!==an&&Xv(e,i,a,h,an,xn,F,j),Ce=q<_.length?_[q]:null,Be=ce<T.length?T[ce]:null}}(_,j,F,F[Ei],F[T+1],F[T+1]=function nx(e,i,a){if(null==a||""===a)return Oe;const h=[],_=U(a);if(Array.isArray(_))for(let T=0;T<_.length;T++)e(h,_[T],!0);else if("object"==typeof _)for(const T in _)_.hasOwnProperty(T)&&e(h,T,_[T]);else"string"==typeof _&&i(h,_);return h}(e,i,a),h,T)}}(ix,Eh,e,!0)}function Eh(e,i){for(let a=function W1(e){return function Hv(e){ul.key=0,ul.keyEnd=0,ul.value=0,ul.valueEnd=0,ul.textEnd=e.length}(e),Uv(e,lg(e,0,ul.textEnd))}(i);a>=0;a=Uv(i,a))Go(e,Vv(i),!0)}function Yv(e,i){return i>=e.expandoStartIndex}function qv(e,i,a,h){const _=e.data;if(null===_[a+1]){const T=_[Z()],F=Yv(e,a);Qv(T,h)&&null===i&&!F&&(i=!1),i=function J1(e,i,a,h){const _=function Ka(e){const i=Nn.lFrame.currentDirectiveIndex;return-1===i?null:e[i]}(e);let T=h?i.residualClasses:i.residualStyles;if(null===_)0===(h?i.classBindings:i.styleBindings)&&(a=Zg(a=Ty(null,e,i,a,h),i.attrs,h),T=null);else{const F=i.directiveStylingLast;if(-1===F||e[F]!==_)if(a=Ty(_,e,i,a,h),null===T){let q=function Q1(e,i,a){const h=a?i.classBindings:i.styleBindings;if(0!==Pp(h))return e[Qf(h)]}(e,i,h);void 0!==q&&Array.isArray(q)&&(q=Ty(null,e,i,q[1],h),q=Zg(q,i.attrs,h),function ex(e,i,a,h){e[Qf(a?i.classBindings:i.styleBindings)]=h}(e,i,h,q))}else T=function tx(e,i,a){let h;const _=i.directiveEnd;for(let T=1+i.directiveStylingLast;T<_;T++)h=Zg(h,e[T].hostAttrs,a);return Zg(h,i.attrs,a)}(e,i,h)}return void 0!==T&&(h?i.residualClasses=T:i.residualStyles=T),a}(_,T,i,h),function j1(e,i,a,h,_,T){let F=T?i.classBindings:i.styleBindings,j=Qf(F),q=Pp(F);e[h]=a;let Ce,ce=!1;if(Array.isArray(a)?(Ce=a[1],(null===Ce||el(a,Ce)>0)&&(ce=!0)):Ce=a,_)if(0!==q){const ct=Qf(e[j+1]);e[h+1]=Jm(ct,j),0!==ct&&(e[ct+1]=Dy(e[ct+1],h)),e[j+1]=function V1(e,i){return 131071&e|i<<17}(e[j+1],h)}else e[h+1]=Jm(j,0),0!==j&&(e[j+1]=Dy(e[j+1],h)),j=h;else e[h+1]=Jm(q,0),0===j?j=h:e[q+1]=Dy(e[q+1],h),q=h;ce&&(e[h+1]=wy(e[h+1])),zv(e,Ce,h,!0),zv(e,Ce,h,!1),function H1(e,i,a,h,_){const T=_?e.residualClasses:e.residualStyles;null!=T&&"string"==typeof i&&el(T,i)>=0&&(a[h+1]=Cy(a[h+1]))}(i,Ce,e,h,T),F=Jm(j,q),T?i.classBindings=F:i.styleBindings=F}(_,T,i,a,F,h)}}function Ty(e,i,a,h,_){let T=null;const F=a.directiveEnd;let j=a.directiveStylingLast;for(-1===j?j=a.directiveStart:j++;j<F&&(T=i[j],h=Zg(h,T.hostAttrs,_),T!==e);)j++;return null!==e&&(a.directiveStylingLast=j),h}function Zg(e,i,a){const h=a?1:2;let _=-1;if(null!==i)for(let T=0;T<i.length;T++){const F=i[T];"number"==typeof F?_=F:_===h&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Go(e,F,!!a||i[++T]))}return void 0===e?null:e}function ix(e,i,a){const h=String(i);""!==h&&!h.includes(" ")&&Go(e,h,a)}function Xv(e,i,a,h,_,T,F,j){if(!(3&i.type))return;const q=e.data,ce=q[j+1],Ce=function U1(e){return 1==(1&e)}(ce)?Jv(q,i,a,_,Pp(ce),F):void 0;Qm(Ce)||(Qm(T)||function z1(e){return 2==(2&e)}(ce)&&(T=Jv(q,null,a,_,j,F)),function If(e,i,a,h,_){if(i)_?e.addClass(a,h):e.removeClass(a,h);else{let T=-1===h.indexOf("-")?void 0:xl.DashCase;null==_?e.removeStyle(a,h,T):("string"==typeof _&&_.endsWith("!important")&&(_=_.slice(0,-10),T|=xl.Important),e.setStyle(a,h,_,T))}}(h,F,He(Z(),a),_,T))}function Jv(e,i,a,h,_,T){const F=null===i;let j;for(;_>0;){const q=e[_],ce=Array.isArray(q),Ce=ce?q[1]:q,Be=null===Ce;let ct=a[_+1];ct===pr&&(ct=Be?Oe:void 0);let _t=Be?Mo(ct,h):Ce===h?ct:void 0;if(ce&&!Qm(_t)&&(_t=Mo(q,h)),Qm(_t)&&(j=_t,F))return j;const an=e[_+1];_=F?Qf(an):Pp(an)}if(null!==i){let q=T?i.residualClasses:i.residualStyles;null!=q&&(j=Mo(q,h))}return j}function Qm(e){return void 0!==e}function Qv(e,i){return 0!=(e.flags&(i?8:16))}function e0(e,i=""){const a=dn(),h=qi(),_=e+Ui,T=h.firstCreatePass?Vf(h,_,1,i,null):h.data[_],F=t0(h,a,T,i,e);a[_]=F,k()&&qu(h,a,F,T),Ar(T,!1)}let t0=(e,i,a,h,_)=>(O(!0),Ll(i[Ei],h));function Sy(e){return e_("",e,""),Sy}function e_(e,i,a){const h=dn(),_=Bd(h,e,i,a);return _!==pr&&function nd(e,i,a){const h=He(i,e);!function qh(e,i,a){e.setValue(i,a)}(e[Ei],h,a)}(h,Z(),_),e_}function My(e,i,a){const h=dn();return ll(h,os(),i)&&Rc(qi(),X(),h,e,i,h[Ei],a,!0),My}const Np=void 0;var Sx=["en",[["a","p"],["AM","PM"],Np],[["AM","PM"],Np,Np],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Np,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Np,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Np,"{1} 'at' {0}",Np],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Tx(e){const a=Math.floor(Math.abs(e)),h=e.toString().replace(/^[^.]*\.?/,"").length;return 1===a&&0===h?1:5}];let cg={};function Ay(e){const i=function Mx(e){return e.toLowerCase().replace(/_/g,"-")}(e);let a=w0(i);if(a)return a;const h=i.split("-")[0];if(a=w0(h),a)return a;if("en"===h)return Sx;throw new lt(701,!1)}function x0(e){return Ay(e)[Wi.PluralCase]}function w0(e){return e in cg||(cg[e]=Rn.ng&&Rn.ng.common&&Rn.ng.common.locales&&Rn.ng.common.locales[e]),cg[e]}var Wi=(()=>((Wi=Wi||{})[Wi.LocaleId=0]="LocaleId",Wi[Wi.DayPeriodsFormat=1]="DayPeriodsFormat",Wi[Wi.DayPeriodsStandalone=2]="DayPeriodsStandalone",Wi[Wi.DaysFormat=3]="DaysFormat",Wi[Wi.DaysStandalone=4]="DaysStandalone",Wi[Wi.MonthsFormat=5]="MonthsFormat",Wi[Wi.MonthsStandalone=6]="MonthsStandalone",Wi[Wi.Eras=7]="Eras",Wi[Wi.FirstDayOfWeek=8]="FirstDayOfWeek",Wi[Wi.WeekendRange=9]="WeekendRange",Wi[Wi.DateFormat=10]="DateFormat",Wi[Wi.TimeFormat=11]="TimeFormat",Wi[Wi.DateTimeFormat=12]="DateTimeFormat",Wi[Wi.NumberSymbols=13]="NumberSymbols",Wi[Wi.NumberFormats=14]="NumberFormats",Wi[Wi.CurrencyCode=15]="CurrencyCode",Wi[Wi.CurrencySymbol=16]="CurrencySymbol",Wi[Wi.CurrencyName=17]="CurrencyName",Wi[Wi.Currencies=18]="Currencies",Wi[Wi.Directionality=19]="Directionality",Wi[Wi.PluralCase=20]="PluralCase",Wi[Wi.ExtraData=21]="ExtraData",Wi))();const ug="en-US",t_={marker:"element"},n_={marker:"ICU"};var ua=(()=>((ua=ua||{})[ua.SHIFT=2]="SHIFT",ua[ua.APPEND_EAGERLY=1]="APPEND_EAGERLY",ua[ua.COMMENT=2]="COMMENT",ua))();let D0=ug;function C0(e){(function Si(e,i){null==e&&st(i,e,null,"!=")})(e,"Expected localeId to be defined"),"string"==typeof e&&(D0=e.toLowerCase().replace(/_/g,"-"))}function E0(e,i,a){const h=i.insertBeforeIndex,_=Array.isArray(h)?h[0]:h;return null===_?Td(e,0,a):K(a[_])}function T0(e,i,a,h,_){const T=i.insertBeforeIndex;if(Array.isArray(T)){let F=h,j=null;if(3&i.type||(j=F,F=_),null!==F&&-1===i.componentOffset)for(let q=1;q<T.length;q++)ic(e,F,a[T[q]],j,!1)}}function S0(e,i){if(e.push(i),e.length>1)for(let a=e.length-2;a>=0;a--){const h=e[a];M0(h)||Nx(h,i)&&null===Rx(h)&&kx(h,i.index)}}function M0(e){return!(64&e.type)}function Nx(e,i){return M0(i)||e.index>i.index}function Rx(e){const i=e.insertBeforeIndex;return Array.isArray(i)?i[0]:i}function kx(e,i){const a=e.insertBeforeIndex;Array.isArray(a)?a[0]=i:(Tc(E0,T0),e.insertBeforeIndex=i)}function Bx(e,i,a){const h=Eg(e,a,64,null,null);return S0(i,h),h}function Gx(){const e=[];let a,h,i=-1;function T(j,q){i=0;const ce=function i_(e,i){const a=i[e.currentCaseLViewIndex];return null===a?a:a<0?~a:a}(j,q);h=null!==ce?j.remove[ce]:Oe}function F(){if(i<h.length){const j=h[i++];return j>0?a[j]:(e.push(i,h),T(a[Ln].data[~j],a),F())}return 0===e.length?null:(h=e.pop(),i=e.pop(),F())}return function _(j,q){for(a=q;e.length;)e.pop();return T(j.value,q),F}}const r_=/\ufffd(\d+):?\d*\ufffd/gi,Zx=/\ufffd(\d+)\ufffd/,L0=/^\s*(\ufffd\d+:?\d*\ufffd)\s*,\s*(select|plural)\s*,/,Xg="\ufffd",Yx=/\ufffd\/?\*(\d+:\d+)\ufffd/gi,qx=/\ufffd(\/?[#*]\d+):?\d*\ufffd/gi,Kx=/\uE500/g;function B0(e,i,a,h,_,T,F){const j=xp(e,h,1,null);let q=j<<ua.SHIFT,ce=Yo();i===ce&&(ce=null),null===ce&&(q|=ua.APPEND_EAGERLY),F&&(q|=ua.COMMENT,function Zh(e){void 0===xd&&(xd=e())}(Gx)),_.push(q,null===T?"":T);const Ce=Eg(e,j,F?32:1,null===T?"":T,null);S0(a,Ce);const Be=Ce.index;return Ar(Ce,!1),null!==ce&&i!==ce&&function Lx(e,i){let a=e.insertBeforeIndex;null===a?(Tc(E0,T0),a=e.insertBeforeIndex=[null,i]):(function ht(e,i,a){e!=i&&st(a,e,i,"==")}(Array.isArray(a),!0,"Expecting array here"),a.push(i))}(ce,Be),Ce}function Qx(e,i,a,h,_,T,F){const j=F.match(r_),q=B0(e,i,a,T,h,j?null:F,!1);j&&Jg(_,F,q.index,null,0,null)}function Jg(e,i,a,h,_,T){const F=e.length,j=F+1;e.push(null,null);const q=F+2,ce=i.split(r_);let Ce=0;for(let Be=0;Be<ce.length;Be++){const ct=ce[Be];if(1&Be){const _t=_+parseInt(ct,10);e.push(-1-_t),Ce|=z0(_t)}else""!==ct&&e.push(ct)}return e.push(a<<2|(h?1:0)),h&&e.push(h,T),e[F]=Ce,e[j]=e.length-q,Ce}function z0(e){return 1<<Math.min(e,31)}function V0(e){let i,T,a="",h=0,_=!1;for(;null!==(i=Yx.exec(e));)_?i[0]===`${Xg}/*${T}${Xg}`&&(h=i.index,_=!1):(a+=e.substring(h,i.index+i[0].length),T=i[1],_=!0);return a+=e.slice(h),a}function U0(e,i,a,h,_,T){let F=0;const j={type:_.type,currentCaseLViewIndex:xp(e,i,1,null),anchorIdx:T,cases:[],create:[],remove:[],update:[]};(function aw(e,i,a){e.push(z0(i.mainBinding),2,-1-i.mainBinding,a<<2|2)})(a,_,T),function Fx(e,i,a){const h=e.data[i];null===h?e.data[i]=a:h.value=a}(e,T,j);const q=_.values;for(let ce=0;ce<q.length;ce++){const Ce=q[ce],Be=[];for(let ct=0;ct<Ce.length;ct++){const _t=Ce[ct];if("string"!=typeof _t){const an=Be.push(_t)-1;Ce[ct]=`\x3c!--\ufffd${an}\ufffd--\x3e`}}F=ow(e,j,i,a,h,_.cases[ce],Ce.join(""),Be)|F}F&&function lw(e,i,a){e.push(i,1,a<<2|3)}(a,F,T)}function rw(e){const i=[],a=[];let h=1,_=0;const T=Iy(e=e.replace(L0,function(F,j,q){return h="select"===q?0:1,_=parseInt(j.slice(1),10),""}));for(let F=0;F<T.length;){let j=T[F++].trim();1===h&&(j=j.replace(/\s*(?:=)?(\w+)\s*/,"$1")),j.length&&i.push(j);const q=Iy(T[F++]);i.length>a.length&&a.push(q)}return{type:h,mainBinding:_,cases:i,values:a}}function Iy(e){if(!e)return[];let i=0;const a=[],h=[],_=/[{}]/g;let T;for(_.lastIndex=0;T=_.exec(e);){const j=T.index;if("}"==T[0]){if(a.pop(),0==a.length){const q=e.substring(i,j);L0.test(q)?h.push(rw(q)):h.push(q),i=j+1}}else{if(0==a.length){const q=e.substring(i,j);h.push(q),i=j+1}a.push("{")}}const F=e.substring(i);return h.push(F),h}function ow(e,i,a,h,_,T,F,j){const q=[],ce=[],Ce=[];i.cases.push(T),i.create.push(q),i.remove.push(ce),i.update.push(Ce);const ct=function pn(e){const i=new Tr(e);return function Oi(){try{return!!(new window.DOMParser).parseFromString(Cu(""),"text/html")}catch{return!1}}()?new Wn(i):i}(Tu()).getInertBodyElement(F),_t=function oc(e){return"content"in e&&function Pd(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}(ct)||ct;return _t?j0(e,i,a,h,q,ce,Ce,_t,_,j,0):0}function j0(e,i,a,h,_,T,F,j,q,ce,Ce){let Be=0,ct=j.firstChild;for(;ct;){const _t=xp(e,a,1,null);switch(ct.nodeType){case Node.ELEMENT_NODE:const an=ct,xn=an.tagName.toLowerCase();if(Jo.hasOwnProperty(xn)){Oy(_,t_,xn,q,_t),e.data[_t]=xn;const gr=an.attributes;for(let Xr=0;Xr<gr.length;Xr++){const ao=gr.item(Xr),dc=ao.name.toLowerCase();ao.value.match(r_)?tl.hasOwnProperty(dc)&&Jg(F,ao.value,_t,ao.name,0,Vs[dc]?xr:null):cw(_,_t,ao)}Be=j0(e,i,a,h,_,T,F,ct,_t,ce,Ce+1)|Be,H0(T,_t,Ce)}break;case Node.TEXT_NODE:const ti=ct.textContent||"",Di=ti.match(r_);Oy(_,null,Di?"":ti,q,_t),H0(T,_t,Ce),Di&&(Be=Jg(F,ti,_t,null,0,null)|Be);break;case Node.COMMENT_NODE:const un=Zx.exec(ct.textContent||"");if(un){const Xr=ce[parseInt(un[1],10)];Oy(_,n_,"",q,_t),U0(e,a,h,q,Xr,_t),sw(T,_t,Ce)}}ct=ct.nextSibling}return Be}function H0(e,i,a){0===a&&e.push(i)}function sw(e,i,a){0===a&&(e.push(~i),e.push(i))}function Oy(e,i,a,h,_){null!==i&&e.push(i),e.push(a,_,function zx(e,i,a){return e|i<<17|a<<1}(0,h,_))}function cw(e,i,a){e.push(i<<1|1,a.name,a.value)}function G0(e,i,a=-1){const h=qi(),_=dn(),T=Ui+e,F=Ii(h.consts,i),j=Yo();h.firstCreatePass&&function Jx(e,i,a,h,_,T){const F=Yo(),j=[],q=[],ce=[[]];_=function iw(e,i){if(function nw(e){return-1===e}(i))return V0(e);{const a=e.indexOf(`:${i}${Xg}`)+2+i.toString().length,h=e.search(new RegExp(`${Xg}\\/\\*\\d+:${i}${Xg}`));return V0(e.substring(a,h))}}(_,T);const Ce=function Xx(e){return e.replace(Kx," ")}(_).split(qx);for(let Be=0;Be<Ce.length;Be++){let ct=Ce[Be];if(1&Be){const _t=47===ct.charCodeAt(0),xn=(ct.charCodeAt(_t?1:0),Ui+Number.parseInt(ct.substring(_t?2:1)));if(_t)ce.shift(),Ar(Yo(),!1);else{const ti=Bx(e,ce[0],xn);ce.unshift([]),Ar(ti,!0)}}else{const _t=Iy(ct);for(let an=0;an<_t.length;an++){let xn=_t[an];if(1&an){const ti=xn;if("object"!=typeof ti)throw new Error(`Unable to parse ICU expression in "${_}" message.`);U0(e,a,q,i,ti,B0(e,F,ce[0],a,j,"",!0).index)}else""!==xn&&Qx(e,F,ce[0],j,q,a,xn)}}}e.data[h]={create:j,update:q}}(h,null===j?0:j.index,_,T,F,a),2===h.type?_[yr][ai]|=32:_[ai]|=32;const q=h.data[T],Ce=ba(h,j===_[Zr]?null:j,_);(function jx(e,i,a,h){const _=e[Ei];for(let T=0;T<i.length;T++){const F=i[T++],j=i[T],ce=(F&ua.APPEND_EAGERLY)===ua.APPEND_EAGERLY,Ce=F>>>ua.SHIFT;let Be=e[Ce];null===Be&&(Be=e[Ce]=(F&ua.COMMENT)===ua.COMMENT?_.createComment(j):Ll(_,j)),ce&&null!==a&&ic(_,a,Be,h,!1)}})(_,q.create,Ce,j&&8&j.type?_[j.index]:null),Pl(!0)}function Z0(e,i,a){G0(e,i,a),function W0(){Pl(!1)}()}function Py(e,i,a,h,_){if(e=Vt(e),Array.isArray(e))for(let T=0;T<e.length;T++)Py(e[T],i,a,h,_);else{const T=qi(),F=dn();let j=P(e)?e:Vt(e.provide),q=pt(e);const ce=qr(),Ce=1048575&ce.providerIndexes,Be=ce.directiveStart,ct=ce.providerIndexes>>20;if(P(e)||!e.multi){const _t=new Hn(q,_,zf),an=Ry(j,i,_?Ce:Ce+ct,Be);-1===an?(So(br(ce,F),T,j),Ny(T,e,i.length),i.push(j),ce.directiveStart++,ce.directiveEnd++,_&&(ce.providerIndexes+=1048576),a.push(_t),F.push(_t)):(a[an]=_t,F[an]=_t)}else{const _t=Ry(j,i,Ce+ct,Be),an=Ry(j,i,Ce,Ce+ct),ti=an>=0&&a[an];if(_&&!ti||!_&&!(_t>=0&&a[_t])){So(br(ce,F),T,j);const Di=function Cw(e,i,a,h,_){const T=new Hn(e,a,zf);return T.multi=[],T.index=i,T.componentProviders=0,q0(T,_,h&&!a),T}(_?Dw:ww,a.length,_,h,q);!_&&ti&&(a[an].providerFactory=Di),Ny(T,e,i.length,0),i.push(j),ce.directiveStart++,ce.directiveEnd++,_&&(ce.providerIndexes+=1048576),a.push(Di),F.push(Di)}else Ny(T,e,_t>-1?_t:an,q0(a[_?an:_t],q,!_&&h));!_&&h&&ti&&a[an].componentProviders++}}}function Ny(e,i,a,h){const _=P(i),T=function B(e){return!!e.useClass}(i);if(_||T){const q=(T?Vt(i.useClass):i).prototype.ngOnDestroy;if(q){const ce=e.destroyHooks||(e.destroyHooks=[]);if(!_&&i.multi){const Ce=ce.indexOf(a);-1===Ce?ce.push(a,[h,q]):ce[Ce+1].push(h,q)}else ce.push(a,q)}}}function q0(e,i,a){return a&&e.componentProviders++,e.multi.push(i)-1}function Ry(e,i,a,h){for(let _=a;_<h;_++)if(i[_]===e)return _;return-1}function ww(e,i,a,h){return ky(this.multi,[])}function Dw(e,i,a,h){const _=this.multi;let T;if(this.providerFactory){const F=this.providerFactory.componentProviders,j=aa(a,a[Ln],this.providerFactory.index,h);T=j.slice(0,F),ky(_,T);for(let q=F;q<j.length;q++)T.push(j[q])}else T=[],ky(_,T);return T}function ky(e,i){for(let a=0;a<e.length;a++)i.push((0,e[a])());return i}function K0(e,i=[]){return a=>{a.providersResolver=(h,_)=>function xw(e,i,a){const h=qi();if(h.firstCreatePass){const _=Ho(e);Py(a,h.data,h.blueprint,_,!0),Py(i,h.data,h.blueprint,_,!1)}}(h,_?_(e):e,i)}}class dg{}class X0{}function Ew(e,i){return new Fy(e,i??null,[])}class Fy extends dg{constructor(i,a,h){super(),this._parent=a,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Fg(this);const _=Po(i);this._bootstrapComponents=kd(_.bootstrap),this._r3Injector=Cg(i,a,[{provide:dg,useValue:this},{provide:hf,useValue:this.componentFactoryResolver},...h],Tn(i),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(i)}get injector(){return this._r3Injector}destroy(){const i=this._r3Injector;!i.destroyed&&i.destroy(),this.destroyCbs.forEach(a=>a()),this.destroyCbs=null}onDestroy(i){this.destroyCbs.push(i)}}class Ly extends X0{constructor(i){super(),this.moduleType=i}create(i){return new Fy(this.moduleType,i,[])}}class J0 extends dg{constructor(i){super(),this.componentFactoryResolver=new Fg(this),this.instance=null;const a=new Te([...i.providers,{provide:dg,useValue:this},{provide:hf,useValue:this.componentFactoryResolver}],i.parent||ve(),i.debugName,new Set(["environment"]));this.injector=a,i.runEnvironmentInitializers&&a.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(i){this.injector.onDestroy(i)}}function Q0(e,i,a=null){return new J0({providers:e,parent:i,debugName:a,runEnvironmentInitializers:!0}).injector}let Sw=(()=>{class e{constructor(a){this._injector=a,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(a){if(!a.standalone)return null;if(!this.cachedInjectors.has(a.id)){const h=Qu(0,a.type),_=h.length>0?Q0([h],this._injector,`Standalone[${a.type.name}]`):null;this.cachedInjectors.set(a.id,_)}return this.cachedInjectors.get(a.id)}ngOnDestroy(){try{for(const a of this.cachedInjectors.values())null!==a&&a.destroy()}finally{this.cachedInjectors.clear()}}}return e.\u0275prov=An({token:e,providedIn:"environment",factory:()=>new e(we(xe))}),e})();function eb(e){e.getStandaloneInjector=i=>i.get(Sw).getOrCreateStandaloneInjector(e)}function ab(e,i,a,h){return ub(dn(),Eo(),e,i,a,h)}function lb(e,i,a,h,_){return db(dn(),Eo(),e,i,a,h,_)}function cb(e,i,a,h,_,T){return function hb(e,i,a,h,_,T,F,j){const q=i+a;return function Mp(e,i,a,h,_){const T=bh(e,i,a,h);return ll(e,i+2,_)||T}(e,q,_,T,F)?id(e,q+3,j?h.call(j,_,T,F):h(_,T,F)):Qg(e,q+3)}(dn(),Eo(),e,i,a,h,_,T)}function Qg(e,i){const a=e[i];return a===pr?void 0:a}function ub(e,i,a,h,_,T){const F=i+a;return ll(e,F,_)?id(e,F+1,T?h.call(T,_):h(_)):Qg(e,F+1)}function db(e,i,a,h,_,T,F){const j=i+a;return bh(e,j,_,T)?id(e,j+2,F?h.call(F,_,T):h(_,T)):Qg(e,j+2)}function gb(e,i){const a=qi();let h;const _=e+Ui;a.firstCreatePass?(h=function Hw(e,i){if(i)for(let a=i.length-1;a>=0;a--){const h=i[a];if(e===h.name)return h}}(i,a.pipeRegistry),a.data[_]=h,h.onDestroy&&(a.destroyHooks??=[]).push(_,h.onDestroy)):h=a.data[_];const T=h.factory||(h.factory=Tl(h.type)),F=Qt(zf);try{const j=sa(!1),q=T();return sa(j),function Q(e,i,a,h){a>=e.data.length&&(e.data[a]=null,e.blueprint[a]=null),i[a]=h}(a,dn(),_,q),q}finally{Qt(F)}}function mb(e,i,a){const h=e+Ui,_=dn(),T=sr(_,h);return em(_,h)?ub(_,Eo(),i,T.transform,a,T):T.transform(a)}function _b(e,i,a,h){const _=e+Ui,T=dn(),F=sr(T,_);return em(T,_)?db(T,Eo(),i,F.transform,a,h,F):F.transform(a,h)}function em(e,i){return e[Ln].data[i].pure}function zy(e){return i=>{setTimeout(e,void 0,i)}}const Th=class Zw extends m.x{constructor(i=!1){super(),this.__isAsync=i}emit(i){super.next(i)}subscribe(i,a,h){let _=i,T=a||(()=>null),F=h;if(i&&"object"==typeof i){const q=i;_=q.next?.bind(q),T=q.error?.bind(q),F=q.complete?.bind(q)}this.__isAsync&&(T=zy(T),_&&(_=zy(_)),F&&(F=zy(F)));const j=super.subscribe({next:_,error:T,complete:F});return i instanceof be.w0&&i.add(j),j}};function Yw(){return this._results[Symbol.iterator]()}class Vy{get changes(){return this._changes||(this._changes=new Th)}constructor(i=!1){this._emitDistinctChangesOnly=i,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const a=Vy.prototype;a[Symbol.iterator]||(a[Symbol.iterator]=Yw)}get(i){return this._results[i]}map(i){return this._results.map(i)}filter(i){return this._results.filter(i)}find(i){return this._results.find(i)}reduce(i,a){return this._results.reduce(i,a)}forEach(i){this._results.forEach(i)}some(i){return this._results.some(i)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(i,a){const h=this;h.dirty=!1;const _=function bl(e){return e.flat(Number.POSITIVE_INFINITY)}(i);(this._changesDetected=!function rp(e,i,a){if(e.length!==i.length)return!1;for(let h=0;h<e.length;h++){let _=e[h],T=i[h];if(a&&(_=a(_),T=a(T)),T!==_)return!1}return!0}(h._results,_,a))&&(h._results=_,h.length=_.length,h.last=_[this.length-1],h.first=_[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let tm=(()=>{class e{}return e.__NG_ELEMENT_ID__=Xw,e})();const qw=tm,Kw=class extends qw{constructor(i,a,h){super(),this._declarationLView=i,this._declarationTContainer=a,this.elementRef=h}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(i,a){return this.createEmbeddedViewImpl(i,a,null)}createEmbeddedViewImpl(i,a,h){const F=this._declarationTContainer.tView,j=Xp(this._declarationLView,F,i,4096&this._declarationLView[ai]?4096:16,null,F.declTNode,null,null,null,a||null,h||null);j[ha]=this._declarationLView[this._declarationTContainer.index];const ce=this._declarationLView[Zo];return null!==ce&&(j[Zo]=ce.createEmbeddedView(F)),Rg(F,j,i),new Cp(j)}};function Xw(){return o_(qr(),dn())}function o_(e,i){return 4&e.type?new Kw(i,e,gh(e,i)):null}let s_=(()=>{class e{}return e.__NG_ELEMENT_ID__=rD,e})();function rD(){return Db(qr(),dn())}const oD=s_,xb=class extends oD{constructor(i,a,h){super(),this._lContainer=i,this._hostTNode=a,this._hostLView=h}get element(){return gh(this._hostTNode,this._hostLView)}get injector(){return new Zc(this._hostTNode,this._hostLView)}get parentInjector(){const i=Cr(this._hostTNode,this._hostLView);if(Kr(i)){const a=ar(i,this._hostLView),h=xs(i);return new Zc(a[Ln].data[h+8],a)}return new Zc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(i){const a=wb(this._lContainer);return null!==a&&a[i]||null}get length(){return this._lContainer.length-ho}createEmbeddedView(i,a,h){let _,T;"number"==typeof h?_=h:null!=h&&(_=h.index,T=h.injector);const j=i.createEmbeddedViewImpl(a||{},T,null);return this.insertImpl(j,_,false),j}createComponent(i,a,h,_,T){const F=i&&!function cd(e){return"function"==typeof e}(i);let j;if(F)j=a;else{const xn=a||{};j=xn.index,h=xn.injector,_=xn.projectableNodes,T=xn.environmentInjector||xn.ngModuleRef}const q=F?i:new Ep(dr(i)),ce=h||this.parentInjector;if(!T&&null==q.ngModule){const ti=(F?ce:this.parentInjector).get(xe,null);ti&&(T=ti)}dr(q.componentType??{});const _t=q.create(ce,_,null,T);return this.insertImpl(_t.hostView,j,false),_t}insert(i,a){return this.insertImpl(i,a,!1)}insertImpl(i,a,h){const _=i._lView,T=_[Ln];if(function Wr(e){return wi(e[Fi])}(_)){const q=this.indexOf(i);if(-1!==q)this.detach(q);else{const ce=_[Fi],Ce=new xb(ce,ce[Zr],ce[Fi]);Ce.detach(Ce.indexOf(i))}}const F=this._adjustIndex(a),j=this._lContainer;if(function Zu(e,i,a,h){const _=ho+h,T=a.length;h>0&&(a[_-1][ro]=i),h<T-ho?(i[ro]=a[_],Mh(a,ho+h,i)):(a.push(i),i[ro]=null),i[Fi]=a;const F=i[ha];null!==F&&a!==F&&function Jh(e,i){const a=e[Er];i[yr]!==i[Fi][Fi][yr]&&(e[Dl]=!0),null===a?e[Er]=[i]:a.push(i)}(F,i);const j=i[Zo];null!==j&&j.insertView(e),i[ai]|=128}(T,_,j,F),!h){const q=Sd(F,j),ce=_[Ei],Ce=Ec(ce,j[uo]);null!==Ce&&function Vp(e,i,a,h,_,T){h[rr]=_,h[Zr]=i,Sc(e,h,a,1,_,T)}(T,j[Zr],ce,_,Ce,q)}return i.attachToViewContainerRef(),Mh(jy(j),F,i),i}move(i,a){return this.insert(i,a)}indexOf(i){const a=wb(this._lContainer);return null!==a?a.indexOf(i):-1}remove(i){const a=this._adjustIndex(i,-1),h=Cd(this._lContainer,a);h&&(Fu(jy(this._lContainer),a),fp(h[Ln],h))}detach(i){const a=this._adjustIndex(i,-1),h=Cd(this._lContainer,a);return h&&null!=Fu(jy(this._lContainer),a)?new Cp(h):null}_adjustIndex(i,a=0){return i??this.length+a}};function wb(e){return e[8]}function jy(e){return e[8]||(e[8]=[])}function Db(e,i){let a;const h=i[e.index];return wi(h)?a=h:(a=Sm(h,i,null,e),i[e.index]=a,eg(i,a)),Cb(a,i,e,h),new xb(a,e,i)}let Cb=function Eb(e,i,a,h){if(e[uo])return;let _;_=8&a.type?K(h):function sD(e,i){const a=e[Ei],h=a.createComment(""),_=St(i,e);return ic(a,Ec(a,_),h,function ef(e,i){return e.nextSibling(i)}(a,_),!1),h}(i,a),e[uo]=_};class Hy{constructor(i){this.queryList=i,this.matches=null}clone(){return new Hy(this.queryList)}setDirty(){this.queryList.setDirty()}}class $y{constructor(i=[]){this.queries=i}createEmbeddedView(i){const a=i.queries;if(null!==a){const h=null!==i.contentQueries?i.contentQueries[0]:a.length,_=[];for(let T=0;T<h;T++){const F=a.getByIndex(T);_.push(this.queries[F.indexInDeclarationView].clone())}return new $y(_)}return null}insertView(i){this.dirtyQueriesWithMatches(i)}detachView(i){this.dirtyQueriesWithMatches(i)}dirtyQueriesWithMatches(i){for(let a=0;a<this.queries.length;a++)null!==Rb(i,a).matches&&this.queries[a].setDirty()}}class Tb{constructor(i,a,h=null){this.predicate=i,this.flags=a,this.read=h}}class Gy{constructor(i=[]){this.queries=i}elementStart(i,a){for(let h=0;h<this.queries.length;h++)this.queries[h].elementStart(i,a)}elementEnd(i){for(let a=0;a<this.queries.length;a++)this.queries[a].elementEnd(i)}embeddedTView(i){let a=null;for(let h=0;h<this.length;h++){const _=null!==a?a.length:0,T=this.getByIndex(h).embeddedTView(i,_);T&&(T.indexInDeclarationView=h,null!==a?a.push(T):a=[T])}return null!==a?new Gy(a):null}template(i,a){for(let h=0;h<this.queries.length;h++)this.queries[h].template(i,a)}getByIndex(i){return this.queries[i]}get length(){return this.queries.length}track(i){this.queries.push(i)}}class Wy{constructor(i,a=-1){this.metadata=i,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=a}elementStart(i,a){this.isApplyingToNode(a)&&this.matchTNode(i,a)}elementEnd(i){this._declarationNodeIndex===i.index&&(this._appliesToNextNode=!1)}template(i,a){this.elementStart(i,a)}embeddedTView(i,a){return this.isApplyingToNode(i)?(this.crossesNgTemplate=!0,this.addMatch(-i.index,a),new Wy(this.metadata)):null}isApplyingToNode(i){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const a=this._declarationNodeIndex;let h=i.parent;for(;null!==h&&8&h.type&&h.index!==a;)h=h.parent;return a===(null!==h?h.index:-1)}return this._appliesToNextNode}matchTNode(i,a){const h=this.metadata.predicate;if(Array.isArray(h))for(let _=0;_<h.length;_++){const T=h[_];this.matchTNodeWithReadOption(i,a,cD(a,T)),this.matchTNodeWithReadOption(i,a,ya(a,i,T,!1,!1))}else h===tm?4&a.type&&this.matchTNodeWithReadOption(i,a,-1):this.matchTNodeWithReadOption(i,a,ya(a,i,h,!1,!1))}matchTNodeWithReadOption(i,a,h){if(null!==h){const _=this.metadata.read;if(null!==_)if(_===mh||_===s_||_===tm&&4&a.type)this.addMatch(a.index,-2);else{const T=ya(a,i,_,!1,!1);null!==T&&this.addMatch(a.index,T)}else this.addMatch(a.index,h)}}addMatch(i,a){null===this.matches?this.matches=[i,a]:this.matches.push(i,a)}}function cD(e,i){const a=e.localNames;if(null!==a)for(let h=0;h<a.length;h+=2)if(a[h]===i)return a[h+1];return null}function dD(e,i,a,h){return-1===a?function uD(e,i){return 11&e.type?gh(e,i):4&e.type?o_(e,i):null}(i,e):-2===a?function hD(e,i,a){return a===mh?gh(i,e):a===tm?o_(i,e):a===s_?Db(i,e):void 0}(e,i,h):aa(e,e[Ln],a,i)}function Sb(e,i,a,h){const _=i[Zo].queries[h];if(null===_.matches){const T=e.data,F=a.matches,j=[];for(let q=0;q<F.length;q+=2){const ce=F[q];j.push(ce<0?null:dD(i,T[ce],F[q+1],a.metadata.read))}_.matches=j}return _.matches}function Zy(e,i,a,h){const _=e.queries.getByIndex(a),T=_.matches;if(null!==T){const F=Sb(e,i,_,a);for(let j=0;j<T.length;j+=2){const q=T[j];if(q>0)h.push(F[j/2]);else{const ce=T[j+1],Ce=i[-q];for(let Be=ho;Be<Ce.length;Be++){const ct=Ce[Be];ct[ha]===ct[Fi]&&Zy(ct[Ln],ct,ce,h)}if(null!==Ce[Er]){const Be=Ce[Er];for(let ct=0;ct<Be.length;ct++){const _t=Be[ct];Zy(_t[Ln],_t,ce,h)}}}}}return h}function Mb(e){const i=dn(),a=qi(),h=_a();Va(h+1);const _=Rb(a,h);if(e.dirty&&function lr(e){return 4==(4&e[ai])}(i)===(2==(2&_.metadata.flags))){if(null===_.matches)e.reset([]);else{const T=_.crossesNgTemplate?Zy(a,i,h,[]):Sb(a,i,_,h);e.reset(T,Hp),e.notifyOnChanges()}return!0}return!1}function Ab(e,i,a){const h=qi();h.firstCreatePass&&(Nb(h,new Tb(e,i,a),-1),2==(2&i)&&(h.staticViewQueries=!0)),Pb(h,dn(),i)}function Ib(e,i,a,h){const _=qi();if(_.firstCreatePass){const T=qr();Nb(_,new Tb(i,a,h),T.index),function pD(e,i){const a=e.contentQueries||(e.contentQueries=[]);i!==(a.length?a[a.length-1]:-1)&&a.push(e.queries.length-1,i)}(_,e),2==(2&a)&&(_.staticContentQueries=!0)}Pb(_,dn(),a)}function Ob(){return function fD(e,i){return e[Zo].queries[i].queryList}(dn(),_a())}function Pb(e,i,a){const h=new Vy(4==(4&a));(function T_(e,i,a,h){const _=Am(i);_.push(a),e.firstCreatePass&&Im(e).push(h,_.length-1)})(e,i,h,h.destroy),null===i[Zo]&&(i[Zo]=new $y),i[Zo].queries.push(new Hy(h))}function Nb(e,i,a){null===e.queries&&(e.queries=new Gy),e.queries.track(new Wy(i,a))}function Rb(e,i){return e.queries.getByIndex(i)}function kb(e,i){return o_(e,i)}function Yy(e){return!!Po(e)}const Jb=new wr("Application Initializer");let Qy=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((a,h)=>{this.resolve=a,this.reject=h}),this.appInits=oe(Jb,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const a=[];for(const _ of this.appInits){const T=_();if(Ea(T))a.push(T);else if(uc(T)){const F=new Promise((j,q)=>{T.subscribe({complete:j,error:q})});a.push(F)}}const h=()=>{this.done=!0,this.resolve()};Promise.all(a).then(()=>{h()}).catch(_=>{this.reject(_)}),0===a.length&&h(),this.initialized=!0}}return e.\u0275fac=function(a){return new(a||e)},e.\u0275prov=An({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),Qb=(()=>{class e{log(a){console.log(a)}warn(a){console.warn(a)}}return e.\u0275fac=function(a){return new(a||e)},e.\u0275prov=An({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();const l_=new wr("LocaleId",{providedIn:"root",factory:()=>oe(l_,qn.Optional|qn.SkipSelf)||function kD(){return typeof $localize<"u"&&$localize.locale||ug}()}),FD=new wr("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let e1=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new ge.X(!1)}add(){this.hasPendingTasks.next(!0);const a=this.taskId++;return this.pendingTasks.add(a),a}remove(a){this.pendingTasks.delete(a),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return e.\u0275fac=function(a){return new(a||e)},e.\u0275prov=An({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();class LD{constructor(i,a){this.ngModuleFactory=i,this.componentFactories=a}}let BD=(()=>{class e{compileModuleSync(a){return new Ly(a)}compileModuleAsync(a){return Promise.resolve(this.compileModuleSync(a))}compileModuleAndAllComponentsSync(a){const h=this.compileModuleSync(a),T=kd(Po(a).declarations).reduce((F,j)=>{const q=dr(j);return q&&F.push(new Ep(q)),F},[]);return new LD(h,T)}compileModuleAndAllComponentsAsync(a){return Promise.resolve(this.compileModuleAndAllComponentsSync(a))}clearCache(){}clearCacheFor(a){}getModuleId(a){}}return e.\u0275fac=function(a){return new(a||e)},e.\u0275prov=An({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function i1(...e){}class Lc{constructor({enableLongStackTrace:i=!1,shouldCoalesceEventChangeDetection:a=!1,shouldCoalesceRunChangeDetection:h=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Th(!1),this.onMicrotaskEmpty=new Th(!1),this.onStable=new Th(!1),this.onError=new Th(!1),typeof Zone>"u")throw new lt(908,!1);Zone.assertZonePatched();const _=this;_._nesting=0,_._outer=_._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(_._inner=_._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(_._inner=_._inner.fork(Zone.longStackTraceZoneSpec)),_.shouldCoalesceEventChangeDetection=!h&&a,_.shouldCoalesceRunChangeDetection=h,_.lastRequestAnimationFrameId=-1,_.nativeRequestAnimationFrame=function UD(){const e="function"==typeof Rn.requestAnimationFrame;let i=Rn[e?"requestAnimationFrame":"setTimeout"],a=Rn[e?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&i&&a){const h=i[Zone.__symbol__("OriginalDelegate")];h&&(i=h);const _=a[Zone.__symbol__("OriginalDelegate")];_&&(a=_)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:a}}().nativeRequestAnimationFrame,function $D(e){const i=()=>{!function HD(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(Rn,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,tv(e),e.isCheckStableRunning=!0,ev(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),tv(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(a,h,_,T,F,j)=>{try{return r1(e),a.invokeTask(_,T,F,j)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===T.type||e.shouldCoalesceRunChangeDetection)&&i(),o1(e)}},onInvoke:(a,h,_,T,F,j,q)=>{try{return r1(e),a.invoke(_,T,F,j,q)}finally{e.shouldCoalesceRunChangeDetection&&i(),o1(e)}},onHasTask:(a,h,_,T)=>{a.hasTask(_,T),h===_&&("microTask"==T.change?(e._hasPendingMicrotasks=T.microTask,tv(e),ev(e)):"macroTask"==T.change&&(e.hasPendingMacrotasks=T.macroTask))},onHandleError:(a,h,_,T)=>(a.handleError(_,T),e.runOutsideAngular(()=>e.onError.emit(T)),!1)})}(_)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Lc.isInAngularZone())throw new lt(909,!1)}static assertNotInAngularZone(){if(Lc.isInAngularZone())throw new lt(909,!1)}run(i,a,h){return this._inner.run(i,a,h)}runTask(i,a,h,_){const T=this._inner,F=T.scheduleEventTask("NgZoneEvent: "+_,i,jD,i1,i1);try{return T.runTask(F,a,h)}finally{T.cancelTask(F)}}runGuarded(i,a,h){return this._inner.runGuarded(i,a,h)}runOutsideAngular(i){return this._outer.run(i)}}const jD={};function ev(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function tv(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function r1(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function o1(e){e._nesting--,ev(e)}class GD{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Th,this.onMicrotaskEmpty=new Th,this.onStable=new Th,this.onError=new Th}run(i,a,h){return i.apply(a,h)}runGuarded(i,a,h){return i.apply(a,h)}runOutsideAngular(i){return i()}runTask(i,a,h,_){return i.apply(a,h)}}const s1=new wr("",{providedIn:"root",factory:a1});function a1(){const e=oe(Lc);let i=!0;const a=new x.y(_=>{i=e.isStable&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks,e.runOutsideAngular(()=>{_.next(i),_.complete()})}),h=new x.y(_=>{let T;e.runOutsideAngular(()=>{T=e.onStable.subscribe(()=>{Lc.assertNotInAngularZone(),queueMicrotask(()=>{!i&&!e.hasPendingMacrotasks&&!e.hasPendingMicrotasks&&(i=!0,_.next(!0))})})});const F=e.onUnstable.subscribe(()=>{Lc.assertInAngularZone(),i&&(i=!1,e.runOutsideAngular(()=>{_.next(!1)}))});return()=>{T.unsubscribe(),F.unsubscribe()}});return(0,tt.T)(a,h.pipe($t()))}const l1=new wr(""),c1=new wr("");let nv,WD=(()=>{class e{constructor(a,h,_){this._ngZone=a,this.registry=h,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,nv||(function ZD(e){nv=e}(_),_.addToWindow(h)),this._watchAngularEvents(),a.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Lc.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let a=this._callbacks.pop();clearTimeout(a.timeoutId),a.doneCb(this._didWork)}this._didWork=!1});else{let a=this.getPendingTasks();this._callbacks=this._callbacks.filter(h=>!h.updateCb||!h.updateCb(a)||(clearTimeout(h.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(a=>({source:a.source,creationLocation:a.creationLocation,data:a.data})):[]}addCallback(a,h,_){let T=-1;h&&h>0&&(T=setTimeout(()=>{this._callbacks=this._callbacks.filter(F=>F.timeoutId!==T),a(this._didWork,this.getPendingTasks())},h)),this._callbacks.push({doneCb:a,timeoutId:T,updateCb:_})}whenStable(a,h,_){if(_&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(a,h,_),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(a){this.registry.registerApplication(a,this)}unregisterApplication(a){this.registry.unregisterApplication(a)}findProviders(a,h,_){return[]}}return e.\u0275fac=function(a){return new(a||e)(we(Lc),we(u1),we(c1))},e.\u0275prov=An({token:e,factory:e.\u0275fac}),e})(),u1=(()=>{class e{constructor(){this._applications=new Map}registerApplication(a,h){this._applications.set(a,h)}unregisterApplication(a){this._applications.delete(a)}unregisterAllApplications(){this._applications.clear()}getTestability(a){return this._applications.get(a)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(a,h=!0){return nv?.findTestabilityInTree(this,a,h)??null}}return e.\u0275fac=function(a){return new(a||e)},e.\u0275prov=An({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})(),ep=null;const d1=new wr("AllowMultipleToken"),iv=new wr("PlatformDestroyListeners"),rv=new wr("appBootstrapListener");class KD{constructor(i,a){this.name=i,this.token=a}}function p1(e,i,a=[]){const h=`Platform: ${i}`,_=new wr(h);return(T=[])=>{let F=ov();if(!F||F.injector.get(d1,!1)){const j=[...a,...T,{provide:_,useValue:!0}];e?e(j):function XD(e){if(ep&&!ep.get(d1,!1))throw new lt(400,!1);(function h1(){!function gl(e){Al=e}(()=>{throw new lt(600,!1)})})(),ep=e;const i=e.get(m1);(function f1(e){e.get(kn,null)?.forEach(a=>a())})(e)}(function g1(e=[],i){return yh.create({name:i,providers:[{provide:$,useValue:"platform"},{provide:iv,useValue:new Set([()=>ep=null])},...e]})}(j,h))}return function QD(e){const i=ov();if(!i)throw new lt(401,!1);return i}()}}function ov(){return ep?.get(m1)??null}let m1=(()=>{class e{constructor(a){this._injector=a,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(a,h){const _=function eC(e="zone.js",i){return"noop"===e?new GD:"zone.js"===e?new Lc(i):e}(h?.ngZone,function _1(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}({eventCoalescing:h?.ngZoneEventCoalescing,runCoalescing:h?.ngZoneRunCoalescing}));return _.run(()=>{const T=function Tw(e,i,a){return new Fy(e,i,a)}(a.moduleType,this.injector,function w1(e){return[{provide:Lc,useFactory:e},{provide:Au,multi:!0,useFactory:()=>{const i=oe(nC,{optional:!0});return()=>i.initialize()}},{provide:x1,useFactory:tC},{provide:s1,useFactory:a1}]}(()=>_)),F=T.injector.get(au,null);return _.runOutsideAngular(()=>{const j=_.onError.subscribe({next:q=>{F.handleError(q)}});T.onDestroy(()=>{c_(this._modules,T),j.unsubscribe()})}),function y1(e,i,a){try{const h=a();return Ea(h)?h.catch(_=>{throw i.runOutsideAngular(()=>e.handleError(_)),_}):h}catch(h){throw i.runOutsideAngular(()=>e.handleError(h)),h}}(F,_,()=>{const j=T.injector.get(Qy);return j.runInitializers(),j.donePromise.then(()=>(C0(T.injector.get(l_,ug)||ug),this._moduleDoBootstrap(T),T))})})}bootstrapModule(a,h=[]){const _=v1({},h);return function YD(e,i,a){const h=new Ly(a);return Promise.resolve(h)}(0,0,a).then(T=>this.bootstrapModuleFactory(T,_))}_moduleDoBootstrap(a){const h=a.injector.get(pg);if(a._bootstrapComponents.length>0)a._bootstrapComponents.forEach(_=>h.bootstrap(_));else{if(!a.instance.ngDoBootstrap)throw new lt(-403,!1);a.instance.ngDoBootstrap(h)}this._modules.push(a)}onDestroy(a){this._destroyListeners.push(a)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new lt(404,!1);this._modules.slice().forEach(h=>h.destroy()),this._destroyListeners.forEach(h=>h());const a=this._injector.get(iv,null);a&&(a.forEach(h=>h()),a.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(a){return new(a||e)(we(yh))},e.\u0275prov=An({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();function v1(e,i){return Array.isArray(i)?i.reduce(v1,e):{...e,...i}}let pg=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=oe(x1),this.zoneIsStable=oe(s1),this.componentTypes=[],this.components=[],this.isStable=oe(e1).hasPendingTasks.pipe((0,bt.w)(a=>a?(0,Pe.of)(!1):this.zoneIsStable),(0,Zt.x)(),$t()),this._injector=oe(xe)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(a,h){const _=a instanceof Bf;if(!this._injector.get(Qy).done)throw!_&&xo(a),new lt(405,!1);let F;F=_?a:this._injector.get(hf).resolveComponentFactory(a),this.componentTypes.push(F.componentType);const j=function qD(e){return e.isBoundToModule}(F)?void 0:this._injector.get(dg),ce=F.create(yh.NULL,[],h||F.selector,j),Ce=ce.location.nativeElement,Be=ce.injector.get(l1,null);return Be?.registerApplication(Ce),ce.onDestroy(()=>{this.detachView(ce.hostView),c_(this.components,ce),Be?.unregisterApplication(Ce)}),this._loadComponent(ce),ce}tick(){if(this._runningTick)throw new lt(101,!1);try{this._runningTick=!0;for(let a of this._views)a.detectChanges()}catch(a){this.internalErrorHandler(a)}finally{this._runningTick=!1}}attachView(a){const h=a;this._views.push(h),h.attachToAppRef(this)}detachView(a){const h=a;c_(this._views,h),h.detachFromAppRef()}_loadComponent(a){this.attachView(a.hostView),this.tick(),this.components.push(a);const h=this._injector.get(rv,[]);h.push(...this._bootstrapListeners),h.forEach(_=>_(a))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(a=>a()),this._views.slice().forEach(a=>a.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(a){return this._destroyListeners.push(a),()=>c_(this._destroyListeners,a)}destroy(){if(this._destroyed)throw new lt(406,!1);const a=this._injector;a.destroy&&!a.destroyed&&a.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return e.\u0275fac=function(a){return new(a||e)},e.\u0275prov=An({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function c_(e,i){const a=e.indexOf(i);a>-1&&e.splice(a,1)}const x1=new wr("",{providedIn:"root",factory:()=>oe(au).handleError.bind(void 0)});function tC(){const e=oe(Lc),i=oe(au);return a=>e.runOutsideAngular(()=>i.handleError(a))}let nC=(()=>{class e{constructor(){this.zone=oe(Lc),this.applicationRef=oe(pg)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return e.\u0275fac=function(a){return new(a||e)},e.\u0275prov=An({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();let rC=(()=>{class e{}return e.__NG_ELEMENT_ID__=oC,e})();function oC(e){return function sC(e,i,a){if(Oa(e)&&!a){const h=Ri(e.index,i);return new Cp(h,h)}return 47&e.type?new Cp(i[yr],i):null}(qr(),dn(),16==(16&e))}class T1{constructor(){}supports(i){return ig(i)}create(i){return new hC(i)}}const dC=(e,i)=>i;class hC{constructor(i){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=i||dC}forEachItem(i){let a;for(a=this._itHead;null!==a;a=a._next)i(a)}forEachOperation(i){let a=this._itHead,h=this._removalsHead,_=0,T=null;for(;a||h;){const F=!h||a&&a.currentIndex<M1(h,_,T)?a:h,j=M1(F,_,T),q=F.currentIndex;if(F===h)_--,h=h._nextRemoved;else if(a=a._next,null==F.previousIndex)_++;else{T||(T=[]);const ce=j-_,Ce=q-_;if(ce!=Ce){for(let ct=0;ct<ce;ct++){const _t=ct<T.length?T[ct]:T[ct]=0,an=_t+ct;Ce<=an&&an<ce&&(T[ct]=_t+1)}T[F.previousIndex]=Ce-ce}}j!==q&&i(F,j,q)}}forEachPreviousItem(i){let a;for(a=this._previousItHead;null!==a;a=a._nextPrevious)i(a)}forEachAddedItem(i){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)i(a)}forEachMovedItem(i){let a;for(a=this._movesHead;null!==a;a=a._nextMoved)i(a)}forEachRemovedItem(i){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)i(a)}forEachIdentityChange(i){let a;for(a=this._identityChangesHead;null!==a;a=a._nextIdentityChange)i(a)}diff(i){if(null==i&&(i=[]),!ig(i))throw new lt(900,!1);return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let _,T,F,a=this._itHead,h=!1;if(Array.isArray(i)){this.length=i.length;for(let j=0;j<this.length;j++)T=i[j],F=this._trackByFn(j,T),null!==a&&Object.is(a.trackById,F)?(h&&(a=this._verifyReinsertion(a,T,F,j)),Object.is(a.item,T)||this._addIdentityChange(a,T)):(a=this._mismatch(a,T,F,j),h=!0),a=a._next}else _=0,function Tp(e,i){if(Array.isArray(e))for(let a=0;a<e.length;a++)i(e[a]);else{const a=e[Symbol.iterator]();let h;for(;!(h=a.next()).done;)i(h.value)}}(i,j=>{F=this._trackByFn(_,j),null!==a&&Object.is(a.trackById,F)?(h&&(a=this._verifyReinsertion(a,j,F,_)),Object.is(a.item,j)||this._addIdentityChange(a,j)):(a=this._mismatch(a,j,F,_),h=!0),a=a._next,_++}),this.length=_;return this._truncate(a),this.collection=i,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let i;for(i=this._previousItHead=this._itHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._additionsHead;null!==i;i=i._nextAdded)i.previousIndex=i.currentIndex;for(this._additionsHead=this._additionsTail=null,i=this._movesHead;null!==i;i=i._nextMoved)i.previousIndex=i.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(i,a,h,_){let T;return null===i?T=this._itTail:(T=i._prev,this._remove(i)),null!==(i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null))?(Object.is(i.item,a)||this._addIdentityChange(i,a),this._reinsertAfter(i,T,_)):null!==(i=null===this._linkedRecords?null:this._linkedRecords.get(h,_))?(Object.is(i.item,a)||this._addIdentityChange(i,a),this._moveAfter(i,T,_)):i=this._addAfter(new fC(a,h),T,_),i}_verifyReinsertion(i,a,h,_){let T=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null);return null!==T?i=this._reinsertAfter(T,i._prev,_):i.currentIndex!=_&&(i.currentIndex=_,this._addToMoves(i,_)),i}_truncate(i){for(;null!==i;){const a=i._next;this._addToRemovals(this._unlink(i)),i=a}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(i,a,h){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(i);const _=i._prevRemoved,T=i._nextRemoved;return null===_?this._removalsHead=T:_._nextRemoved=T,null===T?this._removalsTail=_:T._prevRemoved=_,this._insertAfter(i,a,h),this._addToMoves(i,h),i}_moveAfter(i,a,h){return this._unlink(i),this._insertAfter(i,a,h),this._addToMoves(i,h),i}_addAfter(i,a,h){return this._insertAfter(i,a,h),this._additionsTail=null===this._additionsTail?this._additionsHead=i:this._additionsTail._nextAdded=i,i}_insertAfter(i,a,h){const _=null===a?this._itHead:a._next;return i._next=_,i._prev=a,null===_?this._itTail=i:_._prev=i,null===a?this._itHead=i:a._next=i,null===this._linkedRecords&&(this._linkedRecords=new S1),this._linkedRecords.put(i),i.currentIndex=h,i}_remove(i){return this._addToRemovals(this._unlink(i))}_unlink(i){null!==this._linkedRecords&&this._linkedRecords.remove(i);const a=i._prev,h=i._next;return null===a?this._itHead=h:a._next=h,null===h?this._itTail=a:h._prev=a,i}_addToMoves(i,a){return i.previousIndex===a||(this._movesTail=null===this._movesTail?this._movesHead=i:this._movesTail._nextMoved=i),i}_addToRemovals(i){return null===this._unlinkedRecords&&(this._unlinkedRecords=new S1),this._unlinkedRecords.put(i),i.currentIndex=null,i._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=i,i._prevRemoved=null):(i._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=i),i}_addIdentityChange(i,a){return i.item=a,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=i:this._identityChangesTail._nextIdentityChange=i,i}}class fC{constructor(i,a){this.item=i,this.trackById=a,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class pC{constructor(){this._head=null,this._tail=null}add(i){null===this._head?(this._head=this._tail=i,i._nextDup=null,i._prevDup=null):(this._tail._nextDup=i,i._prevDup=this._tail,i._nextDup=null,this._tail=i)}get(i,a){let h;for(h=this._head;null!==h;h=h._nextDup)if((null===a||a<=h.currentIndex)&&Object.is(h.trackById,i))return h;return null}remove(i){const a=i._prevDup,h=i._nextDup;return null===a?this._head=h:a._nextDup=h,null===h?this._tail=a:h._prevDup=a,null===this._head}}class S1{constructor(){this.map=new Map}put(i){const a=i.trackById;let h=this.map.get(a);h||(h=new pC,this.map.set(a,h)),h.add(i)}get(i,a){const _=this.map.get(i);return _?_.get(i,a):null}remove(i){const a=i.trackById;return this.map.get(a).remove(i)&&this.map.delete(a),i}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function M1(e,i,a){const h=e.previousIndex;if(null===h)return h;let _=0;return a&&h<a.length&&(_=a[h]),h+i+_}class A1{constructor(){}supports(i){return i instanceof Map||Sp(i)}create(){return new gC}}class gC{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(i){let a;for(a=this._mapHead;null!==a;a=a._next)i(a)}forEachPreviousItem(i){let a;for(a=this._previousMapHead;null!==a;a=a._nextPrevious)i(a)}forEachChangedItem(i){let a;for(a=this._changesHead;null!==a;a=a._nextChanged)i(a)}forEachAddedItem(i){let a;for(a=this._additionsHead;null!==a;a=a._nextAdded)i(a)}forEachRemovedItem(i){let a;for(a=this._removalsHead;null!==a;a=a._nextRemoved)i(a)}diff(i){if(i){if(!(i instanceof Map||Sp(i)))throw new lt(900,!1)}else i=new Map;return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let a=this._mapHead;if(this._appendAfter=null,this._forEach(i,(h,_)=>{if(a&&a.key===_)this._maybeAddToChanges(a,h),this._appendAfter=a,a=a._next;else{const T=this._getOrCreateRecordForKey(_,h);a=this._insertBeforeOrAppend(a,T)}}),a){a._prev&&(a._prev._next=null),this._removalsHead=a;for(let h=a;null!==h;h=h._nextRemoved)h===this._mapHead&&(this._mapHead=null),this._records.delete(h.key),h._nextRemoved=h._next,h.previousValue=h.currentValue,h.currentValue=null,h._prev=null,h._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(i,a){if(i){const h=i._prev;return a._next=i,a._prev=h,i._prev=a,h&&(h._next=a),i===this._mapHead&&(this._mapHead=a),this._appendAfter=i,i}return this._appendAfter?(this._appendAfter._next=a,a._prev=this._appendAfter):this._mapHead=a,this._appendAfter=a,null}_getOrCreateRecordForKey(i,a){if(this._records.has(i)){const _=this._records.get(i);this._maybeAddToChanges(_,a);const T=_._prev,F=_._next;return T&&(T._next=F),F&&(F._prev=T),_._next=null,_._prev=null,_}const h=new mC(i);return this._records.set(i,h),h.currentValue=a,this._addToAdditions(h),h}_reset(){if(this.isDirty){let i;for(this._previousMapHead=this._mapHead,i=this._previousMapHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._changesHead;null!==i;i=i._nextChanged)i.previousValue=i.currentValue;for(i=this._additionsHead;null!=i;i=i._nextAdded)i.previousValue=i.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(i,a){Object.is(a,i.currentValue)||(i.previousValue=i.currentValue,i.currentValue=a,this._addToChanges(i))}_addToAdditions(i){null===this._additionsHead?this._additionsHead=this._additionsTail=i:(this._additionsTail._nextAdded=i,this._additionsTail=i)}_addToChanges(i){null===this._changesHead?this._changesHead=this._changesTail=i:(this._changesTail._nextChanged=i,this._changesTail=i)}_forEach(i,a){i instanceof Map?i.forEach(a):Object.keys(i).forEach(h=>a(i[h],h))}}class mC{constructor(i){this.key=i,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function I1(){return new uv([new T1])}let uv=(()=>{class e{constructor(a){this.factories=a}static create(a,h){if(null!=h){const _=h.factories.slice();a=a.concat(_)}return new e(a)}static extend(a){return{provide:e,useFactory:h=>e.create(a,h||I1()),deps:[[e,new ja,new Lu]]}}find(a){const h=this.factories.find(_=>_.supports(a));if(null!=h)return h;throw new lt(901,!1)}}return e.\u0275prov=An({token:e,providedIn:"root",factory:I1}),e})();function O1(){return new dv([new A1])}let dv=(()=>{class e{constructor(a){this.factories=a}static create(a,h){if(h){const _=h.factories.slice();a=a.concat(_)}return new e(a)}static extend(a){return{provide:e,useFactory:h=>e.create(a,h||O1()),deps:[[e,new ja,new Lu]]}}find(a){const h=this.factories.find(_=>_.supports(a));if(h)return h;throw new lt(901,!1)}}return e.\u0275prov=An({token:e,providedIn:"root",factory:O1}),e})();const vC=p1(null,"core",[]);let bC=(()=>{class e{constructor(a){}}return e.\u0275fac=function(a){return new(a||e)(we(pg))},e.\u0275mod=$s({type:e}),e.\u0275inj=We({}),e})();function AC(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}function OC(e,i){const a=dr(e),h=i.elementInjector||ve();return new Ep(a).create(h,i.projectableNodes,i.hostElement,i.environmentInjector)}function PC(e){const i=dr(e);if(!i)return null;const a=new Ep(i);return{get selector(){return a.selector},get type(){return a.componentType},get inputs(){return a.inputs},get outputs(){return a.outputs},get ngContentSelectors(){return a.ngContentSelectors},get isStandalone(){return i.standalone},get isSignal(){return i.signals}}}},6223:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{Cf:()=>Gn,JJ:()=>We,JU:()=>yt,On:()=>Oo,Wl:()=>$t,u5:()=>Rr});var m=_e(9468),be=_e(6814),ge=_e(7715),x=_e(9315),tt=_e(7398);let Pe=(()=>{class re{constructor(J,Ae){this._renderer=J,this._elementRef=Ae,this.onChange=Ft=>{},this.onTouched=()=>{}}setProperty(J,Ae){this._renderer.setProperty(this._elementRef.nativeElement,J,Ae)}registerOnTouched(J){this.onTouched=J}registerOnChange(J){this.onChange=J}setDisabledState(J){this.setProperty("disabled",J)}}return re.\u0275fac=function(J){return new(J||re)(m.Y36(m.Qsj),m.Y36(m.SBq))},re.\u0275dir=m.lG2({type:re}),re})(),Ze=(()=>{class re extends Pe{}return re.\u0275fac=function(){let ne;return function(Ae){return(ne||(ne=m.n5z(re)))(Ae||re)}}(),re.\u0275dir=m.lG2({type:re,features:[m.qOj]}),re})();const yt=new m.OlP("NgValueAccessor"),Ht={provide:yt,useExisting:(0,m.Gpc)(()=>$t),multi:!0};let $t=(()=>{class re extends Ze{writeValue(J){this.setProperty("checked",J)}}return re.\u0275fac=function(){let ne;return function(Ae){return(ne||(ne=m.n5z(re)))(Ae||re)}}(),re.\u0275dir=m.lG2({type:re,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(J,Ae){1&J&&m.NdJ("change",function(Vn){return Ae.onChange(Vn.target.checked)})("blur",function(){return Ae.onTouched()})},features:[m._Bn([Ht]),m.qOj]}),re})();const It={provide:yt,useExisting:(0,m.Gpc)(()=>dt),multi:!0},Zt=new m.OlP("CompositionEventMode");let dt=(()=>{class re extends Pe{constructor(J,Ae,Ft){super(J,Ae),this._compositionMode=Ft,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function bt(){const re=(0,be.q)()?(0,be.q)().getUserAgent():"";return/android (\d+)/.test(re.toLowerCase())}())}writeValue(J){this.setProperty("value",J??"")}_handleInput(J){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(J)}_compositionStart(){this._composing=!0}_compositionEnd(J){this._composing=!1,this._compositionMode&&this.onChange(J)}}return re.\u0275fac=function(J){return new(J||re)(m.Y36(m.Qsj),m.Y36(m.SBq),m.Y36(Zt,8))},re.\u0275dir=m.lG2({type:re,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(J,Ae){1&J&&m.NdJ("input",function(Vn){return Ae._handleInput(Vn.target.value)})("blur",function(){return Ae.onTouched()})("compositionstart",function(){return Ae._compositionStart()})("compositionend",function(Vn){return Ae._compositionEnd(Vn.target.value)})},features:[m._Bn([It]),m.qOj]}),re})();const Gn=new m.OlP("NgValidators"),yi=new m.OlP("NgAsyncValidators");function en(re){return null!=re}function ui(re){return(0,m.QGY)(re)?(0,ge.D)(re):re}function Jt(re){let ne={};return re.forEach(J=>{ne=null!=J?{...ne,...J}:ne}),0===Object.keys(ne).length?null:ne}function Pn(re,ne){return ne.map(J=>J(re))}function bi(re){return re.map(ne=>function Mi(re){return!re.validate}(ne)?ne:J=>ne.validate(J))}function ht(re){return null!=re?function ft(re){if(!re)return null;const ne=re.filter(en);return 0==ne.length?null:function(J){return Jt(Pn(J,ne))}}(bi(re)):null}function Nt(re){return null!=re?function Pt(re){if(!re)return null;const ne=re.filter(en);return 0==ne.length?null:function(J){const Ae=Pn(J,ne).map(ui);return(0,x.D)(Ae).pipe((0,tt.U)(Jt))}}(bi(re)):null}function hn(re,ne){return null===re?[ne]:Array.isArray(re)?[...re,ne]:[re,ne]}function mi(re){return re?Array.isArray(re)?re:[re]:[]}function zi(re,ne){return Array.isArray(re)?re.includes(ne):re===ne}function di(re,ne){const J=mi(ne);return mi(re).forEach(Ft=>{zi(J,Ft)||J.push(Ft)}),J}function Si(re,ne){return mi(ne).filter(J=>!zi(re,J))}class st{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(ne){this._rawValidators=ne||[],this._composedValidatorFn=ht(this._rawValidators)}_setAsyncValidators(ne){this._rawAsyncValidators=ne||[],this._composedAsyncValidatorFn=Nt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(ne){this._onDestroyCallbacks.push(ne)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(ne=>ne()),this._onDestroyCallbacks=[]}reset(ne=void 0){this.control&&this.control.reset(ne)}hasError(ne,J){return!!this.control&&this.control.hasError(ne,J)}getError(ne,J){return this.control?this.control.getError(ne,J):null}}class Ci extends st{get formDirective(){return null}get path(){return null}}class er extends st{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Mn{constructor(ne){this._cd=ne}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let We=(()=>{class re extends Mn{constructor(J){super(J)}}return re.\u0275fac=function(J){return new(J||re)(m.Y36(er,2))},re.\u0275dir=m.lG2({type:re,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(J,Ae){2&J&&m.ekj("ng-untouched",Ae.isUntouched)("ng-touched",Ae.isTouched)("ng-pristine",Ae.isPristine)("ng-dirty",Ae.isDirty)("ng-valid",Ae.isValid)("ng-invalid",Ae.isInvalid)("ng-pending",Ae.isPending)},features:[m.qOj]}),re})();const _r="VALID",Ai="INVALID",ur="PENDING",si="DISABLED";function ye(re){return null!=re&&!Array.isArray(re)&&"object"==typeof re}class $e{constructor(ne,J){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(ne),this._assignAsyncValidators(J)}get validator(){return this._composedValidatorFn}set validator(ne){this._rawValidators=this._composedValidatorFn=ne}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(ne){this._rawAsyncValidators=this._composedAsyncValidatorFn=ne}get parent(){return this._parent}get valid(){return this.status===_r}get invalid(){return this.status===Ai}get pending(){return this.status==ur}get disabled(){return this.status===si}get enabled(){return this.status!==si}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(ne){this._assignValidators(ne)}setAsyncValidators(ne){this._assignAsyncValidators(ne)}addValidators(ne){this.setValidators(di(ne,this._rawValidators))}addAsyncValidators(ne){this.setAsyncValidators(di(ne,this._rawAsyncValidators))}removeValidators(ne){this.setValidators(Si(ne,this._rawValidators))}removeAsyncValidators(ne){this.setAsyncValidators(Si(ne,this._rawAsyncValidators))}hasValidator(ne){return zi(this._rawValidators,ne)}hasAsyncValidator(ne){return zi(this._rawAsyncValidators,ne)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(ne={}){this.touched=!0,this._parent&&!ne.onlySelf&&this._parent.markAsTouched(ne)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(ne=>ne.markAllAsTouched())}markAsUntouched(ne={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(J=>{J.markAsUntouched({onlySelf:!0})}),this._parent&&!ne.onlySelf&&this._parent._updateTouched(ne)}markAsDirty(ne={}){this.pristine=!1,this._parent&&!ne.onlySelf&&this._parent.markAsDirty(ne)}markAsPristine(ne={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(J=>{J.markAsPristine({onlySelf:!0})}),this._parent&&!ne.onlySelf&&this._parent._updatePristine(ne)}markAsPending(ne={}){this.status=ur,!1!==ne.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!ne.onlySelf&&this._parent.markAsPending(ne)}disable(ne={}){const J=this._parentMarkedDirty(ne.onlySelf);this.status=si,this.errors=null,this._forEachChild(Ae=>{Ae.disable({...ne,onlySelf:!0})}),this._updateValue(),!1!==ne.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...ne,skipPristineCheck:J}),this._onDisabledChange.forEach(Ae=>Ae(!0))}enable(ne={}){const J=this._parentMarkedDirty(ne.onlySelf);this.status=_r,this._forEachChild(Ae=>{Ae.enable({...ne,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:ne.emitEvent}),this._updateAncestors({...ne,skipPristineCheck:J}),this._onDisabledChange.forEach(Ae=>Ae(!1))}_updateAncestors(ne){this._parent&&!ne.onlySelf&&(this._parent.updateValueAndValidity(ne),ne.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(ne){this._parent=ne}getRawValue(){return this.value}updateValueAndValidity(ne={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===_r||this.status===ur)&&this._runAsyncValidator(ne.emitEvent)),!1!==ne.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!ne.onlySelf&&this._parent.updateValueAndValidity(ne)}_updateTreeValidity(ne={emitEvent:!0}){this._forEachChild(J=>J._updateTreeValidity(ne)),this.updateValueAndValidity({onlySelf:!0,emitEvent:ne.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?si:_r}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(ne){if(this.asyncValidator){this.status=ur,this._hasOwnPendingAsyncValidator=!0;const J=ui(this.asyncValidator(this));this._asyncValidationSubscription=J.subscribe(Ae=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(Ae,{emitEvent:ne})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(ne,J={}){this.errors=ne,this._updateControlsErrors(!1!==J.emitEvent)}get(ne){let J=ne;return null==J||(Array.isArray(J)||(J=J.split(".")),0===J.length)?null:J.reduce((Ae,Ft)=>Ae&&Ae._find(Ft),this)}getError(ne,J){const Ae=J?this.get(J):this;return Ae&&Ae.errors?Ae.errors[ne]:null}hasError(ne,J){return!!this.getError(ne,J)}get root(){let ne=this;for(;ne._parent;)ne=ne._parent;return ne}_updateControlsErrors(ne){this.status=this._calculateStatus(),ne&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(ne)}_initObservables(){this.valueChanges=new m.vpe,this.statusChanges=new m.vpe}_calculateStatus(){return this._allControlsDisabled()?si:this.errors?Ai:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ur)?ur:this._anyControlsHaveStatus(Ai)?Ai:_r}_anyControlsHaveStatus(ne){return this._anyControls(J=>J.status===ne)}_anyControlsDirty(){return this._anyControls(ne=>ne.dirty)}_anyControlsTouched(){return this._anyControls(ne=>ne.touched)}_updatePristine(ne={}){this.pristine=!this._anyControlsDirty(),this._parent&&!ne.onlySelf&&this._parent._updatePristine(ne)}_updateTouched(ne={}){this.touched=this._anyControlsTouched(),this._parent&&!ne.onlySelf&&this._parent._updateTouched(ne)}_registerOnCollectionChange(ne){this._onCollectionChange=ne}_setUpdateStrategy(ne){ye(ne)&&null!=ne.updateOn&&(this._updateOn=ne.updateOn)}_parentMarkedDirty(ne){return!ne&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(ne){return null}_assignValidators(ne){this._rawValidators=Array.isArray(ne)?ne.slice():ne,this._composedValidatorFn=function Vo(re){return Array.isArray(re)?ht(re):re||null}(this._rawValidators)}_assignAsyncValidators(ne){this._rawAsyncValidators=Array.isArray(ne)?ne.slice():ne,this._composedAsyncValidatorFn=function he(re){return Array.isArray(re)?Nt(re):re||null}(this._rawAsyncValidators)}}const Xe=new m.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>gt}),gt="always";function wn(re,ne,J=gt){(function ut(re,ne){const J=function ln(re){return re._rawValidators}(re);null!==ne.validator?re.setValidators(hn(J,ne.validator)):"function"==typeof J&&re.setValidators([J]);const Ae=function oi(re){return re._rawAsyncValidators}(re);null!==ne.asyncValidator?re.setAsyncValidators(hn(Ae,ne.asyncValidator)):"function"==typeof Ae&&re.setAsyncValidators([Ae]);const Ft=()=>re.updateValueAndValidity();Cn(ne._rawValidators,Ft),Cn(ne._rawAsyncValidators,Ft)})(re,ne),ne.valueAccessor.writeValue(re.value),(re.disabled||"always"===J)&&ne.valueAccessor.setDisabledState?.(re.disabled),function Ge(re,ne){ne.valueAccessor.registerOnChange(J=>{re._pendingValue=J,re._pendingChange=!0,re._pendingDirty=!0,"change"===re.updateOn&&tn(re,ne)})}(re,ne),function Wt(re,ne){const J=(Ae,Ft)=>{ne.valueAccessor.writeValue(Ae),Ft&&ne.viewToModelUpdate(Ae)};re.registerOnChange(J),ne._registerOnDestroy(()=>{re._unregisterOnChange(J)})}(re,ne),function Gt(re,ne){ne.valueAccessor.registerOnTouched(()=>{re._pendingTouched=!0,"blur"===re.updateOn&&re._pendingChange&&tn(re,ne),"submit"!==re.updateOn&&re.markAsTouched()})}(re,ne),function Fn(re,ne){if(ne.valueAccessor.setDisabledState){const J=Ae=>{ne.valueAccessor.setDisabledState(Ae)};re.registerOnDisabledChange(J),ne._registerOnDestroy(()=>{re._unregisterOnDisabledChange(J)})}}(re,ne)}function Cn(re,ne){re.forEach(J=>{J.registerOnValidatorChange&&J.registerOnValidatorChange(ne)})}function tn(re,ne){re._pendingDirty&&re.markAsDirty(),re.setValue(re._pendingValue,{emitModelToViewChange:!1}),ne.viewToModelUpdate(re._pendingValue),re._pendingChange=!1}function ds(re,ne){const J=re.indexOf(ne);J>-1&&re.splice(J,1)}function es(re){return"object"==typeof re&&null!==re&&2===Object.keys(re).length&&"value"in re&&"disabled"in re}const ir=class extends $e{constructor(ne=null,J,Ae){super(function Br(re){return(ye(re)?re.validators:re)||null}(J),function Le(re,ne){return(ye(ne)?ne.asyncValidators:re)||null}(Ae,J)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(ne),this._setUpdateStrategy(J),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),ye(J)&&(J.nonNullable||J.initialValueIsDefault)&&(this.defaultValue=es(ne)?ne.value:ne)}setValue(ne,J={}){this.value=this._pendingValue=ne,this._onChange.length&&!1!==J.emitModelToViewChange&&this._onChange.forEach(Ae=>Ae(this.value,!1!==J.emitViewToModelChange)),this.updateValueAndValidity(J)}patchValue(ne,J={}){this.setValue(ne,J)}reset(ne=this.defaultValue,J={}){this._applyFormState(ne),this.markAsPristine(J),this.markAsUntouched(J),this.setValue(this.value,J),this._pendingChange=!1}_updateValue(){}_anyControls(ne){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(ne){this._onChange.push(ne)}_unregisterOnChange(ne){ds(this._onChange,ne)}registerOnDisabledChange(ne){this._onDisabledChange.push(ne)}_unregisterOnDisabledChange(ne){ds(this._onDisabledChange,ne)}_forEachChild(ne){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(ne){es(ne)?(this.value=this._pendingValue=ne.value,ne.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=ne}},Qs={provide:er,useExisting:(0,m.Gpc)(()=>Oo)},$s=(()=>Promise.resolve())();let Oo=(()=>{class re extends er{constructor(J,Ae,Ft,Vn,Jr,Is){super(),this._changeDetectorRef=Jr,this.callSetDisabledState=Is,this.control=new ir,this._registered=!1,this.name="",this.update=new m.vpe,this._parent=J,this._setValidators(Ae),this._setAsyncValidators(Ft),this.valueAccessor=function hi(re,ne){if(!ne)return null;let J,Ae,Ft;return Array.isArray(ne),ne.forEach(Vn=>{Vn.constructor===dt?J=Vn:function Hr(re){return Object.getPrototypeOf(re.constructor)===Ze}(Vn)?Ae=Vn:Ft=Vn}),Ft||Ae||J||null}(0,Vn)}ngOnChanges(J){if(this._checkForErrors(),!this._registered||"name"in J){if(this._registered&&(this._checkName(),this.formDirective)){const Ae=J.name.previousValue;this.formDirective.removeControl({name:Ae,path:this._getPath(Ae)})}this._setUpControl()}"isDisabled"in J&&this._updateDisabled(J),function tr(re,ne){if(!re.hasOwnProperty("model"))return!1;const J=re.model;return!!J.isFirstChange()||!Object.is(ne,J.currentValue)}(J,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(J){this.viewModel=J,this.update.emit(J)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){wn(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(J){$s.then(()=>{this.control.setValue(J,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(J){const Ae=J.isDisabled.currentValue,Ft=0!==Ae&&(0,m.VuI)(Ae);$s.then(()=>{Ft&&!this.control.disabled?this.control.disable():!Ft&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(J){return this._parent?function mn(re,ne){return[...ne.path,re]}(J,this._parent):[J]}}return re.\u0275fac=function(J){return new(J||re)(m.Y36(Ci,9),m.Y36(Gn,10),m.Y36(yi,10),m.Y36(yt,10),m.Y36(m.sBO,8),m.Y36(Xe,8))},re.\u0275dir=m.lG2({type:re,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[m._Bn([Qs]),m.qOj,m.TTD]}),re})(),bo=(()=>{class re{}return re.\u0275fac=function(J){return new(J||re)},re.\u0275mod=m.oAB({type:re}),re.\u0275inj=m.cJS({}),re})(),gs=(()=>{class re{}return re.\u0275fac=function(J){return new(J||re)},re.\u0275mod=m.oAB({type:re}),re.\u0275inj=m.cJS({imports:[bo]}),re})(),Rr=(()=>{class re{static withConfig(J){return{ngModule:re,providers:[{provide:Xe,useValue:J.callSetDisabledState??gt}]}}}return re.\u0275fac=function(J){return new(J||re)},re.\u0275mod=m.oAB({type:re}),re.\u0275inj=m.cJS({imports:[gs]}),re})()},2614:()=>{"use strict";const ri=":";const er=function(mt,...We){if(er.translate){const kt=er.translate(mt,We);mt=kt[0],We=kt[1]}let Ot=An(mt[0],mt.raw[0]);for(let kt=1;kt<mt.length;kt++)Ot+=We[kt-1]+An(mt[kt],mt.raw[kt]);return Ot},Mn=":";function An(mt,We){return We.charAt(0)===Mn?mt.substring(function ht(mt,We){for(let Ot=1,kt=1;Ot<mt.length;Ot++,kt++)if("\\"===We[kt])kt++;else if(mt[Ot]===ri)return Ot;throw new Error(`Unterminated $localize metadata block in "${We}".`)}(mt,We)+1):mt}(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)().$localize=er},6593:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{Dx:()=>gn,b2:()=>An,q6:()=>st});var m=_e(9468),be=_e(6814);class ge extends be.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class x extends ge{static makeCurrent(){(0,be.HT)(new x)}onAndCancel(me,oe,Se){return me.addEventListener(oe,Se),()=>{me.removeEventListener(oe,Se)}}dispatchEvent(me,oe){me.dispatchEvent(oe)}remove(me){me.parentNode&&me.parentNode.removeChild(me)}createElement(me,oe){return(oe=oe||this.getDefaultDocument()).createElement(me)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(me){return me.nodeType===Node.ELEMENT_NODE}isShadowRoot(me){return me instanceof DocumentFragment}getGlobalEventTarget(me,oe){return"window"===oe?window:"document"===oe?me:"body"===oe?me.body:null}getBaseHref(me){const oe=function Pe(){return tt=tt||document.querySelector("base"),tt?tt.getAttribute("href"):null}();return null==oe?null:function yt(we){Ze=Ze||document.createElement("a"),Ze.setAttribute("href",we);const me=Ze.pathname;return"/"===me.charAt(0)?me:`/${me}`}(oe)}resetBaseElement(){tt=null}getUserAgent(){return window.navigator.userAgent}getCookie(me){return(0,be.Mx)(document.cookie,me)}}let Ze,tt=null,$t=(()=>{class we{build(){return new XMLHttpRequest}}return we.\u0275fac=function(oe){return new(oe||we)},we.\u0275prov=m.Yz7({token:we,factory:we.\u0275fac}),we})();const It=new m.OlP("EventManagerPlugins");let bt=(()=>{class we{constructor(oe,Se){this._zone=Se,this._eventNameToPlugin=new Map,oe.forEach(Ye=>{Ye.manager=this}),this._plugins=oe.slice().reverse()}addEventListener(oe,Se,Ye){return this._findPluginFor(Se).addEventListener(oe,Se,Ye)}getZone(){return this._zone}_findPluginFor(oe){let Se=this._eventNameToPlugin.get(oe);if(Se)return Se;if(Se=this._plugins.find(Xe=>Xe.supports(oe)),!Se)throw new m.vHH(5101,!1);return this._eventNameToPlugin.set(oe,Se),Se}}return we.\u0275fac=function(oe){return new(oe||we)(m.LFG(It),m.LFG(m.R0b))},we.\u0275prov=m.Yz7({token:we,factory:we.\u0275fac}),we})();class Zt{constructor(me){this._doc=me}}const dt="ng-app-id";let nn=(()=>{class we{constructor(oe,Se,Ye,Xe={}){this.doc=oe,this.appId=Se,this.nonce=Ye,this.platformId=Xe,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,be.PM)(Xe),this.resetHostNodes()}addStyles(oe){for(const Se of oe)1===this.changeUsageCount(Se,1)&&this.onStyleAdded(Se)}removeStyles(oe){for(const Se of oe)this.changeUsageCount(Se,-1)<=0&&this.onStyleRemoved(Se)}ngOnDestroy(){const oe=this.styleNodesInDOM;oe&&(oe.forEach(Se=>Se.remove()),oe.clear());for(const Se of this.getAllStyles())this.onStyleRemoved(Se);this.resetHostNodes()}addHost(oe){this.hostNodes.add(oe);for(const Se of this.getAllStyles())this.addStyleToHost(oe,Se)}removeHost(oe){this.hostNodes.delete(oe)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(oe){for(const Se of this.hostNodes)this.addStyleToHost(Se,oe)}onStyleRemoved(oe){const Se=this.styleRef;Se.get(oe)?.elements?.forEach(Ye=>Ye.remove()),Se.delete(oe)}collectServerRenderedStyles(){const oe=this.doc.head?.querySelectorAll(`style[${dt}="${this.appId}"]`);if(oe?.length){const Se=new Map;return oe.forEach(Ye=>{null!=Ye.textContent&&Se.set(Ye.textContent,Ye)}),Se}return null}changeUsageCount(oe,Se){const Ye=this.styleRef;if(Ye.has(oe)){const Xe=Ye.get(oe);return Xe.usage+=Se,Xe.usage}return Ye.set(oe,{usage:Se,elements:[]}),Se}getStyleElement(oe,Se){const Ye=this.styleNodesInDOM,Xe=Ye?.get(Se);if(Xe?.parentNode===oe)return Ye.delete(Se),Xe.removeAttribute(dt),Xe;{const gt=this.doc.createElement("style");return this.nonce&&gt.setAttribute("nonce",this.nonce),gt.textContent=Se,this.platformIsServer&&gt.setAttribute(dt,this.appId),gt}}addStyleToHost(oe,Se){const Ye=this.getStyleElement(oe,Se);oe.appendChild(Ye);const Xe=this.styleRef,gt=Xe.get(Se)?.elements;gt?gt.push(Ye):Xe.set(Se,{elements:[Ye],usage:1})}resetHostNodes(){const oe=this.hostNodes;oe.clear(),oe.add(this.doc.head)}}return we.\u0275fac=function(oe){return new(oe||we)(m.LFG(be.K0),m.LFG(m.AFp),m.LFG(m.Ojb,8),m.LFG(m.Lbi))},we.\u0275prov=m.Yz7({token:we,factory:we.\u0275fac}),we})();const Tn={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Gn=/%COMP%/g,wt=new m.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function lt(we,me){return me.map(oe=>oe.replace(Gn,we))}let zt=(()=>{class we{constructor(oe,Se,Ye,Xe,gt,mn,wn,sn=null){this.eventManager=oe,this.sharedStylesHost=Se,this.appId=Ye,this.removeStylesOnCompDestroy=Xe,this.doc=gt,this.platformId=mn,this.ngZone=wn,this.nonce=sn,this.rendererByCompId=new Map,this.platformIsServer=(0,be.PM)(mn),this.defaultRenderer=new nt(oe,gt,wn,this.platformIsServer)}createRenderer(oe,Se){if(!oe||!Se)return this.defaultRenderer;this.platformIsServer&&Se.encapsulation===m.ifc.ShadowDom&&(Se={...Se,encapsulation:m.ifc.Emulated});const Ye=this.getOrCreateRenderer(oe,Se);return Ye instanceof Pn?Ye.applyToHost(oe):Ye instanceof Jt&&Ye.applyStyles(),Ye}getOrCreateRenderer(oe,Se){const Ye=this.rendererByCompId;let Xe=Ye.get(Se.id);if(!Xe){const gt=this.doc,mn=this.ngZone,wn=this.eventManager,sn=this.sharedStylesHost,Cn=this.removeStylesOnCompDestroy,Fn=this.platformIsServer;switch(Se.encapsulation){case m.ifc.Emulated:Xe=new Pn(wn,sn,Se,this.appId,Cn,gt,mn,Fn);break;case m.ifc.ShadowDom:return new ui(wn,sn,oe,Se,gt,mn,this.nonce,Fn);default:Xe=new Jt(wn,sn,Se,Cn,gt,mn,Fn)}Xe.onDestroy=()=>Ye.delete(Se.id),Ye.set(Se.id,Xe)}return Xe}ngOnDestroy(){this.rendererByCompId.clear()}}return we.\u0275fac=function(oe){return new(oe||we)(m.LFG(bt),m.LFG(nn),m.LFG(m.AFp),m.LFG(wt),m.LFG(be.K0),m.LFG(m.Lbi),m.LFG(m.R0b),m.LFG(m.Ojb))},we.\u0275prov=m.Yz7({token:we,factory:we.\u0275fac}),we})();class nt{constructor(me,oe,Se,Ye){this.eventManager=me,this.doc=oe,this.ngZone=Se,this.platformIsServer=Ye,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(me,oe){return oe?this.doc.createElementNS(Tn[oe]||oe,me):this.doc.createElement(me)}createComment(me){return this.doc.createComment(me)}createText(me){return this.doc.createTextNode(me)}appendChild(me,oe){(en(me)?me.content:me).appendChild(oe)}insertBefore(me,oe,Se){me&&(en(me)?me.content:me).insertBefore(oe,Se)}removeChild(me,oe){me&&me.removeChild(oe)}selectRootElement(me,oe){let Se="string"==typeof me?this.doc.querySelector(me):me;if(!Se)throw new m.vHH(-5104,!1);return oe||(Se.textContent=""),Se}parentNode(me){return me.parentNode}nextSibling(me){return me.nextSibling}setAttribute(me,oe,Se,Ye){if(Ye){oe=Ye+":"+oe;const Xe=Tn[Ye];Xe?me.setAttributeNS(Xe,oe,Se):me.setAttribute(oe,Se)}else me.setAttribute(oe,Se)}removeAttribute(me,oe,Se){if(Se){const Ye=Tn[Se];Ye?me.removeAttributeNS(Ye,oe):me.removeAttribute(`${Se}:${oe}`)}else me.removeAttribute(oe)}addClass(me,oe){me.classList.add(oe)}removeClass(me,oe){me.classList.remove(oe)}setStyle(me,oe,Se,Ye){Ye&(m.JOm.DashCase|m.JOm.Important)?me.style.setProperty(oe,Se,Ye&m.JOm.Important?"important":""):me.style[oe]=Se}removeStyle(me,oe,Se){Se&m.JOm.DashCase?me.style.removeProperty(oe):me.style[oe]=""}setProperty(me,oe,Se){me[oe]=Se}setValue(me,oe){me.nodeValue=oe}listen(me,oe,Se){if("string"==typeof me&&!(me=(0,be.q)().getGlobalEventTarget(this.doc,me)))throw new Error(`Unsupported event target ${me} for event ${oe}`);return this.eventManager.addEventListener(me,oe,this.decoratePreventDefault(Se))}decoratePreventDefault(me){return oe=>{if("__ngUnwrap__"===oe)return me;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>me(oe)):me(oe))&&oe.preventDefault()}}}function en(we){return"TEMPLATE"===we.tagName&&void 0!==we.content}class ui extends nt{constructor(me,oe,Se,Ye,Xe,gt,mn,wn){super(me,Xe,gt,wn),this.sharedStylesHost=oe,this.hostEl=Se,this.shadowRoot=Se.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const sn=lt(Ye.id,Ye.styles);for(const Cn of sn){const Fn=document.createElement("style");mn&&Fn.setAttribute("nonce",mn),Fn.textContent=Cn,this.shadowRoot.appendChild(Fn)}}nodeOrShadowRoot(me){return me===this.hostEl?this.shadowRoot:me}appendChild(me,oe){return super.appendChild(this.nodeOrShadowRoot(me),oe)}insertBefore(me,oe,Se){return super.insertBefore(this.nodeOrShadowRoot(me),oe,Se)}removeChild(me,oe){return super.removeChild(this.nodeOrShadowRoot(me),oe)}parentNode(me){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(me)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Jt extends nt{constructor(me,oe,Se,Ye,Xe,gt,mn,wn){super(me,Xe,gt,mn),this.sharedStylesHost=oe,this.removeStylesOnCompDestroy=Ye,this.rendererUsageCount=0,this.styles=wn?lt(wn,Se.styles):Se.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestroy&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class Pn extends Jt{constructor(me,oe,Se,Ye,Xe,gt,mn,wn){const sn=Ye+"-"+Se.id;super(me,oe,Se,Xe,gt,mn,wn,sn),this.contentAttr=function Et(we){return"_ngcontent-%COMP%".replace(Gn,we)}(sn),this.hostAttr=function Bt(we){return"_nghost-%COMP%".replace(Gn,we)}(sn)}applyToHost(me){this.applyStyles(),this.setAttribute(me,this.hostAttr,"")}createElement(me,oe){const Se=super.createElement(me,oe);return super.setAttribute(Se,this.contentAttr,""),Se}}let Mi=(()=>{class we extends Zt{constructor(oe){super(oe)}supports(oe){return!0}addEventListener(oe,Se,Ye){return oe.addEventListener(Se,Ye,!1),()=>this.removeEventListener(oe,Se,Ye)}removeEventListener(oe,Se,Ye){return oe.removeEventListener(Se,Ye)}}return we.\u0275fac=function(oe){return new(oe||we)(m.LFG(be.K0))},we.\u0275prov=m.Yz7({token:we,factory:we.\u0275fac}),we})();const bi=["alt","control","meta","shift"],ft={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ht={alt:we=>we.altKey,control:we=>we.ctrlKey,meta:we=>we.metaKey,shift:we=>we.shiftKey};let Pt=(()=>{class we extends Zt{constructor(oe){super(oe)}supports(oe){return null!=we.parseEventName(oe)}addEventListener(oe,Se,Ye){const Xe=we.parseEventName(Se),gt=we.eventCallback(Xe.fullKey,Ye,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,be.q)().onAndCancel(oe,Xe.domEventName,gt))}static parseEventName(oe){const Se=oe.toLowerCase().split("."),Ye=Se.shift();if(0===Se.length||"keydown"!==Ye&&"keyup"!==Ye)return null;const Xe=we._normalizeKey(Se.pop());let gt="",mn=Se.indexOf("code");if(mn>-1&&(Se.splice(mn,1),gt="code."),bi.forEach(sn=>{const Cn=Se.indexOf(sn);Cn>-1&&(Se.splice(Cn,1),gt+=sn+".")}),gt+=Xe,0!=Se.length||0===Xe.length)return null;const wn={};return wn.domEventName=Ye,wn.fullKey=gt,wn}static matchEventFullKeyCode(oe,Se){let Ye=ft[oe.key]||oe.key,Xe="";return Se.indexOf("code.")>-1&&(Ye=oe.code,Xe="code."),!(null==Ye||!Ye)&&(Ye=Ye.toLowerCase()," "===Ye?Ye="space":"."===Ye&&(Ye="dot"),bi.forEach(gt=>{gt!==Ye&&(0,ht[gt])(oe)&&(Xe+=gt+".")}),Xe+=Ye,Xe===Se)}static eventCallback(oe,Se,Ye){return Xe=>{we.matchEventFullKeyCode(Xe,oe)&&Ye.runGuarded(()=>Se(Xe))}}static _normalizeKey(oe){return"esc"===oe?"escape":oe}}return we.\u0275fac=function(oe){return new(oe||we)(m.LFG(be.K0))},we.\u0275prov=m.Yz7({token:we,factory:we.\u0275fac}),we})();const st=(0,m.eFA)(m._c5,"browser",[{provide:m.Lbi,useValue:be.bD},{provide:m.g9A,useValue:function mi(){x.makeCurrent()},multi:!0},{provide:be.K0,useFactory:function di(){return(0,m.RDi)(document),document},deps:[]}]),Ci=new m.OlP(""),er=[{provide:m.rWj,useClass:class Ht{addToWindow(me){m.dqk.getAngularTestability=(Se,Ye=!0)=>{const Xe=me.findTestabilityInTree(Se,Ye);if(null==Xe)throw new m.vHH(5103,!1);return Xe},m.dqk.getAllAngularTestabilities=()=>me.getAllTestabilities(),m.dqk.getAllAngularRootElements=()=>me.getAllRootElements(),m.dqk.frameworkStabilizers||(m.dqk.frameworkStabilizers=[]),m.dqk.frameworkStabilizers.push(Se=>{const Ye=m.dqk.getAllAngularTestabilities();let Xe=Ye.length,gt=!1;const mn=function(wn){gt=gt||wn,Xe--,0==Xe&&Se(gt)};Ye.forEach(wn=>{wn.whenStable(mn)})})}findTestabilityInTree(me,oe,Se){return null==oe?null:me.getTestability(oe)??(Se?(0,be.q)().isShadowRoot(oe)?this.findTestabilityInTree(me,oe.host,!0):this.findTestabilityInTree(me,oe.parentElement,!0):null)}},deps:[]},{provide:m.lri,useClass:m.dDg,deps:[m.R0b,m.eoX,m.rWj]},{provide:m.dDg,useClass:m.dDg,deps:[m.R0b,m.eoX,m.rWj]}],Mn=[{provide:m.zSh,useValue:"root"},{provide:m.qLn,useFactory:function zi(){return new m.qLn},deps:[]},{provide:It,useClass:Mi,multi:!0,deps:[be.K0,m.R0b,m.Lbi]},{provide:It,useClass:Pt,multi:!0,deps:[be.K0]},zt,nn,bt,{provide:m.FYo,useExisting:zt},{provide:be.JF,useClass:$t,deps:[]},[]];let An=(()=>{class we{constructor(oe){}static withServerTransition(oe){return{ngModule:we,providers:[{provide:m.AFp,useValue:oe.appId}]}}}return we.\u0275fac=function(oe){return new(oe||we)(m.LFG(Ci,12))},we.\u0275mod=m.oAB({type:we}),we.\u0275inj=m.cJS({providers:[...Mn,...er],imports:[be.ez,m.hGG]}),we})(),gn=(()=>{class we{constructor(oe){this._doc=oe}getTitle(){return this._doc.title}setTitle(oe){this._doc.title=oe||""}}return we.\u0275fac=function(oe){return new(oe||we)(m.LFG(be.K0))},we.\u0275prov=m.Yz7({token:we,factory:function(oe){let Se=null;return Se=oe?new oe:function kt(){return new gn((0,m.LFG)(be.K0))}(),Se},providedIn:"root"}),we})();typeof window<"u"&&window},594:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{gz:()=>Gr,F0:()=>ys,rH:()=>pi,Bz:()=>n,lC:()=>Zo});var m=_e(9468),be=_e(5592),ge=_e(4674),tt=_e(7715),Pe=_e(2096),Ze=_e(5619),yt=_e(7453),Ht=_e(2737),$t=_e(7400),It=_e(9940),bt=_e(2714),Zt=_e(8251),dt=_e(7103);function nn(...R){const k=(0,It.yG)(R),O=(0,It.jO)(R),{args:z,keys:W}=(0,yt.D)(R);if(0===z.length)return(0,tt.D)([],k);const ie=new be.y(function Tn(R,k,O=Ht.y){return z=>{Gn(k,()=>{const{length:W}=R,ie=new Array(W);let ue=W,Ne=W;for(let et=0;et<W;et++)Gn(k,()=>{const Mt=(0,tt.D)(R[et],k);let vt=!1;Mt.subscribe((0,Zt.x)(z,on=>{ie[et]=on,vt||(vt=!0,Ne--),Ne||z.next(O(ie.slice()))},()=>{--ue||z.complete()}))},z)},z)}}(z,k,W?ue=>(0,bt.n)(W,ue):Ht.y));return O?ie.pipe((0,$t.Z)(O)):ie}function Gn(R,k,O){R?(0,dt.f)(O,R,k):k()}const vi=(0,_e(2306).d)(R=>function(){R(this),this.name="EmptyError",this.message="no elements in sequence"});var Vt=_e(5211),Tt=_e(4829);function wt(R){return new be.y(k=>{(0,Tt.Xf)(R()).subscribe(k)})}var Et=_e(8407);function Bt(R,k){const O=(0,ge.m)(R)?R:()=>R,z=W=>W.error(O());return new be.y(k?W=>k.schedule(z,0,W):z)}var lt=_e(6232),zt=_e(7394),nt=_e(9360);function xt(){return(0,nt.e)((R,k)=>{let O=null;R._refCount++;const z=(0,Zt.x)(k,void 0,void 0,void 0,()=>{if(!R||R._refCount<=0||0<--R._refCount)return void(O=null);const W=R._connection,ie=O;O=null,W&&(!ie||W===ie)&&W.unsubscribe(),k.unsubscribe()});R.subscribe(z),z.closed||(O=R.connect())})}class bn extends be.y{constructor(k,O){super(),this.source=k,this.subjectFactory=O,this._subject=null,this._refCount=0,this._connection=null,(0,nt.A)(k)&&(this.lift=k.lift)}_subscribe(k){return this.getSubject().subscribe(k)}getSubject(){const k=this._subject;return(!k||k.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:k}=this;this._subject=this._connection=null,k?.unsubscribe()}connect(){let k=this._connection;if(!k){k=this._connection=new zt.w0;const O=this.getSubject();k.add(this.source.subscribe((0,Zt.x)(O,void 0,()=>{this._teardown(),O.complete()},z=>{this._teardown(),O.error(z)},()=>this._teardown()))),k.closed&&(this._connection=null,k=zt.w0.EMPTY)}return k}refCount(){return xt()(this)}}var en=_e(8645),ui=_e(6814),Jt=_e(7398),Pn=_e(4664),Mi=_e(8180),bi=_e(7921),ft=_e(2181),ht=_e(1631);function Pt(R){return(0,nt.e)((k,O)=>{let z=!1;k.subscribe((0,Zt.x)(O,W=>{z=!0,O.next(W)},()=>{z||O.next(R),O.complete()}))})}function Nt(R=hn){return(0,nt.e)((k,O)=>{let z=!1;k.subscribe((0,Zt.x)(O,W=>{z=!0,O.next(W)},()=>z?O.complete():O.error(R())))})}function hn(){return new vi}function ln(R,k){const O=arguments.length>=2;return z=>z.pipe(R?(0,ft.h)((W,ie)=>R(W,ie,z)):Ht.y,(0,Mi.q)(1),O?Pt(k):Nt(()=>new vi))}var oi=_e(6328),mi=_e(9397);function zi(R){return(0,nt.e)((k,O)=>{let ie,z=null,W=!1;z=k.subscribe((0,Zt.x)(O,void 0,void 0,ue=>{ie=(0,Tt.Xf)(R(ue,zi(R)(k))),z?(z.unsubscribe(),z=null,ie.subscribe(O)):W=!0})),W&&(z.unsubscribe(),z=null,ie.subscribe(O))})}function st(R){return R<=0?()=>lt.E:(0,nt.e)((k,O)=>{let z=[];k.subscribe((0,Zt.x)(O,W=>{z.push(W),R<z.length&&z.shift()},()=>{for(const W of z)O.next(W);O.complete()},void 0,()=>{z=null}))})}var er=_e(975),Mn=_e(4716),An=_e(7537),mt=_e(6593);const We="primary",Ot=Symbol("RouteTitle");class kt{constructor(k){this.params=k||{}}has(k){return Object.prototype.hasOwnProperty.call(this.params,k)}get(k){if(this.has(k)){const O=this.params[k];return Array.isArray(O)?O[0]:O}return null}getAll(k){if(this.has(k)){const O=this.params[k];return Array.isArray(O)?O:[O]}return[]}get keys(){return Object.keys(this.params)}}function gn(R){return new kt(R)}function Yt(R,k,O){const z=O.path.split("/");if(z.length>R.length||"full"===O.pathMatch&&(k.hasChildren()||z.length<R.length))return null;const W={};for(let ie=0;ie<z.length;ie++){const ue=z[ie],Ne=R[ie];if(ue.startsWith(":"))W[ue.substring(1)]=Ne;else if(ue!==Ne.path)return null}return{consumed:R.slice(0,z.length),posParams:W}}function at(R,k){const O=R?Object.keys(R):void 0,z=k?Object.keys(k):void 0;if(!O||!z||O.length!=z.length)return!1;let W;for(let ie=0;ie<O.length;ie++)if(W=O[ie],!qt(R[W],k[W]))return!1;return!0}function qt(R,k){if(Array.isArray(R)&&Array.isArray(k)){if(R.length!==k.length)return!1;const O=[...R].sort(),z=[...k].sort();return O.every((W,ie)=>z[ie]===W)}return R===k}function yn(R){return R.length>0?R[R.length-1]:null}function Kn(R){return function x(R){return!!R&&(R instanceof be.y||(0,ge.m)(R.lift)&&(0,ge.m)(R.subscribe))}(R)?R:(0,m.QGY)(R)?(0,tt.D)(Promise.resolve(R)):(0,Pe.of)(R)}const qn={exact:function mr(R,k,O){if(!Br(R.segments,k.segments)||!Lr(R.segments,k.segments,O)||R.numberOfChildren!==k.numberOfChildren)return!1;for(const z in k.children)if(!R.children[z]||!mr(R.children[z],k.children[z],O))return!1;return!0},subset:Rn},rn={exact:function Qt(R,k){return at(R,k)},subset:function ii(R,k){return Object.keys(k).length<=Object.keys(R).length&&Object.keys(k).every(O=>qt(R[O],k[O]))},ignored:()=>!0};function On(R,k,O){return qn[O.paths](R.root,k.root,O.matrixParams)&&rn[O.queryParams](R.queryParams,k.queryParams)&&!("exact"===O.fragment&&R.fragment!==k.fragment)}function Rn(R,k,O){return Li(R,k,k.segments,O)}function Li(R,k,O,z){if(R.segments.length>O.length){const W=R.segments.slice(0,O.length);return!(!Br(W,O)||k.hasChildren()||!Lr(W,O,z))}if(R.segments.length===O.length){if(!Br(R.segments,O)||!Lr(R.segments,O,z))return!1;for(const W in k.children)if(!R.children[W]||!Rn(R.children[W],k.children[W],z))return!1;return!0}{const W=O.slice(0,R.segments.length),ie=O.slice(R.segments.length);return!!(Br(R.segments,W)&&Lr(R.segments,W,z)&&R.children[We])&&Li(R.children[We],k,ie,z)}}function Lr(R,k,O){return k.every((z,W)=>rn[O](R[W].parameters,z.parameters))}class _r{constructor(k=new Ai([],{}),O={},z=null){this.root=k,this.queryParams=O,this.fragment=z}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=gn(this.queryParams)),this._queryParamMap}toString(){return ye.serialize(this)}}class Ai{constructor(k,O){this.segments=k,this.children=O,this.parent=null,Object.values(O).forEach(z=>z.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ie(this)}}class ur{constructor(k,O){this.path=k,this.parameters=O}get parameterMap(){return this._parameterMap||(this._parameterMap=gn(this.parameters)),this._parameterMap}toString(){return Xe(this)}}function Br(R,k){return R.length===k.length&&R.every((O,z)=>O.path===k[z].path)}let Le=(()=>{class R{}return R.\u0275fac=function(O){return new(O||R)},R.\u0275prov=m.Yz7({token:R,factory:function(){return new he},providedIn:"root"}),R})();class he{parse(k){const O=new tn(k);return new _r(O.parseRootSegment(),O.parseQueryParams(),O.parseFragment())}serialize(k){const O=`/${Ve(k.root,!0)}`,z=function mn(R){const k=Object.keys(R).map(O=>{const z=R[O];return Array.isArray(z)?z.map(W=>`${we(O)}=${we(W)}`).join("&"):`${we(O)}=${we(z)}`}).filter(O=>!!O);return k.length?`?${k.join("&")}`:""}(k.queryParams);return`${O}${z}${"string"==typeof k.fragment?`#${function me(R){return encodeURI(R)}(k.fragment)}`:""}`}}const ye=new he;function Ie(R){return R.segments.map(k=>Xe(k)).join("/")}function Ve(R,k){if(!R.hasChildren())return Ie(R);if(k){const O=R.children[We]?Ve(R.children[We],!1):"",z=[];return Object.entries(R.children).forEach(([W,ie])=>{W!==We&&z.push(`${W}:${Ve(ie,!1)}`)}),z.length>0?`${O}(${z.join("//")})`:O}{const O=function Vo(R,k){let O=[];return Object.entries(R.children).forEach(([z,W])=>{z===We&&(O=O.concat(k(W,z)))}),Object.entries(R.children).forEach(([z,W])=>{z!==We&&(O=O.concat(k(W,z)))}),O}(R,(z,W)=>W===We?[Ve(R.children[We],!1)]:[`${W}:${Ve(z,!1)}`]);return 1===Object.keys(R.children).length&&null!=R.children[We]?`${Ie(R)}/${O[0]}`:`${Ie(R)}/(${O.join("//")})`}}function $e(R){return encodeURIComponent(R).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function we(R){return $e(R).replace(/%3B/gi,";")}function oe(R){return $e(R).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Se(R){return decodeURIComponent(R)}function Ye(R){return Se(R.replace(/\+/g,"%20"))}function Xe(R){return`${oe(R.path)}${function gt(R){return Object.keys(R).map(k=>`;${oe(k)}=${oe(R[k])}`).join("")}(R.parameters)}`}const wn=/^[^\/()?;#]+/;function sn(R){const k=R.match(wn);return k?k[0]:""}const Cn=/^[^\/()?;=#]+/,ut=/^[^=?&#]+/,Ge=/^[^&#]+/;class tn{constructor(k){this.url=k,this.remaining=k}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ai([],{}):new Ai([],this.parseChildren())}parseQueryParams(){const k={};if(this.consumeOptional("?"))do{this.parseQueryParam(k)}while(this.consumeOptional("&"));return k}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const k=[];for(this.peekStartsWith("(")||k.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),k.push(this.parseSegment());let O={};this.peekStartsWith("/(")&&(this.capture("/"),O=this.parseParens(!0));let z={};return this.peekStartsWith("(")&&(z=this.parseParens(!1)),(k.length>0||Object.keys(O).length>0)&&(z[We]=new Ai(k,O)),z}parseSegment(){const k=sn(this.remaining);if(""===k&&this.peekStartsWith(";"))throw new m.vHH(4009,!1);return this.capture(k),new ur(Se(k),this.parseMatrixParams())}parseMatrixParams(){const k={};for(;this.consumeOptional(";");)this.parseParam(k);return k}parseParam(k){const O=function Fn(R){const k=R.match(Cn);return k?k[0]:""}(this.remaining);if(!O)return;this.capture(O);let z="";if(this.consumeOptional("=")){const W=sn(this.remaining);W&&(z=W,this.capture(z))}k[Se(O)]=Se(z)}parseQueryParam(k){const O=function Oe(R){const k=R.match(ut);return k?k[0]:""}(this.remaining);if(!O)return;this.capture(O);let z="";if(this.consumeOptional("=")){const ue=function Gt(R){const k=R.match(Ge);return k?k[0]:""}(this.remaining);ue&&(z=ue,this.capture(z))}const W=Ye(O),ie=Ye(z);if(k.hasOwnProperty(W)){let ue=k[W];Array.isArray(ue)||(ue=[ue],k[W]=ue),ue.push(ie)}else k[W]=ie}parseParens(k){const O={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const z=sn(this.remaining),W=this.remaining[z.length];if("/"!==W&&")"!==W&&";"!==W)throw new m.vHH(4010,!1);let ie;z.indexOf(":")>-1?(ie=z.slice(0,z.indexOf(":")),this.capture(ie),this.capture(":")):k&&(ie=We);const ue=this.parseChildren();O[ie]=1===Object.keys(ue).length?ue[We]:new Ai([],ue),this.consumeOptional("//")}return O}peekStartsWith(k){return this.remaining.startsWith(k)}consumeOptional(k){return!!this.peekStartsWith(k)&&(this.remaining=this.remaining.substring(k.length),!0)}capture(k){if(!this.consumeOptional(k))throw new m.vHH(4011,!1)}}function Wt(R){return R.segments.length>0?new Ai([],{[We]:R}):R}function cn(R){const k={};for(const z of Object.keys(R.children)){const ie=cn(R.children[z]);if(z===We&&0===ie.segments.length&&ie.hasChildren())for(const[ue,Ne]of Object.entries(ie.children))k[ue]=Ne;else(ie.segments.length>0||ie.hasChildren())&&(k[z]=ie)}return function Zi(R){if(1===R.numberOfChildren&&R.children[We]){const k=R.children[We];return new Ai(R.segments.concat(k.segments),k.children)}return R}(new Ai(R.segments,k))}function Qn(R){return R instanceof _r}function ji(R){let k;const W=Wt(function O(ie){const ue={};for(const et of ie.children){const Mt=O(et);ue[et.outlet]=Mt}const Ne=new Ai(ie.url,ue);return ie===R&&(k=Ne),Ne}(R.root));return k??W}function Pr(R,k,O,z){let W=R;for(;W.parent;)W=W.parent;if(0===k.length)return Hr(W,W,W,O,z);const ie=function Uo(R){if("string"==typeof R[0]&&1===R.length&&"/"===R[0])return new hi(!0,0,R);let k=0,O=!1;const z=R.reduce((W,ie,ue)=>{if("object"==typeof ie&&null!=ie){if(ie.outlets){const Ne={};return Object.entries(ie.outlets).forEach(([et,Mt])=>{Ne[et]="string"==typeof Mt?Mt.split("/"):Mt}),[...W,{outlets:Ne}]}if(ie.segmentPath)return[...W,ie.segmentPath]}return"string"!=typeof ie?[...W,ie]:0===ue?(ie.split("/").forEach((Ne,et)=>{0==et&&"."===Ne||(0==et&&""===Ne?O=!0:".."===Ne?k++:""!=Ne&&W.push(Ne))}),W):[...W,ie]},[]);return new hi(O,k,z)}(k);if(ie.toRoot())return Hr(W,W,new Ai([],{}),O,z);const ue=function lo(R,k,O){if(R.isAbsolute)return new mo(k,!0,0);if(!O)return new mo(k,!1,NaN);if(null===O.parent)return new mo(O,!0,0);const z=Ki(R.commands[0])?0:1;return function Vi(R,k,O){let z=R,W=k,ie=O;for(;ie>W;){if(ie-=W,z=z.parent,!z)throw new m.vHH(4005,!1);W=z.segments.length}return new mo(z,!1,W-ie)}(O,O.segments.length-1+z,R.numberOfDoubleDots)}(ie,W,R),Ne=ue.processChildren?es(ue.segmentGroup,ue.index,ie.commands):ds(ue.segmentGroup,ue.index,ie.commands);return Hr(W,ue.segmentGroup,Ne,O,z)}function Ki(R){return"object"==typeof R&&null!=R&&!R.outlets&&!R.segmentPath}function tr(R){return"object"==typeof R&&null!=R&&R.outlets}function Hr(R,k,O,z,W){let ue,ie={};z&&Object.entries(z).forEach(([et,Mt])=>{ie[et]=Array.isArray(Mt)?Mt.map(vt=>`${vt}`):`${Mt}`}),ue=R===k?O:Hi(R,k,O);const Ne=Wt(cn(ue));return new _r(Ne,ie,W)}function Hi(R,k,O){const z={};return Object.entries(R.children).forEach(([W,ie])=>{z[W]=ie===k?O:Hi(ie,k,O)}),new Ai(R.segments,z)}class hi{constructor(k,O,z){if(this.isAbsolute=k,this.numberOfDoubleDots=O,this.commands=z,k&&z.length>0&&Ki(z[0]))throw new m.vHH(4003,!1);const W=z.find(tr);if(W&&W!==yn(z))throw new m.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class mo{constructor(k,O,z){this.segmentGroup=k,this.processChildren=O,this.index=z}}function ds(R,k,O){if(R||(R=new Ai([],{})),0===R.segments.length&&R.hasChildren())return es(R,k,O);const z=function ir(R,k,O){let z=0,W=k;const ie={match:!1,pathIndex:0,commandIndex:0};for(;W<R.segments.length;){if(z>=O.length)return ie;const ue=R.segments[W],Ne=O[z];if(tr(Ne))break;const et=`${Ne}`,Mt=z<O.length-1?O[z+1]:null;if(W>0&&void 0===et)break;if(et&&Mt&&"object"==typeof Mt&&void 0===Mt.outlets){if(!io(et,Mt,ue))return ie;z+=2}else{if(!io(et,{},ue))return ie;z++}W++}return{match:!0,pathIndex:W,commandIndex:z}}(R,k,O),W=O.slice(z.commandIndex);if(z.match&&z.pathIndex<R.segments.length){const ie=new Ai(R.segments.slice(0,z.pathIndex),{});return ie.children[We]=new Ai(R.segments.slice(z.pathIndex),R.children),es(ie,0,W)}return z.match&&0===W.length?new Ai(R.segments,{}):z.match&&!R.hasChildren()?Ts(R,k,O):z.match?es(R,0,W):Ts(R,k,O)}function es(R,k,O){if(0===O.length)return new Ai(R.segments,{});{const z=function us(R){return tr(R[0])?R[0].outlets:{[We]:R}}(O),W={};if(!z[We]&&R.children[We]&&1===R.numberOfChildren&&0===R.children[We].segments.length){const ie=es(R.children[We],k,O);return new Ai(R.segments,ie.children)}return Object.entries(z).forEach(([ie,ue])=>{"string"==typeof ue&&(ue=[ue]),null!==ue&&(W[ie]=ds(R.children[ie],k,ue))}),Object.entries(R.children).forEach(([ie,ue])=>{void 0===z[ie]&&(W[ie]=ue)}),new Ai(R.segments,W)}}function Ts(R,k,O){const z=R.segments.slice(0,k);let W=0;for(;W<O.length;){const ie=O[W];if(tr(ie)){const et=da(ie.outlets);return new Ai(z,et)}if(0===W&&Ki(O[0])){z.push(new ur(R.segments[k].path,Ss(O[0]))),W++;continue}const ue=tr(ie)?ie.outlets[We]:`${ie}`,Ne=W<O.length-1?O[W+1]:null;ue&&Ne&&Ki(Ne)?(z.push(new ur(ue,Ss(Ne))),W+=2):(z.push(new ur(ue,{})),W++)}return new Ai(z,{})}function da(R){const k={};return Object.entries(R).forEach(([O,z])=>{"string"==typeof z&&(z=[z]),null!==z&&(k[O]=Ts(new Ai([],{}),0,z))}),k}function Ss(R){const k={};return Object.entries(R).forEach(([O,z])=>k[O]=`${z}`),k}function io(R,k,O){return R==O.path&&at(k,O.parameters)}const Za="imperative";class ts{constructor(k,O){this.id=k,this.url=O}}class Ta extends ts{constructor(k,O,z="imperative",W=null){super(k,O),this.type=0,this.navigationTrigger=z,this.restoredState=W}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class hs extends ts{constructor(k,O,z){super(k,O),this.urlAfterRedirects=z,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Sa extends ts{constructor(k,O,z,W){super(k,O),this.reason=z,this.code=W,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Qs extends ts{constructor(k,O,z,W){super(k,O),this.reason=z,this.code=W,this.type=16}}class $s extends ts{constructor(k,O,z,W){super(k,O),this.error=z,this.target=W,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Oo extends ts{constructor(k,O,z,W){super(k,O),this.urlAfterRedirects=z,this.state=W,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ya extends ts{constructor(k,O,z,W){super(k,O),this.urlAfterRedirects=z,this.state=W,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ma extends ts{constructor(k,O,z,W,ie){super(k,O),this.urlAfterRedirects=z,this.state=W,this.shouldActivate=ie,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class dl extends ts{constructor(k,O,z,W){super(k,O),this.urlAfterRedirects=z,this.state=W,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class dr extends ts{constructor(k,O,z,W){super(k,O),this.urlAfterRedirects=z,this.state=W,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $r{constructor(k){this.route=k,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class bo{constructor(k){this.route=k,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class xo{constructor(k){this.snapshot=k,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Po{constructor(k){this.snapshot=k,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ms{constructor(k){this.snapshot=k,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ks{constructor(k){this.snapshot=k,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Gs{constructor(k,O,z){this.routerEvent=k,this.position=O,this.anchor=z,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Fs{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new rr,this.attachRef=null}}let rr=(()=>{class R{constructor(){this.contexts=new Map}onChildOutletCreated(O,z){const W=this.getOrCreateContext(O);W.outlet=z,this.contexts.set(O,W)}onChildOutletDestroyed(O){const z=this.getContext(O);z&&(z.outlet=null,z.attachRef=null)}onOutletDeactivated(){const O=this.contexts;return this.contexts=new Map,O}onOutletReAttached(O){this.contexts=O}getOrCreateContext(O){let z=this.getContext(O);return z||(z=new Fs,this.contexts.set(O,z)),z}getContext(O){return this.contexts.get(O)||null}}return R.\u0275fac=function(O){return new(O||R)},R.\u0275prov=m.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})();class Ln{constructor(k){this._root=k}get root(){return this._root.value}parent(k){const O=this.pathFromRoot(k);return O.length>1?O[O.length-2]:null}children(k){const O=ai(k,this._root);return O?O.children.map(z=>z.value):[]}firstChild(k){const O=ai(k,this._root);return O&&O.children.length>0?O.children[0].value:null}siblings(k){const O=Fi(k,this._root);return O.length<2?[]:O[O.length-2].children.map(W=>W.value).filter(W=>W!==k)}pathFromRoot(k){return Fi(k,this._root).map(O=>O.value)}}function ai(R,k){if(R===k.value)return k;for(const O of k.children){const z=ai(R,O);if(z)return z}return null}function Fi(R,k){if(R===k.value)return[k];for(const O of k.children){const z=Fi(R,O);if(z.length)return z.unshift(k),z}return[]}class ro{constructor(k,O){this.value=k,this.children=O}toString(){return`TreeNode(${this.value})`}}function $i(R){const k={};return R&&R.children.forEach(O=>k[O.value.outlet]=O),k}class Zr extends Ln{constructor(k,O){super(k),this.snapshot=O,ps(this,k)}toString(){return this.snapshot.toString()}}function fs(R,k){const O=function zr(R,k){const ue=new ns([],{},{},"",{},We,k,null,{});return new As("",new ro(ue,[]))}(0,k),z=new Ze.X([new ur("",{})]),W=new Ze.X({}),ie=new Ze.X({}),ue=new Ze.X({}),Ne=new Ze.X(""),et=new Gr(z,W,ue,Ne,ie,We,k,O.root);return et.snapshot=O.root,new Zr(new ro(et,[]),O)}class Gr{constructor(k,O,z,W,ie,ue,Ne,et){this.urlSubject=k,this.paramsSubject=O,this.queryParamsSubject=z,this.fragmentSubject=W,this.dataSubject=ie,this.outlet=ue,this.component=Ne,this._futureSnapshot=et,this.title=this.dataSubject?.pipe((0,Jt.U)(Mt=>Mt[Ot]))??(0,Pe.of)(void 0),this.url=k,this.params=O,this.queryParams=z,this.fragment=W,this.data=ie}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,Jt.U)(k=>gn(k)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,Jt.U)(k=>gn(k)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Ni(R,k="emptyOnly"){const O=R.pathFromRoot;let z=0;if("always"!==k)for(z=O.length-1;z>=1;){const W=O[z],ie=O[z-1];if(W.routeConfig&&""===W.routeConfig.path)z--;else{if(ie.component)break;z--}}return function Ei(R){return R.reduce((k,O)=>({params:{...k.params,...O.params},data:{...k.data,...O.data},resolve:{...O.data,...k.resolve,...O.routeConfig?.data,...O._resolvedData}}),{params:{},data:{},resolve:{}})}(O.slice(z))}class ns{get title(){return this.data?.[Ot]}constructor(k,O,z,W,ie,ue,Ne,et,Mt){this.url=k,this.params=O,this.queryParams=z,this.fragment=W,this.data=ie,this.outlet=ue,this.component=Ne,this.routeConfig=et,this._resolve=Mt}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=gn(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=gn(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(z=>z.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class As extends Ln{constructor(k,O){super(O),this.url=k,ps(this,O)}toString(){return yr(this._root)}}function ps(R,k){k.value._routerState=R,k.children.forEach(O=>ps(R,O))}function yr(R){const k=R.children.length>0?` { ${R.children.map(yr).join(", ")} } `:"";return`${R.value}${k}`}function ha(R){if(R.snapshot){const k=R.snapshot,O=R._futureSnapshot;R.snapshot=O,at(k.queryParams,O.queryParams)||R.queryParamsSubject.next(O.queryParams),k.fragment!==O.fragment&&R.fragmentSubject.next(O.fragment),at(k.params,O.params)||R.paramsSubject.next(O.params),function jn(R,k){if(R.length!==k.length)return!1;for(let O=0;O<R.length;++O)if(!at(R[O],k[O]))return!1;return!0}(k.url,O.url)||R.urlSubject.next(O.url),at(k.data,O.data)||R.dataSubject.next(O.data)}else R.snapshot=R._futureSnapshot,R.dataSubject.next(R._futureSnapshot.data)}function fa(R,k){const O=at(R.params,k.params)&&function si(R,k){return Br(R,k)&&R.every((O,z)=>at(O.parameters,k[z].parameters))}(R.url,k.url);return O&&!(!R.parent!=!k.parent)&&(!R.parent||fa(R.parent,k.parent))}let Zo=(()=>{class R{constructor(){this.activated=null,this._activatedRoute=null,this.name=We,this.activateEvents=new m.vpe,this.deactivateEvents=new m.vpe,this.attachEvents=new m.vpe,this.detachEvents=new m.vpe,this.parentContexts=(0,m.f3M)(rr),this.location=(0,m.f3M)(m.s_b),this.changeDetector=(0,m.f3M)(m.sBO),this.environmentInjector=(0,m.f3M)(m.lqb),this.inputBinder=(0,m.f3M)(Aa,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(O){if(O.name){const{firstChange:z,previousValue:W}=O.name;if(z)return;this.isTrackedInParentContexts(W)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(W)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(O){return this.parentContexts.getContext(O)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const O=this.parentContexts.getContext(this.name);O?.route&&(O.attachRef?this.attach(O.attachRef,O.route):this.activateWith(O.route,O.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new m.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new m.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new m.vHH(4012,!1);this.location.detach();const O=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(O.instance),O}attach(O,z){this.activated=O,this._activatedRoute=z,this.location.insert(O.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(O.instance)}deactivate(){if(this.activated){const O=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(O)}}activateWith(O,z){if(this.isActivated)throw new m.vHH(4013,!1);this._activatedRoute=O;const W=this.location,ue=O.snapshot.component,Ne=this.parentContexts.getOrCreateContext(this.name).children,et=new hl(O,Ne,W.injector);this.activated=W.createComponent(ue,{index:W.length,injector:et,environmentInjector:z??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return R.\u0275fac=function(O){return new(O||R)},R.\u0275dir=m.lG2({type:R,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[m.TTD]}),R})();class hl{constructor(k,O,z){this.route=k,this.childContexts=O,this.parent=z}get(k,O){return k===Gr?this.route:k===rr?this.childContexts:this.parent.get(k,O)}}const Aa=new m.OlP("");let jo=(()=>{class R{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(O){this.unsubscribeFromRouteData(O),this.subscribeToRouteData(O)}unsubscribeFromRouteData(O){this.outletDataSubscriptions.get(O)?.unsubscribe(),this.outletDataSubscriptions.delete(O)}subscribeToRouteData(O){const{activatedRoute:z}=O,W=nn([z.queryParams,z.params,z.data]).pipe((0,Pn.w)(([ie,ue,Ne],et)=>(Ne={...ie,...ue,...Ne},0===et?(0,Pe.of)(Ne):Promise.resolve(Ne)))).subscribe(ie=>{if(!O.isActivated||!O.activatedComponentRef||O.activatedRoute!==z||null===z.component)return void this.unsubscribeFromRouteData(O);const ue=(0,m.qFp)(z.component);if(ue)for(const{templateName:Ne}of ue.inputs)O.activatedComponentRef.setInput(Ne,ie[Ne]);else this.unsubscribeFromRouteData(O)});this.outletDataSubscriptions.set(O,W)}}return R.\u0275fac=function(O){return new(O||R)},R.\u0275prov=m.Yz7({token:R,factory:R.\u0275fac}),R})();function Ls(R,k,O){if(O&&R.shouldReuseRoute(k.value,O.value.snapshot)){const z=O.value;z._futureSnapshot=k.value;const W=function Ia(R,k,O){return k.children.map(z=>{for(const W of O.children)if(R.shouldReuseRoute(z.value,W.value.snapshot))return Ls(R,z,W);return Ls(R,z)})}(R,k,O);return new ro(z,W)}{if(R.shouldAttach(k.value)){const ie=R.retrieve(k.value);if(null!==ie){const ue=ie.route;return ue.value._futureSnapshot=k.value,ue.children=k.children.map(Ne=>Ls(R,Ne)),ue}}const z=function Ui(R){return new Gr(new Ze.X(R.url),new Ze.X(R.params),new Ze.X(R.queryParams),new Ze.X(R.fragment),new Ze.X(R.data),R.outlet,R.component,R)}(k.value),W=k.children.map(ie=>Ls(R,ie));return new ro(z,W)}}const ea="ngNavigationCancelingError";function pa(R,k){const{redirectTo:O,navigationBehaviorOptions:z}=Qn(k)?{redirectTo:k,navigationBehaviorOptions:void 0}:k,W=Dl(!1,0,k);return W.url=O,W.navigationBehaviorOptions=z,W}function Dl(R,k,O){const z=new Error("NavigationCancelingError: "+(R||""));return z[ea]=!0,z.cancellationCode=k,O&&(z.url=O),z}function uo(R){return Nr(R)&&Qn(R.url)}function Nr(R){return R&&R[ea]}let Er=(()=>{class R{}return R.\u0275fac=function(O){return new(O||R)},R.\u0275cmp=m.Xpm({type:R,selectors:[["ng-component"]],standalone:!0,features:[m.jDz],decls:1,vars:0,template:function(O,z){1&O&&m._UZ(0,"router-outlet")},dependencies:[Zo],encapsulation:2}),R})();function Cl(R){const k=R.children&&R.children.map(Cl),O=k?{...R,children:k}:{...R};return!O.component&&!O.loadComponent&&(k||O.loadChildren)&&O.outlet&&O.outlet!==We&&(O.component=Er),O}function gs(R){return R.outlet||We}function fl(R){if(!R)return null;if(R.routeConfig?._injector)return R.routeConfig._injector;for(let k=R.parent;k;k=k.parent){const O=k.routeConfig;if(O?._loadedInjector)return O._loadedInjector;if(O?._injector)return O._injector}return null}class Yr{constructor(k,O,z,W,ie){this.routeReuseStrategy=k,this.futureState=O,this.currState=z,this.forwardEvent=W,this.inputBindingEnabled=ie}activate(k){const O=this.futureState._root,z=this.currState?this.currState._root:null;this.deactivateChildRoutes(O,z,k),ha(this.futureState.root),this.activateChildRoutes(O,z,k)}deactivateChildRoutes(k,O,z){const W=$i(O);k.children.forEach(ie=>{const ue=ie.value.outlet;this.deactivateRoutes(ie,W[ue],z),delete W[ue]}),Object.values(W).forEach(ie=>{this.deactivateRouteAndItsChildren(ie,z)})}deactivateRoutes(k,O,z){const W=k.value,ie=O?O.value:null;if(W===ie)if(W.component){const ue=z.getContext(W.outlet);ue&&this.deactivateChildRoutes(k,O,ue.children)}else this.deactivateChildRoutes(k,O,z);else ie&&this.deactivateRouteAndItsChildren(O,z)}deactivateRouteAndItsChildren(k,O){k.value.component&&this.routeReuseStrategy.shouldDetach(k.value.snapshot)?this.detachAndStoreRouteSubtree(k,O):this.deactivateRouteAndOutlet(k,O)}detachAndStoreRouteSubtree(k,O){const z=O.getContext(k.value.outlet),W=z&&k.value.component?z.children:O,ie=$i(k);for(const ue of Object.keys(ie))this.deactivateRouteAndItsChildren(ie[ue],W);if(z&&z.outlet){const ue=z.outlet.detach(),Ne=z.children.onOutletDeactivated();this.routeReuseStrategy.store(k.value.snapshot,{componentRef:ue,route:k,contexts:Ne})}}deactivateRouteAndOutlet(k,O){const z=O.getContext(k.value.outlet),W=z&&k.value.component?z.children:O,ie=$i(k);for(const ue of Object.keys(ie))this.deactivateRouteAndItsChildren(ie[ue],W);z&&(z.outlet&&(z.outlet.deactivate(),z.children.onOutletDeactivated()),z.attachRef=null,z.route=null)}activateChildRoutes(k,O,z){const W=$i(O);k.children.forEach(ie=>{this.activateRoutes(ie,W[ie.value.outlet],z),this.forwardEvent(new ks(ie.value.snapshot))}),k.children.length&&this.forwardEvent(new Po(k.value.snapshot))}activateRoutes(k,O,z){const W=k.value,ie=O?O.value:null;if(ha(W),W===ie)if(W.component){const ue=z.getOrCreateContext(W.outlet);this.activateChildRoutes(k,O,ue.children)}else this.activateChildRoutes(k,O,z);else if(W.component){const ue=z.getOrCreateContext(W.outlet);if(this.routeReuseStrategy.shouldAttach(W.snapshot)){const Ne=this.routeReuseStrategy.retrieve(W.snapshot);this.routeReuseStrategy.store(W.snapshot,null),ue.children.onOutletReAttached(Ne.contexts),ue.attachRef=Ne.componentRef,ue.route=Ne.route.value,ue.outlet&&ue.outlet.attach(Ne.componentRef,Ne.route.value),ha(Ne.route.value),this.activateChildRoutes(k,null,ue.children)}else{const Ne=fl(W.snapshot);ue.attachRef=null,ue.route=W,ue.injector=Ne,ue.outlet&&ue.outlet.activateWith(W,ue.injector),this.activateChildRoutes(k,null,ue.children)}}else this.activateChildRoutes(k,null,z)}}class El{constructor(k){this.path=k,this.route=this.path[this.path.length-1]}}class Bi{constructor(k,O){this.component=k,this.route=O}}function $l(R,k,O){const z=R._root;return re(z,k?k._root:null,O,[z.value])}function vr(R,k){const O=Symbol(),z=k.get(R,O);return z===O?"function"!=typeof R||(0,m.Z0I)(R)?k.get(R):R:z}function re(R,k,O,z,W={canDeactivateChecks:[],canActivateChecks:[]}){const ie=$i(k);return R.children.forEach(ue=>{(function ne(R,k,O,z,W={canDeactivateChecks:[],canActivateChecks:[]}){const ie=R.value,ue=k?k.value:null,Ne=O?O.getContext(R.value.outlet):null;if(ue&&ie.routeConfig===ue.routeConfig){const et=function J(R,k,O){if("function"==typeof O)return O(R,k);switch(O){case"pathParamsChange":return!Br(R.url,k.url);case"pathParamsOrQueryParamsChange":return!Br(R.url,k.url)||!at(R.queryParams,k.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!fa(R,k)||!at(R.queryParams,k.queryParams);default:return!fa(R,k)}}(ue,ie,ie.routeConfig.runGuardsAndResolvers);et?W.canActivateChecks.push(new El(z)):(ie.data=ue.data,ie._resolvedData=ue._resolvedData),re(R,k,ie.component?Ne?Ne.children:null:O,z,W),et&&Ne&&Ne.outlet&&Ne.outlet.isActivated&&W.canDeactivateChecks.push(new Bi(Ne.outlet.component,ue))}else ue&&Ae(k,Ne,W),W.canActivateChecks.push(new El(z)),re(R,null,ie.component?Ne?Ne.children:null:O,z,W)})(ue,ie[ue.value.outlet],O,z.concat([ue.value]),W),delete ie[ue.value.outlet]}),Object.entries(ie).forEach(([ue,Ne])=>Ae(Ne,O.getContext(ue),W)),W}function Ae(R,k,O){const z=$i(R),W=R.value;Object.entries(z).forEach(([ie,ue])=>{Ae(ue,W.component?k?k.children.getContext(ie):null:k,O)}),O.canDeactivateChecks.push(new Bi(W.component&&k&&k.outlet&&k.outlet.isActivated?k.outlet.component:null,W))}function Ft(R){return"function"==typeof R}function fo(R){return R instanceof vi||"EmptyError"===R?.name}const ms=Symbol("INITIAL_VALUE");function wo(){return(0,Pn.w)(R=>nn(R.map(k=>k.pipe((0,Mi.q)(1),(0,bi.O)(ms)))).pipe((0,Jt.U)(k=>{for(const O of k)if(!0!==O){if(O===ms)return ms;if(!1===O||O instanceof _r)return O}return!0}),(0,ft.h)(k=>k!==ms),(0,Mi.q)(1)))}function Bc(R){return(0,Et.z)((0,mi.b)(k=>{if(Qn(k))throw pa(0,k)}),(0,Jt.U)(k=>!0===k))}class zo{constructor(k){this.segmentGroup=k||null}}class is{constructor(k){this.urlTree=k}}function ka(R){return Bt(new zo(R))}function cu(R){return Bt(new is(R))}class gl{constructor(k,O){this.urlSerializer=k,this.urlTree=O}noMatchError(k){return new m.vHH(4002,!1)}lineralizeSegments(k,O){let z=[],W=O.root;for(;;){if(z=z.concat(W.segments),0===W.numberOfChildren)return(0,Pe.of)(z);if(W.numberOfChildren>1||!W.children[We])return Bt(new m.vHH(4e3,!1));W=W.children[We]}}applyRedirectCommands(k,O,z){return this.applyRedirectCreateUrlTree(O,this.urlSerializer.parse(O),k,z)}applyRedirectCreateUrlTree(k,O,z,W){const ie=this.createSegmentGroup(k,O.root,z,W);return new _r(ie,this.createQueryParams(O.queryParams,this.urlTree.queryParams),O.fragment)}createQueryParams(k,O){const z={};return Object.entries(k).forEach(([W,ie])=>{if("string"==typeof ie&&ie.startsWith(":")){const Ne=ie.substring(1);z[W]=O[Ne]}else z[W]=ie}),z}createSegmentGroup(k,O,z,W){const ie=this.createSegments(k,O.segments,z,W);let ue={};return Object.entries(O.children).forEach(([Ne,et])=>{ue[Ne]=this.createSegmentGroup(k,et,z,W)}),new Ai(ie,ue)}createSegments(k,O,z,W){return O.map(ie=>ie.path.startsWith(":")?this.findPosParam(k,ie,W):this.findOrReturn(ie,z))}findPosParam(k,O,z){const W=z[O.path.substring(1)];if(!W)throw new m.vHH(4001,!1);return W}findOrReturn(k,O){let z=0;for(const W of O){if(W.path===k.path)return O.splice(z),W;z++}return k}}const ia={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function zc(R,k,O,z,W){const ie=Ws(R,k,O);return ie.matched?(z=function or(R,k){return R.providers&&!R._injector&&(R._injector=(0,m.MMx)(R.providers,k,`Route: ${R.path}`)),R._injector??k}(k,z),function Ml(R,k,O,z){const W=k.canMatch;if(!W||0===W.length)return(0,Pe.of)(!0);const ie=W.map(ue=>{const Ne=vr(ue,R);return Kn(function fc(R){return R&&Ft(R.canMatch)}(Ne)?Ne.canMatch(k,O):R.runInContext(()=>Ne(k,O)))});return(0,Pe.of)(ie).pipe(wo(),Bc())}(z,k,O).pipe((0,Jt.U)(ue=>!0===ue?ie:{...ia}))):(0,Pe.of)(ie)}function Ws(R,k,O){if(""===k.path)return"full"===k.pathMatch&&(R.hasChildren()||O.length>0)?{...ia}:{matched:!0,consumedSegments:[],remainingSegments:O,parameters:{},positionalParamSegments:{}};const W=(k.matcher||Yt)(O,R,k);if(!W)return{...ia};const ie={};Object.entries(W.posParams??{}).forEach(([Ne,et])=>{ie[Ne]=et.path});const ue=W.consumed.length>0?{...ie,...W.consumed[W.consumed.length-1].parameters}:ie;return{matched:!0,consumedSegments:W.consumed,remainingSegments:O.slice(W.consumed.length),parameters:ue,positionalParamSegments:W.posParams??{}}}function Os(R,k,O,z){return O.length>0&&function Fa(R,k,O){return O.some(z=>Yl(R,k,z)&&gs(z)!==We)}(R,O,z)?{segmentGroup:new Ai(k,po(z,new Ai(O,R.children))),slicedSegments:[]}:0===O.length&&function rd(R,k,O){return O.some(z=>Yl(R,k,z))}(R,O,z)?{segmentGroup:new Ai(R.segments,Zl(R,0,O,z,R.children)),slicedSegments:O}:{segmentGroup:new Ai(R.segments,R.children),slicedSegments:O}}function Zl(R,k,O,z,W){const ie={};for(const ue of z)if(Yl(R,O,ue)&&!W[gs(ue)]){const Ne=new Ai([],{});ie[gs(ue)]=Ne}return{...W,...ie}}function po(R,k){const O={};O[We]=k;for(const z of R)if(""===z.path&&gs(z)!==We){const W=new Ai([],{});O[gs(z)]=W}return O}function Yl(R,k,O){return(!(R.hasChildren()||k.length>0)||"full"!==O.pathMatch)&&""===O.path}class ra{constructor(k,O,z,W,ie,ue,Ne){this.injector=k,this.configLoader=O,this.rootComponentType=z,this.config=W,this.urlTree=ie,this.paramsInheritanceStrategy=ue,this.urlSerializer=Ne,this.allowRedirects=!0,this.applyRedirects=new gl(this.urlSerializer,this.urlTree)}noMatchError(k){return new m.vHH(4002,!1)}recognize(){const k=Os(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,k,We).pipe(zi(O=>{if(O instanceof is)return this.allowRedirects=!1,this.urlTree=O.urlTree,this.match(O.urlTree);throw O instanceof zo?this.noMatchError(O):O}),(0,Jt.U)(O=>{const z=new ns([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},We,this.rootComponentType,null,{}),W=new ro(z,O),ie=new As("",W),ue=function nr(R,k,O=null,z=null){return Pr(ji(R),k,O,z)}(z,[],this.urlTree.queryParams,this.urlTree.fragment);return ue.queryParams=this.urlTree.queryParams,ie.url=this.urlSerializer.serialize(ue),this.inheritParamsAndData(ie._root),{state:ie,tree:ue}}))}match(k){return this.processSegmentGroup(this.injector,this.config,k.root,We).pipe(zi(z=>{throw z instanceof zo?this.noMatchError(z):z}))}inheritParamsAndData(k){const O=k.value,z=Ni(O,this.paramsInheritanceStrategy);O.params=Object.freeze(z.params),O.data=Object.freeze(z.data),k.children.forEach(W=>this.inheritParamsAndData(W))}processSegmentGroup(k,O,z,W){return 0===z.segments.length&&z.hasChildren()?this.processChildren(k,O,z):this.processSegment(k,O,z,z.segments,W,!0)}processChildren(k,O,z){const W=[];for(const ie of Object.keys(z.children))"primary"===ie?W.unshift(ie):W.push(ie);return(0,tt.D)(W).pipe((0,oi.b)(ie=>{const ue=z.children[ie],Ne=function jl(R,k){const O=R.filter(z=>gs(z)===k);return O.push(...R.filter(z=>gs(z)!==k)),O}(O,ie);return this.processSegmentGroup(k,Ne,ue,ie)}),function Si(R,k){return(0,nt.e)(function di(R,k,O,z,W){return(ie,ue)=>{let Ne=O,et=k,Mt=0;ie.subscribe((0,Zt.x)(ue,vt=>{const on=Mt++;et=Ne?R(et,vt,on):(Ne=!0,vt),z&&ue.next(et)},W&&(()=>{Ne&&ue.next(et),ue.complete()})))}}(R,k,arguments.length>=2,!0))}((ie,ue)=>(ie.push(...ue),ie)),Pt(null),function Ci(R,k){const O=arguments.length>=2;return z=>z.pipe(R?(0,ft.h)((W,ie)=>R(W,ie,z)):Ht.y,st(1),O?Pt(k):Nt(()=>new vi))}(),(0,ht.z)(ie=>{if(null===ie)return ka(z);const ue=_s(ie);return function Xn(R){R.sort((k,O)=>k.value.outlet===We?-1:O.value.outlet===We?1:k.value.outlet.localeCompare(O.value.outlet))}(ue),(0,Pe.of)(ue)}))}processSegment(k,O,z,W,ie,ue){return(0,tt.D)(O).pipe((0,oi.b)(Ne=>this.processSegmentAgainstRoute(Ne._injector??k,O,Ne,z,W,ie,ue).pipe(zi(et=>{if(et instanceof zo)return(0,Pe.of)(null);throw et}))),ln(Ne=>!!Ne),zi(Ne=>{if(fo(Ne))return function Il(R,k,O){return 0===k.length&&!R.children[O]}(z,W,ie)?(0,Pe.of)([]):ka(z);throw Ne}))}processSegmentAgainstRoute(k,O,z,W,ie,ue,Ne){return function uu(R,k,O,z){return!!(gs(R)===z||z!==We&&Yl(k,O,R))&&("**"===R.path||Ws(k,R,O).matched)}(z,W,ie,ue)?void 0===z.redirectTo?this.matchSegmentAgainstRoute(k,W,z,ie,ue,Ne):Ne&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(k,W,O,z,ie,ue):ka(W):ka(W)}expandSegmentAgainstRouteUsingRedirect(k,O,z,W,ie,ue){return"**"===W.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(k,z,W,ue):this.expandRegularSegmentAgainstRouteUsingRedirect(k,O,z,W,ie,ue)}expandWildCardWithParamsAgainstRouteUsingRedirect(k,O,z,W){const ie=this.applyRedirects.applyRedirectCommands([],z.redirectTo,{});return z.redirectTo.startsWith("/")?cu(ie):this.applyRedirects.lineralizeSegments(z,ie).pipe((0,ht.z)(ue=>{const Ne=new Ai(ue,{});return this.processSegment(k,O,Ne,ue,W,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(k,O,z,W,ie,ue){const{matched:Ne,consumedSegments:et,remainingSegments:Mt,positionalParamSegments:vt}=Ws(O,W,ie);if(!Ne)return ka(O);const on=this.applyRedirects.applyRedirectCommands(et,W.redirectTo,vt);return W.redirectTo.startsWith("/")?cu(on):this.applyRedirects.lineralizeSegments(W,on).pipe((0,ht.z)(Hn=>this.processSegment(k,z,O,Hn.concat(Mt),ue,!1)))}matchSegmentAgainstRoute(k,O,z,W,ie,ue){let Ne;if("**"===z.path){const et=W.length>0?yn(W).parameters:{},Mt=new ns(W,et,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,rs(z),gs(z),z.component??z._loadedComponent??null,z,G(z));Ne=(0,Pe.of)({snapshot:Mt,consumedSegments:[],remainingSegments:[]}),O.children={}}else Ne=zc(O,z,W,k).pipe((0,Jt.U)(({matched:et,consumedSegments:Mt,remainingSegments:vt,parameters:on})=>et?{snapshot:new ns(Mt,on,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,rs(z),gs(z),z.component??z._loadedComponent??null,z,G(z)),consumedSegments:Mt,remainingSegments:vt}:null));return Ne.pipe((0,Pn.w)(et=>null===et?ka(O):this.getChildConfig(k=z._injector??k,z,W).pipe((0,Pn.w)(({routes:Mt})=>{const vt=z._loadedInjector??k,{snapshot:on,consumedSegments:Hn,remainingSegments:Pi}=et,{segmentGroup:Dn,slicedSegments:gi}=Os(O,Hn,Pi,Mt);if(0===gi.length&&Dn.hasChildren())return this.processChildren(vt,Mt,Dn).pipe((0,Jt.U)(cr=>null===cr?null:[new ro(on,cr)]));if(0===Mt.length&&0===gi.length)return(0,Pe.of)([new ro(on,[])]);const Bn=gs(z)===ie;return this.processSegment(vt,Mt,Dn,gi,Bn?We:ie,!0).pipe((0,Jt.U)(cr=>[new ro(on,cr)]))}))))}getChildConfig(k,O,z){return O.children?(0,Pe.of)({routes:O.children,injector:k}):O.loadChildren?void 0!==O._loadedRoutes?(0,Pe.of)({routes:O._loadedRoutes,injector:O._loadedInjector}):function Sl(R,k,O,z){const W=k.canLoad;if(void 0===W||0===W.length)return(0,Pe.of)(!0);const ie=W.map(ue=>{const Ne=vr(ue,R);return Kn(function Jr(R){return R&&Ft(R.canLoad)}(Ne)?Ne.canLoad(k,O):R.runInContext(()=>Ne(k,O)))});return(0,Pe.of)(ie).pipe(wo(),Bc())}(k,O,z).pipe((0,ht.z)(W=>W?this.configLoader.loadChildren(k,O).pipe((0,mi.b)(ie=>{O._loadedRoutes=ie.routes,O._loadedInjector=ie.injector})):function mc(R){return Bt(Dl(!1,3))}())):(0,Pe.of)({routes:[],injector:k})}}function Vc(R){const k=R.value.routeConfig;return k&&""===k.path}function _s(R){const k=[],O=new Set;for(const z of R){if(!Vc(z)){k.push(z);continue}const W=k.find(ie=>z.value.routeConfig===ie.value.routeConfig);void 0!==W?(W.children.push(...z.children),O.add(W)):k.push(z)}for(const z of O){const W=_s(z.children);k.push(new ro(z.value,W))}return k.filter(z=>!O.has(z))}function rs(R){return R.data||{}}function G(R){return R.resolve||{}}function ni(R){return"string"==typeof R.title||null===R.title}function sr(R){return(0,Pn.w)(k=>{const O=R(k);return O?(0,tt.D)(O).pipe((0,Jt.U)(()=>k)):(0,Pe.of)(k)})}const Ri=new m.OlP("ROUTES");let lr=(()=>{class R{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,m.f3M)(m.Sil)}loadComponent(O){if(this.componentLoaders.get(O))return this.componentLoaders.get(O);if(O._loadedComponent)return(0,Pe.of)(O._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(O);const z=Kn(O.loadComponent()).pipe((0,Jt.U)(Wr),(0,mi.b)(ie=>{this.onLoadEndListener&&this.onLoadEndListener(O),O._loadedComponent=ie}),(0,Mn.x)(()=>{this.componentLoaders.delete(O)})),W=new bn(z,()=>new en.x).pipe(xt());return this.componentLoaders.set(O,W),W}loadChildren(O,z){if(this.childrenLoaders.get(z))return this.childrenLoaders.get(z);if(z._loadedRoutes)return(0,Pe.of)({routes:z._loadedRoutes,injector:z._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(z);const ie=this.loadModuleFactoryOrRoutes(z.loadChildren).pipe((0,Jt.U)(Ne=>{this.onLoadEndListener&&this.onLoadEndListener(z);let et,Mt;return Array.isArray(Ne)?Mt=Ne:(et=Ne.create(O).injector,Mt=et.get(Ri,[],m.XFs.Self|m.XFs.Optional).flat()),{routes:Mt.map(Cl),injector:et}}),(0,Mn.x)(()=>{this.childrenLoaders.delete(z)})),ue=new bn(ie,()=>new en.x).pipe(xt());return this.childrenLoaders.set(z,ue),ue}loadModuleFactoryOrRoutes(O){return Kn(O()).pipe((0,Jt.U)(Wr),(0,ht.z)(z=>z instanceof m.YKP||Array.isArray(z)?(0,Pe.of)(z):(0,tt.D)(this.compiler.compileModuleAsync(z))))}}return R.\u0275fac=function(O){return new(O||R)},R.\u0275prov=m.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})();function Wr(R){return function Yi(R){return R&&"object"==typeof R&&"default"in R}(R)?R.default:R}let Ii=(()=>{class R{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new en.x,this.configLoader=(0,m.f3M)(lr),this.environmentInjector=(0,m.f3M)(m.lqb),this.urlSerializer=(0,m.f3M)(Le),this.rootContexts=(0,m.f3M)(rr),this.inputBindingEnabled=null!==(0,m.f3M)(Aa,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,Pe.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=W=>this.events.next(new bo(W)),this.configLoader.onLoadStartListener=W=>this.events.next(new $r(W))}complete(){this.transitions?.complete()}handleNavigationRequest(O){const z=++this.navigationId;this.transitions?.next({...this.transitions.value,...O,id:z})}setupNavigations(O){return this.transitions=new Ze.X({id:0,currentUrlTree:O.currentUrlTree,currentRawUrl:O.currentUrlTree,extractedUrl:O.urlHandlingStrategy.extract(O.currentUrlTree),urlAfterRedirects:O.urlHandlingStrategy.extract(O.currentUrlTree),rawUrl:O.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Za,restoredState:null,currentSnapshot:O.routerState.snapshot,targetSnapshot:null,currentRouterState:O.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,ft.h)(z=>0!==z.id),(0,Jt.U)(z=>({...z,extractedUrl:O.urlHandlingStrategy.extract(z.rawUrl)})),(0,Pn.w)(z=>{let W=!1,ie=!1;return(0,Pe.of)(z).pipe((0,mi.b)(ue=>{this.currentNavigation={id:ue.id,initialUrl:ue.rawUrl,extractedUrl:ue.extractedUrl,trigger:ue.source,extras:ue.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Pn.w)(ue=>{const Ne=O.browserUrlTree.toString(),et=!O.navigated||ue.extractedUrl.toString()!==Ne||Ne!==O.currentUrlTree.toString();if(!et&&"reload"!==(ue.extras.onSameUrlNavigation??O.onSameUrlNavigation)){const vt="";return this.events.next(new Qs(ue.id,O.serializeUrl(z.rawUrl),vt,0)),O.rawUrlTree=ue.rawUrl,ue.resolve(null),lt.E}if(O.urlHandlingStrategy.shouldProcessUrl(ue.rawUrl))return Vr(ue.source)&&(O.browserUrlTree=ue.extractedUrl),(0,Pe.of)(ue).pipe((0,Pn.w)(vt=>{const on=this.transitions?.getValue();return this.events.next(new Ta(vt.id,this.urlSerializer.serialize(vt.extractedUrl),vt.source,vt.restoredState)),on!==this.transitions?.getValue()?lt.E:Promise.resolve(vt)}),function de(R,k,O,z,W,ie){return(0,ht.z)(ue=>function _c(R,k,O,z,W,ie,ue="emptyOnly"){return new ra(R,k,O,z,W,ue,ie).recognize()}(R,k,O,z,ue.extractedUrl,W,ie).pipe((0,Jt.U)(({state:Ne,tree:et})=>({...ue,targetSnapshot:Ne,urlAfterRedirects:et}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,O.config,this.urlSerializer,O.paramsInheritanceStrategy),(0,mi.b)(vt=>{if(z.targetSnapshot=vt.targetSnapshot,z.urlAfterRedirects=vt.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:vt.urlAfterRedirects},"eager"===O.urlUpdateStrategy){if(!vt.extras.skipLocationChange){const Hn=O.urlHandlingStrategy.merge(vt.urlAfterRedirects,vt.rawUrl);O.setBrowserUrl(Hn,vt)}O.browserUrlTree=vt.urlAfterRedirects}const on=new Oo(vt.id,this.urlSerializer.serialize(vt.extractedUrl),this.urlSerializer.serialize(vt.urlAfterRedirects),vt.targetSnapshot);this.events.next(on)}));if(et&&O.urlHandlingStrategy.shouldProcessUrl(O.rawUrlTree)){const{id:vt,extractedUrl:on,source:Hn,restoredState:Pi,extras:Dn}=ue,gi=new Ta(vt,this.urlSerializer.serialize(on),Hn,Pi);this.events.next(gi);const Bn=fs(0,this.rootComponentType).snapshot;return z={...ue,targetSnapshot:Bn,urlAfterRedirects:on,extras:{...Dn,skipLocationChange:!1,replaceUrl:!1}},(0,Pe.of)(z)}{const vt="";return this.events.next(new Qs(ue.id,O.serializeUrl(z.extractedUrl),vt,1)),O.rawUrlTree=ue.rawUrl,ue.resolve(null),lt.E}}),(0,mi.b)(ue=>{const Ne=new Ya(ue.id,this.urlSerializer.serialize(ue.extractedUrl),this.urlSerializer.serialize(ue.urlAfterRedirects),ue.targetSnapshot);this.events.next(Ne)}),(0,Jt.U)(ue=>z={...ue,guards:$l(ue.targetSnapshot,ue.currentSnapshot,this.rootContexts)}),function pc(R,k){return(0,ht.z)(O=>{const{targetSnapshot:z,currentSnapshot:W,guards:{canActivateChecks:ie,canDeactivateChecks:ue}}=O;return 0===ue.length&&0===ie.length?(0,Pe.of)({...O,guardsResult:!0}):function gc(R,k,O,z){return(0,tt.D)(R).pipe((0,ht.z)(W=>function Qr(R,k,O,z,W){const ie=k&&k.routeConfig?k.routeConfig.canDeactivate:null;if(!ie||0===ie.length)return(0,Pe.of)(!0);const ue=ie.map(Ne=>{const et=fl(k)??W,Mt=vr(Ne,et);return Kn(function na(R){return R&&Ft(R.canDeactivate)}(Mt)?Mt.canDeactivate(R,k,O,z):et.runInContext(()=>Mt(R,k,O,z))).pipe(ln())});return(0,Pe.of)(ue).pipe(wo())}(W.component,W.route,O,k,z)),ln(W=>!0!==W,!0))}(ue,z,W,R).pipe((0,ht.z)(Ne=>Ne&&function Vn(R){return"boolean"==typeof R}(Ne)?function Na(R,k,O,z){return(0,tt.D)(k).pipe((0,oi.b)(W=>(0,Vt.z)(function ma(R,k){return null!==R&&k&&k(new xo(R)),(0,Pe.of)(!0)}(W.route.parent,z),function Ra(R,k){return null!==R&&k&&k(new Ms(R)),(0,Pe.of)(!0)}(W.route,z),function Wl(R,k,O){const z=k[k.length-1],ie=k.slice(0,k.length-1).reverse().map(ue=>function Rr(R){const k=R.routeConfig?R.routeConfig.canActivateChild:null;return k&&0!==k.length?{node:R,guards:k}:null}(ue)).filter(ue=>null!==ue).map(ue=>wt(()=>{const Ne=ue.guards.map(et=>{const Mt=fl(ue.node)??O,vt=vr(et,Mt);return Kn(function pl(R){return R&&Ft(R.canActivateChild)}(vt)?vt.canActivateChild(z,R):Mt.runInContext(()=>vt(z,R))).pipe(ln())});return(0,Pe.of)(Ne).pipe(wo())}));return(0,Pe.of)(ie).pipe(wo())}(R,W.path,O),function Do(R,k,O){const z=k.routeConfig?k.routeConfig.canActivate:null;if(!z||0===z.length)return(0,Pe.of)(!0);const W=z.map(ie=>wt(()=>{const ue=fl(k)??O,Ne=vr(ie,ue);return Kn(function Is(R){return R&&Ft(R.canActivate)}(Ne)?Ne.canActivate(k,R):ue.runInContext(()=>Ne(k,R))).pipe(ln())}));return(0,Pe.of)(W).pipe(wo())}(R,W.route,O))),ln(W=>!0!==W,!0))}(z,ie,R,k):(0,Pe.of)(Ne)),(0,Jt.U)(Ne=>({...O,guardsResult:Ne})))})}(this.environmentInjector,ue=>this.events.next(ue)),(0,mi.b)(ue=>{if(z.guardsResult=ue.guardsResult,Qn(ue.guardsResult))throw pa(0,ue.guardsResult);const Ne=new Ma(ue.id,this.urlSerializer.serialize(ue.extractedUrl),this.urlSerializer.serialize(ue.urlAfterRedirects),ue.targetSnapshot,!!ue.guardsResult);this.events.next(Ne)}),(0,ft.h)(ue=>!!ue.guardsResult||(O.restoreHistory(ue),this.cancelNavigationTransition(ue,"",3),!1)),sr(ue=>{if(ue.guards.canActivateChecks.length)return(0,Pe.of)(ue).pipe((0,mi.b)(Ne=>{const et=new dl(Ne.id,this.urlSerializer.serialize(Ne.extractedUrl),this.urlSerializer.serialize(Ne.urlAfterRedirects),Ne.targetSnapshot);this.events.next(et)}),(0,Pn.w)(Ne=>{let et=!1;return(0,Pe.of)(Ne).pipe(function K(R,k){return(0,ht.z)(O=>{const{targetSnapshot:z,guards:{canActivateChecks:W}}=O;if(!W.length)return(0,Pe.of)(O);let ie=0;return(0,tt.D)(W).pipe((0,oi.b)(ue=>function Ee(R,k,O,z){const W=R.routeConfig,ie=R._resolve;return void 0!==W?.title&&!ni(W)&&(ie[Ot]=W.title),function He(R,k,O,z){const W=function St(R){return[...Object.keys(R),...Object.getOwnPropertySymbols(R)]}(R);if(0===W.length)return(0,Pe.of)({});const ie={};return(0,tt.D)(W).pipe((0,ht.z)(ue=>function Kt(R,k,O,z){const W=fl(k)??z,ie=vr(R,W);return Kn(ie.resolve?ie.resolve(k,O):W.runInContext(()=>ie(k,O)))}(R[ue],k,O,z).pipe(ln(),(0,mi.b)(Ne=>{ie[ue]=Ne}))),st(1),(0,er.h)(ie),zi(ue=>fo(ue)?lt.E:Bt(ue)))}(ie,R,k,z).pipe((0,Jt.U)(ue=>(R._resolvedData=ue,R.data=Ni(R,O).resolve,W&&ni(W)&&(R.data[Ot]=W.title),null)))}(ue.route,z,R,k)),(0,mi.b)(()=>ie++),st(1),(0,ht.z)(ue=>ie===W.length?(0,Pe.of)(O):lt.E))})}(O.paramsInheritanceStrategy,this.environmentInjector),(0,mi.b)({next:()=>et=!0,complete:()=>{et||(O.restoreHistory(Ne),this.cancelNavigationTransition(Ne,"",2))}}))}),(0,mi.b)(Ne=>{const et=new dr(Ne.id,this.urlSerializer.serialize(Ne.extractedUrl),this.urlSerializer.serialize(Ne.urlAfterRedirects),Ne.targetSnapshot);this.events.next(et)}))}),sr(ue=>{const Ne=et=>{const Mt=[];et.routeConfig?.loadComponent&&!et.routeConfig._loadedComponent&&Mt.push(this.configLoader.loadComponent(et.routeConfig).pipe((0,mi.b)(vt=>{et.component=vt}),(0,Jt.U)(()=>{})));for(const vt of et.children)Mt.push(...Ne(vt));return Mt};return nn(Ne(ue.targetSnapshot.root)).pipe(Pt(),(0,Mi.q)(1))}),sr(()=>this.afterPreactivation()),(0,Jt.U)(ue=>{const Ne=function co(R,k,O){const z=Ls(R,k._root,O?O._root:void 0);return new Zr(z,k)}(O.routeReuseStrategy,ue.targetSnapshot,ue.currentRouterState);return z={...ue,targetRouterState:Ne}}),(0,mi.b)(ue=>{O.currentUrlTree=ue.urlAfterRedirects,O.rawUrlTree=O.urlHandlingStrategy.merge(ue.urlAfterRedirects,ue.rawUrl),O.routerState=ue.targetRouterState,"deferred"===O.urlUpdateStrategy&&(ue.extras.skipLocationChange||O.setBrowserUrl(O.rawUrlTree,ue),O.browserUrlTree=ue.urlAfterRedirects)}),((R,k,O,z)=>(0,Jt.U)(W=>(new Yr(k,W.targetRouterState,W.currentRouterState,O,z).activate(R),W)))(this.rootContexts,O.routeReuseStrategy,ue=>this.events.next(ue),this.inputBindingEnabled),(0,Mi.q)(1),(0,mi.b)({next:ue=>{W=!0,this.lastSuccessfulNavigation=this.currentNavigation,O.navigated=!0,this.events.next(new hs(ue.id,this.urlSerializer.serialize(ue.extractedUrl),this.urlSerializer.serialize(O.currentUrlTree))),O.titleStrategy?.updateTitle(ue.targetRouterState.snapshot),ue.resolve(!0)},complete:()=>{W=!0}}),(0,Mn.x)(()=>{W||ie||this.cancelNavigationTransition(z,"",1),this.currentNavigation?.id===z.id&&(this.currentNavigation=null)}),zi(ue=>{if(ie=!0,Nr(ue)){uo(ue)||(O.navigated=!0,O.restoreHistory(z,!0));const Ne=new Sa(z.id,this.urlSerializer.serialize(z.extractedUrl),ue.message,ue.cancellationCode);if(this.events.next(Ne),uo(ue)){const et=O.urlHandlingStrategy.merge(ue.url,O.rawUrlTree),Mt={skipLocationChange:z.extras.skipLocationChange,replaceUrl:"eager"===O.urlUpdateStrategy||Vr(z.source)};O.scheduleNavigation(et,Za,null,Mt,{resolve:z.resolve,reject:z.reject,promise:z.promise})}else z.resolve(!1)}else{O.restoreHistory(z,!0);const Ne=new $s(z.id,this.urlSerializer.serialize(z.extractedUrl),ue,z.targetSnapshot??void 0);this.events.next(Ne);try{z.resolve(O.errorHandler(ue))}catch(et){z.reject(et)}}return lt.E}))}))}cancelNavigationTransition(O,z,W){const ie=new Sa(O.id,this.urlSerializer.serialize(O.extractedUrl),z,W);this.events.next(ie),O.resolve(!1)}}return R.\u0275fac=function(O){return new(O||R)},R.\u0275prov=m.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})();function Vr(R){return R!==Za}let eo=(()=>{class R{buildTitle(O){let z,W=O.root;for(;void 0!==W;)z=this.getResolvedTitleForRoute(W)??z,W=W.children.find(ie=>ie.outlet===We);return z}getResolvedTitleForRoute(O){return O.data[Ot]}}return R.\u0275fac=function(O){return new(O||R)},R.\u0275prov=m.Yz7({token:R,factory:function(){return(0,m.f3M)(Ps)},providedIn:"root"}),R})(),Ps=(()=>{class R extends eo{constructor(O){super(),this.title=O}updateTitle(O){const z=this.buildTitle(O);void 0!==z&&this.title.setTitle(z)}}return R.\u0275fac=function(O){return new(O||R)(m.LFG(mt.Dx))},R.\u0275prov=m.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})(),oa=(()=>{class R{}return R.\u0275fac=function(O){return new(O||R)},R.\u0275prov=m.Yz7({token:R,factory:function(){return(0,m.f3M)(kr)},providedIn:"root"}),R})();class Co{shouldDetach(k){return!1}store(k,O){}shouldAttach(k){return!1}retrieve(k){return null}shouldReuseRoute(k,O){return k.routeConfig===O.routeConfig}}let kr=(()=>{class R extends Co{}return R.\u0275fac=function(){let k;return function(z){return(k||(k=m.n5z(R)))(z||R)}}(),R.\u0275prov=m.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})();const Nn=new m.OlP("",{providedIn:"root",factory:()=>({})});let Xi=(()=>{class R{}return R.\u0275fac=function(O){return new(O||R)},R.\u0275prov=m.Yz7({token:R,factory:function(){return(0,m.f3M)(Uc)},providedIn:"root"}),R})(),Uc=(()=>{class R{shouldProcessUrl(O){return!0}extract(O){return O}merge(O,z){return O}}return R.\u0275fac=function(O){return new(O||R)},R.\u0275prov=m.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})();var _o=(()=>((_o=_o||{})[_o.COMPLETE=0]="COMPLETE",_o[_o.FAILED=1]="FAILED",_o[_o.REDIRECTING=2]="REDIRECTING",_o))();function Ru(R,k){R.events.pipe((0,ft.h)(O=>O instanceof hs||O instanceof Sa||O instanceof $s||O instanceof Qs),(0,Jt.U)(O=>O instanceof hs||O instanceof Qs?_o.COMPLETE:O instanceof Sa&&(0===O.code||1===O.code)?_o.REDIRECTING:_o.FAILED),(0,ft.h)(O=>O!==_o.REDIRECTING),(0,Mi.q)(1)).subscribe(()=>{k()})}function ql(R){throw R}function du(R,k,O){return k.parse("/")}const Zs={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Ba={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ys=(()=>{class R{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,m.f3M)(m.c2e),this.isNgZoneEnabled=!1,this.options=(0,m.f3M)(Nn,{optional:!0})||{},this.pendingTasks=(0,m.f3M)(m.HDt),this.errorHandler=this.options.errorHandler||ql,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||du,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,m.f3M)(Xi),this.routeReuseStrategy=(0,m.f3M)(oa),this.titleStrategy=(0,m.f3M)(eo),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,m.f3M)(Ri,{optional:!0})?.flat()??[],this.navigationTransitions=(0,m.f3M)(Ii),this.urlSerializer=(0,m.f3M)(Le),this.location=(0,m.f3M)(ui.Ye),this.componentInputBindingEnabled=!!(0,m.f3M)(Aa,{optional:!0}),this.isNgZoneEnabled=(0,m.f3M)(m.R0b)instanceof m.R0b&&m.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new _r,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=fs(0,null),this.navigationTransitions.setupNavigations(this).subscribe(O=>{this.lastSuccessfulId=O.id,this.currentPageId=this.browserPageId??0},O=>{this.console.warn(`Unhandled Navigation Error: ${O}`)})}resetRootComponentType(O){this.routerState.root.component=O,this.navigationTransitions.rootComponentType=O}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const O=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Za,O)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(O=>{const z="popstate"===O.type?"popstate":"hashchange";"popstate"===z&&setTimeout(()=>{this.navigateToSyncWithBrowser(O.url,z,O.state)},0)}))}navigateToSyncWithBrowser(O,z,W){const ie={replaceUrl:!0},ue=W?.navigationId?W:null;if(W){const et={...W};delete et.navigationId,delete et.\u0275routerPageId,0!==Object.keys(et).length&&(ie.state=et)}const Ne=this.parseUrl(O);this.scheduleNavigation(Ne,z,ue,ie)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(O){this.config=O.map(Cl),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(O,z={}){const{relativeTo:W,queryParams:ie,fragment:ue,queryParamsHandling:Ne,preserveFragment:et}=z,Mt=et?this.currentUrlTree.fragment:ue;let on,vt=null;switch(Ne){case"merge":vt={...this.currentUrlTree.queryParams,...ie};break;case"preserve":vt=this.currentUrlTree.queryParams;break;default:vt=ie||null}null!==vt&&(vt=this.removeEmptyProps(vt));try{on=ji(W?W.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof O[0]||!O[0].startsWith("/"))&&(O=[]),on=this.currentUrlTree.root}return Pr(on,O,vt,Mt??null)}navigateByUrl(O,z={skipLocationChange:!1}){const W=Qn(O)?O:this.parseUrl(O),ie=this.urlHandlingStrategy.merge(W,this.rawUrlTree);return this.scheduleNavigation(ie,Za,null,z)}navigate(O,z={skipLocationChange:!1}){return function li(R){for(let k=0;k<R.length;k++)if(null==R[k])throw new m.vHH(4008,!1)}(O),this.navigateByUrl(this.createUrlTree(O,z),z)}serializeUrl(O){return this.urlSerializer.serialize(O)}parseUrl(O){let z;try{z=this.urlSerializer.parse(O)}catch(W){z=this.malformedUriErrorHandler(W,this.urlSerializer,O)}return z}isActive(O,z){let W;if(W=!0===z?{...Zs}:!1===z?{...Ba}:z,Qn(O))return On(this.currentUrlTree,O,W);const ie=this.parseUrl(O);return On(this.currentUrlTree,ie,W)}removeEmptyProps(O){return Object.keys(O).reduce((z,W)=>{const ie=O[W];return null!=ie&&(z[W]=ie),z},{})}scheduleNavigation(O,z,W,ie,ue){if(this.disposed)return Promise.resolve(!1);let Ne,et,Mt;ue?(Ne=ue.resolve,et=ue.reject,Mt=ue.promise):Mt=new Promise((on,Hn)=>{Ne=on,et=Hn});const vt=this.pendingTasks.add();return Ru(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(vt))}),this.navigationTransitions.handleNavigationRequest({source:z,restoredState:W,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:O,extras:ie,resolve:Ne,reject:et,promise:Mt,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Mt.catch(on=>Promise.reject(on))}setBrowserUrl(O,z){const W=this.urlSerializer.serialize(O);if(this.location.isCurrentPathEqualTo(W)||z.extras.replaceUrl){const ue={...z.extras.state,...this.generateNgRouterState(z.id,this.browserPageId)};this.location.replaceState(W,"",ue)}else{const ie={...z.extras.state,...this.generateNgRouterState(z.id,(this.browserPageId??0)+1)};this.location.go(W,"",ie)}}restoreHistory(O,z=!1){if("computed"===this.canceledNavigationResolution){const ie=this.currentPageId-(this.browserPageId??this.currentPageId);0!==ie?this.location.historyGo(ie):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===ie&&(this.resetState(O),this.browserUrlTree=O.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(z&&this.resetState(O),this.resetUrlToCurrentUrlTree())}resetState(O){this.routerState=O.currentRouterState,this.currentUrlTree=O.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,O.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(O,z){return"computed"===this.canceledNavigationResolution?{navigationId:O,\u0275routerPageId:z}:{navigationId:O}}}return R.\u0275fac=function(O){return new(O||R)},R.\u0275prov=m.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})(),pi=(()=>{class R{constructor(O,z,W,ie,ue,Ne){this.router=O,this.route=z,this.tabIndexAttribute=W,this.renderer=ie,this.el=ue,this.locationStrategy=Ne,this.href=null,this.commands=null,this.onChanges=new en.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const et=ue.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===et||"area"===et,this.isAnchorElement?this.subscription=O.events.subscribe(Mt=>{Mt instanceof hs&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(O){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",O)}ngOnChanges(O){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(O){null!=O?(this.commands=Array.isArray(O)?O:[O],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(O,z,W,ie,ue){return!!(null===this.urlTree||this.isAnchorElement&&(0!==O||z||W||ie||ue||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const O=null===this.href?null:(0,m.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",O)}applyAttributeValue(O,z){const W=this.renderer,ie=this.el.nativeElement;null!==z?W.setAttribute(ie,O,z):W.removeAttribute(ie,O)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return R.\u0275fac=function(O){return new(O||R)(m.Y36(ys),m.Y36(Gr),m.$8M("tabindex"),m.Y36(m.Qsj),m.Y36(m.SBq),m.Y36(ui.S$))},R.\u0275dir=m.lG2({type:R,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(O,z){1&O&&m.NdJ("click",function(ie){return z.onClick(ie.button,ie.ctrlKey,ie.shiftKey,ie.altKey,ie.metaKey)}),2&O&&m.uIk("target",z.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",m.VuI],skipLocationChange:["skipLocationChange","skipLocationChange",m.VuI],replaceUrl:["replaceUrl","replaceUrl",m.VuI],routerLink:"routerLink"},standalone:!0,features:[m.Xq5,m.TTD]}),R})();class qi{}let qr=(()=>{class R{constructor(O,z,W,ie,ue){this.router=O,this.injector=W,this.preloadingStrategy=ie,this.loader=ue}setUpPreloading(){this.subscription=this.router.events.pipe((0,ft.h)(O=>O instanceof hs),(0,oi.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(O,z){const W=[];for(const ie of z){ie.providers&&!ie._injector&&(ie._injector=(0,m.MMx)(ie.providers,O,`Route: ${ie.path}`));const ue=ie._injector??O,Ne=ie._loadedInjector??ue;(ie.loadChildren&&!ie._loadedRoutes&&void 0===ie.canLoad||ie.loadComponent&&!ie._loadedComponent)&&W.push(this.preloadConfig(ue,ie)),(ie.children||ie._loadedRoutes)&&W.push(this.processRoutes(Ne,ie.children??ie._loadedRoutes))}return(0,tt.D)(W).pipe((0,An.J)())}preloadConfig(O,z){return this.preloadingStrategy.preload(z,()=>{let W;W=z.loadChildren&&void 0===z.canLoad?this.loader.loadChildren(O,z):(0,Pe.of)(null);const ie=W.pipe((0,ht.z)(ue=>null===ue?(0,Pe.of)(void 0):(z._loadedRoutes=ue.routes,z._loadedInjector=ue.injector,this.processRoutes(ue.injector??O,ue.routes))));if(z.loadComponent&&!z._loadedComponent){const ue=this.loader.loadComponent(z);return(0,tt.D)([ie,ue]).pipe((0,An.J)())}return ie})}}return R.\u0275fac=function(O){return new(O||R)(m.LFG(ys),m.LFG(m.Sil),m.LFG(m.lqb),m.LFG(qi),m.LFG(lr))},R.\u0275prov=m.Yz7({token:R,factory:R.\u0275fac,providedIn:"root"}),R})();const Kl=new m.OlP("");let Yo=(()=>{class R{constructor(O,z,W,ie,ue={}){this.urlSerializer=O,this.transitions=z,this.viewportScroller=W,this.zone=ie,this.options=ue,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},ue.scrollPositionRestoration=ue.scrollPositionRestoration||"disabled",ue.anchorScrolling=ue.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(O=>{O instanceof Ta?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=O.navigationTrigger,this.restoredId=O.restoredState?O.restoredState.navigationId:0):O instanceof hs?(this.lastId=O.id,this.scheduleScrollEvent(O,this.urlSerializer.parse(O.urlAfterRedirects).fragment)):O instanceof Qs&&0===O.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(O,this.urlSerializer.parse(O.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(O=>{O instanceof Gs&&(O.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(O.position):O.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(O.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(O,z){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Gs(O,"popstate"===this.lastSource?this.store[this.restoredId]:null,z))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return R.\u0275fac=function(O){m.$Z()},R.\u0275prov=m.Yz7({token:R,factory:R.\u0275fac}),R})();function vs(R,k){return{\u0275kind:R,\u0275providers:k}}function Ys(){const R=(0,m.f3M)(m.zs3);return k=>{const O=R.get(m.z2F);if(k!==O.components[0])return;const z=R.get(ys),W=R.get(za);1===R.get(os)&&z.initialNavigation(),R.get(Bs,null,m.XFs.Optional)?.setUpPreloading(),R.get(Kl,null,m.XFs.Optional)?.init(),z.resetRootComponentType(O.componentTypes[0]),W.closed||(W.next(),W.complete(),W.unsubscribe())}}const za=new m.OlP("",{factory:()=>new en.x}),os=new m.OlP("",{providedIn:"root",factory:()=>1}),Bs=new m.OlP("");function $c(R){return vs(0,[{provide:Bs,useExisting:qr},{provide:qi,useExisting:R}])}const Nl=new m.OlP("ROUTER_FORROOT_GUARD"),Xl=[ui.Ye,{provide:Le,useClass:he},ys,rr,{provide:Gr,useFactory:function yo(R){return R.routerState.root},deps:[ys]},lr,[]];function w(){return new m.PXZ("Router",ys)}let n=(()=>{class R{constructor(O){}static forRoot(O,z){return{ngModule:R,providers:[Xl,[],{provide:Ri,multi:!0,useValue:O},{provide:Nl,useFactory:N,deps:[[ys,new m.FiY,new m.tp0]]},{provide:Nn,useValue:z||{}},z?.useHash?{provide:ui.S$,useClass:ui.Do}:{provide:ui.S$,useClass:ui.b0},{provide:Kl,useFactory:()=>{const R=(0,m.f3M)(ui.EM),k=(0,m.f3M)(m.R0b),O=(0,m.f3M)(Nn),z=(0,m.f3M)(Ii),W=(0,m.f3M)(Le);return O.scrollOffset&&R.setOffset(O.scrollOffset),new Yo(W,z,R,k,O)}},z?.preloadingStrategy?$c(z.preloadingStrategy).\u0275providers:[],{provide:m.PXZ,multi:!0,useFactory:w},z?.initialNavigation?V(z):[],z?.bindToComponentInputs?vs(8,[jo,{provide:Aa,useExisting:jo}]).\u0275providers:[],[{provide:Z,useFactory:Ys},{provide:m.tb,multi:!0,useExisting:Z}]]}}static forChild(O){return{ngModule:R,providers:[{provide:Ri,multi:!0,useValue:O}]}}}return R.\u0275fac=function(O){return new(O||R)(m.LFG(Nl,8))},R.\u0275mod=m.oAB({type:R}),R.\u0275inj=m.cJS({}),R})();function N(R){return"guarded"}function V(R){return["disabled"===R.initialNavigation?vs(3,[{provide:m.ip1,multi:!0,useFactory:()=>{const k=(0,m.f3M)(ys);return()=>{k.setUpLocationChangeListener()}}},{provide:os,useValue:2}]).\u0275providers:[],"enabledBlocking"===R.initialNavigation?vs(2,[{provide:os,useValue:0},{provide:m.ip1,multi:!0,deps:[m.zs3],useFactory:k=>{const O=k.get(ui.V_,Promise.resolve());return()=>O.then(()=>new Promise(z=>{const W=k.get(ys),ie=k.get(za);Ru(W,()=>{z(!0)}),k.get(Ii).afterPreactivation=()=>(z(!0),ie.closed?(0,Pe.of)(void 0):ie),W.initialNavigation()}))}}]).\u0275providers:[]]}const Z=new m.OlP("")},6303:(ri,Lt,_e)=>{"use strict";_e.d(Lt,{fA:()=>Pl,fD:()=>ml,ud:()=>Bs,QQ:()=>Va,I:()=>Ka,VE:()=>_a,Kz:()=>yu,FF:()=>vd,IJ:()=>kf,N9:()=>Xo,Iv:()=>Ku});var m=_e(9468),be=_e(5592),ge=_e(6232),x=_e(2096),tt=_e(8645),Pe=_e(4829),Ze=_e(1631),yt=_e(4266),Ht=_e(4674),$t=_e(7400);const It=["addListener","removeListener"],bt=["addEventListener","removeEventListener"],Zt=["on","off"];function dt(b,A,f,S){if((0,Ht.m)(f)&&(S=f,f=void 0),S)return dt(b,A,f).pipe((0,$t.Z)(S));const[U,te]=function yi(b){return(0,Ht.m)(b.addEventListener)&&(0,Ht.m)(b.removeEventListener)}(b)?bt.map(Fe=>Ke=>b[Fe](A,Ke,f)):function Tn(b){return(0,Ht.m)(b.addListener)&&(0,Ht.m)(b.removeListener)}(b)?It.map(nn(b,A)):function Gn(b){return(0,Ht.m)(b.on)&&(0,Ht.m)(b.off)}(b)?Zt.map(nn(b,A)):[];if(!U&&(0,yt.z)(b))return(0,Ze.z)(Fe=>dt(Fe,A,f))((0,Pe.Xf)(b));if(!U)throw new TypeError("Invalid event target");return new be.y(Fe=>{const Ke=(...ot)=>Fe.next(1<ot.length?ot:ot[0]);return U(Ke),()=>te(Ke)})}function nn(b,A){return f=>S=>b[f](A,S)}var vi=_e(4352),Vt=_e(671);const{isArray:Et}=Array;function Bt(b){return 1===b.length&&Et(b[0])?b[0]:b}var lt=_e(8251);_e(3019);var bn=_e(9940);function en(...b){const A=(0,bn.jO)(b),f=Bt(b);return f.length?new be.y(S=>{let U=f.map(()=>[]),te=f.map(()=>!1);S.add(()=>{U=te=null});for(let Fe=0;!S.closed&&Fe<f.length;Fe++)(0,Pe.Xf)(f[Fe]).subscribe((0,lt.x)(S,Ke=>{if(U[Fe].push(Ke),U.every(ot=>ot.length)){const ot=U.map(Dt=>Dt.shift());S.next(A?A(...ot):ot),U.some((Dt,Rt)=>!Dt.length&&te[Rt])&&S.complete()}},()=>{te[Fe]=!0,!U[Fe].length&&S.complete()}));return()=>{U=te=null}}):ge.E}var ui=_e(5211),Pn=_e(9360),Mi=_e(2420);function bi(b){return(0,Pn.e)((A,f)=>{(0,Pe.Xf)(b).subscribe((0,lt.x)(f,()=>f.complete(),Mi.Z)),!f.closed&&A.subscribe(f)})}var ft=_e(2181),ht=_e(8180),Pt=_e(9397),Nt=_e(7398),hn=_e(2737);function ln(...b){const A=(0,bn.jO)(b);return(0,Pn.e)((f,S)=>{const U=b.length,te=new Array(U);let Fe=b.map(()=>!1),Ke=!1;for(let ot=0;ot<U;ot++)(0,Pe.Xf)(b[ot]).subscribe((0,lt.x)(S,Dt=>{te[ot]=Dt,!Ke&&!Fe[ot]&&(Fe[ot]=!0,(Ke=Fe.every(hn.y))&&(Fe=null))},Mi.Z));f.subscribe((0,lt.x)(S,ot=>{if(Ke){const Dt=[ot,...te];S.next(A?A(...Dt):Dt)}}))})}_e(975);var Si=_e(4664);_e(7921),_e(3997);var Mn=_e(6814);_e(6223),Math,Math,Math;const Ui=["*"],Is=["dialog"];function Gl(b,A){1&b&&(m.TgZ(0,"span",9),m.SDv(1,10),m.qZA())}function fo(b,A){1&b&&(m.TgZ(0,"span",9),m.SDv(1,11),m.qZA())}function ms(b,A){1&b&&(m.TgZ(0,"span",9),m.SDv(1,12),m.qZA())}function wo(b,A){1&b&&(m.TgZ(0,"span",9),m.SDv(1,13),m.qZA())}function pc(b,A){1&b&&m._uU(0,"...")}function gc(b,A){1&b&&m._uU(0),2&b&&m.Oqu(A.$implicit)}function Na(b,A){}const Ra=function(b){return{disabled:!0,currentPage:b}};function ma(b,A){if(1&b&&(m.TgZ(0,"a",18),m.YNc(1,Na,0,0,"ng-template",8),m.qZA()),2&b){const f=m.oxw(2).$implicit,S=m.oxw(),U=m.MAs(9);m.xp6(1),m.Q6J("ngTemplateOutlet",(null==S.tplEllipsis?null:S.tplEllipsis.templateRef)||U)("ngTemplateOutletContext",m.VKq(2,Ra,f))}}function Do(b,A){}const Wl=function(b,A,f){return{disabled:b,$implicit:A,currentPage:f}};function Qr(b,A){if(1&b){const f=m.EpF();m.TgZ(0,"a",19),m.NdJ("click",function(U){m.CHM(f);const te=m.oxw().$implicit;return m.oxw(2).selectPage(te),m.KtG(U.preventDefault())}),m.YNc(1,Do,0,0,"ng-template",8),m.qZA()}if(2&b){const f=m.oxw().$implicit,S=m.oxw(),U=S.disabled,te=S.$implicit,Fe=m.oxw(),Ke=m.MAs(11);m.uIk("tabindex",U?"-1":null)("aria-disabled",U?"true":null),m.xp6(1),m.Q6J("ngTemplateOutlet",(null==Fe.tplNumber?null:Fe.tplNumber.templateRef)||Ke)("ngTemplateOutletContext",m.kEZ(4,Wl,U,f,te))}}function Sl(b,A){if(1&b&&(m.TgZ(0,"li",15),m.YNc(1,ma,2,4,"a",16),m.YNc(2,Qr,2,8,"a",17),m.qZA()),2&b){const f=A.$implicit,S=m.oxw(),U=S.$implicit,te=S.disabled,Fe=m.oxw();m.ekj("active",f===U)("disabled",Fe.isEllipsis(f)||te),m.uIk("aria-current",f===U?"page":null),m.xp6(1),m.Q6J("ngIf",Fe.isEllipsis(f)),m.xp6(1),m.Q6J("ngIf",!Fe.isEllipsis(f))}}function Bc(b,A){1&b&&m.YNc(0,Sl,3,7,"li",14),2&b&&m.Q6J("ngForOf",A.pages)}function Ml(b,A){}const zo=function(b,A){return{disabled:b,currentPage:A}};function is(b,A){if(1&b){const f=m.EpF();m.TgZ(0,"li",15)(1,"a",20),m.NdJ("click",function(U){return m.CHM(f),m.oxw().selectPage(1),m.KtG(U.preventDefault())}),m.YNc(2,Ml,0,0,"ng-template",8),m.qZA()()}if(2&b){const f=m.oxw(),S=m.MAs(1);m.ekj("disabled",f.previousDisabled()),m.xp6(1),m.uIk("tabindex",f.previousDisabled()?"-1":null)("aria-disabled",f.previousDisabled()?"true":null),m.xp6(1),m.Q6J("ngTemplateOutlet",(null==f.tplFirst?null:f.tplFirst.templateRef)||S)("ngTemplateOutletContext",m.WLB(6,zo,f.previousDisabled(),f.page))}}function ka(b,A){}const cu=function(b){return{disabled:b}};function Al(b,A){if(1&b){const f=m.EpF();m.TgZ(0,"li",15)(1,"a",21),m.NdJ("click",function(U){m.CHM(f);const te=m.oxw();return te.selectPage(te.page-1),m.KtG(U.preventDefault())}),m.YNc(2,ka,0,0,"ng-template",8),m.qZA()()}if(2&b){const f=m.oxw(),S=m.MAs(3);m.ekj("disabled",f.previousDisabled()),m.xp6(1),m.uIk("tabindex",f.previousDisabled()?"-1":null)("aria-disabled",f.previousDisabled()?"true":null),m.xp6(1),m.Q6J("ngTemplateOutlet",(null==f.tplPrevious?null:f.tplPrevious.templateRef)||S)("ngTemplateOutletContext",m.VKq(6,cu,f.previousDisabled()))}}function mc(b,A){}function gl(b,A){}function ia(b,A){if(1&b){const f=m.EpF();m.TgZ(0,"li",15)(1,"a",22),m.NdJ("click",function(U){m.CHM(f);const te=m.oxw();return te.selectPage(te.page+1),m.KtG(U.preventDefault())}),m.YNc(2,gl,0,0,"ng-template",8),m.qZA()()}if(2&b){const f=m.oxw(),S=m.MAs(5);m.ekj("disabled",f.nextDisabled()),m.xp6(1),m.uIk("tabindex",f.nextDisabled()?"-1":null)("aria-disabled",f.nextDisabled()?"true":null),m.xp6(1),m.Q6J("ngTemplateOutlet",(null==f.tplNext?null:f.tplNext.templateRef)||S)("ngTemplateOutletContext",m.WLB(6,zo,f.nextDisabled(),f.page))}}function zc(b,A){}function Ws(b,A){if(1&b){const f=m.EpF();m.TgZ(0,"li",15)(1,"a",23),m.NdJ("click",function(U){m.CHM(f);const te=m.oxw();return te.selectPage(te.pageCount),m.KtG(U.preventDefault())}),m.YNc(2,zc,0,0,"ng-template",8),m.qZA()()}if(2&b){const f=m.oxw(),S=m.MAs(7);m.ekj("disabled",f.nextDisabled()),m.xp6(1),m.uIk("tabindex",f.nextDisabled()?"-1":null)("aria-disabled",f.nextDisabled()?"true":null),m.xp6(1),m.Q6J("ngTemplateOutlet",(null==f.tplLast?null:f.tplLast.templateRef)||S)("ngTemplateOutletContext",m.WLB(6,zo,f.nextDisabled(),f.page))}}const Os=function(b,A,f){return{$implicit:b,pages:A,disabled:f}};function St(b,A){if(1&b&&(m.TgZ(0,"strong",3),m._uU(1),m.qZA()),2&b){const f=m.oxw();m.xp6(1),m.Oqu(f.header)}}function Kt(b,A){}function ni(b,A){if(1&b){const f=m.EpF();m.TgZ(0,"div",4),m.YNc(1,Kt,0,0,"ng-template",5),m.TgZ(2,"button",6),m.NdJ("click",function(){m.CHM(f);const U=m.oxw();return m.KtG(U.hide())}),m.qZA()()}if(2&b){const f=m.oxw(),S=m.MAs(1);m.xp6(1),m.Q6J("ngTemplateOutlet",f.contentHeaderTpl||S)}}function Co(b){return"string"==typeof b}function kr(b){return!isNaN(function eo(b){return parseInt(`${b}`,10)}(b))}function Xi(b){return null!=b}function Zs(b){return(b||document.body).getBoundingClientRect()}const pi={animation:!0,transitionTimerDelayMs:5},yc=()=>{},{transitionTimerDelayMs:dn}=pi,qi=new Map,Fr=(b,A,f,S)=>{let U=S.context||{};const te=qi.get(A);if(te)switch(S.runningTransition){case"continue":return ge.E;case"stop":b.run(()=>te.transition$.complete()),U=Object.assign(te.context,U),qi.delete(A)}const Fe=f(A,S.animation,U)||yc;if(!S.animation||"none"===window.getComputedStyle(A).transitionProperty)return b.run(()=>Fe()),(0,x.of)(void 0).pipe(function Ba(b){return A=>new be.y(f=>A.subscribe({next:Fe=>b.run(()=>f.next(Fe)),error:Fe=>b.run(()=>f.error(Fe)),complete:()=>b.run(()=>f.complete())}))}(b));const Ke=new tt.x,ot=new tt.x,Dt=Ke.pipe(function Jt(...b){return A=>(0,ui.z)(A,(0,x.of)(...b))}(!0));qi.set(A,{transition$:Ke,complete:()=>{ot.next(),ot.complete()},context:U});const Rt=function li(b){const{transitionDelay:A,transitionDuration:f}=window.getComputedStyle(b);return 1e3*(parseFloat(A)+parseFloat(f))}(A);return b.runOutsideAngular(()=>{const zn=dt(A,"transitionend").pipe(bi(Dt),(0,ft.h)(({target:Wn})=>Wn===A));(function zt(...b){return 1===(b=Bt(b)).length?(0,Pe.Xf)(b[0]):new be.y(function nt(b){return A=>{let f=[];for(let S=0;f&&!A.closed&&S<b.length;S++)f.push((0,Pe.Xf)(b[S]).subscribe((0,lt.x)(A,U=>{if(f){for(let te=0;te<f.length;te++)te!==S&&f[te].unsubscribe();f=null}A.next(U)})))}}(b))})(function wt(b=0,A,f=vi.P){let S=-1;return null!=A&&((0,Vt.K)(A)?f=A:S=A),new be.y(U=>{let te=function Tt(b){return b instanceof Date&&!isNaN(b)}(b)?+b-f.now():b;te<0&&(te=0);let Fe=0;return f.schedule(function(){U.closed||(U.next(Fe++),0<=S?this.schedule(void 0,S):U.complete())},te)})}(Rt+dn).pipe(bi(Dt)),zn,ot).pipe(bi(Dt)).subscribe(()=>{qi.delete(A),b.run(()=>{Fe(),Ke.next(),Ke.complete()})})}),Ke.asObservable()},Kl=(b,A,f)=>{let{direction:S,maxSize:U,dimension:te}=f;const{classList:Fe}=b;function Ke(){Fe.add("collapse"),"show"===S?Fe.add("show"):Fe.remove("show")}if(A)return U||(U=function qr(b,A){if(typeof navigator>"u")return"0px";const{classList:f}=b,S=f.contains("show");S||f.add("show"),b.style[A]="";const U=b.getBoundingClientRect()[A]+"px";return S||f.remove("show"),U}(b,te),f.maxSize=U,b.style[te]="show"!==S?U:"0px",Fe.remove("collapse"),Fe.remove("collapsing"),Fe.remove("show"),Zs(b),Fe.add("collapsing")),b.style[te]="show"===S?U:"0px",()=>{Ke(),Fe.remove("collapsing"),b.style[te]=""};Ke()};let Yo=(()=>{class b{constructor(){this.animation=pi.animation}}return b.\u0275fac=function(f){return new(f||b)},b.\u0275prov=m.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})(),Ar=(()=>{class b{constructor(f){this._ngbConfig=f,this.closeOthers=!1}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(f){this._animation=f}}return b.\u0275fac=function(f){return new(f||b)(m.LFG(Yo))},b.\u0275prov=m.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})(),os=(()=>{class b{constructor(f){this._ngbConfig=f,this.horizontal=!1}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(f){this._animation=f}}return b.\u0275fac=function(f){return new(f||b)(m.LFG(Yo))},b.\u0275prov=m.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})(),bs=(()=>{class b{set collapsed(f){this._isCollapsed!==f&&(this._isCollapsed=f,this._afterInit&&this._runTransitionWithEvents(f,this.animation))}constructor(f,S,U){this._element=f,this._zone=U,this._afterInit=!1,this._isCollapsed=!1,this.ngbCollapseChange=new m.vpe,this.shown=new m.vpe,this.hidden=new m.vpe,this.animation=S.animation,this.horizontal=S.horizontal}ngOnInit(){this._runTransition(this._isCollapsed,!1),this._afterInit=!0}toggle(f=this._isCollapsed){this.collapsed=!f,this.ngbCollapseChange.next(this._isCollapsed)}_runTransition(f,S){return Fr(this._zone,this._element.nativeElement,Kl,{animation:S,runningTransition:"stop",context:{direction:f?"hide":"show",dimension:this.horizontal?"width":"height"}})}_runTransitionWithEvents(f,S){this._runTransition(f,S).subscribe(()=>{f?this.hidden.emit():this.shown.emit()})}}return b.\u0275fac=function(f){return new(f||b)(m.Y36(m.SBq),m.Y36(os),m.Y36(m.R0b))},b.\u0275dir=m.lG2({type:b,selectors:[["","ngbCollapse",""]],hostVars:2,hostBindings:function(f,S){2&f&&m.ekj("collapse-horizontal",S.horizontal)},inputs:{animation:"animation",collapsed:["ngbCollapse","collapsed"],horizontal:"horizontal"},outputs:{ngbCollapseChange:"ngbCollapseChange",shown:"shown",hidden:"hidden"},exportAs:["ngbCollapse"],standalone:!0}),b})(),hu=0,Pl=(()=>{class b{constructor(){this._appRef=(0,m.f3M)(m.z2F),this._element=(0,m.f3M)(m.SBq).nativeElement,this._item=(0,m.f3M)(_a),this._viewRef=null}ngAfterContentChecked(){this._bodyTpl&&(this._item.animatingBodyCollapse||!this._item.destroyOnHide?this._createViewIfNotExists():this._destroyViewIfExists())}ngOnDestroy(){this._destroyViewIfExists()}_destroyViewIfExists(){this._viewRef&&(this._appRef.detachView(this._viewRef),this._viewRef.destroy(),this._viewRef=null)}_createViewIfNotExists(){if(!this._viewRef){this._viewRef=this._bodyTpl.createEmbeddedView(null),this._viewRef.detectChanges(),this._appRef.attachView(this._viewRef);for(const f of this._viewRef.rootNodes)this._element.appendChild(f)}}}return b.\u0275fac=function(f){return new(f||b)},b.\u0275dir=m.lG2({type:b,selectors:[["","ngbAccordionBody",""]],contentQueries:function(f,S,U){if(1&f&&m.Suo(U,m.Rgc,7),2&f){let te;m.iGM(te=m.CRH())&&(S._bodyTpl=te.first)}},hostVars:2,hostBindings:function(f,S){2&f&&m.ekj("accordion-body",!0)},standalone:!0}),b})(),Bs=(()=>{class b{constructor(f,S){this.item=f,this.ngbCollapse=S}}return b.\u0275fac=function(f){return new(f||b)(m.Y36((0,m.Gpc)(()=>_a)),m.Y36(bs))},b.\u0275dir=m.lG2({type:b,selectors:[["","ngbAccordionCollapse",""]],hostAttrs:["role","region"],hostVars:4,hostBindings:function(f,S){2&f&&(m.Ikx("id",S.item.collapseId),m.uIk("aria-labelledby",S.item.toggleId),m.ekj("accordion-collapse",!0))},exportAs:["ngbAccordionCollapse"],standalone:!0,features:[m.zW0([bs])]}),b})(),$c=(()=>{class b{constructor(f,S){this.item=f,this.accordion=S}}return b.\u0275fac=function(f){return new(f||b)(m.Y36((0,m.Gpc)(()=>_a)),m.Y36((0,m.Gpc)(()=>Va)))},b.\u0275dir=m.lG2({type:b,selectors:[["","ngbAccordionToggle",""]],hostVars:5,hostBindings:function(f,S){1&f&&m.NdJ("click",function(){return!S.item.disabled&&S.accordion.toggle(S.item.id)}),2&f&&(m.Ikx("id",S.item.toggleId),m.uIk("aria-controls",S.item.collapseId)("aria-expanded",!S.item.collapsed),m.ekj("collapsed",S.item.collapsed))},standalone:!0}),b})(),ml=(()=>{class b{constructor(f){this.item=f}}return b.\u0275fac=function(f){return new(f||b)(m.Y36((0,m.Gpc)(()=>_a)))},b.\u0275dir=m.lG2({type:b,selectors:[["button","ngbAccordionButton",""]],hostAttrs:["type","button"],hostVars:3,hostBindings:function(f,S){2&f&&(m.Ikx("disabled",S.item.disabled),m.ekj("accordion-button",!0))},standalone:!0,features:[m.zW0([$c])]}),b})(),Ka=(()=>{class b{constructor(f){this.item=f}}return b.\u0275fac=function(f){return new(f||b)(m.Y36((0,m.Gpc)(()=>_a)))},b.\u0275dir=m.lG2({type:b,selectors:[["","ngbAccordionHeader",""]],hostAttrs:["role","heading"],hostVars:4,hostBindings:function(f,S){2&f&&m.ekj("accordion-header",!0)("collapsed",S.item.collapsed)},standalone:!0}),b})(),_a=(()=>{class b{constructor(f,S){this._accordion=f,this._cd=S,this._subscriptions=[],this._collapsed=!0,this._id="ngb-accordion-item-"+hu++,this.animatingBodyCollapse=!1,this.destroyOnHide=this._accordion.destroyOnHide,this.disabled=!1,this.show=new m.vpe,this.shown=new m.vpe,this.hide=new m.vpe,this.hidden=new m.vpe}set id(f){Co(f)&&""!==f&&(this._id=f)}set collapsed(f){if(this.collapsed!==f){if(this.collapsed&&!this._accordion._ensureCanExpand(this))return;this._collapsed=f,this._cd.markForCheck(),this.collapsed||(this.animatingBodyCollapse=!0,this._cd.detectChanges()),this.collapsed?(this.hide.emit(),this._accordion.hide.emit(this.id)):(this.show.emit(),this._accordion.show.emit(this.id)),this._collapse.ngbCollapse.animation=this._accordion.animation,this._collapse.ngbCollapse.collapsed=this.collapsed}}get collapsed(){return this._collapsed}get id(){return`${this._id}`}get toggleId(){return`${this.id}-toggle`}get collapseId(){return`${this.id}-collapse`}ngAfterContentInit(){const{ngbCollapse:f}=this._collapse;f.animation=!1,f.collapsed=this.collapsed,f.animation=this._accordion.animation,this._subscriptions.push(f.hidden.subscribe(()=>{this.animatingBodyCollapse=!1,this.hidden.emit(),this._accordion.hidden.emit(this.id)}),f.shown.subscribe(()=>{this.shown.emit(),this._accordion.shown.emit(this.id)}))}ngOnDestroy(){this._subscriptions.forEach(f=>f.unsubscribe())}toggle(){this.collapsed=!this.collapsed}expand(){this.collapsed=!1}collapse(){this.collapsed=!0}}return b.\u0275fac=function(f){return new(f||b)(m.Y36((0,m.Gpc)(()=>Va)),m.Y36(m.sBO))},b.\u0275dir=m.lG2({type:b,selectors:[["","ngbAccordionItem",""]],contentQueries:function(f,S,U){if(1&f&&m.Suo(U,Bs,7),2&f){let te;m.iGM(te=m.CRH())&&(S._collapse=te.first)}},hostVars:3,hostBindings:function(f,S){2&f&&(m.Ikx("id",S.id),m.ekj("accordion-item",!0))},inputs:{id:["ngbAccordionItem","id"],destroyOnHide:"destroyOnHide",disabled:"disabled",collapsed:"collapsed"},outputs:{show:"show",shown:"shown",hide:"hide",hidden:"hidden"},exportAs:["ngbAccordionItem"],standalone:!0}),b})(),Va=(()=>{class b{constructor(f){this.destroyOnHide=!0,this.show=new m.vpe,this.shown=new m.vpe,this.hide=new m.vpe,this.hidden=new m.vpe,this._anItemWasAlreadyExpandedDuringInitialisation=!1,this.animation=f.animation,this.closeOthers=f.closeOthers}toggle(f){this._getItem(f)?.toggle()}expand(f){this._getItem(f)?.expand()}expandAll(){this._items&&(this.closeOthers?this._items.find(f=>!f.collapsed)||this._items.first.expand():this._items.forEach(f=>f.expand()))}collapse(f){this._getItem(f)?.collapse()}collapseAll(){this._items?.forEach(f=>f.collapse())}isExpanded(f){const S=this._getItem(f);return!!S&&!S.collapsed}_ensureCanExpand(f){return!(this.closeOthers&&(this._items?(this._items.find(S=>!S.collapsed&&f!==S)?.collapse(),0):this._anItemWasAlreadyExpandedDuringInitialisation||(this._anItemWasAlreadyExpandedDuringInitialisation=!0,0)))}_getItem(f){return this._items?.find(S=>S.id===f)}}return b.\u0275fac=function(f){return new(f||b)(m.Y36(Ar))},b.\u0275dir=m.lG2({type:b,selectors:[["","ngbAccordion",""]],contentQueries:function(f,S,U){if(1&f&&m.Suo(U,_a,4),2&f){let te;m.iGM(te=m.CRH())&&(S._items=te)}},hostVars:2,hostBindings:function(f,S){2&f&&m.ekj("accordion",!0)},inputs:{animation:"animation",closeOthers:"closeOthers",destroyOnHide:"destroyOnHide"},outputs:{show:"show",shown:"shown",hide:"hide",hidden:"hidden"},exportAs:["ngbAccordion"],standalone:!0}),b})(),Nl=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})(),d=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})(),ke=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})(),R=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})();var ci=(()=>((ci=ci||{})[ci.Tab=9]="Tab",ci[ci.Enter=13]="Enter",ci[ci.Escape=27]="Escape",ci[ci.Space=32]="Space",ci[ci.PageUp=33]="PageUp",ci[ci.PageDown=34]="PageDown",ci[ci.End=35]="End",ci[ci.Home=36]="Home",ci[ci.ArrowLeft=37]="ArrowLeft",ci[ci.ArrowUp=38]="ArrowUp",ci[ci.ArrowRight=39]="ArrowRight",ci[ci.ArrowDown=40]="ArrowDown",ci))();typeof navigator<"u"&&navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent));const ku=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function oo(b){const A=Array.from(b.querySelectorAll(ku)).filter(f=>-1!==f.tabIndex);return[A[0],A[A.length-1]]}new Date(1882,10,12),new Date(2174,10,25);let kh=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})(),cp=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})();class Hu{constructor(A,f,S){this.nodes=A,this.viewRef=f,this.componentRef=S}}let Fh=(()=>{class b{constructor(f,S){this._el=f,this._zone=S}ngOnInit(){this._zone.onStable.asObservable().pipe((0,ht.q)(1)).subscribe(()=>{Fr(this._zone,this._el.nativeElement,(f,S)=>{S&&Zs(f),f.classList.add("show")},{animation:this.animation,runningTransition:"continue"})})}hide(){return Fr(this._zone,this._el.nativeElement,({classList:f})=>f.remove("show"),{animation:this.animation,runningTransition:"stop"})}}return b.\u0275fac=function(f){return new(f||b)(m.Y36(m.SBq),m.Y36(m.R0b))},b.\u0275cmp=m.Xpm({type:b,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1055"],hostVars:6,hostBindings:function(f,S){2&f&&(m.Tol("modal-backdrop"+(S.backdropClass?" "+S.backdropClass:"")),m.ekj("show",!S.animation)("fade",S.animation))},inputs:{animation:"animation",backdropClass:"backdropClass"},standalone:!0,features:[m.jDz],decls:0,vars:0,template:function(f,S){},encapsulation:2}),b})();class yu{update(A){}close(A){}dismiss(A){}}const Lh=["animation","ariaLabelledBy","ariaDescribedBy","backdrop","centered","fullscreen","keyboard","scrollable","size","windowClass","modalDialogClass"],Df=["animation","backdropClass"];class Qd{_applyWindowOptions(A,f){Lh.forEach(S=>{Xi(f[S])&&(A[S]=f[S])})}_applyBackdropOptions(A,f){Df.forEach(S=>{Xi(f[S])&&(A[S]=f[S])})}update(A){this._applyWindowOptions(this._windowCmptRef.instance,A),this._backdropCmptRef&&this._backdropCmptRef.instance&&this._applyBackdropOptions(this._backdropCmptRef.instance,A)}get componentInstance(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}get closed(){return this._closed.asObservable().pipe(bi(this._hidden))}get dismissed(){return this._dismissed.asObservable().pipe(bi(this._hidden))}get hidden(){return this._hidden.asObservable()}get shown(){return this._windowCmptRef.instance.shown.asObservable()}constructor(A,f,S,U){this._windowCmptRef=A,this._contentRef=f,this._backdropCmptRef=S,this._beforeDismiss=U,this._closed=new tt.x,this._dismissed=new tt.x,this._hidden=new tt.x,A.instance.dismissEvent.subscribe(te=>{this.dismiss(te)}),this.result=new Promise((te,Fe)=>{this._resolve=te,this._reject=Fe}),this.result.then(null,()=>{})}close(A){this._windowCmptRef&&(this._closed.next(A),this._resolve(A),this._removeModalElements())}_dismiss(A){this._dismissed.next(A),this._reject(A),this._removeModalElements()}dismiss(A){if(this._windowCmptRef)if(this._beforeDismiss){const f=this._beforeDismiss();!function Uc(b){return b&&b.then}(f)?!1!==f&&this._dismiss(A):f.then(S=>{!1!==S&&this._dismiss(A)},()=>{})}else this._dismiss(A)}_removeModalElements(){const A=this._windowCmptRef.instance.hide(),f=this._backdropCmptRef?this._backdropCmptRef.instance.hide():(0,x.of)(void 0);A.subscribe(()=>{const{nativeElement:S}=this._windowCmptRef.location;S.parentNode.removeChild(S),this._windowCmptRef.destroy(),this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._contentRef=null}),f.subscribe(()=>{if(this._backdropCmptRef){const{nativeElement:S}=this._backdropCmptRef.location;S.parentNode.removeChild(S),this._backdropCmptRef.destroy(),this._backdropCmptRef=null}}),en(A,f).subscribe(()=>{this._hidden.next(),this._hidden.complete()})}}var tc=(()=>((tc=tc||{})[tc.BACKDROP_CLICK=0]="BACKDROP_CLICK",tc[tc.ESC=1]="ESC",tc))();let nc=(()=>{class b{constructor(f,S,U){this._document=f,this._elRef=S,this._zone=U,this._closed$=new tt.x,this._elWithFocus=null,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new m.vpe,this.shown=new tt.x,this.hidden=new tt.x}get fullscreenClass(){return!0===this.fullscreen?" modal-fullscreen":Co(this.fullscreen)?` modal-fullscreen-${this.fullscreen}-down`:""}dismiss(f){this.dismissEvent.emit(f)}ngOnInit(){this._elWithFocus=this._document.activeElement,this._zone.onStable.asObservable().pipe((0,ht.q)(1)).subscribe(()=>{this._show()})}ngOnDestroy(){this._disableEventHandling()}hide(){const{nativeElement:f}=this._elRef,S={animation:this.animation,runningTransition:"stop"},Fe=en(Fr(this._zone,f,()=>f.classList.remove("show"),S),Fr(this._zone,this._dialogEl.nativeElement,()=>{},S));return Fe.subscribe(()=>{this.hidden.next(),this.hidden.complete()}),this._disableEventHandling(),this._restoreFocus(),Fe}_show(){const f={animation:this.animation,runningTransition:"continue"};en(Fr(this._zone,this._elRef.nativeElement,(te,Fe)=>{Fe&&Zs(te),te.classList.add("show")},f),Fr(this._zone,this._dialogEl.nativeElement,()=>{},f)).subscribe(()=>{this.shown.next(),this.shown.complete()}),this._enableEventHandling(),this._setFocus()}_enableEventHandling(){const{nativeElement:f}=this._elRef;this._zone.runOutsideAngular(()=>{dt(f,"keydown").pipe(bi(this._closed$),(0,ft.h)(U=>U.which===ci.Escape)).subscribe(U=>{this.keyboard?requestAnimationFrame(()=>{U.defaultPrevented||this._zone.run(()=>this.dismiss(tc.ESC))}):"static"===this.backdrop&&this._bumpBackdrop()});let S=!1;dt(this._dialogEl.nativeElement,"mousedown").pipe(bi(this._closed$),(0,Pt.b)(()=>S=!1),(0,Si.w)(()=>dt(f,"mouseup").pipe(bi(this._closed$),(0,ht.q)(1))),(0,ft.h)(({target:U})=>f===U)).subscribe(()=>{S=!0}),dt(f,"click").pipe(bi(this._closed$)).subscribe(({target:U})=>{f===U&&("static"===this.backdrop?this._bumpBackdrop():!0===this.backdrop&&!S&&this._zone.run(()=>this.dismiss(tc.BACKDROP_CLICK))),S=!1})})}_disableEventHandling(){this._closed$.next()}_setFocus(){const{nativeElement:f}=this._elRef;if(!f.contains(document.activeElement)){const S=f.querySelector("[ngbAutofocus]"),U=oo(f)[0];(S||U||f).focus()}}_restoreFocus(){const f=this._document.body,S=this._elWithFocus;let U;U=S&&S.focus&&f.contains(S)?S:f,this._zone.runOutsideAngular(()=>{setTimeout(()=>U.focus()),this._elWithFocus=null})}_bumpBackdrop(){"static"===this.backdrop&&Fr(this._zone,this._elRef.nativeElement,({classList:f})=>(f.add("modal-static"),()=>f.remove("modal-static")),{animation:this.animation,runningTransition:"continue"})}}return b.\u0275fac=function(f){return new(f||b)(m.Y36(Mn.K0),m.Y36(m.SBq),m.Y36(m.R0b))},b.\u0275cmp=m.Xpm({type:b,selectors:[["ngb-modal-window"]],viewQuery:function(f,S){if(1&f&&m.Gf(Is,7),2&f){let U;m.iGM(U=m.CRH())&&(S._dialogEl=U.first)}},hostAttrs:["role","dialog","tabindex","-1"],hostVars:7,hostBindings:function(f,S){2&f&&(m.uIk("aria-modal",!0)("aria-labelledby",S.ariaLabelledBy)("aria-describedby",S.ariaDescribedBy),m.Tol("modal d-block"+(S.windowClass?" "+S.windowClass:"")),m.ekj("fade",S.animation))},inputs:{animation:"animation",ariaLabelledBy:"ariaLabelledBy",ariaDescribedBy:"ariaDescribedBy",backdrop:"backdrop",centered:"centered",fullscreen:"fullscreen",keyboard:"keyboard",scrollable:"scrollable",size:"size",windowClass:"windowClass",modalDialogClass:"modalDialogClass"},outputs:{dismissEvent:"dismiss"},standalone:!0,features:[m.jDz],ngContentSelectors:Ui,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(f,S){1&f&&(m.F$t(),m.TgZ(0,"div",0,1)(2,"div",2),m.Hsn(3),m.qZA()()),2&f&&m.Tol("modal-dialog"+(S.size?" modal-"+S.size:"")+(S.centered?" modal-dialog-centered":"")+S.fullscreenClass+(S.scrollable?" modal-dialog-scrollable":"")+(S.modalDialogClass?" "+S.modalDialogClass:""))},styles:["ngb-modal-window .component-host-scrollable{display:flex;flex-direction:column;overflow:hidden}\n"],encapsulation:2}),b})(),vu=(()=>{class b{constructor(f){this._document=f}hide(){const f=Math.abs(window.innerWidth-this._document.documentElement.clientWidth),S=this._document.body,U=S.style,{overflow:te,paddingRight:Fe}=U;if(f>0){const Ke=parseFloat(window.getComputedStyle(S).paddingRight);U.paddingRight=`${Ke+f}px`}return U.overflow="hidden",()=>{f>0&&(U.paddingRight=Fe),U.overflow=te}}}return b.\u0275fac=function(f){return new(f||b)(m.LFG(Mn.K0))},b.\u0275prov=m.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})(),_d=(()=>{class b{constructor(f,S,U,te,Fe,Ke,ot){this._applicationRef=f,this._injector=S,this._environmentInjector=U,this._document=te,this._scrollBar=Fe,this._rendererFactory=Ke,this._ngZone=ot,this._activeWindowCmptHasChanged=new tt.x,this._ariaHiddenValues=new Map,this._scrollBarRestoreFn=null,this._modalRefs=[],this._windowCmpts=[],this._activeInstances=new m.vpe,this._activeWindowCmptHasChanged.subscribe(()=>{if(this._windowCmpts.length){const Dt=this._windowCmpts[this._windowCmpts.length-1];((b,A,f,S=!1)=>{b.runOutsideAngular(()=>{const U=dt(A,"focusin").pipe(bi(f),(0,Nt.U)(te=>te.target));dt(A,"keydown").pipe(bi(f),(0,ft.h)(te=>te.which===ci.Tab),ln(U)).subscribe(([te,Fe])=>{const[Ke,ot]=oo(A);(Fe===Ke||Fe===A)&&te.shiftKey&&(ot.focus(),te.preventDefault()),Fe===ot&&!te.shiftKey&&(Ke.focus(),te.preventDefault())}),S&&dt(A,"click").pipe(bi(f),ln(U),(0,Nt.U)(te=>te[1])).subscribe(te=>te.focus())})})(this._ngZone,Dt.location.nativeElement,this._activeWindowCmptHasChanged),this._revertAriaHidden(),this._setAriaHidden(Dt.location.nativeElement)}})}_restoreScrollBar(){const f=this._scrollBarRestoreFn;f&&(this._scrollBarRestoreFn=null,f())}_hideScrollBar(){this._scrollBarRestoreFn||(this._scrollBarRestoreFn=this._scrollBar.hide())}open(f,S,U){const te=U.container instanceof HTMLElement?U.container:Xi(U.container)?this._document.querySelector(U.container):this._document.body,Fe=this._rendererFactory.createRenderer(null,null);if(!te)throw new Error(`The specified modal container "${U.container||"body"}" was not found in the DOM.`);this._hideScrollBar();const Ke=new yu,ot=(f=U.injector||f).get(m.lqb,null)||this._environmentInjector,Dt=this._getContentRef(f,ot,S,Ke,U);let Rt=!1!==U.backdrop?this._attachBackdrop(te):void 0,zn=this._attachWindowComponent(te,Dt.nodes),pn=new Qd(zn,Dt,Rt,U.beforeDismiss);return this._registerModalRef(pn),this._registerWindowCmpt(zn),pn.hidden.pipe((0,ht.q)(1)).subscribe(()=>Promise.resolve(!0).then(()=>{this._modalRefs.length||(Fe.removeClass(this._document.body,"modal-open"),this._restoreScrollBar(),this._revertAriaHidden())})),Ke.close=Wn=>{pn.close(Wn)},Ke.dismiss=Wn=>{pn.dismiss(Wn)},Ke.update=Wn=>{pn.update(Wn)},pn.update(U),1===this._modalRefs.length&&Fe.addClass(this._document.body,"modal-open"),Rt&&Rt.instance&&Rt.changeDetectorRef.detectChanges(),zn.changeDetectorRef.detectChanges(),pn}get activeInstances(){return this._activeInstances}dismissAll(f){this._modalRefs.forEach(S=>S.dismiss(f))}hasOpenModals(){return this._modalRefs.length>0}_attachBackdrop(f){let S=(0,m.LMc)(Fh,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector});return this._applicationRef.attachView(S.hostView),f.appendChild(S.location.nativeElement),S}_attachWindowComponent(f,S){let U=(0,m.LMc)(nc,{environmentInjector:this._applicationRef.injector,elementInjector:this._injector,projectableNodes:S});return this._applicationRef.attachView(U.hostView),f.appendChild(U.location.nativeElement),U}_getContentRef(f,S,U,te,Fe){return U?U instanceof m.Rgc?this._createFromTemplateRef(U,te):Co(U)?this._createFromString(U):this._createFromComponent(f,S,U,te,Fe):new Hu([])}_createFromTemplateRef(f,S){const te=f.createEmbeddedView({$implicit:S,close(Fe){S.close(Fe)},dismiss(Fe){S.dismiss(Fe)}});return this._applicationRef.attachView(te),new Hu([te.rootNodes],te)}_createFromString(f){const S=this._document.createTextNode(`${f}`);return new Hu([[S]])}_createFromComponent(f,S,U,te,Fe){const Ke=m.zs3.create({providers:[{provide:yu,useValue:te}],parent:f}),ot=(0,m.LMc)(U,{environmentInjector:S,elementInjector:Ke}),Dt=ot.location.nativeElement;return Fe.scrollable&&Dt.classList.add("component-host-scrollable"),this._applicationRef.attachView(ot.hostView),new Hu([[Dt]],ot.hostView,ot)}_setAriaHidden(f){const S=f.parentElement;S&&f!==this._document.body&&(Array.from(S.children).forEach(U=>{U!==f&&"SCRIPT"!==U.nodeName&&(this._ariaHiddenValues.set(U,U.getAttribute("aria-hidden")),U.setAttribute("aria-hidden","true"))}),this._setAriaHidden(S))}_revertAriaHidden(){this._ariaHiddenValues.forEach((f,S)=>{f?S.setAttribute("aria-hidden",f):S.removeAttribute("aria-hidden")}),this._ariaHiddenValues.clear()}_registerModalRef(f){const S=()=>{const U=this._modalRefs.indexOf(f);U>-1&&(this._modalRefs.splice(U,1),this._activeInstances.emit(this._modalRefs))};this._modalRefs.push(f),this._activeInstances.emit(this._modalRefs),f.result.then(S,S)}_registerWindowCmpt(f){this._windowCmpts.push(f),this._activeWindowCmptHasChanged.next(),f.onDestroy(()=>{const S=this._windowCmpts.indexOf(f);S>-1&&(this._windowCmpts.splice(S,1),this._activeWindowCmptHasChanged.next())})}}return b.\u0275fac=function(f){return new(f||b)(m.LFG(m.z2F),m.LFG(m.zs3),m.LFG(m.lqb),m.LFG(Mn.K0),m.LFG(vu),m.LFG(m.FYo),m.LFG(m.R0b))},b.\u0275prov=m.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})(),yd=(()=>{class b{constructor(f){this._ngbConfig=f,this.backdrop=!0,this.fullscreen=!1,this.keyboard=!0}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(f){this._animation=f}}return b.\u0275fac=function(f){return new(f||b)(m.LFG(Yo))},b.\u0275prov=m.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})(),vd=(()=>{class b{constructor(f,S,U){this._injector=f,this._modalStack=S,this._config=U}open(f,S={}){const U={...this._config,animation:this._config.animation,...S};return this._modalStack.open(this._injector,f,U)}get activeInstances(){return this._modalStack.activeInstances}dismissAll(f){this._modalStack.dismissAll(f)}hasOpenModals(){return this._modalStack.hasOpenModals()}}return b.\u0275fac=function(f){return new(f||b)(m.LFG(m.zs3),m.LFG(_d),m.LFG(yd))},b.\u0275prov=m.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})(),xl=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({providers:[vd]}),b})(),Ds=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})(),bu=(()=>{class b{constructor(){this.disabled=!1,this.boundaryLinks=!1,this.directionLinks=!0,this.ellipses=!0,this.maxSize=0,this.pageSize=10,this.rotate=!1}}return b.\u0275fac=function(f){return new(f||b)},b.\u0275prov=m.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})(),nh=(()=>{class b{constructor(f){this.templateRef=f}}return b.\u0275fac=function(f){return new(f||b)(m.Y36(m.Rgc))},b.\u0275dir=m.lG2({type:b,selectors:[["ng-template","ngbPaginationEllipsis",""]],standalone:!0}),b})(),jh=(()=>{class b{constructor(f){this.templateRef=f}}return b.\u0275fac=function(f){return new(f||b)(m.Y36(m.Rgc))},b.\u0275dir=m.lG2({type:b,selectors:[["ng-template","ngbPaginationFirst",""]],standalone:!0}),b})(),Hh=(()=>{class b{constructor(f){this.templateRef=f}}return b.\u0275fac=function(f){return new(f||b)(m.Y36(m.Rgc))},b.\u0275dir=m.lG2({type:b,selectors:[["ng-template","ngbPaginationLast",""]],standalone:!0}),b})(),ih=(()=>{class b{constructor(f){this.templateRef=f}}return b.\u0275fac=function(f){return new(f||b)(m.Y36(m.Rgc))},b.\u0275dir=m.lG2({type:b,selectors:[["ng-template","ngbPaginationNext",""]],standalone:!0}),b})(),$h=(()=>{class b{constructor(f){this.templateRef=f}}return b.\u0275fac=function(f){return new(f||b)(m.Y36(m.Rgc))},b.\u0275dir=m.lG2({type:b,selectors:[["ng-template","ngbPaginationNumber",""]],standalone:!0}),b})(),Gh=(()=>{class b{constructor(f){this.templateRef=f}}return b.\u0275fac=function(f){return new(f||b)(m.Y36(m.Rgc))},b.\u0275dir=m.lG2({type:b,selectors:[["ng-template","ngbPaginationPrevious",""]],standalone:!0}),b})(),xu=(()=>{class b{constructor(f){this.templateRef=f}}return b.\u0275fac=function(f){return new(f||b)(m.Y36(m.Rgc))},b.\u0275dir=m.lG2({type:b,selectors:[["ng-template","ngbPaginationPages",""]],standalone:!0}),b})(),Xo=(()=>{class b{constructor(f){this.pageCount=0,this.pages=[],this.page=1,this.pageChange=new m.vpe(!0),this.disabled=f.disabled,this.boundaryLinks=f.boundaryLinks,this.directionLinks=f.directionLinks,this.ellipses=f.ellipses,this.maxSize=f.maxSize,this.pageSize=f.pageSize,this.rotate=f.rotate,this.size=f.size}hasPrevious(){return this.page>1}hasNext(){return this.page<this.pageCount}nextDisabled(){return!this.hasNext()||this.disabled}previousDisabled(){return!this.hasPrevious()||this.disabled}selectPage(f){this._updatePages(f)}ngOnChanges(f){this._updatePages(this.page)}isEllipsis(f){return-1===f}_applyEllipses(f,S){this.ellipses&&(f>0&&(f>2?this.pages.unshift(-1):2===f&&this.pages.unshift(2),this.pages.unshift(1)),S<this.pageCount&&(S<this.pageCount-2?this.pages.push(-1):S===this.pageCount-2&&this.pages.push(this.pageCount-1),this.pages.push(this.pageCount)))}_applyRotation(){let f=0,S=this.pageCount,U=Math.floor(this.maxSize/2);return this.page<=U?S=this.maxSize:this.pageCount-this.page<U?f=this.pageCount-this.maxSize:(f=this.page-U-1,S=this.page+(this.maxSize%2==0?U-1:U)),[f,S]}_applyPagination(){let S=(Math.ceil(this.page/this.maxSize)-1)*this.maxSize;return[S,S+this.maxSize]}_setPageInRange(f){const S=this.page;this.page=function oa(b,A,f=0){return Math.max(Math.min(b,A),f)}(f,this.pageCount,1),this.page!==S&&kr(this.collectionSize)&&this.pageChange.emit(this.page)}_updatePages(f){this.pageCount=Math.ceil(this.collectionSize/this.pageSize),kr(this.pageCount)||(this.pageCount=0),this.pages.length=0;for(let S=1;S<=this.pageCount;S++)this.pages.push(S);if(this._setPageInRange(f),this.maxSize>0&&this.pageCount>this.maxSize){let S=0,U=this.pageCount;[S,U]=this.rotate?this._applyRotation():this._applyPagination(),this.pages=this.pages.slice(S,U),this._applyEllipses(S,U)}}}return b.\u0275fac=function(f){return new(f||b)(m.Y36(bu))},b.\u0275cmp=m.Xpm({type:b,selectors:[["ngb-pagination"]],contentQueries:function(f,S,U){if(1&f&&(m.Suo(U,nh,5),m.Suo(U,jh,5),m.Suo(U,Hh,5),m.Suo(U,ih,5),m.Suo(U,$h,5),m.Suo(U,Gh,5),m.Suo(U,xu,5)),2&f){let te;m.iGM(te=m.CRH())&&(S.tplEllipsis=te.first),m.iGM(te=m.CRH())&&(S.tplFirst=te.first),m.iGM(te=m.CRH())&&(S.tplLast=te.first),m.iGM(te=m.CRH())&&(S.tplNext=te.first),m.iGM(te=m.CRH())&&(S.tplNumber=te.first),m.iGM(te=m.CRH())&&(S.tplPrevious=te.first),m.iGM(te=m.CRH())&&(S.tplPages=te.first)}},hostAttrs:["role","navigation"],inputs:{disabled:"disabled",boundaryLinks:"boundaryLinks",directionLinks:"directionLinks",ellipses:"ellipses",rotate:"rotate",collectionSize:"collectionSize",maxSize:"maxSize",page:"page",pageSize:"pageSize",size:"size"},outputs:{pageChange:"pageChange"},standalone:!0,features:[m.TTD,m.jDz],decls:20,vars:12,consts:function(){let A,f,S,U,te,Fe,Ke,ot;return A=$localize`:@@ngb.pagination.first:`,f=$localize`:@@ngb.pagination.previous:`,S=$localize`:@@ngb.pagination.next:`,U=$localize`:@@ngb.pagination.last:`,te=$localize`:@@ngb.pagination.first-aria:First`,Fe=$localize`:@@ngb.pagination.previous-aria:Previous`,Ke=$localize`:@@ngb.pagination.next-aria:Next`,ot=$localize`:@@ngb.pagination.last-aria:Last`,[["first",""],["previous",""],["next",""],["last",""],["ellipsis",""],["defaultNumber",""],["defaultPages",""],["class","page-item",3,"disabled",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["aria-hidden","true"],A,f,S,U,["class","page-item",3,"active","disabled",4,"ngFor","ngForOf"],[1,"page-item"],["class","page-link","tabindex","-1","aria-disabled","true",4,"ngIf"],["class","page-link","href","",3,"click",4,"ngIf"],["tabindex","-1","aria-disabled","true",1,"page-link"],["href","",1,"page-link",3,"click"],["aria-label",te,"href","",1,"page-link",3,"click"],["aria-label",Fe,"href","",1,"page-link",3,"click"],["aria-label",Ke,"href","",1,"page-link",3,"click"],["aria-label",ot,"href","",1,"page-link",3,"click"]]},template:function(f,S){if(1&f&&(m.YNc(0,Gl,2,0,"ng-template",null,0,m.W1O),m.YNc(2,fo,2,0,"ng-template",null,1,m.W1O),m.YNc(4,ms,2,0,"ng-template",null,2,m.W1O),m.YNc(6,wo,2,0,"ng-template",null,3,m.W1O),m.YNc(8,pc,1,0,"ng-template",null,4,m.W1O),m.YNc(10,gc,1,1,"ng-template",null,5,m.W1O),m.YNc(12,Bc,1,1,"ng-template",null,6,m.W1O),m.TgZ(14,"ul"),m.YNc(15,is,3,9,"li",7),m.YNc(16,Al,3,8,"li",7),m.YNc(17,mc,0,0,"ng-template",8),m.YNc(18,ia,3,9,"li",7),m.YNc(19,Ws,3,9,"li",7),m.qZA()),2&f){const U=m.MAs(13);m.xp6(14),m.Tol("pagination"+(S.size?" pagination-"+S.size:"")),m.xp6(1),m.Q6J("ngIf",S.boundaryLinks),m.xp6(1),m.Q6J("ngIf",S.directionLinks),m.xp6(1),m.Q6J("ngTemplateOutlet",(null==S.tplPages?null:S.tplPages.templateRef)||U)("ngTemplateOutletContext",m.kEZ(8,Os,S.page,S.pages,S.disabled)),m.xp6(1),m.Q6J("ngIf",S.directionLinks),m.xp6(1),m.Q6J("ngIf",S.boundaryLinks)}},dependencies:[Mn.O5,Mn.ax,Mn.tP],encapsulation:2,changeDetection:0}),b})(),Wh=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})(),qh=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})(),Mf=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})(),Dd=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})(),ic=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})(),Tc=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})();const qu=(b,A)=>{const{classList:f}=b;if(A)return f.add("fade"),Zs(b),f.add("show","showing"),()=>{f.remove("showing")};f.add("show")},Du=({classList:b})=>(b.add("showing"),()=>{b.remove("show","showing")});let lh=(()=>{class b{constructor(f){this._ngbConfig=f,this.autohide=!0,this.delay=5e3,this.ariaLive="polite"}get animation(){return void 0===this._animation?this._ngbConfig.animation:this._animation}set animation(f){this._animation=f}}return b.\u0275fac=function(f){return new(f||b)(m.LFG(Yo))},b.\u0275prov=m.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})(),Sd=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275dir=m.lG2({type:b,selectors:[["","ngbToastHeader",""]],standalone:!0}),b})(),Ku=(()=>{class b{constructor(f,S,U,te){this.ariaLive=f,this._zone=U,this._element=te,this.contentHeaderTpl=null,this.shown=new m.vpe,this.hidden=new m.vpe,null==this.ariaLive&&(this.ariaLive=S.ariaLive),this.delay=S.delay,this.autohide=S.autohide,this.animation=S.animation}ngAfterContentInit(){this._zone.onStable.asObservable().pipe((0,ht.q)(1)).subscribe(()=>{this._init(),this.show()})}ngOnChanges(f){"autohide"in f&&(this._clearTimeout(),this._init())}hide(){this._clearTimeout();const f=Fr(this._zone,this._element.nativeElement,Du,{animation:this.animation,runningTransition:"stop"});return f.subscribe(()=>{this.hidden.emit()}),f}show(){const f=Fr(this._zone,this._element.nativeElement,qu,{animation:this.animation,runningTransition:"continue"});return f.subscribe(()=>{this.shown.emit()}),f}_init(){this.autohide&&!this._timeoutID&&(this._timeoutID=setTimeout(()=>this.hide(),this.delay))}_clearTimeout(){this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null)}}return b.\u0275fac=function(f){return new(f||b)(m.$8M("aria-live"),m.Y36(lh),m.Y36(m.R0b),m.Y36(m.SBq))},b.\u0275cmp=m.Xpm({type:b,selectors:[["ngb-toast"]],contentQueries:function(f,S,U){if(1&f&&m.Suo(U,Sd,7,m.Rgc),2&f){let te;m.iGM(te=m.CRH())&&(S.contentHeaderTpl=te.first)}},hostAttrs:["role","alert","aria-atomic","true",1,"toast"],hostVars:3,hostBindings:function(f,S){2&f&&(m.uIk("aria-live",S.ariaLive),m.ekj("fade",S.animation))},inputs:{animation:"animation",delay:"delay",autohide:"autohide",header:"header"},outputs:{shown:"shown",hidden:"hidden"},exportAs:["ngbToast"],standalone:!0,features:[m.TTD,m.jDz],ngContentSelectors:Ui,decls:5,vars:1,consts:function(){let A;return A=$localize`:@@ngb.toast.close-aria:Close`,[["headerTpl",""],[3,"ngIf"],[1,"toast-body"],[1,"me-auto"],[1,"toast-header"],[3,"ngTemplateOutlet"],["type","button","aria-label",A,1,"btn-close",3,"click"]]},template:function(f,S){1&f&&(m.F$t(),m.YNc(0,St,2,1,"ng-template",null,0,m.W1O),m.YNc(2,ni,3,1,"ng-template",1),m.TgZ(3,"div",2),m.Hsn(4),m.qZA()),2&f&&(m.xp6(2),m.Q6J("ngIf",S.contentHeaderTpl||S.header))},dependencies:[Mn.O5,Mn.tP],styles:["ngb-toast{display:block}ngb-toast .toast-header .close{margin-left:auto;margin-bottom:.25rem}\n"],encapsulation:2}),b})(),Md=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})(),nf=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})();new m.OlP("live announcer delay",{providedIn:"root",factory:function Xu(){return 100}});let Pf=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})(),uh=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({}),b})();const Rf=[Nl,d,ke,R,kh,cp,xl,Ds,uh,Wh,qh,Mf,Dd,ic,Tc,Md,nf,Pf];let kf=(()=>{class b{}return b.\u0275fac=function(f){return new(f||b)},b.\u0275mod=m.oAB({type:b}),b.\u0275inj=m.cJS({imports:[Rf,Nl,d,ke,R,kh,cp,xl,Ds,uh,Wh,qh,Mf,Dd,ic,Tc,Md,nf,Pf]}),b})()},7582:(ri,Lt,_e)=>{"use strict";function bt(ft,ht,Pt,Nt){return new(Pt||(Pt=Promise))(function(ln,oi){function mi(Si){try{di(Nt.next(Si))}catch(st){oi(st)}}function zi(Si){try{di(Nt.throw(Si))}catch(st){oi(st)}}function di(Si){Si.done?ln(Si.value):function hn(ln){return ln instanceof Pt?ln:new Pt(function(oi){oi(ln)})}(Si.value).then(mi,zi)}di((Nt=Nt.apply(ft,ht||[])).next())})}function Tt(ft){return this instanceof Tt?(this.v=ft,this):new Tt(ft)}function wt(ft,ht,Pt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var hn,Nt=Pt.apply(ft,ht||[]),ln=[];return hn={},oi("next"),oi("throw"),oi("return"),hn[Symbol.asyncIterator]=function(){return this},hn;function oi(Ci){Nt[Ci]&&(hn[Ci]=function(er){return new Promise(function(Mn,An){ln.push([Ci,er,Mn,An])>1||mi(Ci,er)})})}function mi(Ci,er){try{!function zi(Ci){Ci.value instanceof Tt?Promise.resolve(Ci.value.v).then(di,Si):st(ln[0][2],Ci)}(Nt[Ci](er))}catch(Mn){st(ln[0][3],Mn)}}function di(Ci){mi("next",Ci)}function Si(Ci){mi("throw",Ci)}function st(Ci,er){Ci(er),ln.shift(),ln.length&&mi(ln[0][0],ln[0][1])}}function Bt(ft){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Pt,ht=ft[Symbol.asyncIterator];return ht?ht.call(ft):(ft=function Tn(ft){var ht="function"==typeof Symbol&&Symbol.iterator,Pt=ht&&ft[ht],Nt=0;if(Pt)return Pt.call(ft);if(ft&&"number"==typeof ft.length)return{next:function(){return ft&&Nt>=ft.length&&(ft=void 0),{value:ft&&ft[Nt++],done:!ft}}};throw new TypeError(ht?"Object is not iterable.":"Symbol.iterator is not defined.")}(ft),Pt={},Nt("next"),Nt("throw"),Nt("return"),Pt[Symbol.asyncIterator]=function(){return this},Pt);function Nt(ln){Pt[ln]=ft[ln]&&function(oi){return new Promise(function(mi,zi){!function hn(ln,oi,mi,zi){Promise.resolve(zi).then(function(di){ln({value:di,done:mi})},oi)}(mi,zi,(oi=ft[ln](oi)).done,oi.value)})}}}_e.d(Lt,{FC:()=>wt,KL:()=>Bt,mG:()=>bt,qq:()=>Tt}),"function"==typeof SuppressedError&&SuppressedError}},ri=>{var Lt=m=>ri(ri.s=m);Lt(2614),Lt(8442)}]);